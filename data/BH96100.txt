 PROCESS OPT(TIME);                                                     
 BH96100:/* DAN DATA TIL EVS PERSONTABEL SAMT SLUT PÅ CSC */            
         PROCEDURE (EXECPARM) OPTIONS (MAIN) REORDER;                   
 /********************************************************************/ 
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KMD A/S 2012');  /*SLUT12*/   
 /**********************************************************************
 *                                                                     *
 * FORMÅL :  DAN DATA TIL EVS EJERSKABSTABELLER SAMT SLUT PÅ CSC       *
 *                                                                     *
 * INPUT  : B.H96000D  BEREGNINGSBÅND TIL SLUT 2008                    *
 *                                                                     *
 * OUTPUT : B.H96100D  UDTRÆK - EJERSKABSTABEL                         *
 *        : B.H96110D  UDTRÆK - EJERSKABSFELTTABEL                     *
 *          B.H96120D  UDTRÆK - EVS DATA TIL SLUT PÅ CSC               *
 *          BH96101Y   KØRSELSKONTROLLISTE                             *
 *          BH96102Y   FEJLLISTE FRA MASKINEL AFSTEMNING               *
 *                                                                     *
 * PROGRAMMØR: AAGE RASMUSSEN  JANUAR    2001                          *
 ***********************************************************************
 *                                                                     *
 * ÅRSTILRET : AAGE RASMUSSEN  DECEMBER  2001                          *
 *                                                                     *
 ***********************************************************************
 * RETTET:     OLUF MØRK             OMO, LSU/T&S BALLERUP 28.11.2002. *
 *             LOADFUNKTION ÆNDRET TIL NY TABELOPBYGNING.              *
 ***********************************************************************
 * RETTET:     OLUF MØRK             OMO, LSU/T&S BALLERUP 28.11.2002. *
 *             FEJLNR 5060 SKAL OVERSPRINGES VED DANNELSE AF LOAD OG   *
 *             DATA (EVSGRUND) TIL CSC.                                *
 ***********************************************************************
 * RETTET:     HANS ERIK KJELDSEN    HKS, LSU/T&S BALLERUP 19.11.2003. *
 *             ÅRSTIL RETTET MED NYE OG UDGÅEDE FELTER                 *
 ***********************************************************************
 * RETTET:     AAGE RASMUSSEN        AAR, LSU/T&S BALLERUP 24.11.2004. *
 *             ÅRSTIL RETTET MED NYE OG UDGÅEDE FELTER                 *
 ***********************************************************************
 * SLUT05      SUSANNE KROGH VILLUMSEN                     11.11.2005. *
 *             TILRETTET SLUT05                                        *
 *                                                                     *
 * SLUT06      BO SCHMIDT                                  04.10.2006. *
 *             TILRETTET SLUT06                                        *
 *                                                                     *
 * SLUT07      INGRID FISCHER                              04.10.2007. *
 *             TILRETTET SLUT07                                        *
 *                                                                     *
 * SLUT08      BO SCHMIDT                                  14.11.2008. *
 *             TILRETTET SLUT08                                        *
 *                                                                     *
 * SLUT09      GERD HOLM-PEDERSEN                          09.10.2009. *
 *             TILRETTET SLUT09                                        *
 *                                                                     *
 * SLUT10      GERD HOLM-PEDERSEN                          12.10.2010. *
 *             TILRETTET SLUT10                                        *
 *                                                                     *
 * SLUT11      GERD HOLM-PEDERSEN                          18.10.2011. *
 *             TILRETTET SLUT11                                        *
 *                                                                     *
 * SLUT12      LARS KAAE HARRITSHØJ                        SEP 2012    *
 *             TILRETTET SLUT12                                        *
 *                                                                     *
 * SLUT13      JØRGEN SAUGMANN                             OKT 2013    *
 *             TILRETTET SLUT13                                        *
 *                                                                     *
 * SLUT14      JØRGEN SAUGMANN                             OKT 2014    *
 *             TILRETTET SLUT14                                        *
 *                                                                     *
 * SLUT15     Z6JNK. Årsrullet. (Søg efter 'RUL')             OKT 2015 *
 * SLUT15      ESBEN BRODERSEN                             MAR 2016    *
 *             UDVIDET BRUG AF BH65300M DATO/ÅRSTALS INCLUDE #01       *
 * SLUT16      OPTÆLING PÅ BLANKE BELIGHED ELLER BLANK CLANDEKODE      *
 * SLUT17      ESBEN BRODERSEN                             OKT 2017    *
 *             INGEN RETTELSER                                         *
 **********************************************************************/
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /*********************************************************************/
 /*      PARAMETER TIL ANGIVELSE AF OM DET ER PRODUKTION ELLER        */
 /*      TESTKØRSEL AF HENSYN TIL MASKINEL AFSTEMNING                 */
 /*********************************************************************/
 DCL     EXECPARM        CHAR      (6) VAR;                             
 DCL     EX_PARM         CHAR      (4);                                 
         EX_PARM = EXECPARM;                                            
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL BH960I  FILE RECORD INPUT;  /* BEREGN.BÅND EFTER BEREGN.         */
 DCL BH961O  FILE RECORD OUTPUT; /* EVS DATA TIL SLUT PÅ CSC          */
 DCL BQ300O  FILE RECORD OUTPUT; /* LOADFIL EJERSKABSTABEL     2008   */
 DCL BQ310O  FILE RECORD OUTPUT; /* LOADFIL EJERSKABSFELTTABEL 2008   */
 /********************************************************************* 
 *       DECLARE AF UDTRÆK                                            * 
 *********************************************************************/ 
 DCL     BH960_AR        CHAR (23472) VAR;                              
 DCL     1 BH960         BASED     (ADDR(BH960_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH90000N;;                                          
 DCL     1 BH96099       BASED     (ADDR(BH960_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH90099N;                                           
                                                                        
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (LOAD-GRUNDLAG)                            * 
 *********************************************************************/ 
                                                                        
 DCL     1 BQ300_STRUK,         /* EJERSKABSTABEL */                    
           %INCLUDE BQ30000N;;                                          
 DCL     1 BQ310_STRUK,         /* EJERSKABSFELTTABEL  */               
           %INCLUDE BQ31000N;;                                          
                                                                        
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (SLUT PÅ CSC)                              * 
 *********************************************************************/ 
 DCL     1 BH961,                                                       
           %INCLUDE BH96110N;;                                          
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_BH960    FIXED DEC (11),                               
           2 KUN_EJDTAB   FIXED DEC (11),                               
           2 SKREVET      FIXED DEC (11),                               
           2 BEREGNET     FIXED DEC (11),                               
           2 EVSNYTÅR     FIXED DEC (15,2),                             
           2 BPROM1       FIXED DEC (11),                               
           2 BPROM2       FIXED DEC (11),                               
           2 BNEDSL1      FIXED DEC (11),                               
           2 BNEDSL2      FIXED DEC (11),                               
           2 CPENSN1      FIXED DEC (11),                               
           2 CPENSN2      FIXED DEC (11),                               
           2 BFASTSTIG    FIXED DEC (11),                               
           2 BER_BOPÆL0   FIXED DEC (11),                               
           2 BER_BOPÆL1   FIXED DEC (11),                               
           2 BER_BOPÆL2   FIXED DEC (11),                               
           2 BER_BOPÆL3   FIXED DEC (11),                               
           2 BER_BOPÆL4   FIXED DEC (11),                               
           2 BER_BOPÆL5   FIXED DEC (11),                               
           2 BER_BOPÆL6   FIXED DEC (11),                               
           2 EJBEREGNET   FIXED DEC (11),                               
           2 EJBER_BOPÆL0 FIXED DEC (11),                               
           2 EJBER_BOPÆL1 FIXED DEC (11),                               
           2 EJBER_BOPÆL2 FIXED DEC (11),                               
           2 EJBER_BOPÆL3 FIXED DEC (11),                               
           2 EJBER_BOPÆL4 FIXED DEC (11),                               
           2 EJBER_BOPÆL5 FIXED DEC (11),                               
           2 EJBER_BOPÆL6 FIXED DEC (11),                               
           2 BEVSGL       FIXED DEC (15,2),                             
           2 FANTGLÅR     FIXED DEC (11),                               
           2 FANTHELÅRSOM FIXED DEC (11),                               
           2 BQ300_SKRIV  FIXED DEC (11),                               
           2 BQ310_SKRIV  FIXED DEC (11),                               
           2 UDLANDSK_EJD FIXED DEC (11),    /*Ny slut 2016*/           
           2 BLANK_CLANDKODE FIXED DEC (11), /*Ny slut 2016*/           
           2 BLANK_BELIGHED  FIXED DEC (11); /*Ny slut 2016*/           
                                                                        
 DCL     1 LÆST_FEJLNR(4000:6000), /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
                                                                        
 DCL     1 SKR_FEJLNR(4000:6000),  /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_EJBEVS(0:9),        /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_BERGRL(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_CSTIBLB(10),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_EJDTYP(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 TAB_PERSON(16),         /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 TEKST       CHAR      (60),                                
           2 ANTAL       FIXED DEC (7);                                 
 DCL     MAX_ANT_INDV    FIXED DEC (7) INIT (0);                        
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     ZS34900         ENTRY OPTIONS (INTER ASM);   /* FAKTURERING  */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    LIN_DEB          CHAR      (133);                               
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH96100L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (                
           'DAN DATA TIL EVS EJERSKABSTABEL SAMT SLUT PÅ CSC'),         
           2 F2          CHAR      (12)      INIT      (' '),           
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZ.ZZZ.ZZZ.ZZZ',                    
           2 F2          CHAR      (58)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZ.ZZZ.ZZZ.ZZ9',                    
           2 F2          CHAR      (07)      INIT      (' '),           
           2 TEKST2      CHAR      (07)      INIT      ('BELØB: '),     
           2 BELØB       PIC       'Z.ZZZ.ZZZ.ZZZ.ZZ9,V99',             
           2 F3          CHAR      (24)      INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     EOF_BH960       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     INDEX           BIN FIXED (31);                                
 DCL     I               BIN FIXED (15);                                
 DCL     HJ_CHAR4        CHAR      (4);                                 
 DCL     HJ_PIC4         PIC       '(4)9'  BASED(ADDR(HJ_CHAR4));       
                                                                        
 DCL     HJ_FEJLNR       PIC       '(4)9';                              
 DCL     HJ_FEJLNRC      CHAR      (4)     BASED(ADDR(HJ_FEJLNR));      
                                                                        
 DCL     HJ_CHAR1        CHAR      (1);                                 
 DCL     HJ_PIC1         PIC       '9'     BASED(ADDR(HJ_CHAR1));       
 DCL     HJ_CHAR2        CHAR      (2);                                 
 DCL     HJ_PIC2         PIC       '99'    BASED(ADDR(HJ_CHAR2));       
 DCL     HJ_CHAR3        CHAR      (3);                                 
 DCL     HJ_PIC3         PIC       '999'   BASED(ADDR(HJ_CHAR3));       
 DCL     HJ_CHAR7        CHAR      (7);                                 
 DCL     HJ_PIC7         PIC       '(7)9'  BASED(ADDR(HJ_CHAR7));       
                                                                        
 DCL     GLPNR           FIXED     (11)      INIT      (0);             
 DCL     AKTPNR          FIXED     (11)      INIT      (0);             
 DCL     FANTINDV    BIN FIXED     (31)      INIT      (0);             
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     HJ_CHAR10     CHAR (10);                                       
 DCL     HJ_CHAR_4_PIC PIC '9999';                                      
 DCL     HJ_CHAR_4     CHAR (4) DEF HJ_CHAR_4_PIC;                      
 DCL     DEC_15_2      DEC FIXED (15,2);                                
 DCL     CHAR254       CHAR (254) INIT (' ');                           
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     1 BH65300M      ALIGNED,                                       
           %INCLUDE BH65300M;                                           
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *********************************************************************/ 
 DCL     BH960_ANT_INDV  FIXED     (7)       INIT      (0);             
 DCL     SWFEJL          CHAR      (1)       INIT      (' ');           
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         EOF_BH960 = NEJ;                                               
                                                                        
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
                                                                        
         OPEN FILE (BH960I)  TITLE ('BH96000I');                        
         OPEN FILE (BH961O)  TITLE ('BH96120O');                        
                                                                        
         OPEN FILE (BQ300O)  TITLE ('BH96100O');  /* 2002 */            
         OPEN FILE (BQ310O)  TITLE ('BH96110O');  /* 2002 */            
                                                                        
         ON ENDFILE (BH960I)                                            
            EOF_BH960 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH96101Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         TV = 0;                                                        
                                                                        
         DO INDEX = 4000 TO 6000;                                       
            LÆST_FEJLNR(INDEX).ANTAL = 0;                               
            SKR_FEJLNR(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            SKR_EJBEVS(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_BERGRL(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_EJDTYP(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 1 TO 10;                                            
            LÆST_CSTIBLB(INDEX).ANTAL = 0;                              
         END;                                                           
                                                                        
         DO INDEX = 1 TO 16;                                            
            TAB_PERSON(INDEX).ANTAL  = 0;                               
         END;                                                           
                                                                        
         TAB_PERSON(1).TEKST  = 'ANTAL PERSONER TIL PERSONTABEL IALT:'; 
         TAB_PERSON(2).TEKST  = '      HERAF MED 1 EJENDOM           '; 
         TAB_PERSON(3).TEKST  = '      HERAF MED 2 EJENDOMME         '; 
         TAB_PERSON(4).TEKST  = '      HERAF MED 3 EJENDOMME         '; 
         TAB_PERSON(5).TEKST  = '      HERAF MED 4 EJENDOMME         '; 
         TAB_PERSON(6).TEKST  = '      HERAF MED 5 EJENDOMME         '; 
         TAB_PERSON(7).TEKST  = '      HERAF MED 6 EJENDOMME         '; 
         TAB_PERSON(8).TEKST  = '      HERAF MED 7 EJENDOMME         '; 
         TAB_PERSON(9).TEKST  = '      HERAF MED 8 EJENDOMME         '; 
         TAB_PERSON(10).TEKST = '      HERAF MED 9 EJENDOMME         '; 
         TAB_PERSON(11).TEKST = '      HERAF MED 10 EJENDOMME        '; 
         TAB_PERSON(12).TEKST = '      HERAF MED 11-20 EJENDOMME     '; 
         TAB_PERSON(13).TEKST = '      HERAF MED 21-30 EJENDOMME     '; 
         TAB_PERSON(14).TEKST = '      HERAF MED 31-40 EJENDOMME     '; 
         TAB_PERSON(15).TEKST = '      HERAF MED 41-50 EJENDOMME     '; 
         TAB_PERSON(16).TEKST = '      HERAF MED OVER 50 EJENDOMME   '; 
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_BH960;                                                
                                                                        
         DO WHILE ( EOF_BH960 = NEJ );                                  
                                                                        
            CALL BEHANDLOAD;                                            
            CALL BEHANDELCSC;                                           
                                                                        
            CALL LÆS_BH960;                                             
                                                                        
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR                                           * 
 *********************************************************************/ 
 LÆS_BH960:                                                             
         PROC;                                                          
                                                                        
         READ FILE (BH960I) INTO (BH960_AR);                            
                                                                        
         IF BH960.SORT_CPR = 99999999999     /* OPTÆLL.INDV. 1 */       
         THEN                                                           
            DO;                                                         
               BH960_ANT_INDV = BH96099.ANT_INDV;                       
               READ FILE (BH960I) INTO (BH960_AR);                      
            END;                                                        
                                                                        
         IF EOF_BH960 = NEJ                                             
         THEN                                                           
            TV.LÆS_BH960 = TV.LÆS_BH960 + 1;                            
                                                                        
 END LÆS_BH960;                                                         
 /********************************************************************* 
 *       PERSONER SOM EVT. SKAL BEREGNES                              * 
 *********************************************************************/ 
 BEHANDLOAD: PROC;                                                      
                                                                        
         IF (BH960.TIL_EVS.DAFSTAA > 0 &                                
             BH960.TIL_EVS.DAFSTAA < BH960.MT.DRGNÅRFRA)                
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH960.FEJLNR > 0                                            
         THEN                                                           
            DO;                                                         
               HJ_FEJLNR = BH960.FEJLNR;                                
               INDEX = HJ_FEJLNR;                                       
               LÆST_FEJLNR(INDEX).ANTAL = LÆST_FEJLNR(INDEX).ANTAL + 1; 
            END;                                                        
                                                                        
         IF BH960.FEJLNR = 5001 !                                       
           (BH960.TIL_EVS.CEJBEVS = '1' & BH960.FEJLNR = 5008) !        
            BH960.FEJLNR = 5020 !                                       
            BH960.FEJLNR = 5060                                         
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH960.MT.CCIVS = 'D' &                                      
            BH960.MT.HIST_OPL(SLUTÅR).DCIÆN > 0 &   /* EJER ER DØD   */ 
           (BH960.MT.HIST_OPL(SLUTÅR).DCIÆN <       /* FØR INDK.ÅRET */ 
            BH960.MT.DRGNÅRFRA)                                         
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH960.CINVPNR > '0'                                         
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH960.CKUN_SLS = '1'                                        
         THEN                                                           
            RETURN;                                                     
                                                                        
         HJ_CHAR1 = BH960.EJENDOM.CEJDTYPE;                             
         INDEX = HJ_PIC1;                                               
         LÆST_EJDTYP(INDEX).ANTAL = LÆST_EJDTYP(INDEX).ANTAL + 1;       
                                                                        
         HJ_CHAR1 = BH960.EJENDOM.CBERGRL;                              
         INDEX = HJ_PIC1;                                               
         LÆST_BERGRL(INDEX).ANTAL = LÆST_BERGRL(INDEX).ANTAL + 1;       
                                                                        
         IF BH960.TIL_EVS.FELT759 = '1'                                 
         THEN                                                           
            TV.CPENSN1 = TV.CPENSN1 + 1;                                
                                                                        
         IF BH960.TIL_EVS.FELT759 = '2'                                 
         THEN                                                           
            TV.CPENSN2 = TV.CPENSN2 + 1;                                
                                                                        
         IF BH960.TIL_EVS.BFASTSTIGBGR_SW = 0                           
         THEN                                                           
            TV.BFASTSTIG = TV.BFASTSTIG + 1;                            
                                                                        
         IF BH960.FRA_EVS_BER.CSTIBLB > '00'                            
         THEN                                                           
           DO;                                                          
             HJ_CHAR2 = BH960.FRA_EVS_BER.CSTIBLB;                      
             INDEX = HJ_PIC2;                                           
             LÆST_CSTIBLB(INDEX).ANTAL = LÆST_CSTIBLB(INDEX).ANTAL + 1; 
           END;                                                         
                                                                        
         BQ300_STRUK.DCPRN       = BH960.SORT_CPR;                      
         BQ300_STRUK.DINDKAAR    = BH65300M.SLUTÅR;  /*#01*/            
         BQ300_STRUK.EKOMNR      = BH960.SORT_KOMNR;                    
         BQ300_STRUK.EEJDNR      = BH960.SORT_EJDNR;                    
         BQ300_STRUK.ELBNR       = BH960.UDSKRLBNR;                     
         BQ300_STRUK.EGENNR      = 1;                                   
         BQ300_STRUK.CDATAFRA    = TIL_EVS.CDATAFRA;                    
         BQ300_STRUK.DFRAGLD     = DATO2.ÅR !! '-' !! DATO2.MD !! '-' !!
                                   DATO2.DG !! '-01.01.01.000001';      
         BQ300_STRUK.DTILGLD     = '9999-12-31-23.59.59.999999';        
         BQ300_STRUK.CSCREGISTMP = '';                                  
         BQ300_STRUK.PERSKOD     = '';                                  
         BQ300_STRUK.MYNDNR      = '';                                  
                                                                        
         IF BH960.ESR.EJER.COMPLA > '0'                                 
         THEN                                                           
            DO;                                                         
               BQ300_STRUK.COMPLA = BH960.ESR.EJER.COMPLA;              
               BQ300_STRUK.DOMPLACPR = BH960.ESR.EJER.DOMPLACPR;        
            END;                                                        
         ELSE                                                           
            DO;                                                         
               BQ300_STRUK.COMPLA    = '';                              
               BQ300_STRUK.DOMPLACPR = '';                              
            END;                                                        
                                                                        
         BQ300_STRUK.CAJOUR = ' ';                                      
         BQ300_STRUK.CSUPPL = '1';  /* DEFAULT */                       
                                                                        
         IF BH960.FEJLNR > 0                                            
         THEN                                                           
            DO;                                                         
               HJ_FEJLNR = BH960.FEJLNR;                                
               BQ300_STRUK.FEJLNR = HJ_FEJLNRC;                         
            END;                                                        
         ELSE                                                           
            BQ300_STRUK.FEJLNR = ' ';                                   
                                                                        
         WRITE FILE(BQ300O) FROM(BQ300_STRUK);                          
                                                                        
         TV.BQ300_SKRIV = TV.BQ300_SKRIV + 1;                           
                                                                        
         BQ310_STRUK.DCPRN       = BH960.SORT_CPR;                      
         BQ310_STRUK.DINDKAAR    = BH65300M.SLUTÅR;  /*#01*/            
         BQ310_STRUK.EKOMNR      = BH960.SORT_KOMNR;                    
         BQ310_STRUK.EEJDNR      = BH960.SORT_EJDNR;                    
         BQ310_STRUK.ELBNR       = BH960.UDSKRLBNR;                     
         BQ310_STRUK.EGENNR      = 1;                                   
                                                                        
         CALL OPBYG_BQ31000T;                                           
                                                                        
         IF BH960.FEJLNR > 0                                            
         THEN                                                           
            DO;                                                         
              HJ_FEJLNR = BH960.FEJLNR;                                 
              INDEX = HJ_FEJLNR;                                        
              SKR_FEJLNR(INDEX).ANTAL = SKR_FEJLNR(INDEX).ANTAL + 1;    
            END;                                                        
                                                                        
         IF BH960.TIL_EVS.CEJBEVS >= '0'                                
         THEN                                                           
            DO;                                                         
              HJ_CHAR1 = BH960.TIL_EVS.CEJBEVS;                         
              INDEX = HJ_PIC1;                                          
              SKR_EJBEVS(INDEX).ANTAL = SKR_EJBEVS(INDEX).ANTAL + 1;    
            END;                                                        
                                                                        
         IF BH960.TIL_EVS.CEJBEVS = '0'                                 
         THEN                                                           
            DO;                                                         
              TV.BEREGNET = TV.BEREGNET + 1;                            
              TV.EVSNYTÅR = TV.EVSNYTÅR + BH960.FRA_EVS_BER.BNETTO;     
              IF BH960.CHELÅR = '1' !                                   
                 BH960.CHELÅR = '2' !                                   
                 BH960.CHELÅR = '3' !                                   
                 BH960.CHELÅR = '7' !                                   
                 BH960.CHELÅR = '8' !                                   
                 BH960.CHELÅR = '9'                                     
              THEN                                                      
                 TV.FANTHELÅRSOM = TV.FANTHELÅRSOM + 1;                 
              IF BH960.FRA_EVS_BER.BPROM1 ^= 0                          
              THEN                                                      
                 TV.BPROM1 = TV.BPROM1 + 1;                             
              IF BH960.FRA_EVS_BER.BPROM2 ^= 0                          
              THEN                                                      
                 TV.BPROM2 = TV.BPROM2 + 1;                             
              IF BH960.FRA_EVS_BER.BNEDSL1 ^= 0                         
              THEN                                                      
                 TV.BNEDSL1 = TV.BNEDSL1 + 1;                           
              IF BH960.FRA_EVS_BER.BNEDSL2 ^= 0                         
              THEN                                                      
                 TV.BNEDSL2 = TV.BNEDSL2 + 1;                           
                                                                        
              SELECT (BH960.AKT_EJER.BOPÆLSKODE);                       
                WHEN ('1')                                              
                  TV.BER_BOPÆL1 = TV.BER_BOPÆL1 + 1;                    
                WHEN ('2')                                              
                  TV.BER_BOPÆL2 = TV.BER_BOPÆL2 + 1;                    
                WHEN ('3')                                              
                  TV.BER_BOPÆL3 = TV.BER_BOPÆL3 + 1;                    
                WHEN ('4')                                              
                  TV.BER_BOPÆL4 = TV.BER_BOPÆL4 + 1;                    
                WHEN ('5')                                              
                  TV.BER_BOPÆL5 = TV.BER_BOPÆL5 + 1;                    
                WHEN ('6')                                              
                  TV.BER_BOPÆL6 = TV.BER_BOPÆL6 + 1;                    
                OTHERWISE                                               
                  TV.BER_BOPÆL0 = TV.BER_BOPÆL0 + 1;                    
              END;                                                      
            END;                                                        
         ELSE                                                           
            DO;                                                         
              TV.EJBEREGNET = TV.EJBEREGNET + 1;                        
              SELECT (BH960.AKT_EJER.BOPÆLSKODE);                       
                WHEN ('1')                                              
                  TV.EJBER_BOPÆL1 = TV.EJBER_BOPÆL1 + 1;                
                WHEN ('2')                                              
                  TV.EJBER_BOPÆL2 = TV.EJBER_BOPÆL2 + 1;                
                WHEN ('3')                                              
                  TV.EJBER_BOPÆL3 = TV.EJBER_BOPÆL3 + 1;                
                WHEN ('4')                                              
                  TV.EJBER_BOPÆL4 = TV.EJBER_BOPÆL4 + 1;                
                WHEN ('5')                                              
                  TV.EJBER_BOPÆL5 = TV.EJBER_BOPÆL5 + 1;                
                WHEN ('6')                                              
                  TV.EJBER_BOPÆL6 = TV.EJBER_BOPÆL6 + 1;                
                OTHERWISE                                               
                  TV.EJBER_BOPÆL0 = TV.EJBER_BOPÆL0 + 1;                
              END;                                                      
            END;                                                        
                                                                        
         IF BH960.TIL_EVS.BEVSGL_SW = 0                                 
         THEN                                                           
            DO;                                                         
               TV.BEVSGL = TV.BEVSGL + BH960.TIL_EVS.BEVSGL;            
               TV.FANTGLÅR = TV.FANTGLÅR + 1;                           
            END;                                                        
                                                                        
         IF AKTPNR ^= BH960.SORT_CPR                                    
         THEN                                                           
            DO;                                                         
               IF FANTINDV > 0                                          
               THEN                                                     
                  CALL OPTÆL_PERSON;                                    
               FANTINDV = 1;                                            
               AKTPNR = BH960.SORT_CPR;                                 
            END;                                                        
         ELSE                                                           
            /* OPTÆL ANTAL INDIVIDER PR. PERSON */                      
            FANTINDV = FANTINDV + 1;                                    
                                                                        
 END BEHANDLOAD;                                                        
 /*********************************************************************/
 /*    SKRIV PÅ FLAT SEKV DATASÆT TIL LOAD PÅ DB2 TABEL BQ31000T      */
 /*********************************************************************/
 SKRIV_BQ310: PROC(FELT_NUMMER, INDHOLD, HJ_BLB);                       
                                                                        
      DCL FELT_NUMMER  BIN FIXED(31);                                   
      DCL INDHOLD      CHAR(254);                                       
      DCL HJ_BLB       FIXED (15,2);                                    
                                                                        
      BQ310_STRUK.DCPRN         = BH960.SORT_CPR;                       
      BQ310_STRUK.DINDKAAR      = BH65300M.SLUTÅR;  /*#01*/             
      BQ310_STRUK.EKOMNR        = BH960.SORT_KOMNR;                     
      BQ310_STRUK.EEJDNR        = BH960.SORT_EJDNR;                     
      BQ310_STRUK.ELBNR         = BH960.UDSKRLBNR;                      
      BQ310_STRUK.EGENNR        = 1;                                    
      BQ310_STRUK.FELTKODE      = FELT_NUMMER;                          
      BQ310_STRUK.FELTKODETYPE  = '3';                                  
      BQ310_STRUK.INDHOLD_C     = INDHOLD;                              
      BQ310_STRUK.INDHOLD_D     = HJ_BLB;                               
                                                                        
      WRITE FILE(BQ310O) FROM(BQ310_STRUK);                             
                                                                        
      TV.BQ310_SKRIV = TV.BQ310_SKRIV + 1;                              
                                                                        
      DEC_15_2 = 0;                                                     
      CHAR254  = ' ';                                                   
                                                                        
 END SKRIV_BQ310;                                                       
 /********************************************************************* 
 *       DAN DATASÆT TIL CSC                                          * 
 *********************************************************************/ 
 BEHANDELCSC: PROC;                                                     
                                                                        
         IF (BH960.TIL_EVS.DAFSTAA > 0 &                                
             BH960.TIL_EVS.DAFSTAA < BH960.MT.DRGNÅRFRA)                
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH960.FEJLNR = 5001 !                                       
           (BH960.TIL_EVS.CEJBEVS = '1' & BH960.FEJLNR = 5008) !        
            BH960.FEJLNR = 5020 !                                       
            BH960.FEJLNR = 5024 !                                       
            BH960.FEJLNR = 5060  /* 2002 */                             
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH960.MT.CCIVS = 'D' &                                      
            BH960.MT.HIST_OPL(SLUTÅR).DCIÆN > 0 &   /* EJER ER DØD   */ 
           (BH960.MT.HIST_OPL(SLUTÅR).DCIÆN <       /* FØR INDK.ÅRET */ 
            BH960.MT.DRGNÅRFRA)                                         
         THEN                                                           
            RETURN;                                                     
                                                                        
        IF BH960.CINVPNR > '0' !                                        
            BH960.ESR.EJER.COMPLA = '1'                                 
         THEN                                                           
            RETURN;                                                     
                                                                        
                                                                        
        /* Ny slut 2016 */                                              
        IF BH960.SORT_KOMNR = 999                                       
        THEN                                                            
          DO;                                                           
            TV.UDLANDSK_EJD = TV.UDLANDSK_EJD + 1;                      
            IF BH960.EJENDOM.CLANDEKODE = ''                            
            THEN                                                        
              DO;                                                       
                TV.BLANK_CLANDKODE = TV.BLANK_CLANDKODE + 1;            
              END;                                                      
                                                                        
            IF BH960.EJENDOM.EJDBELIG = ''                              
            THEN                                                        
              DO;                                                       
                TV.BLANK_BELIGHED = TV.BLANK_BELIGHED + 1;              
              END;                                                      
          END;                                                          
                                                                        
                                                                        
        CALL DAN_DATA_TIL_SLUT;                                         
                                                                        
 END BEHANDELCSC;                                                       
 /********************************************************************* 
 *       OPTÆL STATUS FOR DENNE PERSON                                * 
 *********************************************************************/ 
 OPTÆL_PERSON:                                                          
         PROC;                                                          
                                                                        
         SELECT;                                                        
           WHEN (FANTINDV = 1)                                          
              INDEX = 2;                                                
           WHEN (FANTINDV = 2)                                          
              INDEX = 3;                                                
           WHEN (FANTINDV = 3)                                          
              INDEX = 4;                                                
           WHEN (FANTINDV = 4)                                          
              INDEX = 5;                                                
           WHEN (FANTINDV = 5)                                          
              INDEX = 6;                                                
           WHEN (FANTINDV = 6)                                          
              INDEX = 7;                                                
           WHEN (FANTINDV = 7)                                          
              INDEX = 8;                                                
           WHEN (FANTINDV = 8)                                          
              INDEX = 9;                                                
           WHEN (FANTINDV = 9)                                          
              INDEX = 10;                                               
           WHEN (FANTINDV = 10)                                         
              INDEX = 11;                                               
           WHEN (FANTINDV >= 11 & FANTINDV  <= 20)                      
              INDEX = 12;                                               
           WHEN (FANTINDV >= 21 & FANTINDV  <= 30)                      
              INDEX = 13;                                               
           WHEN (FANTINDV >= 31 & FANTINDV  <= 40)                      
              INDEX = 14;                                               
           WHEN (FANTINDV >= 41 & FANTINDV  <= 50)                      
              INDEX = 15;                                               
           OTHERWISE                                                    
              INDEX = 16;                                               
         END;                                                           
                                                                        
         TAB_PERSON(1).ANTAL = TAB_PERSON(1).ANTAL + 1;                 
         TAB_PERSON(INDEX).ANTAL = TAB_PERSON(INDEX).ANTAL + 1;         
                                                                        
         IF MAX_ANT_INDV < FANTINDV                                     
         THEN                                                           
            MAX_ANT_INDV = FANTINDV;                                    
                                                                        
 END OPTÆL_PERSON;                                                      
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH960;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK             B.H96000D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF LÆST_EJDTYP(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJENDOMSTYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_EJDTYP(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF LÆST_BERGRL(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED BER.GRL.TYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_BERGRL(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 1 TO 10;                                            
            IF LÆST_CSTIBLB(INDEX).ANTAL > 0                            
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC2 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED CSTIBLB ' !! HJ_CHAR2;               
                  DETLIN1.ANTAL = LÆST_CSTIBLB(INDEX).ANTAL;            
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 4000 TO 6000;                                       
            IF LÆST_FEJLNR(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = LÆST_FEJLNR(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.KUN_EJDTAB;                                 
         DETLIN1.TEKST = 'HERAF INDIVIDER KUN TIL EVS-EJENDOMSTABEL  '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER TIL CSC   B.H96110D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.BQ300_SKRIV;                                
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER            BQ30000T'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.BQ310_SKRIV;                                
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER            BQ31000T'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 4000 TO 6000;                                       
            IF SKR_FEJLNR(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = SKR_FEJLNR(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF SKR_EJBEVS(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED CEJBEVS ' !! HJ_CHAR1;               
                  DETLIN1.ANTAL = SKR_EJBEVS(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(1).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(1).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(2).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(2).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(3).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(3).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(4).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(4).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(5).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(5).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(6).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(6).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(7).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(7).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(8).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(8).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(9).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(9).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(10).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(10).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(11).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(11).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(12).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(12).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(13).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(13).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(14).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(14).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(15).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(15).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = TAB_PERSON(16).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(16).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = MAX_ANT_INDV;                                  
         DETLIN1.TEKST = 'MAX. ANTAL EJENDOMME TIL SAMME PERSON';       
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.FANTGLÅR;                                   
         DETLIN2.TEKST = 'BEREGNET GL. EVS TIL STIGN.BEGR.     ANTAL:'; 
         DETLIN2.BELØB = TV.BEVSGL;                                     
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.BEREGNET;                                   
         DETLIN2.TEKST = 'ANTAL BEREGNEDE EJENDOMME (EVS)            '; 
         DETLIN2.BELØB = TV.EVSNYTÅR;                                   
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FANTHELÅRSOM;                               
         DETLIN1.TEKST = '    HERAF HELÅRSSOMMERHUSE           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM1;                                     
         DETLIN1.TEKST = '    HERAF MED 10 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM2;                                     
         DETLIN1.TEKST = '    HERAF MED 30 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL1;                                    
         DETLIN1.TEKST = '    HERAF MED 2 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL2;                                    
         DETLIN1.TEKST = '    HERAF MED 4 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN1;                                    
         DETLIN1.TEKST = '    HERAF MED PENS.NEDSLAG = 1       ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN2;                                    
         DETLIN1.TEKST = '    HERAF MED PENS.NEDSLAG = 2       ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BFASTSTIG;                                  
         DETLIN1.TEKST = '    HERAF MED FASTFROSSET NEDSLAG    ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL1;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL2;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL3;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL4;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL5;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL6;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL0;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.EJBEREGNET;                                 
         DETLIN1.TEKST = 'ANTAL IKKE BEREGNEDE EJENDOMME (EVS)       '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL1;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL2;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL3;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL4;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL5;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL6;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL0;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         /* Nye til slut 2016 */                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.UDLANDSK_EJD;                               
         DETLIN1.TEKST = 'ANTAL UDENLANDSKE EJENDOMME ';                
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BLANK_BELIGHED;                             
         DETLIN1.TEKST = '    HERAF MED BLANK BELIGHED ANTAL:';         
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BLANK_CLANDKODE;                            
         DETLIN1.TEKST = '    HERAF MED BLANK CLANDEKODE ANTAL:';       
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
                                                                        
                                                                        
  END TOTALLISTE;                                                       
 /********************************************************************* 
 *       MASKINEL AFSTEMNING                                          * 
 *********************************************************************/ 
 MASK_AFSTEMNING:                                                       
         PROC;                                                          
         IF BH96099.SORT_KOMNR ^= 999                                   
         THEN                                                           
            CALL FEJLLISTE('1');                                        
         IF BH960_ANT_INDV ^= TV.LÆS_BH960 &                            
            EX_PARM ^= 'TEST'                                           
         THEN                                                           
            CALL FEJLLISTE('2');                                        
 END MASK_AFSTEMNING;                                                   
 /*********************************************************************/
 /*      UDSKRIV FEJLLISTE VEDR. KONSTATERET AFSTEMNINGFEJL PÅ ???    */
 /*********************************************************************/
 FEJLLISTE:                                                             
         PROC(FEJL);                                                    
 DCL     FEJL            CHAR      (01);                                
         CALL ZZ20390 ('*OPEN','BH96102Y');                             
         CALL ZZ20300(SIDELIN,'02');                                    
         CALL ZZ20300(OVERLIN1,'02');                                   
         OVERLIN2.CCA = ZZWS3;                                          
         OVERLIN2.TEKST1 = 'FEJLLISTE VEDR. MASKINEL AFSTEMNING';       
         CALL ZZ20300(OVERLIN2,'02');                                   
         IF FEJL = '1'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  =                                         
               'AFSTEMNINGSINDIVID MANGLER PÅ B.H96000D';               
               DETLIN1.ANTAL = '';                                      
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '2'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST = 'ANTAL LÆSTE INDIVIDER PÅ B.H96000D';    
               DETLIN1.ANTAL = TV.LÆS_BH960;                            
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST =                                          
               'ANTAL IFØLGE AFSTEMNINGSINDIVID IALT  :';               
               DETLIN1.ANTAL = BH960_ANT_INDV;                          
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
            SWFEJL = '1';                                               
 END FEJLLISTE;                                                         
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
         CALL OPTÆL_PERSON;                /* SIDSTE PERSON OPTÆLLES */ 
         CALL FAKTURER_TS;                                              
         CALL TOTALLISTE;                                               
         CALL MASK_AFSTEMNING;                                          
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH960I),                                           
               FILE (BH961O),                                           
               FILE (BQ300O),     /* 2004 */                            
               FILE (BQ310O);     /* 2004 */                            
         IF SWFEJL = '1'                                                
         THEN                                                           
            CALL ZS30101(4,'BH96100 ** 251 ' !!                         
                 'MASKINEL KONSTATERET AFSTEMNINGSFEJL',2);             
 END AFSLUT;                                                            
 /********************************************************************* 
 *       DIVERSE INCLUDES                                             * 
 *********************************************************************/ 
                                                                        
         %INCLUDE BH00003M;                    /* FIX09_TIL_DB2_DATO  */
         %INCLUDE BH96102M;                    /* DAN_DATA_TIL_SLUT   */
         %INCLUDE BH96100M;                    /* FAKTURER T&S        */
         %INCLUDE BH96131M;      /* 2008       /* OPBYG BQ31000T      */
                                                                        
 END  BH96100;                                                          
