  PROCESS OPT(TIME);                                                    
 BH61100: /**  ESKEMA - PÅSÆT CSMUDS M.V. PÅ BEREGNINGSBÅND  **/        
         PROCEDURE(EXECPARM) OPTIONS (MAIN) REORDER;                    
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 1998');       
 /********************************************************************* 
 * PROGRAMMETS FORMÅL ER AT OPSÆTTE DIVERSE OPLYSNINGER PÅ BEREGNINGS-* 
 * BÅNDET (SLUTLIGNINGSKOMMUNE, CSMUDS, CVÆRGE, EJ PÅ MANDTAL, DØD    * 
 * IFLG. MANDTAL M.V.) P.G.A. MINI-MTFILEN FRA SLUTMANDTAL.           * 
 * OPLYSNINGERNE SKAL BENYTTES TIL STYRING AF UDSKRIVNING AF USA, BSA * 
 * SAMT EJENDOMSSKEMAER (EJENDOMSSKEMAER VED EJ PLADS TIL EJENDOMSOP- * 
 * LYSNINGER PÅ USA, BSA ELLER PSA SAMT TIL PERSONER DER ER DØDE EL-  * 
 * LER EJ PÅ MANDTAL).                                                * 
 *                                                                    * 
 * OPSÆTNINGEN SKER I 2 KØRSLER.                                      * 
 *                                                                    * 
 * 1. KØRSEL VEDR. PERSONER MED CSMUDS >= B & <= G (USA/BSA) SAMT     * 
 * CSMUDS = I OG K (ER OPTAGET SENERE PÅ MANDTAL) ELLER CSMUDS = J OG * 
 * L (D.V.S. AFDØDES OPLYSNINGER UDSKRIVES PÅ EFTERLEVENDES USA/BSA). * 
 *                                                                    * 
 * 2. KØRSEL VEDR. PERSONER SOM  I K K E  VAR OMFATTET AF KØRSEL 1,   * 
 * D.V.S. SKULLE UDSKRIVES PÅ PRINTSELVANGIVELSE(PSA), MEN HVOR DER   * 
 * VED DANNELSEN AF PRINTBÅNDENE PÅ DC  I K K E  VAR PLADS NOK TIL    * 
 * TIL EJENDOMSOPLYSNINGERNE I OPLYSNINGSFELTET (DISSE PERSONER HAVDE * 
 * CSMUDS=H I KØRSEL 1, MEN CSMUDS=M ELLER N I KØRSEL 2),             * 
 *  E L L E R                                                         * 
 * VAR ENTEN DØDE ELLER EJ PÅ MANDTAL I KØRSEL 1, HVORFOR DER TIL     * 
 * DISSE PERSONER SKAL UDSKRIVES EJENDOMSSKEMA, MED MINDRE DE HAR     * 
 * CSMUDS = O (D.V.S. ER OPTAGET SENERE PÅ MANDTAL) ELLER CSMUDS = P  * 
 * (D.V.S. AFDØDES OPLYSNINGER UDSKRIVES PÅ EFTERLEVENDES PSA).       * 
 *                                                                    * 
 * INPUT  1: B.H61000D (FRA BH61000 SORTERING) I 1. KØRSEL            * 
 *           E L L E R                                                * 
 *           B.H61100D.USA (DANNET I KØRSEL 1) I 2. KØRSEL            * 
 *   -    2: B.F62001D SAMSORTEDE MINI MT-FILER PR. RC FRA SLUTMANDTAL* 
 *                                                                    * 
 * OUTPUT 1: B.H61100D.USA I 1. KØRSEL (TIL USA/BSA UDSKRIVNING)      * 
 *           E L L E R                                                * 
 *           B.H61100D.PSA I 2. KØRSEL (EJENDOMSSKEMAER TIL PSA EJ    * 
 *                     PLADS, DØDE ELLER EJ PÅ MANDTAL)               * 
 *        2: BH61101Y  (KØRSELSKONTROLLISTE)                          * 
 *        3: BH61102Y  (FEJLLISTE FRA MASKINEL AFSTEMNING AF KØRSLEN) * 
 *        2: BH61103Y  (ADVISLISTE VEDR. PERSONER SOM IKKE LÆNGERE    * 
 *                      EJER EJENDOMME IFLG. BEREGNINGSBÅNDET F. EKS. * 
 *                      EFTERLEVENDE SOM HAR FÅET TILFØRT EJENDOMSOP- * 
 *                      LYSNINGER FRA EN AFDØD ÆGTEFÆLLE/SAMLEVER).   * 
 *                                                                    * 
 * PROGRAMMERET AF  AAGE RASMUSSEN, DIV SKAT DEC 1992                 * 
 *                                                                    * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, DIV SKAT DEC 1993                 * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, PUS      DEC 1994                 * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, PUS      DEC 1995                 * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, PFB SKAT JAN 1997                 * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, PFB SKAT JAN 1998                 * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, PFB SKAT JAN 1999                 * 
 * ÅRSTILRETTET AF  AAGE RASMUSSEN, PUS SKAT JAN 2000                 * 
 *                                                                    * 
 *       RETTET AF  AAGE RASMUSSEN, PUS SKAT MAR 2000                 * 
 *       (FJERNET KALD AF AS27100 I.F.M. KOMMUNENAVN OG -ADRESSE)     * 
 ********************************************************************** 
         DEFAULT RANGE(*) STATIC UNALIGNED CONN;                        
 /*********************************************************************/
 /*      PARAMETER TIL ANGIVELSE AF OM DET ER PRODUKTION ELLER        */
 /*      TESTKØRSEL AF HENSYN TIL MASKINEL AFSTEMNING                 */
 /*********************************************************************/
 DCL     EXECPARM        CHAR      (6) VAR;                             
 DCL     EX_PARM         CHAR      (4);                                 
         EX_PARM = EXECPARM;                                            
 /*********************************************************************/
 /*      DECLARE AF FILER                                             */
 /*********************************************************************/
 DCL     BH610IN         FILE RECORD INPUT;  /* BEREGNINGSBÅND        */
 DCL     BF620IN         FILE RECORD INPUT;  /* MT - FIL              */
 DCL     BH611UD         FILE RECORD OUTPUT; /* BEREGNINGSBÅND        */
 DCL     SYSPRINT        FILE OUTPUT;                                   
 /*********************************************************************/
 /*      DECLARE AF BEREGNINGSBÅND                                    */
 /*********************************************************************/
 DCL     BH610_AR        CHAR      (4000) VAR;                          
 DCL     1 BH610                          BASED(ADDR(BH610_AR)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH60100N;                                           
 DCL     1 BH610_KOM                      BASED(ADDR(BH610_AR)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH60101N;                                           
 DCL     1 BH61099                        BASED(ADDR(BH610_AR)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH60199N;                                           
 DCL     BH61099_LÆNGDE BIN FIXED (15);                                 
 DCL BH_ADRTAB(5)        CHAR      (35) BASED(ADDR(BH610.ANAVN));       
 DCL     1 BH61001,                                                     
           %INCLUDE BH60101N;                                           
 /*********************************************************************/
 /*      DECLARE AF MT-FIL                                            */
 /*********************************************************************/
 DCL     1 MTFIL,                            /* MT-FIL FRA SLUTMAN   */ 
 %INCLUDE BF62000N;                                                     
 DCL MT_ADRTAB(6)        CHAR      (34) BASED(ADDR(MTFIL.PNVNADR));     
 DCL     1 BF62001       BASED(ADDR(MTFIL)),                            
 %INCLUDE BF62001N;                                                     
 DCL     1 BF62099       BASED(ADDR(MTFIL)),                            
 %INCLUDE BF62099N;                                                     
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *       AF ANTAL INDIVIDER PÅ B.F62001D                              * 
 *********************************************************************/ 
 DCL     OPTALT          FIXED     (7)       INIT      (0);             
 DCL     J               BIN FIXED (15)      INIT      (0);             
 /*********************************************************************/
 /*      DECLARE AF DIVERSE                                           */
 /*********************************************************************/
 DCL     EOF_BH610       BIT       (1);                                 
 DCL     EOF_BF620       BIT       (1);                                 
 DCL     PDCPRCIR        PIC       '(11)9';   /* HJÆLPEFELT TIL CPRNR */
 DCL     CDCPRCIR        CHAR      (11) BASED(ADDR(PDCPRCIR));          
 DCL     GDCPRCIR        FIXED     (11) INIT (0);                       
 DCL     1 KOMTOT (101:910),                                            
           2 KOMINDV_OK  BIT        (1),/*KOMINDV SKRIVES I KØRSEL USA*/
           2 MYNVNADR    CHAR      (43),/*SLUTLIGN.KOMM.NAVN          */
           2 MYPOSTADR   CHAR      (37),/*SLUTLIGN.KOMM.ADRESSE       */
           2 MYPOSTNR    CHAR      (35),/*SLUTLIGN.KOMM.POSTNR        */
           2 FEJERE      FIXED      (7),                                
           2 FUDSKR      FIXED      (7),                                
           2 FEJUDSKR    FIXED      (7),                                
           2 FUSA_B      FIXED      (7),                                
           2 FUSA_C      FIXED      (7),                                
           2 FUSA_D      FIXED      (7),                                
           2 FUSA_I      FIXED      (7),                                
           2 FUSA_J      FIXED      (7),                                
           2 FBSA_E      FIXED      (7),                                
           2 FBSA_F      FIXED      (7),                                
           2 FBSA_G      FIXED      (7),                                
           2 FBSA_K      FIXED      (7),                                
           2 FBSA_L      FIXED      (7),                                
           2 FPSA        FIXED      (7),                                
           2 FPSAD       FIXED      (7),                                
           2 FPSAK       FIXED      (7),                                
           2 FPSAO       FIXED      (7),                                
           2 FPSAP       FIXED      (7),                                
           2 FØVRIGE     FIXED      (7),                                
           2 CRCKO       PIC        '9';                                
 DCL     KØRSELSKODE     CHAR      (1); /* USA M.V. ELLER PSA EJ PLADS*/
 DCL     SWFEJL          CHAR      (1)  INIT (' ');                     
 DCL     HJKOMNR         PIC       '999';     /* HJÆLPEFELT TIL KOMNR */
 DCL     HJCRCKO         PIC       '9';       /* HJÆLPEFELT TIL RCKODE*/
 DCL     CH_CRCKO        CHAR      (1) BASED(ADDR(HJCRCKO));            
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     1 BH60100M,                                                    
           %INCLUDE BH60100M;                                           
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL     LINIE           CHAR      (133) INIT (' ');                    
 DCL     1 LIN           DEF       LINIE,                               
          2 CCA          CHAR      (1),      /* SKIPKARAKTER         */ 
          2 PRINTLIN     CHAR      (132);                               
 DCL     1 OVLIN         DEF       LINIE,                               
          2 HDSP1        CHAR      (1),      /* SKIPKARAKTER         */ 
          2 T1           CHAR      (19),                                
          2 T2           CHAR      (24),                                
          2 T3           CHAR      (65),                                
          2 T4           CHAR      (14),                                
          2 DATO         CHAR      (10);                                
 DCL     1 LIN1          DEF       LINIE,                               
          2 HDSP1        CHAR      (1),                                 
          2 TEKST1       CHAR      (47),     /* TEKSTFELT            */ 
          2 TOTAL1       PIC       'ZZZZZZZ.ZZZ.ZZZ',/* FELT T. TOT  */ 
          2 TOTAL(6)     PIC       'ZZ.ZZZ.ZZZ';                        
 DCL     1 LIN2          DEF       LINIE,                               
          2 HDSP1        CHAR      (4),                                 
          2 KOMNR        CHAR      (3),                                 
          2 HDSP2        CHAR      (6),                                 
          2 DCPRN        PIC       '999999B9999',                       
          2 HDSP3        CHAR      (4),                                 
          2 DHENVN       PIC       '999999B9999',                       
          2 HDSP4        CHAR      (9),                                 
          2 CCIVS        CHAR      (1);                                 
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER TIL FEJLLISTE                         */
 /*********************************************************************/
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH61100L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (55)      INIT      (                
           '        BEREGNING TIL EJENDOMSSKEMA         '),             
           2 F2          CHAR      (11)      INIT      (' '),           
           2 TEKST3      CHAR      (14)      INIT      (                
           'UDSKREVET DEN '),                                           
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('               FEJLLISTE     ');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       '(7)Z',                              
           2 F2          CHAR      (65)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (49),                                
           2 RCKOD       CHAR      (01)      INIT      (' '),           
           2 F1          CHAR      (19)      INIT      (' '),           
           2 ANTAL       PIC       '(6)Z9',                             
           2 F2          CHAR      (56)      INIT      (' ');           
 %INCLUDE ZZ20301M;                                                     
 /*********************************************************************/
 /*      DECLARE AF ENTRIES                                           */
 /*********************************************************************/
 DCL    (ZS61900,                                                       
         ZS30101)        ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     (ADDR,PLIDUMP,SUBSTR,STG) BUILTIN;                             
 %INCLUDE AS27100N;                                                     
 /*********************************************************************/
 /*      DECLARE AF TÆLLEVÆRKER                                       */
 /*********************************************************************/
 DCL     (TV_BH610,                           /* ANTAL LÆSTE BH61000  */
          TV_BH610_KOM,                       /* ANTAL KOM.INDIVIDER  */
          TV_BH61099,                         /* ANTAL JVF. OPTÆL.INDV*/
          TV_BH61099_KOM,                     /* ANTAL JVF. OPTÆL.INDV*/
          TV_BH61099_SKEMA,                   /* ANTAL JVF. OPTÆL.INDV*/
          TV_BF620,                           /* ANTAL LÆSTE MT-FIL   */
          TV_BF620_KOM,                       /*   HERAF KOMINDIVIDER */
          TV_SKR,                             /* ANTAL SKRIV BH61100D */
          TV_SKR_KOM,                         /* ANTAL SKRIV KOM.INDV.*/
                                              /* PÅ BH61100D          */
          TV_UDSKR,                           /* ANTAL TIL UDSKRIVNING*/
          TV_EJUDSKR,                         /* ANTAL EJ  UDSKRIVNING*/
          TV_USA_B,                           /* ANTAL TIL UDSKRIVNING*/
          TV_USA_C,                           /* ANTAL TIL UDSKRIVNING*/
          TV_USA_D,                           /* ANTAL TIL UDSKRIVNING*/
          TV_USA_I,                           /* ANTAL TIL UDSKRIVNING*/
          TV_USA_J,                           /* ANTAL TIL UDSKRIVNING*/
          TV_BSA_E,                           /* ANTAL TIL UDSKRIVNING*/
          TV_BSA_F,                           /* ANTAL TIL UDSKRIVNING*/
          TV_BSA_G,                           /* ANTAL TIL UDSKRIVNING*/
          TV_BSA_K,                           /* ANTAL TIL UDSKRIVNING*/
          TV_BSA_L,                           /* ANTAL TIL UDSKRIVNING*/
          TV_PSA,                             /* ANTAL TIL UDSKRIVNING*/
          TV_PSAD,                            /* ANTAL TIL UDSKRIVNING*/
          TV_PSAK,                            /* ANTAL TIL UDSKRIVNING*/
          TV_PSAO,                            /* ANTAL TIL UDSKRIVNING*/
          TV_PSAP,                            /* ANTAL TIL UDSKRIVNING*/
          TV_ØVRIGE,                          /* ANTAL TIL UDSKRIVNING*/
          TV_EJ_FUNDET,                       /* ANTAL M/N EJ FUNDET  */
          TV_NY_SMUDS,                        /* ANTAL M/N EJ H 1.GANG*/
          TV_NY_OP,                           /* ANTAL O/P EJ DØD ELL.*/
                                              /*       EJ PÅ MT 1.GANG*/
          TV_NY_HENVIS,                       /* ANTAL MED NYT HENVISN*/
          TV_EJERE_FUNDET,                    /* ANTAL FUNDNE PÅ MTFIL*/
          TV_FMT,                             /* ANTAL FUNDNE PÅ MTFIL*/
          TV_FMT_FORS,                        /* ANTAL FUNDNE  FORSKUD*/
          TV_FMT_SLUT,                        /* ANTAL FUNDNE  SLUTMAN*/
          TV_FMT_BEGGE,                       /* ANTAL FUNDNE PÅ BEGGE*/
          TV_EJMT)  FIXED (7) INIT (0);       /* ANTAL EJ PÅ MTFIL    */
 DCL     (I,K,N)         FIXED BIN (15);                                
 /*********************************************************************/
 /*      HOUSEKEEPING                                                 */
 /*********************************************************************/
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (BH610IN) TITLE ('BH61000I'),  /* BEREGNINGSBÅND   */
              FILE (BF620IN) TITLE ('BF62000I'),  /* MINI MT          */
              FILE (BH611UD) TITLE ('BH61100O');  /* BEREGNINGSBÅND   */
         CALL ZZ20390 ('*OPEN','BH61101Y');                             
         CALL ZZ20390 ('*OPEN','BH61102Y');                             
         CALL ZZ20390 ('*OPEN','BH61103Y');                             
         EOF_BH610 = '0'B;                                              
         EOF_BF620 = '0'B;                                              
         ON ENDFILE (BH610IN)                                           
            BEGIN;                                                      
               EOF_BH610 = '1'B;                                        
            END;                                                        
         ON ENDFILE (BF620IN)                                           
            BEGIN;                                                      
               EOF_BF620 = '1'B;                                        
               MTFIL.DCPRN = 9999999999;                                
            END;                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         KOMTOT(*) = '';                                                
 /*********************************************************************/
 /*      HOVEDSTYRING                                                 */
 /*********************************************************************/
         CALL SKAF_BEREGNINGSBÅND;                                      
         CALL SKAF_MINI_MTFIL;                                          
         CALL BEHANDL_KOMINDV;                                          
         IF BH610.CAJOUR  = ' ' &                                       
            MTFIL.CKØRSEL = 'USA'                                       
         THEN                                                           
            KØRSELSKODE = 'S';                                          
            /* 1. AJOURFØRING AF CSMUDS M.V. */                         
            /* UDSKRIVNING AF USA,BSA        */                         
         ELSE                                                           
            IF BH610.CAJOUR = 'S' &                                     
               MTFIL.CKØRSEL = 'PSA'                                    
            THEN                                                        
               KØRSELSKODE = 'P';                                       
               /* 2. AJOURFØRING AF  K U N  CSMUDS.     */              
               /* UDSKRIV EJENDOMSSKEMAER PSA EJ PLADS, */              
               /* DØDE ELLER EJ PÅ MANDTAL.             */              
            ELSE                                                        
               CALL AFBRYD_KØRSEL; /* D.V.S. HVIS FORKERT INPUT */      
         CALL SKRIV_KOMINDV;                                            
         DO WHILE ( ^EOF_BH610 );                                       
            DO WHILE ( BH610.SORT_CPR > MTFIL.DCPRN & ^EOF_BF620 );     
               IF KØRSELSKODE = 'P' &        /* I KØRSEL PSA EJ PLADS */
                  MTFIL.CKØRSEL ^= '***'     /* SKAL ALLE PERSONER PÅ */
               THEN                          /* MTFILEN FINDES PÅ BE- */
                  CALL SKRIV_EJ_FUNDET;      /* REGNINGSBÅNDET        */
               CALL SKAF_MINI_MTFIL;                                    
            END;                                                        
            CALL BEHANDLING_AF_BEREGNINGSBÅND;                          
            CALL SKAF_BEREGNINGSBÅND;                                   
         END;                                                           
         DO WHILE ( ^EOF_BF620 );                                       
            IF KØRSELSKODE = 'P' &           /* I KØRSEL PSA EJ PLADS */
               MTFIL.CKØRSEL ^= '***'        /* SKAL ALLE PERSONER PÅ */
            THEN                             /* MTFILEN FINDES PÅ BE- */
               CALL SKRIV_EJ_FUNDET;         /* REGNINGSBÅNDET        */
            CALL SKAF_MINI_MTFIL;                                       
         END;                                                           
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
         CALL TOTALLISTE;                                               
         CALL DAN_OPT_INDV;                                             
         CALL MASK_AFSTEMNING;                                          
         CLOSE FILE (BH611UD),                                          
               FILE (BH610IN),                                          
               FILE (BF620IN);                                          
         LINIE = ' ';                                                   
         CALL ZZ20301 (LINIE,'99');                                     
 /*********************************************************************/
 /*      SKAF BEREGNINGSBÅND                                          */
 /*********************************************************************/
 SKAF_BEREGNINGSBÅND:                                                   
         PROC;                                                          
         READ FILE (BH610IN) INTO (BH610_AR);                           
         IF ^EOF_BH610 &                 /* OPTÆLLINGSINDIVID */        
            BH610.SORT_KOMNR = 999                                      
         THEN                                                           
            DO;                                                         
               BH61099_LÆNGDE = BH61099.LÆNGDE; /* A.H.T. SKRIV */      
               TV_BH61099 = BH61099.ANT_INDV;                           
               READ FILE (BH610IN) INTO (BH610_AR);                     
               IF ^EOF_BH610                                            
               THEN                                                     
                  DO;                                                   
                     BH61099_LÆNGDE = BH61099.LÆNGDE;                   
                     TV_BH61099 = TV_BH61099 + BH61099.ANT_INDV;        
                     READ FILE (BH610IN) INTO (BH610_AR);               
                  END;                                                  
            END;                                                        
         IF ^EOF_BH610 &                                                
            BH610.SORT_KOMNR ^= 999                                     
         THEN                                                           
            DO;                                                         
               IF BH610.SORT_CPR = 0 /* D.V.S. KOMMUNEINDIVID */        
               THEN                                                     
                  TV_BH610_KOM = TV_BH610_KOM + 1;                      
               ELSE                                                     
                  TV_BH610 = TV_BH610 + 1;                              
            END;                                                        
 END SKAF_BEREGNINGSBÅND;                                               
 /*********************************************************************/
 /*      SKAF MINI-MTFIL                                              */
 /*********************************************************************/
 SKAF_MINI_MTFIL:                                                       
         PROC;                                                          
         READ FILE (BF620IN) INTO (MTFIL);                              
         IF MTFIL.DCPRN = 99999999999  /* OPTÆLLINGSINDIVID */          
         THEN                                                           
            DO;                                                         
               OPTALT = BF62099.ANT_INDV;                               
               READ FILE (BF620IN) INTO (MTFIL);                        
            END;                                                        
         IF ^EOF_BF620 &                                                
            MTFIL.DCPRN ^= 99999999999  /* OPTÆLLINGSINDV.*/            
         THEN                                                           
            DO;                                                         
               IF MTFIL.DCPRN = 0       /* KOMMUNEINDV.*/               
               THEN                                                     
                  TV_BF620_KOM = TV_BF620_KOM + 1;                      
               TV_BF620 = TV_BF620 + 1;                                 
            END;                                                        
 END SKAF_MINI_MTFIL;                                                   
 /********************************************************************* 
 *       BEHANDLING AF KOMMUNEINDIVIDER FRA B.F62001D OG/ELLER        * 
 *       BEREGNINGSBÅND                                               * 
 *********************************************************************/ 
 BEHANDL_KOMINDV:                                                       
         PROC;                                                          
                                                                        
         /* NB.: HVIS KØRSEL = PSA UDFØRES:                     */      
         /* SKAF KOMMUNEOPLYSNINGER FRA GL. BEREGNINGSBÅND      */      
         /* HENTET FRA B.F62001D-KOMMUNEINDIVIDER I KØRSEL USA. */      
                                                                        
         DO WHILE ( BH610_KOM.SORT_CPR = 0 & ^EOF_BH610 );              
            K = BH610_KOM.EÆKNR;                                        
            KOMTOT(K).KOMINDV_OK = '1'B;                                
            KOMTOT(K).MYNVNADR  = BH610_KOM.MYNVNADR;                   
            KOMTOT(K).MYPOSTADR = BH610_KOM.MYPOSTADR;                  
            KOMTOT(K).MYPOSTNR  = BH610_KOM.MYPOSTNR;                   
            CALL SKAF_BEREGNINGSBÅND;                                   
         END;                                                           
                                                                        
         /* SKAF KOMMUNEOPLYSNINGER FRA B.F62001D */                    
                                                                        
         DO WHILE ( MTFIL.DCPRN = 0 & ^EOF_BF620 );                     
            K = BF62001.EÆKNR;                                          
            KOMTOT(K).KOMINDV_OK = '1'B;                                
            KOMTOT(K).MYNVNADR  = BF62001.MYNVNADR;                     
            KOMTOT(K).MYPOSTADR = BF62001.MYPOSTADR;                    
            KOMTOT(K).MYPOSTNR  = BF62001.MYPOSTNR;                     
            CH_CRCKO = BF62001.CRCK;                                    
            KOMTOT(K).CRCKO = HJCRCKO;                                  
            CALL SKAF_MINI_MTFIL;                                       
         END;                                                           
                                                                        
 END BEHANDL_KOMINDV;                                                   
 /********************************************************************* 
 *       SKRIV KOMMUNEINDIVIDER PÅ BEREGNINGSBÅND                     * 
 *********************************************************************/ 
 SKRIV_KOMINDV:                                                         
         PROC;                                                          
                                                                        
         DO K = 101 TO 910;                                             
            IF KOMTOT(K).KOMINDV_OK = '1'B                              
            THEN                                                        
               DO;                                                      
                  BH61001 = '';                                         
                  BH61001.SORT_KOMNR = K;                               
                  BH61001.EÆKNR = K;                                    
                  BH61001.MYNVNADR = KOMTOT(K).MYNVNADR;                
                  BH61001.MYPOSTADR = KOMTOT(K).MYPOSTADR;              
                  BH61001.MYPOSTNR  = KOMTOT(K).MYPOSTNR;               
                  BH61001.CAJOUR = KØRSELSKODE;                         
                  TV_SKR_KOM = TV_SKR_KOM + 1;                          
                  WRITE FILE (BH611UD) FROM (BH61001);                  
               END;                                                     
         END;                                                           
                                                                        
 END SKRIV_KOMINDV;                                                     
 /********************************************************************* 
 *       BEHANDLING AF PERSON FRA BEREGNINGSBÅND                      * 
 *********************************************************************/ 
 BEHANDLING_AF_BEREGNINGSBÅND:                                          
         PROC;                                                          
                                                                        
         /* KONVERTER EVT. NAVNE- OG ADR.OPLYSNINGER FRA ESR */         
         /* TIL 'NYT CP277-TEGNSÆT'                          */         
                                                                        
         AS271_PTR = ADDR(BH610.ANAVN);                                 
         AS271_LGD = STG (BH610.ANAVN);                                 
         CALL AS27100(RUT_KOHREGEL,AS271_PTR,AS271_LGD);                
                                                                        
         AS271_PTR = ADDR(BH610.ACONA);                                 
         AS271_LGD = STG (BH610.ACONA);                                 
         CALL AS27100(RUT_KOHREGEL,AS271_PTR,AS271_LGD);                
                                                                        
         AS271_PTR = ADDR(BH610.AUADR);                                 
         AS271_LGD = STG (BH610.AUADR);                                 
         CALL AS27100(RUT_KOHREGEL,AS271_PTR,AS271_LGD);                
                                                                        
         AS271_PTR = ADDR(BH610.ABYNA);                                 
         AS271_LGD = STG (BH610.ABYNA);                                 
         CALL AS27100(RUT_KOHREGEL,AS271_PTR,AS271_LGD);                
                                                                        
         AS271_PTR = ADDR(BH610.APADR);                                 
         AS271_LGD = STG (BH610.APADR);                                 
         CALL AS27100(RUT_KOHREGEL,AS271_PTR,AS271_LGD);                
                                                                        
         AS271_PTR = ADDR(BH610.AUDLADR);                               
         AS271_LGD = STG (BH610.AUDLADR);                               
         CALL AS27100(RUT_KOHREGEL,AS271_PTR,AS271_LGD);                
                                                                        
         IF KØRSELSKODE = 'S' /* 1. AJOURFØRING: USA, BSA, DØDE M.V. */ 
         THEN                                                           
            DO;                                                         
               IF BH610.SORT_CPR < MTFIL.DCPRN                          
               THEN                                                     
                  DO;                                                   
                     /* PERSONEN FINDES IKKE PÅ MT-FILEN */             
                     BH610.EÆKNR = BH610.EKOMNR;                        
                     BH610.SORT_EÆKNR = BH610.EKOMNR;                   
                     BH610.CSMUDS = 'A';                                
                     BH610.CKSLKOM = 1;                                 
                     BH610.ESKYNR  = 0;                                 
                     IF BH610.CINVPNR = '0'                             
                     THEN                                               
                        BH610.CKNAVF = 2;                               
                     ELSE                                               
                        BH610.CKNAVF = 0;                               
                     BH610.CSÆREJD = 2;                                 
                     TV_EJMT = TV_EJMT + 1;                             
                  END;                                                  
               ELSE                                                     
                  CALL OVERFØR_OPLYSNINGER_FRA_MTFIL;                   
            END;                                                        
         ELSE                                                           
            IF BH610.SORT_CPR = MTFIL.DCPRN                             
            THEN                                                        
               CALL OVERFØR_OPLYSNINGER_FRA_MTFIL;/* 2. AJOURFØRING   */
                                                  /* PSA EJ PLADS     */
         /* UDFØR GENERELT */                                           
         IF BH610.EKOMNR = BH610.EÆKNR                                  
         THEN                                                           
            HJKOMNR = BH610.EKOMNR;                                     
         ELSE                                                           
            HJKOMNR = BH610.EÆKNR;                                      
         BH610.SORT_EÆKNR = HJKOMNR;                                    
         CALL RCPROC;                                                   
         BH610.CRCKO = HJCRCKO;                                         
         CALL OPTÆLLING_AF_SKEMAER;                                     
         BH610.CAJOUR = KØRSELSKODE;                                    
         CALL SKRIV_BEREGNB;                                            
 END BEHANDLING_AF_BEREGNINGSBÅND;                                      
 /*********************************************************************/
 /*      OVERFØR OPLYSNINGER FRA MINI MT-FIL                          */
 /*********************************************************************/
 OVERFØR_OPLYSNINGER_FRA_MTFIL:                                         
         PROC;                                                          
         IF BH610.MT.HIST_OPL(INDKÅR).DHENVN ^= MTFIL.DHENVN &          
            BH610.CUDEJD  = 1                                           
         THEN                                                           
            TV_NY_HENVIS = TV_NY_HENVIS + 1;                            
         BH610.DSORP_SL = MTFIL.DSORP;                                  
         BH610.CPART_SL = MTFIL.CPART;                                  
         BH610.ESKYNR = MTFIL.ESKYNR;                                   
         BH610.DHENVN_SL = MTFIL.DHENVN;                                
         BH610.CVÆRGE = MTFIL.CVÆRGE;                                   
         IF MTFIL.EÆKNR = 0                                             
         THEN                                                           
            DO;                                                         
               BH610.EÆKNR = BH610.EKOMNR;                              
               BH610.CKSLKOM = 1;                                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               BH610.EÆKNR = MTFIL.EÆKNR;                               
               BH610.CKSLKOM = 0;                                       
            END;                                                        
         IF MTFIL.CCIVS = 'D'                                           
         THEN                                                           
            DO;                                                         
               /* PERSONER DER ER DØDE JVF. MANDTAL */                  
               /* OG HAR CSMUDS FORSKELLIG FRA 'A'  */                  
               /* SKAL BEHANDLES SOM 'LEVENDE'      */                  
               /* D.V.S. CSÆREJD SÆTTES LIG '9'.    */                  
               IF MTFIL.CSMUDS = 'A'                                    
               THEN                                                     
                  BH610.CSÆREJD = 1;                                    
               ELSE                                                     
                  BH610.CSÆREJD = 9;                                    
               BH610.CKNAVF = 1;                                        
            END;                                                        
         ELSE                                                           
            DO;                                                         
               IF MTFIL.CVÆRGE = 'V' ! MTFIL.CVÆRGE = 'X'               
               THEN                                                     
                  BH610.CSÆREJD = 4;                                    
               ELSE                                                     
                  BH610.CSÆREJD = 9;                                    
               BH610.CKNAVF = 0;                                        
            END;                                                        
         IF KØRSELSKODE = 'P'                                           
         THEN                                                           
            DO;                                                         
               /* 2. AJOURFØRING - PSA EJ PLADS M.V. */                 
               IF MTFIL.CSMUDS = 'M' !      /* PSAD  */                 
                  MTFIL.CSMUDS = 'N'        /* PSAK  */                 
               THEN                                                     
                  DO;                                                   
                     IF BH610.CSMUDS ^= 'H' &                           
                        BH610.CUDEJD  = 1                               
                     THEN                                               
                        TV_NY_SMUDS = TV_NY_SMUDS + 1;                  
                     BH610.CSMUDS_GL = BH610.CSMUDS;                    
                  END;                                                  
               ELSE                                                     
                  IF MTFIL.CSMUDS = 'O' !  /* SENERE OPTAGET PÅ MT   */ 
                     MTFIL.CSMUDS = 'P'    /* DØD OVERFØRT TIL ÆGTF. */ 
                  THEN                                                  
                     DO;                                                
                        IF BH610.CSÆREJD = 1 !                          
                           BH610.CSÆREJD = 2                            
                        THEN;                                           
                        ELSE                                            
                           TV_NY_OP = TV_NY_OP + 1;                     
                        BH610.CSMUDS_GL = BH610.CSMUDS;                 
                     END;                                               
                  ELSE                                                  
                     CALL AFBRYD_KØRSEL;                                
               MTFIL.CKØRSEL = '***';   /* MARKER AT PERSONEN FINDES */ 
                                        /* PÅ BEREGNINGSBÅNDET       */ 
            END;                                                        
         IF BH610.CUDEJD = 1                                            
         THEN                                                           
            BH610.CSMUDS = MTFIL.CSMUDS;                                
         BH610.CKUNNAVN = MTFIL.CKUNNAVN;                               
         DO I = 1 TO 5;                                                 
             BH_ADRTAB(I) = MT_ADRTAB(I);                               
         END;                                                           
         BH610.AUDLADR = MT_ADRTAB(6); /* AUDLADR ER IKKE PLACERET I */ 
                                       /* FORLÆNGELSE AF DE ØVRIGE 5 */ 
                                       /* ADRESSELINIER I BH60105N   */ 
         TV_FMT = TV_FMT + 1;                                           
         IF GDCPRCIR ^= BH610.SORT_CPR                                  
         THEN                                                           
            DO;                                                         
               KOMTOT.FEJERE(BH610.EÆKNR) =                             
               KOMTOT.FEJERE(BH610.EÆKNR) + 1;                          
               TV_EJERE_FUNDET = TV_EJERE_FUNDET + 1;                   
               GDCPRCIR = BH610.SORT_CPR;                               
            END;                                                        
 END OVERFØR_OPLYSNINGER_FRA_MTFIL;                                     
 /*********************************************************************/
 /*      SKAF RC-KODE PÅ GRUNDLAG AF ENTEN SLUTLIGNINGSKOMMUNE        */
 /*      ELLER BELIGGENHEDSKOMMUNE                                    */
 /*********************************************************************/
 RCPROC:                                                                
         PROC;                                                          
         SELECT;                                                        
           WHEN (HJKOMNR = 0)                                           
              HJCRCKO = 6; /* BC */                                     
           WHEN (HJKOMNR < 129)                                         
              HJCRCKO = 1; /* KBH */                                    
           WHEN (HJKOMNR <= 411)                                        
              HJCRCKO = 6; /* BC */                                     
           WHEN (HJKOMNR <= 499)                                        
              HJCRCKO = 5; /* OC */                                     
           WHEN (HJKOMNR >= 751 & HJKOMNR <= 756)                       
              HJCRCKO = 4; /* ÅC */                                     
           OTHERWISE                                                    
              HJCRCKO = 3; /* AC */                                     
         END;                                                           
 END RCPROC;                                                            
 /*********************************************************************/
 /*      DER DANNES ET SLUTINDIVID TIL BRUG FOR MASKINEL AFSTEMNING   */
 /*********************************************************************/
 DAN_OPT_INDV:                                                          
         PROC;                                                          
         BH61099 = '';                                                  
         BH61099.SORT_KOMNR = 999;                                      
         BH61099.SORT_EJDNR = 888888;                                   
         BH61099.SORT_CPR = 99999999999;                                
         BH61099.SORT_CITYP = 9;                                        
         BH61099.SORT_EÆKNR = 999;                                      
         BH61099.ANT_INDV = TV_SKR;                                     
         BH61099.ANT_SKEMA = TV_UDSKR + TV_EJUDSKR;                     
         BH61099.ANT_KOM = TV_SKR_KOM;                                  
         BH61099.LÆNGDE = BH61099_LÆNGDE; /* A.H.T. SKRIV */            
         WRITE FILE (BH611UD) FROM (BH610_AR);                          
 END DAN_OPT_INDV;                                                      
 /*********************************************************************/
 /*      OPTÆL ANTAL TIL UDSKRIVNING PR. SLUTLIGNINGSKOMMUNE          */
 /*********************************************************************/
 OPTÆLLING_AF_SKEMAER:                                                  
         PROC;                                                          
         IF BH610.CUDEJD = 1                                            
         THEN                                                           
            DO;                                                         
               IF BH610.CSMUDS = 'B' !                                  
                  BH610.CSMUDS = 'I' !                                  
                  BH610.CSMUDS = 'J' !                                  
                  BH610.CSMUDS = 'E' !                                  
                  BH610.CSMUDS = 'K' !                                  
                  BH610.CSMUDS = 'L' !                                  
                  BH610.CSMUDS = 'H' !                                  
                  BH610.CSMUDS = 'O' !                                  
                  BH610.CSMUDS = 'P'                                    
               THEN                                                     
                  DO;                                                   
                     TV_EJUDSKR = TV_EJUDSKR + 1;                       
                     KOMTOT.FEJUDSKR(BH610.EÆKNR) =                     
                     KOMTOT.FEJUDSKR(BH610.EÆKNR) + 1;                  
                  END;                                                  
               ELSE                                                     
                  DO;                                                   
                     TV_UDSKR = TV_UDSKR + 1;                           
                     KOMTOT.FUDSKR(BH610.EÆKNR) =                       
                     KOMTOT.FUDSKR(BH610.EÆKNR) + 1;                    
                  END;                                                  
                                                                        
               SELECT (BH610.CSMUDS);                                   
                 WHEN ('B')                                             
                   DO;                                                  
                      TV_USA_B = TV_USA_B + 1;                          
                      KOMTOT.FUSA_B(BH610.EÆKNR) =                      
                      KOMTOT.FUSA_B(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      TV_USA_C = TV_USA_C + 1;                          
                      KOMTOT.FUSA_C(BH610.EÆKNR) =                      
                      KOMTOT.FUSA_C(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      TV_USA_D = TV_USA_D + 1;                          
                      KOMTOT.FUSA_D(BH610.EÆKNR) =                      
                      KOMTOT.FUSA_D(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('I')                                             
                   DO;                                                  
                      TV_USA_I = TV_USA_I + 1;                          
                      KOMTOT.FUSA_I(BH610.EÆKNR) =                      
                      KOMTOT.FUSA_I(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('J')                                             
                   DO;                                                  
                      TV_USA_J = TV_USA_J + 1;                          
                      KOMTOT.FUSA_J(BH610.EÆKNR) =                      
                      KOMTOT.FUSA_J(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('E')                                             
                   DO;                                                  
                      TV_BSA_E = TV_BSA_E + 1;                          
                      KOMTOT.FBSA_E(BH610.EÆKNR) =                      
                      KOMTOT.FBSA_E(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('F')                                             
                   DO;                                                  
                      TV_BSA_F = TV_BSA_F + 1;                          
                      KOMTOT.FBSA_F(BH610.EÆKNR) =                      
                      KOMTOT.FBSA_F(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('G')                                             
                   DO;                                                  
                      TV_BSA_G = TV_BSA_G + 1;                          
                      KOMTOT.FBSA_G(BH610.EÆKNR) =                      
                      KOMTOT.FBSA_G(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('K')                                             
                   DO;                                                  
                      TV_BSA_K = TV_BSA_K + 1;                          
                      KOMTOT.FBSA_K(BH610.EÆKNR) =                      
                      KOMTOT.FBSA_K(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('L')                                             
                   DO;                                                  
                      TV_BSA_L = TV_BSA_L + 1;                          
                      KOMTOT.FBSA_L(BH610.EÆKNR) =                      
                      KOMTOT.FBSA_L(BH610.EÆKNR) + 1;                   
                   END;                                                 
                 WHEN ('H')                                             
                   DO;                                                  
                      TV_PSA = TV_PSA + 1;                              
                      KOMTOT.FPSA(BH610.EÆKNR) =                        
                      KOMTOT.FPSA(BH610.EÆKNR) + 1;                     
                   END;                                                 
                 WHEN ('M')                                             
                   DO;                                                  
                      TV_PSAD = TV_PSAD + 1;                            
                      KOMTOT.FPSAD(BH610.EÆKNR) =                       
                      KOMTOT.FPSAD(BH610.EÆKNR) + 1;                    
                   END;                                                 
                 WHEN ('N')                                             
                   DO;                                                  
                      TV_PSAK = TV_PSAK + 1;                            
                      KOMTOT.FPSAK(BH610.EÆKNR) =                       
                      KOMTOT.FPSAK(BH610.EÆKNR) + 1;                    
                   END;                                                 
                 WHEN ('O')                                             
                   DO;                                                  
                      TV_PSAO = TV_PSAO + 1;                            
                      KOMTOT.FPSAO(BH610.EÆKNR) =                       
                      KOMTOT.FPSAO(BH610.EÆKNR) + 1;                    
                   END;                                                 
                 WHEN ('P')                                             
                   DO;                                                  
                      TV_PSAP = TV_PSAP + 1;                            
                      KOMTOT.FPSAP(BH610.EÆKNR) =                       
                      KOMTOT.FPSAP(BH610.EÆKNR) + 1;                    
                   END;                                                 
                 OTHERWISE                                              
                   DO;                                                  
                      TV_ØVRIGE = TV_ØVRIGE + 1;                        
                      KOMTOT.FØVRIGE(BH610.EÆKNR) =                     
                      KOMTOT.FØVRIGE(BH610.EÆKNR) + 1;                  
                   END;                                                 
               END; /* SELECT (BH610.CSMUDS) */                         
                                                                        
            END;                                                        
                                                                        
         KOMTOT.CRCKO(BH610.EÆKNR) = BH610.CRCKO;                       
                                                                        
 END OPTÆLLING_AF_SKEMAER;                                              
 /*********************************************************************/
 /*      UDSKRIVNING AF EJENDOMSSKEMABEREGNING                        */
 /*********************************************************************/
 SKRIV_BEREGNB:                                                         
         PROC;                                                          
         TV_SKR = TV_SKR + 1;                                           
         WRITE FILE (BH611UD) FROM (BH610_AR);                          
 END SKRIV_BEREGNB;                                                     
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         LIN.CCA = ZZWS1;                                               
         OVLIN.T1 = 'PROGRAM: BH61100L';                                
         OVLIN.T2 = 'AJOURFØR BEREGNINGSBÅND ';                         
         IF KØRSELSKODE = 'S'                                           
         THEN                                                           
            OVLIN.T3 = '1. GANG - UDSKRIV USA OG BSA';                  
         ELSE                                                           
            OVLIN.T3 = '2. GANG - UDSKRIV TIL PSA EJ PLADS, ' !!        
                       'DØDE ELLER EJ PÅ MANDTAL';                      
         OVLIN.T4 = 'UDSKREVET DEN';                                    
         OVLIN.DATO = UDDATO;                                           
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS2;                   /* SPACE 2 AFTER PRINT  */  
         PRINTLIN = (57)' ' !! 'KØRSELSKONTROLLISTE';                   
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS1;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = ' ';                                                
         IF KØRSELSKODE = 'S'                                           
         THEN                                                           
            LIN1.TEKST1 =                                               
                       'ANTAL LÆSTE PÅ                       B.H61000D';
         ELSE                                                           
            LIN1.TEKST1 =                                               
                       'ANTAL LÆSTE PÅ                       B.H61100D';
         TOTAL1 = TV_BH610;                                             
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS1;                                               
         LIN1.TEKST1 = '      HERAF KOMMUNEINDIVIDER                  ';
         TOTAL1 = TV_BH610_KOM;                                         
         CALL ZZ20301(LINIE,'01');                                      
         LIN.CCA = ZZWS1;                                               
         LIN1.TEKST1 = 'ANTAL LÆSTE PÅ                       B.F62001D';
         TOTAL1 = TV_BF620;                                             
         CALL ZZ20301(LINIE,'01');                                      
         LIN.CCA = ZZWS1;                                               
         LIN1.TEKST1 = '      HERAF KOMMUNEINDIVIDER                  ';
         TOTAL1 = TV_BF620_KOM;;                                        
         CALL ZZ20301(LINIE,'01');                                      
         LIN.CCA = ZZWS2;                                               
         LIN1.TEKST1 = 'ANTAL SKREVNE INDIVIDER EXCL. KOM PÅ B.H61100D';
         TOTAL1 = TV_SKR;                                               
         CALL ZZ20301(LINIE,'01');                                      
         LIN.CCA = ZZWS2;                                               
         LIN1.TEKST1 = 'ANTAL SKREVNE KOMMUNEINDIVIDER PÅ    B.H61100D';
         TOTAL1 = TV_SKR_KOM;                                           
         CALL ZZ20301(LINIE,'01');                                      
         LIN.CCA = ZZWS1;                                               
         LIN1.TEKST1 = 'ANTAL FUNDNE INDIVIDER PÅ MT-FIL             '; 
         TOTAL1 = TV_FMT;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS2;                                               
         LIN1.TEKST1 = 'ANTAL EJ FUNDNE INDIVIDER PÅ MT-FIL          '; 
         TOTAL1 = TV_EJMT;                                              
         CALL ZZ20301(LINIE,'01');                                      
         LINIE= (59)' ' !!                                              
          'IALT      KBH.       A.C       Å.C       O.C       B.C';     
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301(LINIE,'01');                                      
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FEJERE(K);                                        
         END;                                                           
         LIN1.TEKST1 = 'ANTAL FUNDNE EJERE PÅ MT-FIL                 '; 
         TOTAL1 = TV_EJERE_FUNDET;                                      
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS3;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         LINIE = ' ';                                                   
         LIN.CCA = ZZWS3;                                               
         LIN1.TEKST1 = 'ANTAL MED NYT HENVISNINGSNR. JVF. SLUTMANDTAL ';
         TOTAL1 = TV_NY_HENVIS;                                         
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS1;                                               
         LIN1.TEKST1 = 'ANTAL PSA EJ PLADS IKKE FUNDET PÅ BEREGN.BÅND ';
         TOTAL1 = TV_EJ_FUNDET;                                         
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS1;                                               
         LIN1.TEKST1 = 'ANTAL IKKE PSA ÆNDRET TIL PSA EJ PLADS        ';
         TOTAL1 = TV_NY_SMUDS;                                          
         CALL ZZ20301 (LINIE,'01');                                     
         LIN.CCA = ZZWS3;                                               
         LIN1.TEKST1 = 'ANTAL IKKE TIDL. DØD ELL. EJ PÅ MT (SMUDS O/P)';
         TOTAL1 = TV_NY_OP;                                             
         CALL ZZ20301 (LINIE,'01');                                     
         LINIE= (59)' ' !!                                              
          'IALT      KBH.       A.C       Å.C       O.C       B.C';     
         LIN.CCA = ZZWS2;                                               
         CALL ZZ20301(LINIE,'01');                                      
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.KOMINDV_OK(K) = '1'B                              
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) + 1;     
         END;                                                           
         LIN1.TEKST1 = 'ANTAL KOMMUNEINDIVIDER ';                       
         TOTAL1 = TV_SKR_KOM;                                           
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FUDSKR(K);                                        
         END;                                                           
         LIN1.TEKST1 = 'ANTAL INDIVIDER TIL UDSKRIVNING PÅ ESKEMAER';   
         TOTAL1 = TV_UDSKR;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FUSA_C(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ USAM';                              
         TOTAL1 = TV_USA_C;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FUSA_D(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ USAC';                              
         TOTAL1 = TV_USA_D;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FBSA_F(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ BSAM';                              
         TOTAL1 = TV_BSA_F;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FBSA_G(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ BSAC';                              
         TOTAL1 = TV_BSA_G;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FPSAD(K);                                         
         END;                                                           
         LIN1.TEKST1 = '   HERAF PSAD EJ PLADS';                        
         TOTAL1 = TV_PSAD;                                              
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FPSAK(K);                                         
         END;                                                           
         LIN1.TEKST1 = '   HERAF PSAK EJ PLADS';                        
         TOTAL1 = TV_PSAK;                                              
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FØVRIGE(K);                                       
         END;                                                           
         LIN1.TEKST1 = '   HERAF ØVRIGE';                               
         TOTAL1 = TV_ØVRIGE;                                            
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS3;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FEJUDSKR(K);                                      
         END;                                                           
         LIN1.TEKST1 = 'ANTAL INDIVIDER TIL UDSKRIVNING PÅ CSC ';       
         TOTAL1 = TV_EJUDSKR;                                           
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FUSA_B(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ USAU';                              
         TOTAL1 = TV_USA_B;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FUSA_I(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF DØDE UDSKREVET PÅ EFTERLEV. (USA)';    
         TOTAL1 = TV_USA_I;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FUSA_J(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF SENERE OPTAGET PÅ MANDTAL (USA)';      
         TOTAL1 = TV_USA_J;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FBSA_E(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ BSAU';                              
         TOTAL1 = TV_BSA_E;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FBSA_K(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF DØDE UDSKREVET PÅ EFTERLEV. (BSA)';    
         TOTAL1 = TV_BSA_K;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FBSA_L(K);                                        
         END;                                                           
         LIN1.TEKST1 = '   HERAF SENERE OPTAGET PÅ MANDTAL (BSA)';      
         TOTAL1 = TV_BSA_L;                                             
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FPSA(K);                                          
         END;                                                           
         LIN1.TEKST1 = '   HERAF PÅ PSA';                               
         TOTAL1 = TV_PSA;                                               
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FPSAP(K);                                         
         END;                                                           
         LIN1.TEKST1 = '   HERAF DØDE UDSKREVET PÅ EFTERLEV. (PSA)';    
         TOTAL1 = TV_PSAP;                                              
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
         TOTAL(*) = 0;                                                  
         DO K = 101 TO 910;                                             
            IF KOMTOT.CRCKO(K) > 0                                      
            THEN                                                        
               TOTAL(KOMTOT.CRCKO(K)) = TOTAL(KOMTOT.CRCKO(K)) +        
               KOMTOT.FPSAO(K);                                         
         END;                                                           
         LIN1.TEKST1 = '   HERAF SENERE OPTAGET PÅ MANDTAL (PSA)';      
         TOTAL1 = TV_PSAO;                                              
         DO I = 2 TO 5;                                                 
            TOTAL(I) = TOTAL(I+1);                                      
         END;                                                           
         TOTAL(6) = 0;                                                  
         LIN.CCA = ZZWS1;                                               
         CALL ZZ20301 (LINIE,'01');                                     
 END TOTALLISTE;                                                        
 /********************************************************************* 
 *       DER SKRIVES EN SIDE PR. PERSON MED CSMUDS = M ELLER N, SOM   * 
 *       IKKE FINDES PÅ BEREGNINGSBÅNDET, SAMT OPTÆLLES TIL KONTROL.  * 
 *********************************************************************/ 
 SKRIV_EJ_FUNDET:                                                       
         PROC;                                                          
         MTFIL.CKØRSEL = '***';   /* MARKER AT PERSONEN ER */           
                                  /* UDSKREVET EEN GANG    */           
         TV_EJ_FUNDET = TV_EJ_FUNDET + 1;                               
         LIN.CCA = ZZWS3;                                               
         OVLIN.T1 = 'PROGRAM: BH61100L';                                
         OVLIN.T2 = 'AJOURFØR BEREGNINGSBÅND ';                         
         OVLIN.T3 = 'MED KODE FOR E-SKEMA PSA EJ PLADS';                
         OVLIN.T4 = 'UDSKREVET DEN';                                    
         OVLIN.DATO = UDDATO;                                           
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWS2;                   /* SPACE 2 AFTER PRINT  */  
         PRINTLIN = 'KOMMUNENR.   PERSONNR.   HENVISNINGSNR.   CIVILSTAN
 D';                                                                    
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWS3;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = ' ';                                                
         LIN2.KOMNR = MTFIL.EÆKNR;                                      
         LIN2.DCPRN = MTFIL.DCPRN;                                      
         SUBSTR(LINIE,20,1) = '-';                                      
         IF MTFIL.DHENVN ^= 0                                           
         THEN                                                           
            DO;                                                         
               LIN2.DHENVN = MTFIL.DHENVN;                              
               SUBSTR(LINIE,35,1) = '-';                                
            END;                                                        
         LIN2.CCIVS = MTFIL.CCIVS;                                      
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWS1;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = 'TIL OVENNÆVNTE PERSON SKULLE DER HAVE VÆRET UDSKREV
 ET EJENDOMSSKEMA(ER), IDET DER IKKE VAR PLADS TIL EJENDOMSOPLYSNINGERNE
  PÅ       ';                                                           
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWS2;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = 'USA-/BSA- ELLER PSA-SELVANGIVELSEN.';              
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWS1;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = 'UDSKRIVNINGEN VIL IMIDLERTID IKKE FINDE STED, IDET 
 PERSONEN IKKE VAR REGISTRERET SOM EJER AF EJENDOM(ME) PÅ BEREGNINGSTIDS
 PUNKTET.  ';                                                           
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWS1;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = 'ÅRSAGEN HERTIL ER SANDSYNLIGVIS, AT DET VAR PERSONE
 NS ÆGTEFÆLLE, SOM VAR REGISTRERET SOM EJER AF EJENDOM(ME), OG AT ÆGTEFÆ
 LLEN      ';                                                           
         CALL ZZ20301 (LINIE,'03');                                     
         LIN.CCA = ZZWK1;                   /* SPACE 1 AFTER PRINT  */  
         PRINTLIN = 'ER DØD, HVOREFTER PERSONEN EFTERFØLGENDE HAR FÅET O
 VERFØRT EJENDOMSOPLYSNINGERNE FRA DEN AFDØDE I SLUT-SYSTEMET.';        
         CALL ZZ20301 (LINIE,'03');                                     
 END SKRIV_EJ_FUNDET;                                                   
 /********************************************************************* 
 *       KØRSELSFEJL : FORKERT MINI-MT ELLER FORKERT BEREGNINGSBÅND   * 
 *                     BRUGT SOM INPUT                                * 
 *********************************************************************/ 
 AFBRYD_KØRSEL:                                                         
         PROC;                                                          
         CALL FEJLLISTE('5');                                           
         CALL ZS30101(4,'BH61100 ** 253 ' !!                            
         'FORKERT(E) INPUT-DATASÆT BENYTTET   ',2);                     
 END AFBRYD_KØRSEL;                                                     
 /********************************************************************* 
 *       MASKINEL AFSTEMNING                                          * 
 *********************************************************************/ 
 MASK_AFSTEMNING:                                                       
         PROC;                                                          
         IF BH61099.SORT_KOMNR ^= 999 !                                 
           ^EOF_BH610               /* OPTÆLLINGSINDIVID MANGLER */     
         THEN                                                           
            CALL FEJLLISTE('1');                                        
         IF TV_BH61099 ^= TV_BH610                                      
         THEN                                                           
            CALL FEJLLISTE('2');                                        
         IF OPTALT = 0                                                  
         THEN                                                           
            CALL FEJLLISTE('3');                                        
         IF OPTALT ^= TV_BF620 &                                        
            EX_PARM ^= 'TEST'                                           
         THEN                                                           
            CALL FEJLLISTE('4');                                        
         IF SWFEJL = '1'                                                
         THEN                                                           
            CALL ZS30101(4,'BH61100 ** 251 ' !!                         
                 'MASKINEL KONSTATERET AFSTEMNINGSFEJL',2);             
 END MASK_AFSTEMNING;                                                   
 /*********************************************************************/
 /*      UDSKRIV FEJLLISTE VEDR. KONSTATERET AFSTEMNINGFEJL PÅ ???    */
 /*********************************************************************/
 FEJLLISTE:                                                             
         PROC(FEJL);                                                    
 DCL     FEJL            CHAR      (01);                                
         OVERLIN1.CCA = ZZWS2;                                          
         OVERLIN1.DATO = UDDATO;                                        
         CALL ZZ20300(OVERLIN1,'02');                                   
         OVERLIN2.CCA = ZZWS3;                                          
         OVERLIN2.TEKST1 = 'FEJLLISTE VEDR. MASKINEL AFSTEMNING';       
         CALL ZZ20300(OVERLIN2,'02');                                   
         IF FEJL = '1'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  =                                         
               'AFSTEMNINGSINDIVID MANGLER PÅ B.H61X00D';               
               DETLIN1.ANTAL = '';                                      
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '2'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  = 'ANTAL LÆSTE INDIVIDER PÅ B.H61X00D';   
               DETLIN1.ANTAL = TV_BH610;                                
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST  =                                         
               'ANTAL INDIVIDER IFØLGE AFSTEMNINGSINDIVID IALT :';      
               DETLIN1.ANTAL = BH61099.ANT_INDV;                        
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '3'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  =                                         
               'AFSTEMNINGSINDIVIDER MANGLER PÅ B.F62001D';             
               DETLIN1.ANTAL = '';                                      
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '4'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  = 'ANTAL LÆSTE INDIVIDER PÅ B.F62001D';   
               DETLIN1.ANTAL = TV_BF620;                                
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST =                                          
               'ANTAL INDIVIDER IFØLGE AFSTEMNINGSINDIVIDER IALT';      
               DETLIN1.ANTAL = OPTALT;                                  
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '5'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST = 'FORKERT MINI-MTFIL OG/ELLER BEREGNINGSBÅ
 ND BRUGT SOM INPUT';                                                   
               DETLIN1.ANTAL = 0;                                       
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         SWFEJL = '1';                                                  
 END FEJLLISTE;                                                         
 END  BH61100;                                                          
