 PROCESS OPT(TIME);                                                     
 BH89700:   /* OPDEL ESR-UDTRÆK I EJENDOMME MED 2 EJERE OG ØVR. EJD. */ 
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /********************************************************************/ 
  DCL COPYRIGHT   CHAR (30) STATIC    INIT ('COPYRIGHT KMD A/S 2021');  
 /********************************************************************* 
 /*                                                                   */
 /* FORMÅL: LÆSER ET DATASÆT OG INDSÆTTE ÅRSTAL FRA PARAMETER         */
 /*                                                                   */
 /*Parameterfil udfyldes således:                                     */
 /*>>BH897002019                                                      */
 /**********-----------------------programnavn                        */
 /*         ****-----------------------årstal                         */
 /*  JCL ligger på BZTSO: UDV.BEVS.S20.JCL(BH89700T)                  */
 /********************************************************************/ 
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL  PARMFIL      FILE RECORD INPUT;                                   
 DCL  BH897I       FILE RECORD INPUT;                                   
 DCL  BH897O       FILE RECORD OUTPUT;                                  
 DCL  SYSPRINT     FILE OUTPUT;                                         
                                                                        
 DCL  1 PARM,                                                           
         03 IDENT          CHAR (09)   init (''),                       
         03 AAR            PIC '(04)9' init (0),                        
         03 FILLER         CHAR(67);                                    
                                                                        
 /********************************************************************* 
 *       DECLARE AF                                                   * 
 *********************************************************************/ 
 DCL   1 INDI810,                                                       
        %INCLUDE BH96110N;;     /* INDIVID 810 */                       
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     EOF_BH897       BIT       (1);                                 
 DCL     EOF_PARMFIL               CHAR      (01)  INIT(' ');           
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     1 TV,                                                          
           2 LÆS_BH897   FIXED DEC (31)    INIT(0),                     
           2 SKRIV_BH897 FIXED DEC (31)    INIT(0);                     
                                                                        
 DCL PROGRAM_ID          CHAR (08)  INIT('BH89700');                    
 DCL MODUL_NAVN          CHAR (08)  INIT('BH89700');                    
                                                                        
 /********************************************************************* 
 *       DECLARE AF ENTRY OG BUILTIN                                  * 
 *********************************************************************/ 
 DCL     MOD             BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     ZS61900         ENTRY;                                         
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
         EXTERNAL INIT ('NOTEST(ALL,,;)');                              
                                                                        
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         EOF_BH897 = NEJ;                                               
                                                                        
         ON ENDFILE (PARMFIL)                                           
         BEGIN;                                                         
          EOF_PARMFIL = '1';                                            
         END;                                                           
                                                                        
         OPEN FILE (PARMFIL) TITLE ('BH89700C') INPUT;                  
         READ FILE (PARMFIL) INTO (PARM);                               
         CLOSE FILE (PARMFIL);                                          
         PUT SKIP LIST('PARMFIL ' !! PARM);                             
                                                                        
         OPEN FILE (BH897I)  TITLE ('BH89700I');                        
         OPEN FILE (BH897O)  TITLE ('BH89700O');                        
                                                                        
         ON ENDFILE(BH897I)                                             
         BEGIN;                                                         
            EOF_BH897 = JA;                                             
         END;                                                           
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         READ FILE (BH897I) INTO (INDI810);                             
                                                                        
         DO WHILE (EOF_BH897 = NEJ);                                    
           TV.LÆS_BH897 = TV.LÆS_BH897 + 1;                             
           INDI810.DINDKAAR = PARM.AAR;                                 
           WRITE FILE (BH897O) FROM (INDI810);                          
           TV.SKRIV_BH897 = TV.SKRIV_BH897 + 1;                         
           READ FILE (BH897I) INTO (INDI810);                           
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************/ 
 AFSLUT: PROC;                                                          
                                                                        
         CLOSE FILE (BH897I),                                           
               FILE (BH897O);                                           
                                                                        
         PUT SKIP LIST ('ANTAL LÆSTE   ' !! TV.LÆS_BH897);              
         PUT SKIP LIST ('ANTAL SKREVNE ' !! TV.SKRIV_BH897);            
                                                                        
                                                                        
 END AFSLUT;                                                            
                                                                        
 END  BH89700;                                                          
