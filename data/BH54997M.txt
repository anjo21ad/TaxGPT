 /*********************************************************************/
 /* DECLARES TIL MACRO BH54997M                                       */
 /*********************************************************************/
 DCL  FORGÆNGER_FUNDET        BIT (1)    INIT ('0'B);                   
 DCL  WS_CHECK_PROGRAMNAVN    CHAR(8)    INIT (' ');                    
                                                                        
 DCL  FØRSTE_MODUL_FORSKUD    CHAR(8)    INIT ('BH20000');              
 DCL  FØRSTE_MODUL_SLUT       CHAR(8)    INIT ('BH20000');              
 DCL  FØRSTE_MODUL_SUPPL      CHAR(8)    INIT ('BH80500');              
                                                                        
 /*********************************************************************/
 /* Check om modul køres i korrekt sekvens -                          */
 /*********************************************************************/
 CHECK_SEKVENS: PROC (SEKVENS_FS_MRK);                                  
                                                                        
 DCL  SEKVENS_FS_MRK          CHAR(1);                                  
                                                                        
         FORGÆNGER_FUNDET = '0'B;                                       
                                                                        
         PUT SKIP LIST ('Check om forgængere for ' !!                   
                         WS_PROGRAMNAVN !! ' er kørt');                 
                                                                        
         SELECT (SEKVENS_FS_MRK);                                       
            WHEN ('S')                                                  
               DO;                                                      
                  CALL SLUT_AFHÆNGIGHEDER;                              
               END;                                                     
            WHEN ('F')                                                  
               DO;                                                      
                  CALL FORSKUD_AFHÆNGIGHEDER;                           
               END;                                                     
            WHEN ('U')                                                  
               DO;                                                      
                  CALL SUPPL_AFHÆNGIGHEDER;                             
               END;                                                     
            OTHERWISE                                                   
               DO;                                                      
                 ABENDTXT = '101 parm skal indeholde S/F eller U: ' !!  
                             SEKVENS_FS_MRK;                            
                 CALL PROGRAM_FEJL;                                     
               END;                                                     
         END; /* select */                                              
                                                                        
         IF ^FORGÆNGER_FUNDET                                           
         THEN DO;                                                       
            ABENDTXT = '101 Der mangler kørsel af ' !!                  
                        WS_CHECK_PROGRAMNAVN;                           
            CALL PROGRAM_FEJL;                                          
         END;                                                           
                                                                        
 END CHECK_SEKVENS;                                                     
                                                                        
 /*********************************************************************/
 /* Check afhængigheder for SLUT                                      */
 /*********************************************************************/
 SLUT_AFHÆNGIGHEDER: PROC;                                              
                                                                        
         put skip list ('slutkørsel');                                  
                                                                        
         SELECT (WS_PROGRAMNAVN);                                       
                                                                        
            WHEN ('BH20100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH20000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH20300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH20100';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH21700')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH20300';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH55500';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                         /* alle forgængere er kørt */                  
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22000')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH21800';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH22600';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22400')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH22200';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22600')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH22000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH55500';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                        /* alle forgængere er kørt */                   
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH50700')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH51300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH55300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH54900';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH55000';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                        WS_CHECK_PROGRAMNAVN = 'BH55100';               
                        CALL FIND_FORGÆNGER;                            
                        IF ^FORGÆNGER_FUNDET                            
                        THEN DO;                                        
                           /* forgænger mangler. stop */                
                        END;                                            
                        ELSE DO;                                        
                           WS_CHECK_PROGRAMNAVN = 'BH58200';            
                           CALL FIND_FORGÆNGER;                         
                           IF ^FORGÆNGER_FUNDET                         
                           THEN DO;                                     
                             /* forgænger mangler. stop */              
                           END;                                         
                           ELSE DO;                                     
                              /* alle forgængere er kørt */             
                           END;                                         
                        END;                                            
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH55500')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH55300';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH58200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH58000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH80100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH21700';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH22400';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                        /* alle forgængere er kørt */                   
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84800';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH80100';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84800')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84300';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH86000')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84200';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH86100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH86300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            OTHERWISE                                                   
               DO;                                                      
                  /* program kræver ingen forgænger */                  
                  FORGÆNGER_FUNDET = '1'B;                              
               END;                                                     
            END;                                                        
                                                                        
 END SLUT_AFHÆNGIGHEDER;                                                
                                                                        
 /*********************************************************************/
 /* Check afhængigheder for FORSKUD                                   */
 /*********************************************************************/
 FORSKUD_AFHÆNGIGHEDER: PROC;                                           
                                                                        
         put skip list ('forskudskørsel');                              
                                                                        
         SELECT (WS_PROGRAMNAVN);                                       
                                                                        
            WHEN ('BH20100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH20000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH21700')                                            
               DO;                                                      
                  /* her skal tilføjes BH20300 for slut */              
                  WS_CHECK_PROGRAMNAVN = 'BH20100';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH55500';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                         /* alle forgængere er kørt */                  
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22000')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH21800';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH22600';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22400')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH22200';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH22600')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH22000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH55500';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                        /* alle forgængere er kørt */                   
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH55300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH54900';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH55000';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                        WS_CHECK_PROGRAMNAVN = 'BH55100';               
                        CALL FIND_FORGÆNGER;                            
                        IF ^FORGÆNGER_FUNDET                            
                        THEN DO;                                        
                           /* forgænger mangler. stop */                
                        END;                                            
                        ELSE DO;                                        
                           WS_CHECK_PROGRAMNAVN = 'BH58200';            
                           CALL FIND_FORGÆNGER;                         
                           IF ^FORGÆNGER_FUNDET                         
                           THEN DO;                                     
                             /* forgænger mangler. stop */              
                           END;                                         
                           ELSE DO;                                     
                              /* alle forgængere er kørt */             
                           END;                                         
                        END;                                            
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH55500')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH55300';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH58200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH58000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH71200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH85000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH80100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH21700';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     WS_CHECK_PROGRAMNAVN = 'BH22400';                  
                     CALL FIND_FORGÆNGER;                               
                     IF ^FORGÆNGER_FUNDET                               
                     THEN DO;                                           
                        /* forgænger mangler. stop */                   
                     END;                                               
                     ELSE DO;                                           
                        /* alle forgængere er kørt */                   
                     END;                                               
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84800';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH80100';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84800')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84300';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH85000')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84200';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH85100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH85000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH85300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH85000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            OTHERWISE                                                   
               DO;                                                      
                  /* program kræver ingen forgænger */                  
                  FORGÆNGER_FUNDET = '1'B;                              
               END;                                                     
            END;                                                        
                                                                        
 END FORSKUD_AFHÆNGIGHEDER;                                             
                                                                        
 /*********************************************************************/
 /* Check afhængigheder for SUPPLEMENT                                */
 /*********************************************************************/
 SUPPL_AFHÆNGIGHEDER: PROC;                                             
                                                                        
         put skip list ('supplementskørsel');                           
                                                                        
         SELECT (WS_PROGRAMNAVN);                                       
                                                                        
            WHEN ('BH50700')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH80500')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000'; /* fra SLUT */      
                  CALL FIND_FORGÆNGER_SLUT;                             
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH80700')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH80500';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84200')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84800';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84300')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH80700';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH84800')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84300';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH86000')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH84200';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            WHEN ('BH87100')                                            
               DO;                                                      
                  WS_CHECK_PROGRAMNAVN = 'BH86000';                     
                  CALL FIND_FORGÆNGER;                                  
                  IF ^FORGÆNGER_FUNDET                                  
                  THEN DO;                                              
                     /* forgænger mangler. stop */                      
                  END;                                                  
                  ELSE DO;                                              
                     /* alle forgængere er kørt */                      
                  END;                                                  
               END;                                                     
                                                                        
            OTHERWISE                                                   
               DO;                                                      
                  /* program kræver ingen forgænger */                  
                  FORGÆNGER_FUNDET = '1'B;                              
               END;                                                     
            END;                                                        
                                                                        
 END SUPPL_AFHÆNGIGHEDER;                                               
                                                                        
 /*********************************************************************/
 /* SELECT KØRSELSTABEL          MACRO BH54998M                       */
 /*********************************************************************/
 FIND_FORGÆNGER: PROC;                                                  
                                                                        
         DCLBQ69000T = '';                                              
                                                                        
         put skip list ('forgænger ' !! WS_CHECK_PROGRAMNAVN !!         
                        ' skal være kørt for ' !!                       
                        WS_TIL_EVS_AAR !! ' ' !! WS_FORSKUD_SLUT_TXT);  
                                                                        
         FORGÆNGER_FUNDET = '0'B;                                       
                                                                        
         EXEC SQL                                                       
            SELECT PROGRAMNAVN                                          
            INTO   :DCLBQ69000T.PROGRAMNAVN                             
            FROM BQ69000T                                               
            WHERE TIL_EVS_AAR = :WS_TIL_EVS_AAR                         
            AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT                  
            AND   PROGRAMNAVN   = :WS_CHECK_PROGRAMNAVN                 
            AND   DB2_FUNKTION ^= '0';                                  
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
            WHEN(0) DO;                                                 
               FORGÆNGER_FUNDET = '1'B;                                 
            END;                                                        
            WHEN(100) DO;                                               
            END;                                                        
            OTHERWISE DO;                                               
               ABENDTXT  = '101 SELECT BQ69000T';                       
               CALL SQL_FEJL;                                           
            END;                                                        
         END;                                                           
                                                                        
 END FIND_FORGÆNGER;                                                    
 /*********************************************************************/
 /* SELECT KØRSELSTABEL          MACRO BH54998M                       */
 /*********************************************************************/
 FIND_FORGÆNGER_SLUT: PROC;                                             
                                                                        
         DCLBQ69000T = '';                                              
                                                                        
         FORGÆNGER_FUNDET = '0'B;                                       
                                                                        
         EXEC SQL                                                       
            SELECT PROGRAMNAVN                                          
            INTO   :DCLBQ69000T.PROGRAMNAVN                             
            FROM BQ69000T                                               
            WHERE TIL_EVS_AAR = :WS_TIL_EVS_AAR                         
            AND   AFVIKLINGS_ID = :WS_SLUT_AFVIKLINGS_ID                
            AND   PROGRAMNAVN   = :WS_CHECK_PROGRAMNAVN                 
            AND   DB2_FUNKTION ^= '0';                                  
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
            WHEN(0) DO;                                                 
               FORGÆNGER_FUNDET = '1'B;                                 
            END;                                                        
            WHEN(100) DO;                                               
            END;                                                        
            OTHERWISE DO;                                               
               ABENDTXT  = '101 SELECT BQ69000T';                       
               CALL SQL_FEJL;                                           
            END;                                                        
         END;                                                           
                                                                        
 END FIND_FORGÆNGER_SLUT;                                               
 /*********************************************************************/
 /* SELECT KØRSELSTABEL  gammelt år   MACRO BH54998M                  */
 /*********************************************************************/
 FIND_FORGÆNGER_GL: PROC;                                               
                                                                        
         DCLBQ69000T = '';                                              
                                                                        
         FORGÆNGER_FUNDET = '0'B;                                       
                                                                        
         EXEC SQL                                                       
            SELECT PROGRAMNAVN                                          
            INTO   :DCLBQ69000T.PROGRAMNAVN                             
            FROM BQ69000T                                               
            WHERE TIL_EVS_AAR = :WS_TIL_EVS_AAR - 1                     
            AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT                  
            AND   PROGRAMNAVN   = :WS_CHECK_PROGRAMNAVN                 
            AND   DB2_FUNKTION ^= '0';                                  
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
            WHEN(0) DO;                                                 
               FORGÆNGER_FUNDET = '1'B;                                 
            END;                                                        
            WHEN(100) DO;                                               
            END;                                                        
            OTHERWISE DO;                                               
               ABENDTXT  = '101 SELECT BQ69000T GL ÅR';                 
               CALL SQL_FEJL;                                           
            END;                                                        
         END;                                                           
                                                                        
 END FIND_FORGÆNGER_GL;                                                 
