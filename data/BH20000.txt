 BH20000: PROCEDURE OPTIONS (MAIN);                                     
 /**********************************************************************
 * PROJEKT:     EVS FORSKUD 2016/EVS SLUT 2015                         *
 * PROGRAMNAVN: BH20000.                                               *
 * PROGRAMTYPE: BATCH.                                                 *
 * FUNKTION:    PROGRAMMET UDTRÆKKER ALLE AKTIVE OG VALIDE EJENDOMME   *
 *              FRA SENEST EVS SLUT ÅR                                 *
 * PGMFORLØB:   1. ÅBEN EVS UDTRÆKSFIL.                                *
 *              2. DECLARE PERSONEJENDOMSOPL.                          *
 *              3. OPEN PERSONEJENDOMSOPL.                             *
 *              4. LÆS/FETCH RÆKKE PÅ PERSONTABEL.                     *
 *              5. BEHANDL DATA TIL FØRSTE DEL AF RECORDSTRUKTUR.      *
 *              6. LÆS/FETCH RÆKKE PÅ PERSONTABEL.                     *
 *              7. BEHANDL DATA TIL SIDSTE DEL AF RECORDSTRUKTUR.      *
 *              8. CHECK/SKRIV RÆKKE PÅ EVS FIL.                       *
 *              9. GENTAG PUNKT 4 TIL 8 INTIL IKKE FLERE RÆKKER        *
 *             10. LUK PERSONEJENDOMSOPL.                              *
 *             11. LUK EVS UDTRÆKSFIL.                                 *
 *             12. SKRIV KONTROLLISTE.                                 *
 * INDDATA:     VB.Q15500D        - EVS EJENDOMSREGISTER SLUT 2015     *
 *              BQ30000T/BQ31000T - EVS PERSONTABEL.                   *
 *              BQ40000T/BQ41000T - EVS RESULTATTABEL.                 *
 * UDDATA:      BQ77000T EVS UDTRÆK FRA TIDLIGERE ÅR DEL AF INDGÅR     *
 *              SOM DATA TIL OPRETTELSEN                               *
 *              BH20001Y - KONTROLLISTE.                               *
 *                                                                     *
 * KONSTRUKTØR: THOMAS FLINDT         THF, PUS/T&S BRØNDBY 16.07.2001. *
 * ÆNDRINGSLOG: PROGRAMMET ER TILRETTET TIL EVS 2001                   *
 *              ESBEN BRODERSEN       ESB,    T&S BRØNDBY  16.11.2001. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2002               *
 *              ESBEN BRODERSEN       ESB,    T&S BRØNDBY  26.07.2002. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2003               *
 *              ESBEN BRODERSEN       ESB,    T&S BALLERUP 17.07.2003. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2004               *
 *              BO SCHMIDT            BOB,    T&S BALLERUP 07.06.2004. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2005               *
 * *FORSKUD06*  SUSANNE KROGH VILLUMSEN SKV,  T&S BALLERUP 23.05.2005. *
 *             -PROGRAMMET ER TILRETTET TIL FORSKUD 2006               *
 *             -ANTAL LÆSTE VAR IKKE LIG MED ANTAL SKREVNE - ANTAL     *
 *              AFVISTE.                                               *
 *             -BSUM1 OG BSUM2 BLEV IKKE OVERFØRT TIL OUTPUT-FILEN     *
 * *SLUT05*     SUSANNE KROGH VILLUMSEN SKV,  T&S BALLERUP 07.11.2005. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2005                  *
 *              KONVERTERING AF ÆRØ KOMMUNE.  KMNR 443 OG 492  TIL 443 *
 * *FORSKUD07*  BO SCHMIDT            BOB,    PKF BALLERUP 11.05.2006. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2007               *
 * *SLUT06*     BO SCHMIDT            BOB,    PKF BALLERUP 03.11.2006. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2006                  *
 *              KONVERTERING AF DE ØVRIGE KOMMUNER I KOMMUNALREFORMEN. *
 * *FORSKUD08*  BO SCHMIDT            BOB,    PKF BALLERUP 22.05.2007. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2008               *
 * *SLUT07*     BO SCHMIDT            BOB,    PKF BALLERUP 03.01.2008. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2007                  *
 * *FORSKUD09*  BO SCHMIDT            BOB,    PKF BALLERUP 25.04.2008. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2009               *
 * *FORSKUD10*  GERD HOLM-PEDERSEN    GEH,    PKF BALLERUP 07.04.2009. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2010               *
 *              BUDLSKC(910) TILFØJET I BN30000N OG I UDTRÆKKET.       *
 * *FORSKUD11*  GERD HOLM-PEDERSEN    GEH,    PKF BALLERUP 28.05.2010. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2011               *
 *              BBERGRLUDL_01 OG BOMBTILBUDL_01                        *
 *              FJERNET I BN30000N OG I UDTRÆKKET.                     *
 * *FORSKUD12*  GERD HOLM-PEDERSEN    GEH,    PKF BALLERUP 16.05.2011. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2012               *
 * *FORSKUD13*  ESBEN BRODERSEN       ESB,    PR  BALLERUP 15.05.2012. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2013               *
 * *FORSKUD14*  ESBEN BRODERSEN       ESB,    PR  BALLERUP 22.05.2013. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2014               *
 * *FORSKUD15*  JØRGEN SAUGMANN       QQS,    PR  BALLERUP 27.06.2014. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2015               *
 * *FORSKUD16*  JENS HOLGER KJÆR      JNK,        BALLERUP 08.06.2015. *
 *             PROGRAMMET ER ÅRSRULLET TIL FORSKUD 2016               * 
 * SLUT 2015   ESBEN BRODERSEN Z8QEB              BALLERUP 08.03.2016  *
 *             INDLAGT KONSTANT MACRO BH65300M #01                     *
 * *FORSKUD17* ESBEN BRODERSEN Z8QEB              BALLERUP 08.06.2016  *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2017                *
 *             KS30-01 SLETTEDE EJERSKABER SKAL IKKE SKRIVES #01       *
 *             UDVIDDET MED PARMKORT DA KUN KOMMUNE 170 SKAL MED       *
 *             I BRUGTEST                                              *
 * *FORSKUD18* UDDATA ER OMLAGT TIL DB2 TABEL BQ77000T I STEDET        *
 *             FOR FILER  QEB  MARTS                                   *
 * *FORSKUD18* ESBEN BRODERSEN Z8QEB              BALLERUP 07.06.2017  *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2018                *
 **********************************************************************/
                                                                        
 DEFAULT RANGE (*) STATIC; /* LAGERTYPE AHT. KALD AF EKSTERNE MODULER */
                                                                        
 DCL     COPYRIGHT      CHAR (30) INIT ('(C) KMD A/S 2017');            
                                                                        
 /*********************************************************************/
 /* DECLARE AF DB2                                                    */
 /*********************************************************************/
                                                                        
         EXEC SQL INCLUDE SQLCA;        /* SQL KOMMUNIKATIONSAREAL    */
         EXEC SQL INCLUDE BQ30000T;     /* EVS SLUT EJERSKABSTABEL    */
         EXEC SQL INCLUDE BQ31000T;     /* EVS SLUT EJERSKABSFELTTABEL*/
         EXEC SQL INCLUDE BQ40000T;     /* EVS SLUT RESULTATTABEL     */
         EXEC SQL INCLUDE BQ41000T;     /* EVS SLUT RESULTATFELTTABEL */
                                                                        
 /**********************************************************************
 * DECLARE AF ABEND RUTINE                                             *
 **********************************************************************/
                                                                        
 DCL     ZS30101        ENTRY;                                          
 DCL     ZS67000        ENTRY;                                          
 DCL     ZS61900        ENTRY;                        /* KST/SSI INFO */
                                                                        
 /*********************************************************************/
 /* DECLARE AF DIVERSE                                                */
 /*********************************************************************/
                                                                        
 DCL     HJ_DCPRN       CHAR (10);                                      
 DCL     HJ_DCPRN_PIC   PIC  '(10)9' BASED(ADDR(HJ_DCPRN));             
 DCL     HJ_EKOMNR      CHAR (03);                                      
 DCL     HJ_EEJDNR      CHAR (06);                                      
 DCL     HJ_DFRAGLD_DTO CHAR (10);                                      
 DCL     EKOMEEJD_NR    CHAR (09);                                      
 DCL     OK             CHAR (01)        INIT('J');                     
 DCL     FEJLTEKST      CHAR (20)        INIT(' ');                     
 DCL     ABENDKODE     FIXED       (2) INIT(5);                         
 DCL     1 ABENDMEDD,                                                   
          2 ABENDMODUL CHAR      (7) INIT ('BH20000'),                  
          2 ABENDFILL1 CHAR      (1) INIT (' '),                        
          2 ABENDMEDNR CHAR      (2) INIT ('**'),                       
          2 ABENDFILL2 CHAR      (1) INIT (' '),                        
          2 ABENDTXT   CHAR      (45);                                  
 DCL     ABENDRTKODE   FIXED     (1) INIT (2);                          
 DCL     FLAG_EN_RÆKKE  BIT(1)           INIT('0'B);                    
 DCL     DCPRN_NGL      DEC FIXED (11,0);                               
 DCL     KOM_NGL        BIN FIXED (15) UNAL;                            
 DCL     EJD_NGL        BIN FIXED (31) UNAL;                            
 DCL     FETCH_SQLKODE  FIXED BIN(15)  INIT(0);                         
                                                                        
 DCL     ANT_INS        BIN FIXED (31) INIT(0);                         
 DCL     ANT_COMM       BIN FIXED (31) INIT(0);                         
                                                                        
 DCL     PARMKOMNR1     BIN FIXED (15);                                 
 DCL     PARMKOMNR2     BIN FIXED (15);                                 
 DCL     PARMKOMNR3     BIN FIXED (15);                                 
                                                                        
 DCL     DT             CHAR (6);                                       
 DCL     1 DAT          BASED(ADDR(DT)),                                
           2 ÅR         PIC   '99',                                     
           2 MD         PIC   '99',                                     
           2 DAG        PIC   '99';                                     
                                                                        
 DCL     HJ_DATOEN       CHAR (8);                                      
 DCL     1 HJ_DATO       BASED(ADDR(HJ_DATOEN)),                        
           2 AAR         PIC  '9999',                                   
           2 MD          PIC  '99',                                     
           2 DG          PIC  '99';                                     
                                                                        
 DCL     EJD_NØGLEN     CHAR      (8);                                  
 DCL     1 EJD_NØGLE    BASED(ADDR(EJD_NØGLEN)),                        
           2 DINDKAAR BIN FIXED(15),                                    
           2 EKOMNR   BIN FIXED(15),                                    
           2 EEJDNR   BIN FIXED(31);                                    
                                                                        
 DCL     TFLAG          BIT(1)         INIT('0'B);                      
                                                                        
 DCL     1 BH65300M,                                                    
           %INCLUDE BH65300M;                    /* DATO OG ÅR MACRO */ 
                                                                        
 DCL     WS_FORSKUD_SLUT_TXT            CHAR(16) INIT (' ');            
 DCL     WS_TIL_EVS_AAR                 BIN FIXED (15);                 
 DCL     WS_GLSLUTÅR                    BIN FIXED (15);                 
 DCL     WS_PROGRAMNAVN                 CHAR(8)  INIT ('BH20000');      
 DCL     JA                             BIT(1)   INIT('1'B);            
 DCL     NEJ                            BIT(1)   INIT('0'B);            
 DCL     WS_SLUT_AFVIKLINGS_ID          CHAR(16) INIT (' ');            
                                                                        
 /*********************************************************************/
 /* PARM KORT                                                         */
 /*********************************************************************/
  DCL     EOF_PARM         BIT (1) INIT ('0'B);                         
  DCL     PARMKORT         FILE RECORD INPUT;                           
  DCL     PARM_AR          CHAR  (80)  INIT (' ');                      
  DCL     PARM_MEDTAGET    BIT (1)       INIT ('0'B);                   
  DCL     PARM_FEJL        BIT (1)       INIT ('0'B);                   
                                                                        
  DCL     1 PARMLINIE  BASED (ADDR (PARM_AR) ),                         
            2 PARMSTART    CHAR      (02),                              
            2 PROGNAVN     CHAR      (07),                              
            2 KOMNR1       CHAR      (03),                              
            2 KOMNR2       CHAR      (03),                              
            2 KOMNR3       CHAR      (03),                              
            2 REST         CHAR      (62);                              
                                                                        
 /*********************************************************************/
 /* PARM FIL(IKKE SAMME FIL SOM PARMKORT)                             */
 /*********************************************************************/
  DCL     EOF_PARMFIL     BIT (1) INIT ('0'B);                          
  DCL     BH20000P        FILE RECORD INPUT;                            
                                                                        
  DCL     1 AFVIKLING_PARM,                                             
           %INCLUDE BH54900N;                                           
                                                                        
         ON ENDFILE (BH20000P)                                          
         BEGIN;                                                         
            EOF_PARMFIL = JA;                                           
         END;                                                           
                                                                        
                                                                        
 /*********************************************************************/
 /* DECLARE DATASÆT                                                   */
 /*********************************************************************/
                                                                        
 DCL     SYSPRINT FILE STREAM PRINT;                                    
    /*  RUL HERUNDER  */                                                
 DCL     BQ165I  FILE RECORD DIRECT  /* EVS EJENDOMS REGISTER         */
                 INPUT KEYED ENV (VSAM);                                
                                                                        
 /*********************************************************************/
 /* DECLARE STRUKTURER                                                */
 /*********************************************************************/
                                                                        
 DCL     1 UDTRÆK_SLUT,                                                 
           %INCLUDE BH30000N;;                                          
                                                                        
 DCL     1 EJENDOM,                   /* EVS EJENDOMS REGISTER      */  
           2 FELTER,                                                    
             %INCLUDE BQ16100N;,    /*RUL*/                             
           2 INDK,                                                      
             %INCLUDE BQ16005N;;    /*RUL*/                             
                                                                        
 DCL     1 PERSON,                    /* EVS EJERSKABSTABELEN       */  
           %INCLUDE BQ16200N;;        /*RUL*/                           
                                                                        
 DCL     1 INDK_PERS,                 /* INDIKATOR EJERSKAB OPLYSN. */  
           %INCLUDE BQ16006N;;        /*RUL*/                           
                                                                        
 DCL     1 RESULTAT,                                                    
           5 BEJERAN     DEC FIXED(15,2);                               
                                                                        
 DCL     1 INDK_RES,                                                    
           5 BEJERAN_SW  BIN FIXED (15) UNAL;                           
                                                                        
 DCL     1 EVS_ESK,                     /* EVS EJERSKABSTABELEN       */
           %INCLUDE BQ30000N;;                                          
 DCL     1 EVS_ESK_FELT,                /* EVS EJERSKABSFELTTABELEN   */
           %INCLUDE BQ31000N;;                                          
 DCL     1 EVS_RES,                     /* EVS RESULTATSTABEL         */
           %INCLUDE BQ40000N;;                                          
 DCL     1 EVS_RES_FELT,                /* EVS RESULTATFELTTABELEN    */
           %INCLUDE BQ41000N;;                                          
                                                                        
 /*********************************************************************/
 /* DECLARE AF BUILTIN                                                */
 /*********************************************************************/
                                                                        
 DCL     (ADDR,DATE,VERIFY,NULL,MOD,SUBSTR,PLIDUMP,PROCNAME) BUILTIN;   
                                                                        
 /*********************************************************************/
 /* DECLARE AF TÆLLERE                                                */
 /*********************************************************************/
                                                                        
 DCL   ANTLÆS_PERSON     BIN FIXED (31) INIT(0);/* LÆSTE PERSONTABEL  */
 DCL   ANTSKRIV_PERSON   BIN FIXED (31) INIT(0);/* SKREVET UDTRÆKSFIL */
 DCL   ANTSKRIV_ØVR      BIN FIXED (31) INIT(0);/* SKREVET EXCL UDLAND*/
 DCL   ANTSKRIV_ØVR_CÆG  BIN FIXED (31) INIT(0);/* SKREVET EXCL UDLAND*/
                                                /* OG CÆGTOPR ^= ' '  */
 DCL   ANTSKRIV_UDL      BIN FIXED (31) INIT(0);/* SKREVET KUN  UDLAND*/
 DCL   ANTCEJBEVS_9      BIN FIXED (31) INIT(0);/* CEJBEVS=9(SLETTET) */
 DCL   ANTOMPLACERET     BIN FIXED (31) INIT(0);/* COMPLA = 1         */
 DCL   ANTCSLET_1        BIN FIXED (31) INIT(0);/* CSLET=1  (SLETTET) */
 DCL   ANTEJDNR_UDL_EJ   BIN FIXED (31) INIT(0);/* FORKERT EJENDOMSNR */
                                                /* HOS CSC FOR UDLAND */
 DCL   ANTEJDNR_EEJDNR_0 BIN FIXED (31) INIT(0);/* FORKERT EJENDOMSNR */
 /*********************************************************************/
 /* PRINTLINIER TIL SPOOL                                             */
 /*********************************************************************/
                                                                        
 DCL     LINIE           CHAR (133);                                    
 DCL     1 LIN           BASED(ADDR(LINIE)),                            
           2 CC          CHAR (1),                                      
           2 TEKST       CHAR (56),                                     
           2 ANT         PIC  '---------9',                             
           2 FIL1        CHAR (66);                                     
                                                                        
         %INCLUDE ZZ20301M;                                             
                                                                        
 /*********************************************************************/
 /* ON - CONDITIONS                                                   */
 /*********************************************************************/
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
                ON ERROR SYSTEM;                                        
                PUT SKIP LIST ('PROGRAMFEJL');                          
                CALL PLIDUMP  ('SBHO','MODUL BH20000');                 
            END;                                                        
                                                                        
         ON KEY (BQ165I)        /*RUL*/                                 
            BEGIN;                                                      
            END;                                                        
                                                                        
 /*********************************************************************/
 /* HOUSEKEEPING                                                      */
 /*********************************************************************/
                                                                        
                                                                        
         UDTRÆK_SLUT       = '';                                        
         PERSON            = '';                                        
         EJENDOM           = '';                                        
         RESULTAT          = '';                                        
                                                                        
         DT = DATE;                                                     
         CALL INIT_INDK;                                                
                                                                        
         CALL OPSTART_INIT;                                             
                                                                        
         OPEN FILE (BQ165I)  TITLE ('BQ16500I');  /*RUL*/               
                                                                        
         CALL ZZ20390('*OPEN','BH20001Y');       /* ÅBEN KONTROLLISTE */
                                                                        
         LINIE = ZZWS3 !! ' KONTROL- & AFSTEMNINGSTOTAL FOR'            
                       !! ' UDTRÆK FRA EVS SLUT '                       
         /*#01*/       !! BH65300M.GLSLUTÅR1 !! ' DATO: '               
                       !!   DAT.DAG !! '.' !! DAT.MD !! '.' !! DAT.ÅR;  
                                                                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE = ZZWS3 !! ' PROGRAMID: BH20000 ';                       
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE = ZZWS2;                                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         CALL ZS61900;                              /* KST/SSI INFO   */
                                                                        
         OPEN FILE (BH20000P) TITLE ('BH20000P');                       
                                                                        
         READ FILE (BH20000P) INTO (AFVIKLING_PARM);                    
                                                                        
         IF EOF_PARMFIL = NEJ                                           
         THEN DO;                                                       
            IF AFVIKLING_PARM.FS_MRK = 'F'                              
            THEN DO;                                                    
               WS_FORSKUD_SLUT_TXT = AFVIKLING_PARM.FORSKUD_TXT;        
               WS_TIL_EVS_AAR = BH65300M.FORSKÅR;                       
            END;                                                        
            ELSE DO;                                                    
               WS_FORSKUD_SLUT_TXT = AFVIKLING_PARM.SLUT_TXT;           
               WS_TIL_EVS_AAR = BH65300M.SLUTÅR;                        
            END;                                                        
         END;                                                           
         ELSE DO;                                                       
             PUT SKIP LIST ('BH20000P PARMFIL MANGLER ');               
             ABENDTXT = '101 PARMFIL MANGLER';                          
             CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);             
         END;                                                           
                                                                        
         /********************************************************/     
         /*  CHECK OM FORGÆNGERE ER KØRT                         */     
         /********************************************************/     
         CALL CHECK_SEKVENS (AFVIKLING_PARM.FS_MRK); /* BH54997M */     
                                                                        
         /********************************************************/     
         /*  NU STARTER CHECK AF OMKØRSEL                        */     
         /********************************************************/     
         CALL CHECK_OM_OMKØRSEL; /* kode ligger i macro BH54999M */     
                                                                        
         IF DER_SKAL_KØRES_OM                                           
         THEN DO;                                                       
            PUT SKIP LIST ('Omkørsel af ' !! WS_PROGRAMNAVN);           
            CALL RYD_OP_FØR_OMKØRSEL;                                   
         END;                                                           
         ELSE DO;                                                       
            PUT SKIP LIST ('Normal kørsel af ' !! WS_PROGRAMNAVN);      
         END;                                                           
                                                                        
         /********************************************************/     
         /*  NU STARTER NORMALT FLOW                             */     
         /********************************************************/     
         CALL OPDATER_KØRSELSTABEL('START',AFVIKLING_PARM.FS_MRK);      
                 /* BH54998M */                                         
                                                                        
 /*********************************************************************/
 /* PROCES                                                            */
 /*********************************************************************/
                                                                        
                                                                        
         CALL DECLARE_CURSOR;                                           
         CALL OPEN_PERSONEJENDOMSOPL;                                   
         CALL FETCH_PERSONEJENDOMSOPL;                                  
                                                                        
         SELECT (FETCH_SQLKODE);  /*GEMT SQLCODE FRA FETCH_PERSONEJ. */ 
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               DO WHILE (FETCH_SQLKODE = 0);                            
                  CALL BEHANDL;                                         
                  CALL INIT_INDK;                                       
                  CALL FETCH_PERSONEJENDOMSOPL;                         
               END;                                                     
             END;                                                       
                                                                        
           WHEN (100)                                                   
               PUT SKIP LIST ('INGEN RÆKKER LÆST');                     
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'FETCH PERSON_CURSOR ';                     
               FEJLTEKST  = 'BH20000 ** 251 ' !! FEJLTEKST;             
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT */                                              
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /*********************************************************************/
 /* BEHANDL                                                    RUTINE */
 /*********************************************************************/
 BEHANDL: PROC;                                                         
                                                                        
         CALL INIT_INDK;                                                
         CALL FØRSTE_PERSONEJENDOMSOPL;                                 
         IF SQLCA.SQLCODE = 0                                           
         THEN                         /* LÆST LÆSTE RÆKKE OG I FØSTE */ 
            CALL GEM_FØRSTE;          /* DEL AF STRUKTUREN           */ 
                                                                        
         IF EVS_ESK.DTILGLD = '9999-12-31-23.59.59.999999'              
         THEN                                                           
            DO;                           /* FØRSTE = SIDSTE SÅ GEMMES*/
              FLAG_EN_RÆKKE = '1'B;       /* FØRSTE DEL AF STRUKTUREN */
              CALL GEM_SIDSTE_CHECK_SKRIV;/* RÆKKEN I SIDSTE DEL AF   */
                                          /* STURKTUREN               */
            END;                                                        
         ELSE                                                           
            DO;                                                         
              CALL INIT_INDK;                                           
              CALL SIDSTE_PERSONEJENDOMSOPL;                            
              IF SQLCA.SQLCODE = 0                                      
              THEN                                                      
                 DO;                                                    
                   CALL GEM_SIDSTE_CHECK_SKRIV;                         
                 END;                                                   
              ELSE                                                      
                 DO;                                                    
                   FLAG_EN_RÆKKE = '0'B;                                
                 END;                                                   
            END;                                                        
                                                                        
 END BEHANDL;                                                           
 /*********************************************************************/
 /* HER INDSÆTTES DATA I DEN FØRSTE DEL AF STUKTUR BH20000N           */
 /*********************************************************************/
 GEM_FØRSTE:  PROC;                                                     
 /*********************************************************************/
 /*      STAM/NØGLEDATA/FÆLLESDATA                                    */
 /*********************************************************************/
         IF TFLAG THEN PUT SKIP LIST('***** '!!PROCNAME!!' *****');     
         UDTRÆK_SLUT.DCPRN      = EVS_ESK.DCPRN;                        
         DCPRN_NGL              = UDTRÆK_SLUT.DCPRN;                    
         UDTRÆK_SLUT.EKOMNR     = EVS_ESK.EKOMNR;                       
         UDTRÆK_SLUT.EEJDNR     = EVS_ESK.EEJDNR;                       
         UDTRÆK_SLUT.EJDBELIG   = EJENDOM.EJDBELIG;                     
         UDTRÆK_SLUT.CLANDEKODE = EJENDOM.CLANDEKODE;                   
                                                                        
         KOM_NGL = EVS_ESK.EKOMNR;                                      
         EJD_NGL = EVS_ESK.EEJDNR;                                      
                                                                        
         UDTRÆK_SLUT.CFRATYPE   = '2';                                  
                                                                        
         IF PERSON.DAFSTAA ^= (10)' '                                   
         THEN                                                           
            UDTRÆK_SLUT.DSORTDAT1 = DB2_DATO_TIL_FIX09(PERSON.DAFSTAA); 
         ELSE                                                           
            UDTRÆK_SLUT.DSORTDAT1 = 99991231;                           
                                                                        
         IF PERSON.DOVTG ^= (10)' '                                     
         THEN                                                           
            UDTRÆK_SLUT.DSORTDAT2 = DB2_DATO_TIL_FIX09(PERSON.DOVTG);   
         ELSE                                                           
            UDTRÆK_SLUT.DSORTDAT2 = 0;                                  
                                                                        
         UDTRÆK_SLUT.CBENYT       = EJENDOM.CBENYT;                     
         UDTRÆK_SLUT.CEJBOLTYP1   = EJENDOM.CEJBOLTYP1;                 
         UDTRÆK_SLUT.CEJBOLTYP2   = EJENDOM.CEJBOLTYP2;                 
                                                                        
 /*******************************************************************/  
 /*    VARIABLE DATA FOR RÆKKE MED EGENNR = 1 OG HØJSTE ELBNR       */  
 /*******************************************************************/  
                                                                        
         UDTRÆK_SLUT.FØRSTE.ELBNR      = EVS_ESK.ELBNR;                 
         UDTRÆK_SLUT.FØRSTE.EGENNR     = EVS_ESK.EGENNR;                
         UDTRÆK_SLUT.FØRSTE.DFRAGLD    = EVS_ESK.DFRAGLD;               
         UDTRÆK_SLUT.FØRSTE.DTILGLD    = EVS_ESK.DTILGLD;               
         UDTRÆK_SLUT.FØRSTE.CDATAFRA   = EVS_ESK.CDATAFRA;              
         UDTRÆK_SLUT.FØRSTE.CAJOUR     = EVS_ESK.CAJOUR;                
         UDTRÆK_SLUT.FØRSTE.CSUPPL     = EVS_ESK.CSUPPL;                
         UDTRÆK_SLUT.FØRSTE.DHENVN     = PERSON.DHENVN;                 
         UDTRÆK_SLUT.FØRSTE.FEJLNR     = PERSON.FEJLNR;                 
         UDTRÆK_SLUT.FØRSTE.CÆGTOPR    = PERSON.CÆGTOPR;                
         UDTRÆK_SLUT.FØRSTE.CSKPLOMF   = PERSON.CSKPLOMF;               
                                                                        
         IF PERSON.CEJBEVS ^= '6'             /* #SLUT2006 */           
          & PERSON.CEJBEVS ^= '7'                                       
          & PERSON.CEJBEVS ^= '8'                                       
          & PERSON.CEJBEVS ^= '9'                                       
          & (PERSON.CÆGTOPR = '1' !                                     
             PERSON.CÆGTOPR = '3' !                                     
             PERSON.CÆGTOPR = '4')                                      
          & PERSON.GPCTEJER = 0                                         
          & INDK_PERS.GPCTEJER_I = 0                                    
          & PERSON.CPCTEJER = '8'                                       
         THEN                                                           
            PERSON.CEJBEVS = '9';                                       
                                                                        
         UDTRÆK_SLUT.FØRSTE.CEJBEVS    = PERSON.CEJBEVS;                
         UDTRÆK_SLUT.FØRSTE.BPENSNED   = PERSON.BPENSNED;               
         UDTRÆK_SLUT.FØRSTE.BPENSNÆ    = PERSON.BPENSNÆ ;               
         UDTRÆK_SLUT.FØRSTE.CEJDTYPE   = EJENDOM.CEJDTYPE;              
         IF PERSON.CEJDTYPE_AKT > '0'                                   
         THEN                                                           
           UDTRÆK_SLUT.FØRSTE.CEJDTYPE   = PERSON.CEJDTYPE_AKT;         
         UDTRÆK_SLUT.FØRSTE.FELT760    = PERSON.FELT760;                
         UDTRÆK_SLUT.FØRSTE.CNEDSL1    = PERSON.CNEDSL1;                
                                                                        
         IF PERSON.DATO0107 ^= (10)' '                                  
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DATO0107 =                               
            DB2_DATO_TIL_FIX09(PERSON.DATO0107);                        
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DATO0107 = 0;                            
                                                                        
         IF PERSON.DOVTG ^= (10)' '                                     
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DOVTG =                                  
            DB2_DATO_TIL_FIX09(PERSON.DOVTG);                           
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DOVTG = 0;                               
                                                                        
         IF PERSON.DAFSTAA ^= (10)' '                                   
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DAFSTAA =                                
            DB2_DATO_TIL_FIX09(PERSON.DAFSTAA);                         
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DAFSTAA = 0;                             
                                                                        
         IF PERSON.DINDFLYT ^= (10)' '                                  
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DINDFLYT =                               
            DB2_DATO_TIL_FIX09(PERSON.DINDFLYT);                        
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DINDFLYT = 0;                            
                                                                        
         IF PERSON.DFRAFLYT ^= (10)' '                                  
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DFRAFLYT =                               
            DB2_DATO_TIL_FIX09(PERSON.DFRAFLYT);                        
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DFRAFLYT = 0;                            
                                                                        
         UDTRÆK_SLUT.FØRSTE.CINDFLYT = PERSON.CINDFLYT;                 
                                                                        
         IF INDK_PERS.GPCTEJER_I = 0                                    
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.GPCTEJER = PERSON.GPCTEJER;           
               UDTRÆK_SLUT.FØRSTE.GPCTEJER_SW = 0;                      
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.GPCTEJER = 0;                         
               UDTRÆK_SLUT.FØRSTE.GPCTEJER_SW = -1;                     
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.FDAGUDLE   = PERSON.FDAGUDLE;               
         UDTRÆK_SLUT.FØRSTE.GPCTUDLE   = PERSON.GPCTUDLE;               
         UDTRÆK_SLUT.FØRSTE.FUDL100    = PERSON.FUDL100;                
         UDTRÆK_SLUT.FØRSTE.FDAGERHV   = PERSON.FDAGERHV;               
         UDTRÆK_SLUT.FØRSTE.GPCTERHV   = PERSON.GPCTERHV;               
         UDTRÆK_SLUT.FØRSTE.FERHVFLER  = PERSON.FERHVFLER;              
         UDTRÆK_SLUT.FØRSTE.CBERGROP   = PERSON.CBERGROP;               
                                                                        
         UDTRÆK_SLUT.FØRSTE.CBERGRGLOP = '';        /*FORSKUD06*/       
                                                                        
         IF INDK_PERS.BBERGRL_015ANV_I = 0          /*FORSKUD06*/       
         &  EJENDOM.INDK.BBERGRL_01OM_I = 0                             
         &  EJENDOM.INDK.BBERGRL_01OMNY_I = 0                           
         &  INDK_PERS.BBERGRL_02ANV_I = 0                               
         &  EJENDOM.INDK.BBERGRL_02OM_I = 0                             
         &  EJENDOM.INDK.BBERGRL_02OMNY_I = 0                           
         &  (PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OM !             
             PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OMNY)            
         &  (PERSON.BBERGRL_02ANV  = EJENDOM.BBERGRL_02OM !             
             PERSON.BBERGRL_02ANV  = EJENDOM.BBERGRL_02OMNY)            
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.CBERGRGLOP = PERSON.CBERGRGLOP;          
                                                                        
         IF INDK_PERS.BBERGRL_015ANV_I = 0          /*FORSKUD06*/       
         &  EJENDOM.INDK.BBERGRL_01OM_I = 0                             
         &  EJENDOM.INDK.BBERGRL_01OMNY_I = 0                           
         &  INDK_PERS.BBERGRL_02ANV_I = 0                               
         &  EJENDOM.INDK.BBERGRL_02OM_I = -1                            
         &  EJENDOM.INDK.BBERGRL_02OMNY_I = -1                          
         &  (PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OM !             
             PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OMNY)            
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.CBERGRGLOP = PERSON.CBERGRGLOP;          
                                                                        
         IF INDK_PERS.BBERGRL_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBERGRL = PERSON.BBERGRL;             
               UDTRÆK_SLUT.FØRSTE.BBERGRL_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBERGRL = 0;                          
               UDTRÆK_SLUT.FØRSTE.BBERGRL_SW = -1;                      
            END;                                                        
                                                                        
         IF INDK_PERS.BBER2FAM_I = 0                                    
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBER2FAM = PERSON.BBER2FAM;           
               UDTRÆK_SLUT.FØRSTE.BBER2FAM_SW = 0;                      
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBER2FAM = 0;                         
               UDTRÆK_SLUT.FØRSTE.BBER2FAM_SW = -1;                     
            END;                                                        
                                                                        
   /*    IF INDK_PERS.BBERGRLUDL_01_I = 0                               
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBERGRLUDL_01 = PERSON.BBERGRLUDL_01; 
               UDTRÆK_SLUT.FØRSTE.BBERGRLUDL_01_SW = 0;                 
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBERGRLUDL_01    = 0;                 
               UDTRÆK_SLUT.FØRSTE.BBERGRLUDL_01_SW = -1;                
            END;                                                        
                                                                        
         IF INDK_PERS.BOMBTILBUDL_01_I = 0                              
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BOMBTILBUDL_01 =                      
                 PERSON.BOMBTILBUDL_01;                                 
               UDTRÆK_SLUT.FØRSTE.BOMBTILBUDL_01_SW = 0;                
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BOMBTILBUDL_01    = 0;                
               UDTRÆK_SLUT.FØRSTE.BOMBTILBUDL_01_SW = -1;               
            END;                                           /*FORSKUD11*/
                                                                        
         IF INDK_PERS.BBERGRL_015ANV_I = 0                              
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_015ANV = PERSON.BBERGRL_015ANV;
              UDTRÆK_SLUT.FØRSTE.BBERGRL_015ANV_SW = 0;                 
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_015ANV    =  0;                
              UDTRÆK_SLUT.FØRSTE.BBERGRL_015ANV_SW = -1;                
            END;                                                        
                                                                        
         IF INDK_PERS.BBER2FAM_015ANV_I = 0                             
         THEN                                                           
            DO;                                                         
            UDTRÆK_SLUT.FØRSTE.BBER2FAM_015ANV = PERSON.BBER2FAM_015ANV;
            UDTRÆK_SLUT.FØRSTE.BBER2FAM_015ANV_SW = 0;                  
            END;                                                        
         ELSE                                                           
            DO;                                                         
             UDTRÆK_SLUT.FØRSTE.BBER2FAM_015ANV    =  0;                
             UDTRÆK_SLUT.FØRSTE.BBER2FAM_015ANV_SW = -1;                
            END;                                                        
                                                                        
         IF INDK_PERS.BBERGRL_02ANV_I = 0       /*FORSKUD06*/           
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_02ANV = PERSON.BBERGRL_02ANV;  
              UDTRÆK_SLUT.FØRSTE.BBERGRL_02ANV_SW = 0;                  
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_02ANV =  0;                    
              UDTRÆK_SLUT.FØRSTE.BBERGRL_02ANV_SW = -1;                 
            END;                                                        
                                                                        
         IF INDK_PERS.BBER2FAM_02ANV_I = 0            /*FORSKUD06*/     
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_02ANV = PERSON.BBER2FAM_02ANV;
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_02ANV_SW = 0;                 
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_02ANV    =  0;                
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_02ANV_SW = -1;                
            END;                                                        
                                                                        
         IF INDK_PERS.BBERGRL_AKT_I = 0                                 
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT = PERSON.BBERGRL_AKT;      
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT_SW = 0;                    
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT = 0;                       
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT_SW = -1;                   
            END;                                                        
                                                                        
         IF INDK_PERS.BBER2FAM_AKT_I = 0                                
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT = PERSON.BBER2FAM_AKT;    
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT_SW = 0;                   
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT   =  0;                   
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT_SW = -1;                  
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.BPROM1     = PERSON.BPROM1;                 
                                                                        
         IF INDK_PERS.BSUM1_I = 0        /*FORSKUD06*/                  
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM1 = PERSON.BSUM1;                 
               UDTRÆK_SLUT.FØRSTE.BSUM1_SW = 0;                         
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM1 = 0;                            
               UDTRÆK_SLUT.FØRSTE.BSUM1_SW = -1;                        
            END;                                                        
                                                                        
         IF INDK_PERS.BSUM3_I = 0        /*FORSKUD06*/                  
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM3 = PERSON.BSUM3;                 
               UDTRÆK_SLUT.FØRSTE.BSUM3_SW = 0;                         
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM3 = 0;                            
               UDTRÆK_SLUT.FØRSTE.BSUM3_SW = -1;                        
            END;                                                        
                                                                        
         IF PERSON.CEJBEVS = '0' ! PERSON.CEJBEVS = '4' !               
            PERSON.CEJBEVS = '5'                                        
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BNETTO    = PERSON.BNETTO;            
               UDTRÆK_SLUT.FØRSTE.BNETTO_SW = 0;                        
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BNETTO    = 0;                        
               UDTRÆK_SLUT.FØRSTE.BNETTO_SW =-1;                        
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.CSTIBLB    = PERSON.CSTIBLB;                
         UDTRÆK_SLUT.FØRSTE.BSTIBEGR   = PERSON.BSTIBEGR;               
                                                                        
         IF INDK_PERS.BFASTSTIGBGR_I = 0                                
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BFASTSTIGBGR = PERSON.BFASTSTIGBGR;   
               UDTRÆK_SLUT.FØRSTE.BFASTSTIGBGR_SW = 0;                  
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BFASTSTIGBGR    = 0;                  
               UDTRÆK_SLUT.FØRSTE.BFASTSTIGBGR_SW =-1;                  
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.BEJERAN    = 0;                             
         UDTRÆK_SLUT.FØRSTE.BEJERAN_SW =-1;                             
                                                                        
         IF INDK_PERS.BEVSMAN_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEVSMAN = PERSON.BEVSMAN;             
               UDTRÆK_SLUT.FØRSTE.BEVSMAN_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEVSMAN = 0;                          
               UDTRÆK_SLUT.FØRSTE.BEVSMAN_SW = -1;                      
            END;                                                        
                                                                        
         IF INDK_PERS.BMANEVSSTI_I = 0                                  
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI    = PERSON.BMANEVSSTI;     
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI_SW = 0;                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI    = 0;                     
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI_SW = -1;                    
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.BMANNEDSL   = PERSON.BMANNEDSL;             
                                                                        
         IF INDK_PERS.MANNEDSLSTI_I = 0                                 
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.MANNEDSLSTI = PERSON.MANNEDSLSTI;      
              UDTRÆK_SLUT.FØRSTE.MANNEDSLSTI_SW = 0;                    
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.MANNEDSLSTI    = 0;                    
              UDTRÆK_SLUT.FØRSTE.MANNEDSLSTI_SW = -1;                   
            END;                                                        
                                                                        
         IF INDK_PERS.MANPENSSTI_I = 0                                  
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.MANPENSSTI = PERSON.MANPENSSTI;        
              UDTRÆK_SLUT.FØRSTE.MANPENSSTI_SW = 0;                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.MANPENSSTI = 0;                        
              UDTRÆK_SLUT.FØRSTE.MANPENSSTI_SW = -1;                    
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.CENKE       = PERSON.CENKE;                 
         UDTRÆK_SLUT.FØRSTE.CENKEBOH    = PERSON.CENKEBOH;              
         UDTRÆK_SLUT.FØRSTE.BOBEHAKOD   = PERSON.BOBEHAKOD;             
         UDTRÆK_SLUT.FØRSTE.CIVILSTAND  = PERSON.CIVILSTAND;            
         UDTRÆK_SLUT.FØRSTE.CSLET       = PERSON.CSLET;                 
                                                                        
         IF INDK_PERS.BEJBOL1_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL1 = PERSON.BEJBOL1;             
               UDTRÆK_SLUT.FØRSTE.BEJBOL1_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL1 = 0;                          
               UDTRÆK_SLUT.FØRSTE.BEJBOL1_SW = -1;                      
            END;                                                        
                                                                        
         IF INDK_PERS.BEJBOL2_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL2 = PERSON.BEJBOL2;             
               UDTRÆK_SLUT.FØRSTE.BEJBOL2_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL2 = 0;                          
               UDTRÆK_SLUT.FØRSTE.BEJBOL2_SW = -1;                      
            END;                                                        
                                                                        
         IF PERSON.CANVEBOL = ' '                                       
          & INDK_PERS.BPROM1_I = 0                                      
          & EJENDOM.INDK.BEJBOL2_AKT_I = 0                              
          & EJENDOM.BEJBOL1_AKT ^= EJENDOM.BEJBOL2_AKT                  
         THEN                                                           
            DO;                                                         
              IF PERSON.BBERGRL_AKT = PERSON.BEJBOL1_AKT                
              THEN                                                      
                 PERSON.CANVEBOL = '1';                                 
              ELSE                                                      
              IF PERSON.BBERGRL_AKT = PERSON.BEJBOL2_AKT                
              THEN                                                      
                 PERSON.CANVEBOL = '2';                                 
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.CANVEBOL   = PERSON.CANVEBOL;               
         UDTRÆK_SLUT.FØRSTE.CPTYPSLUT  = PERSON.CPTYPSLUT;              
         UDTRÆK_SLUT.FØRSTE.FELT759    = PERSON.FELT759;                
         UDTRÆK_SLUT.FØRSTE.CEKSEMP    = PERSON.CEKSEMP; /*#SLUT07*/    
         UDTRÆK_SLUT.FØRSTE.CFRÅR      = PERSON.CFRÅR;                  
         UDTRÆK_SLUT.FØRSTE.COMPLA     = EVS_ESK.COMPLA;                
         UDTRÆK_SLUT.FØRSTE.DOMPLACPR  = EVS_ESK.DOMPLACPR;             
                                                                        
         IF INDK_PERS.BUDLSKC_I = 0        /*FORSKUD10*/                
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BUDLSKC    = PERSON.BUDLSKC;          
               UDTRÆK_SLUT.FØRSTE.BUDLSKC_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BUDLSKC    = 0;                       
               UDTRÆK_SLUT.FØRSTE.BUDLSKC_SW = -1;                      
            END;                                                        
                                                                        
                                                                        
         CALL OPSÆT_GL_INDKOMSTÅR (UDTRÆK_SLUT.FØRSTE.CFRÅR,            
                                   UDTRÆK_SLUT.FØRSTE.DRGNÅRFRA,        
                                   UDTRÆK_SLUT.FØRSTE.DRGNÅRTIL);       
                                                                        
                                                                        
         PERSON            = ''; /* MED DE NYE TABELLER SKAL VI */      
         EJENDOM           = ''; /* NULSTILLE FØR DEN NÆSTE     */      
         RESULTAT          = ''; /* LÆSNING                     */      
         EVS_RES           = '';                                        
                                                                        
 END GEM_FØRSTE;                                                        
 /*********************************************************************/
 /* HER INDSÆTTES DATA I DEN SIDSTE DEL AF STUKTUR BH20000N           */
 /*********************************************************************/
 GEM_SIDSTE_CHECK_SKRIV: PROC;                                          
 /*******************************************************************/  
 /*    VARIABLE DATA FOR RÆKKE MED HØJESTE DTILGLD OG HØJESTE ELBNR */  
 /*******************************************************************/  
         IF TFLAG THEN PUT SKIP LIST('***** '!!PROCNAME!!' *****');     
         IF FLAG_EN_RÆKKE = '1'B                                        
         THEN                                                           
           DO;                                                          
             UDTRÆK_SLUT.SIDSTE = UDTRÆK_SLUT.FØRSTE;                   
             CALL SKAF_BEJERAN;                                         
                                                                        
             IF INDK_RES.BEJERAN_SW = 0   /* CHEK OM FUNDET */          
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = RESULTAT.BEJERAN;    
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = 0;                   
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW =-1;                   
                END;                                                    
           END;                                                         
         ELSE                                                           
           DO;                                                          
             UDTRÆK_SLUT.SIDSTE.ELBNR      = EVS_ESK.ELBNR;             
             UDTRÆK_SLUT.SIDSTE.EGENNR     = EVS_ESK.EGENNR;            
             UDTRÆK_SLUT.SIDSTE.DFRAGLD    = EVS_ESK.DFRAGLD;           
             UDTRÆK_SLUT.SIDSTE.DTILGLD    = EVS_ESK.DTILGLD;           
             UDTRÆK_SLUT.SIDSTE.CDATAFRA   = EVS_ESK.CDATAFRA;          
             UDTRÆK_SLUT.SIDSTE.CAJOUR     = EVS_ESK.CAJOUR;            
             UDTRÆK_SLUT.SIDSTE.CSUPPL     = EVS_ESK.CSUPPL;            
             UDTRÆK_SLUT.SIDSTE.DHENVN     = PERSON.DHENVN;             
             UDTRÆK_SLUT.SIDSTE.FEJLNR     = PERSON.FEJLNR;             
             UDTRÆK_SLUT.SIDSTE.CÆGTOPR    = PERSON.CÆGTOPR;            
             UDTRÆK_SLUT.SIDSTE.CSKPLOMF   = PERSON.CSKPLOMF;           
                                                                        
             IF PERSON.CEJBEVS ^= '6'             /* #SLUT2006 */       
              & PERSON.CEJBEVS ^= '7'                                   
              & PERSON.CEJBEVS ^= '8'                                   
              & PERSON.CEJBEVS ^= '9'                                   
              & (PERSON.CÆGTOPR = '1' !                                 
                 PERSON.CÆGTOPR = '3' !                                 
                 PERSON.CÆGTOPR = '4')                                  
              & INDK_PERS.GPCTEJER_I = 0                                
              & PERSON.GPCTEJER = 0                                     
              & PERSON.CPCTEJER = '8'                                   
             THEN                                                       
                PERSON.CEJBEVS = '9';                                   
                                                                        
             UDTRÆK_SLUT.SIDSTE.CEJBEVS    = PERSON.CEJBEVS;            
             UDTRÆK_SLUT.SIDSTE.BPENSNED   = PERSON.BPENSNED;           
             UDTRÆK_SLUT.SIDSTE.BPENSNÆ    = PERSON.BPENSNÆ ;           
             UDTRÆK_SLUT.SIDSTE.CEJDTYPE   = EJENDOM.CEJDTYPE;          
             IF PERSON.CEJDTYPE_AKT > '0'                               
             THEN                                                       
               UDTRÆK_SLUT.SIDSTE.CEJDTYPE = PERSON.CEJDTYPE_AKT;       
             UDTRÆK_SLUT.SIDSTE.FELT760    = PERSON.FELT760;            
             UDTRÆK_SLUT.SIDSTE.CNEDSL1    = PERSON.CNEDSL1;            
                                                                        
             IF PERSON.DATO0107 ^= (10)' '                              
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DATO0107 =                           
                DB2_DATO_TIL_FIX09(PERSON.DATO0107);                    
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DATO0107 = 0;                        
                                                                        
             IF PERSON.DOVTG ^= (10)' '                                 
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DOVTG =                              
                DB2_DATO_TIL_FIX09(PERSON.DOVTG);                       
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DOVTG = 0;                           
                                                                        
             IF PERSON.DAFSTAA ^= (10)' '                               
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DAFSTAA =                            
                DB2_DATO_TIL_FIX09(PERSON.DAFSTAA);                     
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DAFSTAA = 0;                         
                                                                        
             IF PERSON.DINDFLYT ^= (10)' '                              
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DINDFLYT =                           
                DB2_DATO_TIL_FIX09(PERSON.DINDFLYT);                    
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DINDFLYT = 0;                        
                                                                        
             IF PERSON.DFRAFLYT ^= (10)' '                              
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DFRAFLYT =                           
                DB2_DATO_TIL_FIX09(PERSON.DFRAFLYT);                    
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DFRAFLYT = 0;                        
                                                                        
             UDTRÆK_SLUT.SIDSTE.CINDFLYT = PERSON.CINDFLYT;             
                                                                        
             IF INDK_PERS.GPCTEJER_I = 0                                
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.GPCTEJER = PERSON.GPCTEJER;         
                 UDTRÆK_SLUT.SIDSTE.GPCTEJER_SW = 0;                    
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.GPCTEJER = 0;                       
                 UDTRÆK_SLUT.SIDSTE.GPCTEJER_SW = -1;                   
               END;                                                     
                                                                        
             UDTRÆK_SLUT.SIDSTE.FDAGUDLE   = PERSON.FDAGUDLE;           
             UDTRÆK_SLUT.SIDSTE.GPCTUDLE   = PERSON.GPCTUDLE;           
             UDTRÆK_SLUT.SIDSTE.FUDL100    = PERSON.FUDL100;            
             UDTRÆK_SLUT.SIDSTE.FDAGERHV   = PERSON.FDAGERHV;           
             UDTRÆK_SLUT.SIDSTE.GPCTERHV   = PERSON.GPCTERHV;           
             UDTRÆK_SLUT.SIDSTE.FERHVFLER  = PERSON.FERHVFLER;          
             UDTRÆK_SLUT.SIDSTE.CBERGROP   = PERSON.CBERGROP;           
                                                                        
             UDTRÆK_SLUT.SIDSTE.CBERGRGLOP = '';   /*FORSKUD06*/        
                                                                        
             IF INDK_PERS.BBERGRL_015ANV_I = 0     /*FORSKUD06*/        
             & EJENDOM.INDK.BBERGRL_01OM_I = 0                          
             & EJENDOM.INDK.BBERGRL_01OMNY_I = 0                        
             & INDK_PERS.BBERGRL_02ANV_I = 0                            
             & EJENDOM.INDK.BBERGRL_02OM_I = 0                          
             & EJENDOM.INDK.BBERGRL_02OMNY_I = 0                        
             & (PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OM !          
                 PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OMNY)        
             & (PERSON.BBERGRL_02ANV = EJENDOM.BBERGRL_02OM !           
                 PERSON.BBERGRL_02ANV = EJENDOM.BBERGRL_02OMNY)         
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.CBERGRGLOP = PERSON.CBERGRGLOP;      
                                                                        
             IF INDK_PERS.BBERGRL_015ANV_I = 0     /*FORSKUD06*/        
             & EJENDOM.INDK.BBERGRL_01OM_I = 0                          
             & EJENDOM.INDK.BBERGRL_01OMNY_I = 0                        
             & INDK_PERS.BBERGRL_02ANV_I = 0                            
             & EJENDOM.INDK.BBERGRL_02OM_I = -1                         
             & EJENDOM.INDK.BBERGRL_02OMNY_I = -1                       
             & (PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OM !          
                PERSON.BBERGRL_015ANV = EJENDOM.BBERGRL_01OMNY)         
             THEN                                                       
                 UDTRÆK_SLUT.SIDSTE.CBERGRGLOP = PERSON.CBERGRGLOP;     
                                                                        
             IF INDK_PERS.BBERGRL_I = 0                                 
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL = PERSON.BBERGRL;           
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_SW = 0;                     
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL = 0;                        
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_SW = -1;                    
               END;                                                     
                                                                        
             IF INDK_PERS.BBER2FAM_I = 0                                
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM = PERSON.BBER2FAM;         
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_SW = 0;                    
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM = 0;                       
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_SW = -1;                   
               END;                                                     
                                                                        
      /*     IF INDK_PERS.BBERGRLUDL_01_I = 0                           
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRLUDL_01 =                     
                                               PERSON.BBERGRLUDL_01;    
                 UDTRÆK_SLUT.SIDSTE.BBERGRLUDL_01_SW = 0;               
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRLUDL_01    = 0;               
                 UDTRÆK_SLUT.SIDSTE.BBERGRLUDL_01_SW = -1;              
               END;                                                     
                                                                        
             IF INDK_PERS.BOMBTILBUDL_01_I = 0                          
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BOMBTILBUDL_01 =                    
                   PERSON.BOMBTILBUDL_01;                               
                 UDTRÆK_SLUT.SIDSTE.BOMBTILBUDL_01_SW = 0;              
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BOMBTILBUDL_01    = 0;              
                 UDTRÆK_SLUT.SIDSTE.BOMBTILBUDL_01_SW = -1;             
               END;                                        /*FORSKUD11*/
                                                                        
             IF INDK_PERS.BBERGRL_015ANV_I = 0                          
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_015ANV =                    
                                              PERSON.BBERGRL_015ANV;    
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_015ANV_SW = 0;              
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_015ANV    =  0;             
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_015ANV_SW = -1;             
               END;                                                     
                                                                        
             IF INDK_PERS.BBER2FAM_015ANV_I = 0                         
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_015ANV =                   
                                            PERSON.BBER2FAM_015ANV;     
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_015ANV_SW = 0;             
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_015ANV    =  0;            
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_015ANV_SW = -1;            
               END;                                                     
                                                                        
             IF INDK_PERS.BBERGRL_02ANV_I = 0        /*FORSKUD06*/      
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_02ANV =                     
                                       PERSON.BBERGRL_02ANV;            
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_02ANV_SW = 0;               
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_02ANV =  0;                 
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_02ANV_SW = -1;              
               END;                                                     
                                                                        
             IF INDK_PERS.BBER2FAM_02ANV_I = 0      /*FORSKUD06*/       
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_02ANV                      
                           = PERSON.BBER2FAM_02ANV;                     
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_02ANV_SW = 0;              
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_02ANV    =  0;             
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_02ANV_SW = -1;             
               END;                                                     
                                                                        
             IF INDK_PERS.BBERGRL_AKT_I = 0                             
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT = PERSON.BBERGRL_AKT;  
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT_SW = 0;                
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT = 0;                   
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT_SW = -1;               
                END;                                                    
                                                                        
             IF INDK_PERS.BBER2FAM_AKT_I = 0                            
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT = PERSON.BBER2FAM_AKT;
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT_SW = 0;               
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT = 0;                  
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT_SW = -1;              
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.BPROM1     = PERSON.BPROM1;             
                                                                        
             IF INDK_PERS.BSUM1_I = 0    /*SLUT06*/                     
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM1 = PERSON.BSUM1;             
                   UDTRÆK_SLUT.SIDSTE.BSUM1_SW = 0;                     
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM1 = 0;                        
                   UDTRÆK_SLUT.SIDSTE.BSUM1_SW = -1;                    
                END;                                                    
                                                                        
             IF INDK_PERS.BSUM3_I = 0    /*SLUT06*/                     
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM3 = PERSON.BSUM3;             
                   UDTRÆK_SLUT.SIDSTE.BSUM3_SW = 0;                     
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM3 = 0;                        
                   UDTRÆK_SLUT.SIDSTE.BSUM3_SW = -1;                    
                END;                                                    
                                                                        
             IF PERSON.CEJBEVS = '0' ! PERSON.CEJBEVS = '4' !           
                PERSON.CEJBEVS = '5'                                    
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BNETTO    = PERSON.BNETTO;        
                   UDTRÆK_SLUT.SIDSTE.BNETTO_SW = 0;                    
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BNETTO    = 0;                    
                   UDTRÆK_SLUT.SIDSTE.BNETTO_SW =-1;                    
                END;                                                    
                                                                        
             IF INDK_PERS.BFASTSTIGBGR_I = 0                            
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BFASTSTIGBGR = PERSON.BFASTSTIGBGR;
                  UDTRÆK_SLUT.SIDSTE.BFASTSTIGBGR_SW = 0;               
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BFASTSTIGBGR = 0;                  
                  UDTRÆK_SLUT.SIDSTE.BFASTSTIGBGR_SW =-1;               
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.CSTIBLB    = PERSON.CSTIBLB;            
             UDTRÆK_SLUT.SIDSTE.BSTIBEGR   = PERSON.BSTIBEGR;           
                                                                        
             CALL SKAF_BEJERAN;                                         
             IF INDK_RES.BEJERAN_SW = 0   /* CHEK OM FUNDET */          
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = RESULTAT.BEJERAN;    
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = 0;                   
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW =-1;                   
                END;                                                    
                                                                        
             IF INDK_PERS.BEVSMAN_I = 0                                 
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN = PERSON.BEVSMAN;         
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN = 0;                      
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN_SW = -1;                  
                END;                                                    
                                                                        
             IF INDK_PERS.BMANEVSSTI_I = 0                              
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BMANEVSSTI = PERSON.BMANEVSSTI;    
                  UDTRÆK_SLUT.SIDSTE.BMANEVSSTI_SW = 0;                 
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BMANEVSSTI    = 0;                 
                  UDTRÆK_SLUT.SIDSTE.BMANEVSSTI_SW = -1;                
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.BMANNEDSL  = PERSON.BMANNEDSL;          
                                                                        
             IF INDK_PERS.MANNEDSLSTI_I = 0                             
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.MANNEDSLSTI = PERSON.MANNEDSLSTI;   
                 UDTRÆK_SLUT.SIDSTE.MANNEDSLSTI_SW = 0;                 
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.MANNEDSLSTI    = 0;                 
                 UDTRÆK_SLUT.SIDSTE.MANNEDSLSTI_SW = -1;                
               END;                                                     
                                                                        
             IF INDK_PERS.MANPENSSTI_I = 0                              
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.MANPENSSTI = PERSON.MANPENSSTI;    
                  UDTRÆK_SLUT.SIDSTE.MANPENSSTI_SW = 0;                 
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.MANPENSSTI = 0;                    
                  UDTRÆK_SLUT.SIDSTE.MANPENSSTI_SW = -1;                
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.CENKE      = PERSON.CENKE;              
             UDTRÆK_SLUT.SIDSTE.CENKEBOH   = PERSON.CENKEBOH;           
             UDTRÆK_SLUT.SIDSTE.BOBEHAKOD  = PERSON.BOBEHAKOD;          
             UDTRÆK_SLUT.SIDSTE.CIVILSTAND = PERSON.CIVILSTAND;         
             UDTRÆK_SLUT.SIDSTE.CSLET      = PERSON.CSLET;              
                                                                        
             IF INDK_PERS.BEJBOL1_I = 0                                 
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1 = PERSON.BEJBOL1;         
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1 = 0;                      
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1_SW = -1;                  
                END;                                                    
                                                                        
             IF INDK_PERS.BEJBOL2_I = 0                                 
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2 = PERSON.BEJBOL2;         
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2 = 0;                      
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2_SW = -1;                  
                END;                                                    
                                                                        
             IF PERSON.CANVEBOL = ' '                                   
              & INDK_PERS.BPROM1_I = 0                                  
              & EJENDOM.INDK.BEJBOL2_AKT_I = 0                          
              & EJENDOM.BEJBOL1_AKT ^= EJENDOM.BEJBOL2_AKT              
             THEN                                                       
                DO;                                                     
                  IF PERSON.BBERGRL_AKT = PERSON.BEJBOL1_AKT            
                  THEN                                                  
                     PERSON.CANVEBOL = '1';                             
                  ELSE                                                  
                  IF PERSON.BBERGRL_AKT = PERSON.BEJBOL2_AKT            
                  THEN                                                  
                     PERSON.CANVEBOL = '2';                             
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.CANVEBOL   = PERSON.CANVEBOL;           
             UDTRÆK_SLUT.SIDSTE.CPTYPSLUT  = PERSON.CPTYPSLUT;          
             UDTRÆK_SLUT.SIDSTE.FELT759    = PERSON.FELT759;            
             UDTRÆK_SLUT.SIDSTE.CEKSEMP    = PERSON.CEKSEMP; /*#SLUT07*/
             UDTRÆK_SLUT.SIDSTE.CFRÅR      = PERSON.CFRÅR;              
             UDTRÆK_SLUT.SIDSTE.COMPLA     = EVS_ESK.COMPLA;            
             UDTRÆK_SLUT.SIDSTE.DOMPLACPR  = EVS_ESK.DOMPLACPR;         
                                                                        
             IF INDK_PERS.BUDLSKC_I = 0        /*FORSKUD10*/            
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC    = PERSON.BUDLSKC;      
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC    = 0;                   
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC_SW = -1;                  
             END;                                                       
                                                                        
             CALL OPSÆT_GL_INDKOMSTÅR (UDTRÆK_SLUT.SIDSTE.CFRÅR,        
                                       UDTRÆK_SLUT.SIDSTE.DRGNÅRFRA,    
                                       UDTRÆK_SLUT.SIDSTE.DRGNÅRTIL);   
           END;                                                         
                                                                        
         PERSON            = ''; /* MED DE NYE TABELLER SKAL VI */      
         EJENDOM           = ''; /* NULSTILLE FØR DEN NÆSTE     */      
         RESULTAT          = ''; /* LÆSNING                     */      
         EVS_ESK           = '';                                        
         EVS_RES           = '';                                        
                                                                        
         FLAG_EN_RÆKKE = '0'B;                                          
                                                                        
 /*******************************************************************/  
 /*    CHECK FOR FORKERTE EJENDOMSNUMMER                            */  
 /*******************************************************************/  
                                                                        
         IF (UDTRÆK_SLUT.SIDSTE.COMPLA = '1')                           
         THEN                                                           
            DO;                                                         
               ANTOMPLACERET = ANTOMPLACERET + 1;                       
               RETURN;                                                  
            END;                                                        
                                                                        
         IF (UDTRÆK_SLUT.EEJDNR = 0)                                    
         THEN                                                           
            DO;                                                         
               ANTEJDNR_EEJDNR_0 = ANTEJDNR_EEJDNR_0 + 1;               
               RETURN;                                                  
            END;                                                        
                                                                        
         IF UDTRÆK_SLUT.EKOMNR ^= 999        &     /*FORSKUD09*/        
            UDTRÆK_SLUT.SIDSTE.CEJBEVS = '9' &                          
            UDTRÆK_SLUT.FØRSTE.CÆGTOPR < '1' &                          
            UDTRÆK_SLUT.SIDSTE.CÆGTOPR < '1' &                          
            UDTRÆK_SLUT.SIDSTE.CINDFLYT < '1'                           
         THEN                                                           
            DO;                                                         
               ANTCEJBEVS_9 = ANTCEJBEVS_9 + 1;                         
               RETURN;                                                  
            END;                                                        
                                                                        
         /* Fra Forskud 2017 skal slettede ejendomme */                 
         /* ikke indgå i oprettelsen KS30-01         */                 
         IF UDTRÆK_SLUT.SIDSTE.CSLET = '1'                              
         THEN                                                           
            DO;                                                         
               ANTCSLET_1 = ANTCSLET_1 + 1;                             
               RETURN; /*#01*/                                          
            END;                                                        
                                                                        
 /*********************************************************************/
 /* UDSKRIVNING                                                       */
 /*********************************************************************/
         ANTSKRIV_PERSON = ANTSKRIV_PERSON + 1;                         
                                                                        
         IF UDTRÆK_SLUT.EKOMNR ^= 999 THEN                              
           DO;                                                          
             ANTSKRIV_ØVR = ANTSKRIV_ØVR + 1;                           
             CALL SKRIV_TIL_BQ77000T;                                   
           END;                                                         
         ELSE                                                           
           DO;                                                          
             ANTSKRIV_UDL = ANTSKRIV_UDL + 1;                           
             CALL SKRIV_TIL_BQ77000T;                                   
           END;                                                         
                                                                        
 END GEM_SIDSTE_CHECK_SKRIV;                                            
 /*********************************************************************/
 /* OPSÆT BRUGTE INDIKATORE TIL -1 SOM STARTS VÆRDI            RUTINE */
 /*********************************************************************/
 INIT_INDK: PROC;                                                       
   IF TFLAG THEN PUT SKIP LIST('***** '!!PROCNAME!!' *****');           
   INDK_PERS.BBER2FAM_I         = -1;                                   
   INDK_PERS.BBER2FAM_015ANV_I  = -1;                                   
   INDK_PERS.BBERGRL_I          = -1;                                   
   INDK_PERS.BBERGRL_015ANV_I   = -1;                                   
 /*INDK_PERS.BBERGRLUDL_01_I    = -1;                      /*FORSKUD11*/
   INDK_PERS.BEJBOL1_I          = -1;                                   
   INDK_PERS.BEJBOL1_015ANV_I   = -1;                                   
   INDK_PERS.BEJBOL2_I          = -1;                                   
   INDK_PERS.BEJBOL2_015ANV_I   = -1;                                   
   INDK_PERS.BEJBOLANV_I        = -1;                                   
   INDK_PERS.BEJBOLANV_015ANV_I = -1;                                   
   INDK_PERS.BEJBOLANV_02_I     = -1;                                   
   INDK_PERS.BEJDVÆR_015ANV_I   = -1;                                   
   INDK_PERS.BEVSGL_I           = -1;                                   
   INDK_PERS.BEVSMAN_I          = -1;                                   
   INDK_PERS.BFORSKAT_I         = -1;                                   
   INDK_PERS.BGRPROM1_I         = -1;                                   
   INDK_PERS.BGRPROM2_I         = -1;                                   
   INDK_PERS.BMANNEDSL_I        = -1;                                   
   INDK_PERS.BNEDSL1_I          = -1;                                   
   INDK_PERS.BNEDSL2_I          = -1;                                   
   INDK_PERS.BNETTO_I           = -1;                                   
 /*INDK_PERS.BOMBTILBUDL_01_I   = -1;                      /*FORSKUD11*/
   INDK_PERS.BPENSNED_I         = -1;                                   
   INDK_PERS.BPENSNEDGL_I       = -1;                                   
   INDK_PERS.BPENSNÆ_I          = -1;                                   
   INDK_PERS.BPROM1_I           = -1;                                   
   INDK_PERS.BPROM2_I           = -1;                                   
   INDK_PERS.BSTIBEGR_I         = -1;                                   
   INDK_PERS.BSTITIL_I          = -1;                                   
   INDK_PERS.BSUM1_I            = -1;                                   
   INDK_PERS.BSUM2_I            = -1;                                   
   INDK_PERS.BUDLSKC_I          = -1;                                   
   INDK_PERS.GPCTEJER_I         = -1;                                   
   INDK_PERS.MANNEDSLSTI_I      = -1;                                   
   INDK_PERS.BEJBOLANV_015PCT_I = -1;                                   
   INDK_PERS.BEJBOLANV_02OM_I   = -1;                                   
   INDK_PERS.BEJBOLANV_02OMNY_I = -1;                                   
   INDK_PERS.BBER2FAM_AKT_I     = -1;                                   
   INDK_PERS.BBERGRL_AKT_I      = -1;                                   
   INDK_PERS.BEJBOL1_AKT_I      = -1;                                   
   INDK_PERS.BEJBOL2_AKT_I      = -1;                                   
   INDK_PERS.BEJBOLANV_AKT_I    = -1;                                   
   INDK_PERS.BPENSNÆGL_I        = -1;                                   
   INDK_PERS.BSUM3_I            = -1;                                   
   INDK_PERS.BGLSUM1_I          = -1;                                   
   INDK_PERS.BFASTSTIGBGR_I     = -1;                                   
   INDK_PERS.BMANEVSSTI_I       = -1;                                   
   INDK_PERS.MANPENSSTI_I       = -1;                                   
   INDK_PERS.BBER2FAM_02ANV_I   = -1;                                   
   INDK_PERS.BBERGRL_02ANV_I    = -1;                                   
   INDK_PERS.BEJBOL1_02ANV_I    = -1;                                   
   INDK_PERS.BEJBOL2_02ANV_I    = -1;                                   
   INDK_PERS.BEJBOLANV_01OM_I   = -1;                                   
   INDK_PERS.BEJBOLANV_01OMNY_I = -1;                                   
   INDK_PERS.BEJBOLANV_02ANV_I  = -1;                                   
   INDK_PERS.BEJDVÆR_02ANV_I    = -1;                                   
                                                                        
 END INIT_INDK;                                                         
 /*********************************************************************/
 OPSTART_INIT: PROC;                                                    
                                                                        
   DCL     HJ_KOMNR     PIC '(03)9';                                    
                                                                        
   /* PARMKORT ER EVT. MEDTAGET I KØRSLEN */                            
   ON  ENDFILE (PARMKORT)                                               
   BEGIN;                                                               
      EOF_PARM  = '1'B;                                                 
      GO TO INIT_SLUT;                                                  
   END;                                                                 
                                                                        
   PARMLINIE = '';                                                      
                                                                        
   READ FILE (PARMKORT) INTO  (PARM_AR);                                
                                                                        
   IF PARMLINIE.PROGNAVN ^= 'BH20000'                                   
    THEN                                                                
       PARM_FEJL = '1'B;                                                
                                                                        
    IF VERIFY (PARMLINIE.KOMNR1,'0123456789')  >  0                     
    THEN                                                                
      DO;                                                               
        PARM_FEJL = '1'B;                                               
      END;                                                              
                                                                        
    /*Første kommunenummer skal være udfyldt når der er parmkort*/      
    IF PARMLINIE.KOMNR1  <  '100' !                                     
       PARMLINIE.KOMNR1  >  '999'                                       
    THEN                                                                
      DO;                                                               
        PARM_FEJL = '1'B;                                               
      END;                                                              
                                                                        
    IF PARM_FEJL                                                        
    THEN                                                                
       DO;                                                              
         PUT SKIP LIST ('FEJL I PARMKORT: ',PARM_AR);                   
         ABENDTXT = '101 FEJL I PARMKORT';                              
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
       END;                                                             
    ELSE                                                                
       DO;                                                              
         PARM_MEDTAGET  = '1'B;                                         
         PUT SKIP LIST('PARMKORT MEDTAGET: ' !!                         
                PARMLINIE.PROGNAVN  !! PARMLINIE.KOMNR1 !!              
                PARMLINIE.KOMNR2 !! PARMLINIE.KOMNR3);                  
       END;                                                             
                                                                        
   INIT_SLUT:                                                           
                                                                        
   IF PARMLINIE.KOMNR1 = ''                                             
   THEN                                                                 
     DO;                                                                
       PARMKOMNR1 = 0;                                                  
       PARMKOMNR2 = 0;                                                  
       PARMKOMNR3 = 0;                                                  
     END;                                                               
   ELSE                                                                 
     DO;                                                                
       HJ_KOMNR  = PARMLINIE.KOMNR1;                                    
       PARMKOMNR1 = HJ_KOMNR;                                           
       IF PARMLINIE.KOMNR2 > '000'                                      
       THEN                                                             
         DO;                                                            
           HJ_KOMNR  = PARMLINIE.KOMNR2;                                
           PARMKOMNR2 = HJ_KOMNR;                                       
         END;                                                           
                                                                        
       IF PARMLINIE.KOMNR3 > '000'                                      
       THEN                                                             
         DO;                                                            
           HJ_KOMNR  = PARMLINIE.KOMNR3;                                
           PARMKOMNR3 = HJ_KOMNR;                                       
         END;                                                           
                                                                        
       PUT SKIP LIST('PARMLINIE.KOMNR1 =',PARMKOMNR1);                  
       PUT SKIP LIST('PARMLINIE.KOMNR2 =',PARMKOMNR2);                  
       PUT SKIP LIST('PARMLINIE.KOMNR3 =',PARMKOMNR3);                  
     END;                                                               
                                                                        
                                                                        
  END OPSTART_INIT;                                                     
                                                                        
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST('SQL_FEJL.....');                                
         PUT SKIP LIST('SQLCA',SQLCA);                                  
         CLOSE FILE(BQ165I);            /*RUL*/                         
         CALL ZS67000(SQLCA);                                           
                                                                        
         ABENDTXT = '101 SQL FEJL ' !! FEJLTEKST;                       
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* LUK FILER, CURSOR OG UDSKRIV AFSTEMNINGS- OG KONTROLLISTE  RUTINE */
 /*********************************************************************/
 AFSLUT: PROC;                                                          
                                                                        
         CLOSE FILE(BQ165I);             /*RUL*/                        
         CALL CLOSE_PERSONEJENDOMSOPL;                                  
                                                                        
         CALL OPDATER_KØRSELSTABEL('SLUT',AFVIKLING_PARM.FS_MRK);       
                                                                        
         LINIE = ZZWS2;                                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL LÆSTE FRA PERSONTABELLEN ................'; 
         LIN.ANT   = ANTLÆS_PERSON;                                     
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKRIV MED CEJBEVS = 9 OG CÆGTOPR < 1..'; 
         LIN.ANT   = ANTCEJBEVS_9;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET OMPLACERET ...................'; 
         LIN.ANT   = ANTOMPLACERET;                                     
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET MED EJDNR = 0 ................'; 
         LIN.ANT   = ANTEJDNR_EEJDNR_0;                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET MED CSLET LIG 1 ..............'; 
         LIN.ANT   = ANTCSLET_1;                                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL SKREVNE IALT ............................'; 
         LIN.ANT   = ANTSKRIV_PERSON;                                   
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '      HERAF DANSKE EJENDOMME ..................'; 
         LIN.ANT   = ANTSKRIV_ØVR;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '      HERAF UDENLANDSKE EJENDOMME .............'; 
         LIN.ANT   = ANTSKRIV_UDL;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         CALL ZZ20300(' ','99');                      /* LUK KMDSPOOL */
                                                                        
 END AFSLUT;                                                            
 /*********************************************************************/
 /* HER STARTER APPLIKATIONENS EGNE INCLUDES                          */
 /*********************************************************************/
                                                                        
 %INCLUDE BH20000M;             /* DECLARE OG FETCH SQL STATEMENTS.   */
 %INCLUDE ZM90013M;             /* OMSÆT DATO TIL/FRA DB2-DATOFORMAT  */
 %INCLUDE ZM90051M;             /* KONV BIN15 TIL CHAR                */
 %INCLUDE BS34307M;             /* KONV BF31 TIL CHAR6                */
 %INCLUDE BH30001M;             /* KONV DATO FRA CHAR TIL DEC FIXED   */
 %INCLUDE BH30002M;             /* KONV CHAR(10) TIL DEC FIXED(11)    */
 %INCLUDE BH30003M;             /* OPSÆT GL. REGNSKABS- OG INDKOMSTÅR */
 %INCLUDE BH30010M;             /* FLYT VÆRDIER FRA EJERSKABS FELTER  */
                                                                        
 /* NYE TIL DB2 OMLÆGNING*/                                             
 %INCLUDE BH20021M;             /* NULSTIL BQ77000T */                  
 %INCLUDE BH20022M;             /* INSERT BQ77000T */                   
 %INCLUDE BH20024M;             /* UPDATE BQ77000T */                   
 %INCLUDE BH54998M;             /* OPDATER KØRSELS TABEL */             
 %INCLUDE BH54999M;             /* CHECK OM OMKØSEL + EVT OPRYDNING */  
 %INCLUDE BH54997M;             /* ER FORGÆNGERE KØRT. STOP HVIS IKKE */
                                                                        
                                                                        
 /*********************************************************************/
 /* SKRIV TIL TABEL BQ77000 FORSØG PÅ SKRIVE MODUL                    */
 /* DATA SKRIVES FRA STRUKTUR BH20000N SOM ER KOPI AF BH30000N        */
 /* DER LAVES ALTID INSERT DA TABELLEN BLIVER RYDDET OP AF BH54999M   */
 /*********************************************************************/
 SKRIV_TIL_BQ77000T: PROC;                                              
                                                                        
    DCL RÆKKE_FINDES         BIT (1) INIT ('0'B);                       
                                                                        
    RÆKKE_FINDES = NEJ;                                                 
                                                                        
    DCLBQ77000T.DB2FUNKTION   = 'I';                                    
    CALL INSERT_BQ77000T;                                               
                                                                        
 INSERT_BQ77000T: PROC;                                                 
                                                                        
                                                                        
      /*NULSTIL STRUKTUR HUSK SWITCH NULSTILLING*/                      
      CALL NULSTIL_BQ77000T;                                            
                                                                        
      /*FLYT TIL DB2 STRUKTUR*/                                         
                                                                        
      DCLBQ77000T.TIL_EVS_AAR   = WS_TIL_EVS_AAR;                       
      DCLBQ77000T.AFVIKLINGS_ID = WS_FORSKUD_SLUT_TXT;                  
      DCLBQ77000T.DCPRN         = UDTRÆK_SLUT.DCPRN;                    
      DCLBQ77000T.EKOMNR        = UDTRÆK_SLUT.EKOMNR;                   
      DCLBQ77000T.EEJDNR        = UDTRÆK_SLUT.EEJDNR;                   
      DCLBQ77000T.PROGRAMNAVN   = WS_PROGRAMNAVN;                       
      DCLBQ77000T.DB2FUNKTION   = 'I'; /*ELLER U*/                      
      DCLBQ77000T.EGENNR  = 1;   /* Kun et EVS udtræk pr. ejerskab*/    
      DCLBQ77000T.CITYP   = 0;   /*0 data er fra EVS ?*/                
      DCLBQ77000T.CUDLAND = '';  /*opsættes senere kun udenlandske*/    
      DCLBQ77000T.CSBSK   = '';  /*opsættes senere ?*/                  
                                                                        
      DCLBQ77000T.EVSSEJ_CFRATYPE  = UDTRÆK_SLUT.CFRATYPE;              
      DCLBQ77000T.EVSSEJ_DCPRN     = UDTRÆK_SLUT.DCPRN;                 
      DCLBQ77000T.EVSSEJ_EKOMNR    = UDTRÆK_SLUT.EKOMNR;                
      DCLBQ77000T.EVSSEJ_EEJDNR    = UDTRÆK_SLUT.EEJDNR;                
                                                                        
      /*FLYT FELTER TIL BQ770000T */                                    
      DCLBQ77000T.EVSSEJ_DSORTDAT1  = UDTRÆK_SLUT.DSORTDAT1;            
      DCLBQ77000T.EVSSEJ_DSORTDAT2  = UDTRÆK_SLUT.DSORTDAT2;            
      DCLBQ77000T.EVSSEJ_EJDBELIG   = UDTRÆK_SLUT.EJDBELIG;             
      DCLBQ77000T.EVSSEJ_CLANDEKODE = UDTRÆK_SLUT.CLANDEKODE;           
      DCLBQ77000T.EVSSEJ_CBENYT     = UDTRÆK_SLUT.CBENYT;               
      DCLBQ77000T.EVSSEJ_CEJBOLTYP1 = UDTRÆK_SLUT.CEJBOLTYP1;           
      DCLBQ77000T.EVSSEJ_CEJBOLTYP2 = UDTRÆK_SLUT.CEJBOLTYP2;           
                                                                        
      /* FLYT FELTER FRA FØRSTE RÆKKE TIL BQ770000T */                  
      DCLBQ77000T.EVSSEJ_FST_ELBNR  = UDTRÆK_SLUT.FØRSTE.ELBNR;         
      DCLBQ77000T.EVSSEJ_FST_EGENNR = UDTRÆK_SLUT.FØRSTE.EGENNR;        
      DCLBQ77000T.EVSSEJ_FST_DFRAGLD = UDTRÆK_SLUT.FØRSTE.DFRAGLD;      
      DCLBQ77000T.EVSSEJ_FST_DTILGLD = UDTRÆK_SLUT.FØRSTE.DTILGLD;      
      DCLBQ77000T.EVSSEJ_FST_CDATAFRA = UDTRÆK_SLUT.FØRSTE.CDATAFRA;    
      DCLBQ77000T.EVSSEJ_FST_CAJOUR = UDTRÆK_SLUT.FØRSTE.CAJOUR;        
      DCLBQ77000T.EVSSEJ_FST_CSUPPL = UDTRÆK_SLUT.FØRSTE.CSUPPL;        
      DCLBQ77000T.EVSSEJ_FST_DHENVN = UDTRÆK_SLUT.FØRSTE.DHENVN;        
      DCLBQ77000T.EVSSEJ_FST_FEJLNR = UDTRÆK_SLUT.FØRSTE.FEJLNR;        
      DCLBQ77000T.EVSSEJ_FST_CÆGTOPR = UDTRÆK_SLUT.FØRSTE.CÆGTOPR;      
      DCLBQ77000T.EVSSEJ_FST_CSKPLOMF = UDTRÆK_SLUT.FØRSTE.CSKPLOMF;    
      DCLBQ77000T.EVSSEJ_FST_CEJBEVS = UDTRÆK_SLUT.FØRSTE.CEJBEVS;      
      DCLBQ77000T.EVSSEJ_FST_CEJDTYPE = UDTRÆK_SLUT.FØRSTE.CEJDTYPE;    
      DCLBQ77000T.EVSSEJ_FST_FELT760 = UDTRÆK_SLUT.FØRSTE.FELT760;      
      DCLBQ77000T.EVSSEJ_FST_CNEDSL1 = UDTRÆK_SLUT.FØRSTE.CNEDSL1;      
      DCLBQ77000T.EVSSEJ_FST_DATO0107 = UDTRÆK_SLUT.FØRSTE.DATO0107;    
      DCLBQ77000T.EVSSEJ_FST_DOVTG = UDTRÆK_SLUT.FØRSTE.DOVTG;          
      DCLBQ77000T.EVSSEJ_FST_DAFSTAA = UDTRÆK_SLUT.FØRSTE.DAFSTAA;      
      DCLBQ77000T.EVSSEJ_FST_DINDFLYT = UDTRÆK_SLUT.FØRSTE.DINDFLYT;    
      DCLBQ77000T.EVSSEJ_FST_DFRAFLYT = UDTRÆK_SLUT.FØRSTE.DFRAFLYT;    
      DCLBQ77000T.EVSSEJ_FST_CINDFLYT = UDTRÆK_SLUT.FØRSTE.CINDFLYT;    
      DCLBQ77000T.EVSSEJ_FST_GPCTEJER = UDTRÆK_SLUT.FØRSTE.GPCTEJER;    
      DCLBQ77000T.EVSSEJ_FST_GPCTEJER_SW =                              
                              UDTRÆK_SLUT.FØRSTE.GPCTEJER_SW;           
      DCLBQ77000T.EVSSEJ_FST_FDAGUDLE = UDTRÆK_SLUT.FØRSTE.FDAGUDLE;    
      DCLBQ77000T.EVSSEJ_FST_GPCTUDLE = UDTRÆK_SLUT.FØRSTE.GPCTUDLE;    
      DCLBQ77000T.EVSSEJ_FST_FUDL100  = UDTRÆK_SLUT.FØRSTE.FUDL100;     
      DCLBQ77000T.EVSSEJ_FST_FDAGERHV = UDTRÆK_SLUT.FØRSTE.FDAGERHV;    
      DCLBQ77000T.EVSSEJ_FST_GPCTERHV = UDTRÆK_SLUT.FØRSTE.GPCTERHV;    
      DCLBQ77000T.EVSSEJ_FST_FERHVFLER = UDTRÆK_SLUT.FØRSTE.FERHVFLER;  
      DCLBQ77000T.EVSSEJ_FST_CBERGROP = UDTRÆK_SLUT.FØRSTE.CBERGROP;    
      DCLBQ77000T.EVSSEJ_FST_CBERGRGLOP = UDTRÆK_SLUT.FØRSTE.CBERGRGLOP;
      DCLBQ77000T.EVSSEJ_FST_BBERGRL = UDTRÆK_SLUT.FØRSTE.BBERGRL;      
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_SW =                               
                                       UDTRÆK_SLUT.FØRSTE.BBERGRL_SW;   
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM =                                 
                                       UDTRÆK_SLUT.FØRSTE.BBER2FAM;     
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_SW =                              
                               UDTRÆK_SLUT.FØRSTE.BBER2FAM_SW;          
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_015ANV =                           
                               UDTRÆK_SLUT.FØRSTE.BBERGRL_015ANV;       
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_015ANV_SW =                        
                               UDTRÆK_SLUT.FØRSTE.BBERGRL_015ANV_SW;    
                                                                        
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_015ANV =                          
                         UDTRÆK_SLUT.FØRSTE.BBER2FAM_015ANV;            
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_015ANV_SW =                       
                         UDTRÆK_SLUT.FØRSTE.BBER2FAM_015ANV_SW;         
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_02ANV =                            
                         UDTRÆK_SLUT.FØRSTE.BBERGRL_02ANV;              
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_02ANV_SW =                         
                         UDTRÆK_SLUT.FØRSTE.BBERGRL_02ANV_SW;           
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_02ANV =                           
                         UDTRÆK_SLUT.FØRSTE.BBER2FAM_02ANV;             
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_02ANV_SW =                        
                         UDTRÆK_SLUT.FØRSTE.BBER2FAM_02ANV_SW;          
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_AKT =                              
                         UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT;                
      DCLBQ77000T.EVSSEJ_FST_BBERGRL_AKT_SW =                           
                         UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT_SW;             
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_AKT =                             
                         UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT;               
      DCLBQ77000T.EVSSEJ_FST_BBER2FAM_AKT_SW =                          
                         UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT_SW;            
      DCLBQ77000T.EVSSEJ_FST_BPROM1 =                                   
                         UDTRÆK_SLUT.FØRSTE.BPROM1;                     
      DCLBQ77000T.EVSSEJ_FST_BPENSNED =                                 
                         UDTRÆK_SLUT.FØRSTE.BPENSNED;                   
      DCLBQ77000T.EVSSEJ_FST_BPENSNÆ =                                  
                         UDTRÆK_SLUT.FØRSTE.BPENSNÆ;                    
      DCLBQ77000T.EVSSEJ_FST_BSUM1 =                                    
                         UDTRÆK_SLUT.FØRSTE.BSUM1;                      
      DCLBQ77000T.EVSSEJ_FST_BSUM1_SW =                                 
                         UDTRÆK_SLUT.FØRSTE.BSUM1_SW;                   
      DCLBQ77000T.EVSSEJ_FST_BSUM3 = UDTRÆK_SLUT.FØRSTE.BSUM3;          
      DCLBQ77000T.EVSSEJ_FST_BSUM3_SW =                                 
                         UDTRÆK_SLUT.FØRSTE.BSUM3_SW;                   
      DCLBQ77000T.EVSSEJ_FST_BNETTO =                                   
                         UDTRÆK_SLUT.FØRSTE.BNETTO;                     
      DCLBQ77000T.EVSSEJ_FST_BNETTO_SW =                                
                         UDTRÆK_SLUT.FØRSTE.BNETTO_SW;                  
      DCLBQ77000T.EVSSEJ_FST_BFASTSTIGBGR =                             
                         UDTRÆK_SLUT.FØRSTE.BFASTSTIGBGR;               
      DCLBQ77000T.EVSSEJ_FST_BFASTSTIGBGR_SW =                          
                         UDTRÆK_SLUT.FØRSTE.BFASTSTIGBGR_SW;            
      DCLBQ77000T.EVSSEJ_FST_CSTIBLB =                                  
                         UDTRÆK_SLUT.FØRSTE.CSTIBLB;                    
      DCLBQ77000T.EVSSEJ_FST_BSTIBEGR =                                 
                         UDTRÆK_SLUT.FØRSTE.BSTIBEGR;                   
      DCLBQ77000T.EVSSEJ_FST_BEJERAN =                                  
                         UDTRÆK_SLUT.FØRSTE.BEJERAN;                    
      DCLBQ77000T.EVSSEJ_FST_BEJERAN_SW =                               
                         UDTRÆK_SLUT.FØRSTE.BEJERAN_SW;                 
      DCLBQ77000T.EVSSEJ_FST_BEVSMAN =                                  
                         UDTRÆK_SLUT.FØRSTE.BEVSMAN;                    
      DCLBQ77000T.EVSSEJ_FST_BEVSMAN_SW =                               
                         UDTRÆK_SLUT.FØRSTE.BEVSMAN_SW;                 
      DCLBQ77000T.EVSSEJ_FST_BMANEVSSTI =                               
                         UDTRÆK_SLUT.FØRSTE.BMANEVSSTI;                 
      DCLBQ77000T.EVSSEJ_FST_BMANEVSSTI_SW =                            
                         UDTRÆK_SLUT.FØRSTE.BMANEVSSTI_SW;              
      DCLBQ77000T.EVSSEJ_FST_BMANNEDSL =                                
                         UDTRÆK_SLUT.FØRSTE.BMANNEDSL;                  
      DCLBQ77000T.EVSSEJ_FST_MANNEDSLSTI =                              
                         UDTRÆK_SLUT.FØRSTE.MANNEDSLSTI;                
      DCLBQ77000T.EVSSEJ_FST_MANNEDSLSTI_SW =                           
                         UDTRÆK_SLUT.FØRSTE.MANNEDSLSTI_SW;             
      DCLBQ77000T.EVSSEJ_FST_MANPENSSTI =                               
                         UDTRÆK_SLUT.FØRSTE.MANPENSSTI;                 
      DCLBQ77000T.EVSSEJ_FST_MANPENSSTI_SW =                            
                         UDTRÆK_SLUT.FØRSTE.MANPENSSTI_SW;              
      DCLBQ77000T.EVSSEJ_FST_CENKE =                                    
                         UDTRÆK_SLUT.FØRSTE.CENKE;                      
      DCLBQ77000T.EVSSEJ_FST_CENKEBOH =                                 
                         UDTRÆK_SLUT.FØRSTE.CENKEBOH;                   
      DCLBQ77000T.EVSSEJ_FST_BOBEHAKOD =                                
                         UDTRÆK_SLUT.FØRSTE.BOBEHAKOD;                  
      DCLBQ77000T.EVSSEJ_FST_CIVILSTAND =                               
                         UDTRÆK_SLUT.FØRSTE.CIVILSTAND;                 
      DCLBQ77000T.EVSSEJ_FST_CSLET =                                    
                         UDTRÆK_SLUT.FØRSTE.CSLET;                      
      DCLBQ77000T.EVSSEJ_FST_BEJBOL1 =                                  
                         UDTRÆK_SLUT.FØRSTE.BEJBOL1;                    
      DCLBQ77000T.EVSSEJ_FST_BEJBOL1_SW =                               
                         UDTRÆK_SLUT.FØRSTE.BEJBOL1_SW;                 
      DCLBQ77000T.EVSSEJ_FST_BEJBOL2 =                                  
                         UDTRÆK_SLUT.FØRSTE.BEJBOL2;                    
      DCLBQ77000T.EVSSEJ_FST_BEJBOL2_SW =                               
                         UDTRÆK_SLUT.FØRSTE.BEJBOL2_SW;                 
      DCLBQ77000T.EVSSEJ_FST_CANVEBOL =                                 
                         UDTRÆK_SLUT.FØRSTE.CANVEBOL;                   
      DCLBQ77000T.EVSSEJ_FST_CPTYPSLUT =                                
                         UDTRÆK_SLUT.FØRSTE.CPTYPSLUT;                  
      DCLBQ77000T.EVSSEJ_FST_FELT759 =                                  
                         UDTRÆK_SLUT.FØRSTE.FELT759;                    
      DCLBQ77000T.EVSSEJ_FST_CEKSEMP =                                  
                         UDTRÆK_SLUT.FØRSTE.CEKSEMP;                    
      DCLBQ77000T.EVSSEJ_FST_CFRÅR =                                    
                         UDTRÆK_SLUT.FØRSTE.CFRÅR;                      
      DCLBQ77000T.EVSSEJ_FST_DRGNÅRFRA =                                
                         UDTRÆK_SLUT.FØRSTE.DRGNÅRFRA;                  
      DCLBQ77000T.EVSSEJ_FST_DRGNÅRTIL =                                
                         UDTRÆK_SLUT.FØRSTE.DRGNÅRTIL;                  
      DCLBQ77000T.EVSSEJ_FST_COMPLA =                                   
                         UDTRÆK_SLUT.FØRSTE.COMPLA;                     
      DCLBQ77000T.EVSSEJ_FST_DOMPLACPR=                                 
                         UDTRÆK_SLUT.FØRSTE.DOMPLACPR;                  
      DCLBQ77000T.EVSSEJ_FST_BUDLSKC =                                  
                         UDTRÆK_SLUT.FØRSTE.BUDLSKC;                    
      DCLBQ77000T.EVSSEJ_FST_BUDLSKC_SW =                               
                         UDTRÆK_SLUT.FØRSTE.BUDLSKC_SW;                 
                                                                        
     /*FLYT SIDSTE FELTER TIL BQ770000T */                              
      DCLBQ77000T.EVSSEJ_SID_ELBNR  = UDTRÆK_SLUT.SIDSTE.ELBNR;         
      DCLBQ77000T.EVSSEJ_SID_EGENNR = UDTRÆK_SLUT.SIDSTE.EGENNR;        
      DCLBQ77000T.EVSSEJ_SID_DFRAGLD = UDTRÆK_SLUT.SIDSTE.DFRAGLD;      
      DCLBQ77000T.EVSSEJ_SID_DTILGLD = UDTRÆK_SLUT.SIDSTE.DTILGLD;      
      DCLBQ77000T.EVSSEJ_SID_CDATAFRA = UDTRÆK_SLUT.SIDSTE.CDATAFRA;    
      DCLBQ77000T.EVSSEJ_SID_CAJOUR = UDTRÆK_SLUT.SIDSTE.CAJOUR;        
      DCLBQ77000T.EVSSEJ_SID_CSUPPL = UDTRÆK_SLUT.SIDSTE.CSUPPL;        
      DCLBQ77000T.EVSSEJ_SID_DHENVN = UDTRÆK_SLUT.SIDSTE.DHENVN;        
      DCLBQ77000T.EVSSEJ_SID_FEJLNR = UDTRÆK_SLUT.SIDSTE.FEJLNR;        
      DCLBQ77000T.EVSSEJ_SID_CÆGTOPR = UDTRÆK_SLUT.SIDSTE.CÆGTOPR;      
      DCLBQ77000T.EVSSEJ_SID_CSKPLOMF = UDTRÆK_SLUT.SIDSTE.CSKPLOMF;    
      DCLBQ77000T.EVSSEJ_SID_CEJBEVS = UDTRÆK_SLUT.SIDSTE.CEJBEVS;      
      DCLBQ77000T.EVSSEJ_SID_CEJDTYPE = UDTRÆK_SLUT.SIDSTE.CEJDTYPE;    
      DCLBQ77000T.EVSSEJ_SID_FELT760 = UDTRÆK_SLUT.SIDSTE.FELT760;      
      DCLBQ77000T.EVSSEJ_SID_CNEDSL1 = UDTRÆK_SLUT.SIDSTE.CNEDSL1;      
      DCLBQ77000T.EVSSEJ_SID_DATO0107 = UDTRÆK_SLUT.SIDSTE.DATO0107;    
      DCLBQ77000T.EVSSEJ_SID_DOVTG = UDTRÆK_SLUT.SIDSTE.DOVTG;          
      DCLBQ77000T.EVSSEJ_SID_DAFSTAA = UDTRÆK_SLUT.SIDSTE.DAFSTAA;      
      DCLBQ77000T.EVSSEJ_SID_DINDFLYT = UDTRÆK_SLUT.SIDSTE.DINDFLYT;    
      DCLBQ77000T.EVSSEJ_SID_DFRAFLYT = UDTRÆK_SLUT.SIDSTE.DFRAFLYT;    
      DCLBQ77000T.EVSSEJ_SID_CINDFLYT = UDTRÆK_SLUT.SIDSTE.CINDFLYT;    
      DCLBQ77000T.EVSSEJ_SID_GPCTEJER = UDTRÆK_SLUT.SIDSTE.GPCTEJER;    
      DCLBQ77000T.EVSSEJ_SID_GPCTEJER_SW =                              
                              UDTRÆK_SLUT.SIDSTE.GPCTEJER_SW;           
      DCLBQ77000T.EVSSEJ_SID_FDAGUDLE = UDTRÆK_SLUT.SIDSTE.FDAGUDLE;    
      DCLBQ77000T.EVSSEJ_SID_GPCTUDLE = UDTRÆK_SLUT.SIDSTE.GPCTUDLE;    
      DCLBQ77000T.EVSSEJ_SID_FUDL100  = UDTRÆK_SLUT.SIDSTE.FUDL100;     
      DCLBQ77000T.EVSSEJ_SID_FDAGERHV = UDTRÆK_SLUT.SIDSTE.FDAGERHV;    
      DCLBQ77000T.EVSSEJ_SID_GPCTERHV = UDTRÆK_SLUT.SIDSTE.GPCTERHV;    
      DCLBQ77000T.EVSSEJ_SID_FERHVFLER = UDTRÆK_SLUT.SIDSTE.FERHVFLER;  
      DCLBQ77000T.EVSSEJ_SID_CBERGROP = UDTRÆK_SLUT.SIDSTE.CBERGROP;    
      DCLBQ77000T.EVSSEJ_SID_CBERGRGLOP = UDTRÆK_SLUT.SIDSTE.CBERGRGLOP;
      DCLBQ77000T.EVSSEJ_SID_BBERGRL = UDTRÆK_SLUT.SIDSTE.BBERGRL;      
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_SW =                               
                                 UDTRÆK_SLUT.SIDSTE.BBERGRL_SW;         
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM =                                 
                                 UDTRÆK_SLUT.SIDSTE.BBER2FAM;           
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_SW =                              
                               UDTRÆK_SLUT.SIDSTE.BBER2FAM_SW;          
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_015ANV =                           
                               UDTRÆK_SLUT.SIDSTE.BBERGRL_015ANV;       
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_015ANV_SW =                        
                               UDTRÆK_SLUT.SIDSTE.BBERGRL_015ANV_SW;    
                                                                        
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_015ANV =                          
                         UDTRÆK_SLUT.SIDSTE.BBER2FAM_015ANV;            
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_015ANV_SW =                       
                         UDTRÆK_SLUT.SIDSTE.BBER2FAM_015ANV_SW;         
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_02ANV =                            
                         UDTRÆK_SLUT.SIDSTE.BBERGRL_02ANV;              
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_02ANV_SW =                         
                         UDTRÆK_SLUT.SIDSTE.BBERGRL_02ANV_SW;           
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_02ANV =                           
                         UDTRÆK_SLUT.SIDSTE.BBER2FAM_02ANV;             
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_02ANV_SW =                        
                         UDTRÆK_SLUT.SIDSTE.BBER2FAM_02ANV_SW;          
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_AKT =                              
                         UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT;                
      DCLBQ77000T.EVSSEJ_SID_BBERGRL_AKT_SW =                           
                         UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT_SW;             
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_AKT =                             
                         UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT;               
      DCLBQ77000T.EVSSEJ_SID_BBER2FAM_AKT_SW =                          
                         UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT_SW;            
      DCLBQ77000T.EVSSEJ_SID_BPROM1 =                                   
                         UDTRÆK_SLUT.SIDSTE.BPROM1;                     
      DCLBQ77000T.EVSSEJ_SID_BPENSNED =                                 
                         UDTRÆK_SLUT.SIDSTE.BPENSNED;                   
      DCLBQ77000T.EVSSEJ_SID_BPENSNÆ =                                  
                         UDTRÆK_SLUT.SIDSTE.BPENSNÆ;                    
      DCLBQ77000T.EVSSEJ_SID_BSUM1 =                                    
                         UDTRÆK_SLUT.SIDSTE.BSUM1;                      
      DCLBQ77000T.EVSSEJ_SID_BSUM1_SW =                                 
                         UDTRÆK_SLUT.SIDSTE.BSUM1_SW;                   
      DCLBQ77000T.EVSSEJ_SID_BSUM3 = UDTRÆK_SLUT.SIDSTE.BSUM3;          
      DCLBQ77000T.EVSSEJ_SID_BSUM3_SW =                                 
                         UDTRÆK_SLUT.SIDSTE.BSUM3_SW;                   
      DCLBQ77000T.EVSSEJ_SID_BNETTO =                                   
                         UDTRÆK_SLUT.SIDSTE.BNETTO;                     
      DCLBQ77000T.EVSSEJ_SID_BNETTO_SW =                                
                         UDTRÆK_SLUT.SIDSTE.BNETTO_SW;                  
      DCLBQ77000T.EVSSEJ_SID_BFASTSTIGBGR =                             
                         UDTRÆK_SLUT.SIDSTE.BFASTSTIGBGR;               
      DCLBQ77000T.EVSSEJ_SID_BFASTSTIGBGR_SW =                          
                         UDTRÆK_SLUT.SIDSTE.BFASTSTIGBGR_SW;            
      DCLBQ77000T.EVSSEJ_SID_CSTIBLB =                                  
                         UDTRÆK_SLUT.SIDSTE.CSTIBLB;                    
      DCLBQ77000T.EVSSEJ_SID_BSTIBEGR =                                 
                         UDTRÆK_SLUT.SIDSTE.BSTIBEGR;                   
      DCLBQ77000T.EVSSEJ_SID_BEJERAN =                                  
                         UDTRÆK_SLUT.SIDSTE.BEJERAN;                    
      DCLBQ77000T.EVSSEJ_SID_BEJERAN_SW =                               
                         UDTRÆK_SLUT.SIDSTE.BEJERAN_SW;                 
      DCLBQ77000T.EVSSEJ_SID_BEVSMAN =                                  
                         UDTRÆK_SLUT.SIDSTE.BEVSMAN;                    
      DCLBQ77000T.EVSSEJ_SID_BEVSMAN_SW =                               
                         UDTRÆK_SLUT.SIDSTE.BEVSMAN_SW;                 
      DCLBQ77000T.EVSSEJ_SID_BMANEVSSTI =                               
                         UDTRÆK_SLUT.SIDSTE.BMANEVSSTI;                 
      DCLBQ77000T.EVSSEJ_SID_BMANEVSSTI_SW =                            
                         UDTRÆK_SLUT.SIDSTE.BMANEVSSTI_SW;              
      DCLBQ77000T.EVSSEJ_SID_BMANNEDSL =                                
                         UDTRÆK_SLUT.SIDSTE.BMANNEDSL;                  
      DCLBQ77000T.EVSSEJ_SID_MANNEDSLSTI =                              
                         UDTRÆK_SLUT.SIDSTE.MANNEDSLSTI;                
      DCLBQ77000T.EVSSEJ_SID_MANNEDSLSTI_SW =                           
                         UDTRÆK_SLUT.SIDSTE.MANNEDSLSTI_SW;             
      DCLBQ77000T.EVSSEJ_SID_MANPENSSTI =                               
                         UDTRÆK_SLUT.SIDSTE.MANPENSSTI;                 
      DCLBQ77000T.EVSSEJ_SID_MANPENSSTI_SW =                            
                         UDTRÆK_SLUT.SIDSTE.MANPENSSTI_SW;              
      DCLBQ77000T.EVSSEJ_SID_CENKE =                                    
                         UDTRÆK_SLUT.SIDSTE.CENKE;                      
      DCLBQ77000T.EVSSEJ_SID_CENKEBOH =                                 
                         UDTRÆK_SLUT.SIDSTE.CENKEBOH;                   
      DCLBQ77000T.EVSSEJ_SID_BOBEHAKOD =                                
                         UDTRÆK_SLUT.SIDSTE.BOBEHAKOD;                  
      DCLBQ77000T.EVSSEJ_SID_CIVILSTAND =                               
                         UDTRÆK_SLUT.SIDSTE.CIVILSTAND;                 
      DCLBQ77000T.EVSSEJ_SID_CSLET =                                    
                         UDTRÆK_SLUT.SIDSTE.CSLET;                      
      DCLBQ77000T.EVSSEJ_SID_BEJBOL1 =                                  
                         UDTRÆK_SLUT.SIDSTE.BEJBOL1;                    
      DCLBQ77000T.EVSSEJ_SID_BEJBOL1_SW =                               
                         UDTRÆK_SLUT.SIDSTE.BEJBOL1_SW;                 
      DCLBQ77000T.EVSSEJ_SID_BEJBOL2 =                                  
                         UDTRÆK_SLUT.SIDSTE.BEJBOL2;                    
      DCLBQ77000T.EVSSEJ_SID_BEJBOL2_SW =                               
                         UDTRÆK_SLUT.SIDSTE.BEJBOL2_SW;                 
      DCLBQ77000T.EVSSEJ_SID_CANVEBOL =                                 
                         UDTRÆK_SLUT.SIDSTE.CANVEBOL;                   
      DCLBQ77000T.EVSSEJ_SID_CPTYPSLUT =                                
                         UDTRÆK_SLUT.SIDSTE.CPTYPSLUT;                  
      DCLBQ77000T.EVSSEJ_SID_FELT759 =                                  
                         UDTRÆK_SLUT.SIDSTE.FELT759;                    
      DCLBQ77000T.EVSSEJ_SID_CEKSEMP =                                  
                         UDTRÆK_SLUT.SIDSTE.CEKSEMP;                    
      DCLBQ77000T.EVSSEJ_SID_CFRÅR =                                    
                         UDTRÆK_SLUT.SIDSTE.CFRÅR;                      
      DCLBQ77000T.EVSSEJ_SID_DRGNÅRFRA =                                
                         UDTRÆK_SLUT.SIDSTE.DRGNÅRFRA;                  
      DCLBQ77000T.EVSSEJ_SID_DRGNÅRTIL =                                
                         UDTRÆK_SLUT.SIDSTE.DRGNÅRTIL;                  
      DCLBQ77000T.EVSSEJ_SID_COMPLA =                                   
                         UDTRÆK_SLUT.SIDSTE.COMPLA;                     
      DCLBQ77000T.EVSSEJ_SID_DOMPLACPR=                                 
                         UDTRÆK_SLUT.SIDSTE.DOMPLACPR;                  
      DCLBQ77000T.EVSSEJ_SID_BUDLSKC =                                  
                         UDTRÆK_SLUT.SIDSTE.BUDLSKC;                    
      DCLBQ77000T.EVSSEJ_SID_BUDLSKC_SW =                               
                         UDTRÆK_SLUT.SIDSTE.BUDLSKC_SW;                 
                                                                        
                                                                        
                                                                        
    CALL INSERT_FELTER_BQ77000T;                                        
                                                                        
    SELECT (SQLCA.SQLCODE);                                             
      WHEN (0)                                                          
        DO;                                                             
          ANT_INS = ANT_INS + 1;                                        
          ANT_COMM = ANT_COMM + 1;                                      
        END;                                                            
      OTHERWISE                                                         
        DO;                                                             
          PUT SKIP LIST('TIL_EVS_AAR   = ',DCLBQ77000T.TIL_EVS_AAR);    
          PUT SKIP LIST('AFVIKLINGS_ID = ',DCLBQ77000T.AFVIKLINGS_ID);  
          PUT SKIP LIST('DCPRN         = ',DCLBQ77000T.DCPRN);          
          PUT SKIP LIST('EKOMNR        = ',DCLBQ77000T.EKOMNR);         
          PUT SKIP LIST('EEJDNR        = ',DCLBQ77000T.EEJDNR);         
          FEJLTEKST  =  'BH20000 ** 262  INSERT FRA BQ77000T';          
          PUT SKIP LIST('BH20000 SQLKODE =',SQLCA.SQLCODE);             
          CALL SQL_FEJL;                                                
       END;                                                             
    END; /*SELECT*/                                                     
                                                                        
    IF ANT_COMM > 9999                                                  
    THEN                                                                
      DO;                                                               
        EXEC SQL COMMIT;                                                
        Put skip list ('Commit efter ' !! ANT_COMM !!                   
                         ' opdateringer.  Ialt ' !! ANT_INS !!          
                           ' opdateringer');                            
        ANT_COMM = 0;                                                   
      END;                                                              
                                                                        
 END INSERT_BQ77000T;                                                   
                                                                        
 END SKRIV_TIL_BQ77000T;                                                
 /*********************************************************************/
 /* HER UDSKRIVES ØVRIGE FEJL                                  RUTINE */
 /*********************************************************************/
 PROGRAM_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED PROGRAMFEJL');                 
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END PROGRAM_FEJL;                                                      
 /*********************************************************************/
 END BH20000;                                                           
