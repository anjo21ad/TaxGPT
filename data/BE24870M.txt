 /**********************************************************************
 * PROJEKT:     EVS SLUT 2024.                                         *
 * PROGRAMNAVN: BE21870M.                                              *
 * PROGRAMTYPE: MAKRO.                                                 *
 * FUNKTION:    CPRNR OMPLACERINGER.                                   *
 * TABELLER:    BE30000T - EJERSKABSTABEL.                             *
 *              BE40000T - RESULTATTABEL.                              *
 * KONSTRUKTØR: Per Brunk            PBR,                     aug 2020 *
 *              Kopi af BQ18070M, med tilretninger                     *
 *                                                                     *
 **********************************************************************/
 /*      RETTET AF   : ONE                               10/05-2021   */
 /*      VEDRØRENDE  : ÅRSTILRETNING 2020                             */
 /*      RETTET AF   : ONE                               nov-2021     */
 /*      VEDRØRENDE  : ÅRSTILRETNING 2021                             */
 /*      RETTET AF   : JJJ                               Sep-2023     */
 /*      VEDRØRENDE  : ÅRSTILRETNING 2024                             */
 /*      RETTET AF   : HNK                               Sep-2023     */
 /*      VEDRØRENDE  : ÅRSTILRETNING 2024 NY EVS         Nov-2023     */
 /*      RETTET AF   : XJY                               13.09.2024   */
 /*      VEDRØRENDE  : #1867500 ÆA70 Fjern CELØNCOR/BGLSUM1           */
 /*********************************************************************/
 /********************************************************************/ 
 /* UNDERSØG OM CPRNR FINDES PÅ PERSONTABEL                          */ 
 /********************************************************************/ 
 UNDERSØG_PNR_FINDES_PERSON: PROC;                                      
                                                                        
         EXEC SQL                                                       
              SELECT DISTINCT (DCPRN)                                   
              INTO  :DCLBE30000T.DCPRN                                  
              FROM   BE30000T                                           
                                                                        
              WHERE  DINDKAAR = :SØGDINDKAAR                            
              AND    DCPRN    = :SØGPNR                                 
          ;                                                             
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
               RETURKODE  = 0;                                          
               RETURTEKST = 'EJERSKABSTABEL: PNR FUNDET ';              
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
               RETURKODE  = 1;                                          
               RETURTEKST = 'EJERSKABSTABEL: PNR IKKE FUNDET ';         
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               RETURKODE  = 2;                                          
               RETURTEKST = 'EJERSKABSTABEL: FIND PNR ';                
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* END-SELECT */                                          
                                                                        
 END UNDERSØG_PNR_FINDES_PERSON;                                        
 /********************************************************************/ 
 /* DECLARE CURSOR OVER PERSONENS EJENDOMME TIL KOPIERING            */ 
 /********************************************************************/ 
 DECLARE_EJD_CUR: PROC;                                                 
                                                                        
         EXEC SQL                                                       
              DECLARE EJD_CUR CURSOR FOR                                
              SELECT EKOMNR,                                            
                     EEJDNR,                                            
                     EENHEDLBNR,                                        
                     ELBNR                                              
                                                                        
              FROM   BE30000T                                           
              WHERE  DINDKAAR = :SØGDINDKAAR                            
              AND    DCPRN    = :GLPNR                                  
              AND    DTILGLD  = '9999-12-31-23.59.59.999999'            
                                                                        
              ORDER BY EKOMNR, EEJDNR, EENHEDLBNR, ELBNR                
              FOR FETCH ONLY                                            
         ;                                                              
                                                                        
 END DECLARE_EJD_CUR;                                                   
 /********************************************************************/ 
 /* FETCH CURSOR OVER PERSONENS EJENDOMME TIL KOPIERING              */ 
 /********************************************************************/ 
 FETCH_EJD_CUR: PROC;                                                   
                                                                        
         EXEC SQL                                                       
              FETCH EJD_CUR                                             
              INTO  :SØGKOMNR,                                          
                    :SØGEJDNR,                                          
                    :SØGEENHEDLBNR,                                     
                    :SØGLBNR;                                           
                                                                        
         IF SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100                   
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: FETCH EJD_CUR';                     
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
 END FETCH_EJD_CUR;                                                     
                                                                        
 /********************************************************************/ 
 /* LÆS NYT PERSONS EJENDOM PÅ EJERSKABSTABEL                        */ 
 /********************************************************************/ 
 LÆS_NYT_PNR_PERSON: PROC;                                              
                                                                        
         EXEC SQL                                                       
              SELECT DFRAGLD                                            
               INTO  :DCLBE30000T.DFRAGLD                               
                                                                        
               FROM   BE30000T                                          
               WHERE  DINDKAAR = :SØGDINDKAAR                           
               AND    DCPRN    = :NYTPNR                                
               AND    EEJDNR   = :SØGEJDNR                              
               AND    EKOMNR   = :SØGKOMNR                              
               AND    EENHEDLBNR = :SØGEENHEDLBNR                       
               AND    ELBNR    = :SØGLBNR                               
               AND    DTILGLD  = '9999-12-31-23.59.59.999999';          
                                                                        
         IF SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100                   
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: SELECT NYT PNR PERSON';             
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
 END LÆS_NYT_PNR_PERSON;                                                
 /********************************************************************/ 
 /* LÆS GAMMEL PERSONS EJENDOM PÅ RESULTAT                           */ 
 /********************************************************************/ 
 LÆS_GL_PNR_RESULTAT: PROC;                                             
                                                                        
         EXEC SQL                                                       
              SELECT DISTINCT (ELBNR)                                   
               INTO  :DCLBE40000T.ELBNR                                 
                                                                        
               FROM   BE40000T                                          
               WHERE  DINDKAAR = :SØGDINDKAAR                           
               AND    DCPRN    = :GLPNR                                 
               AND    EKOMNR   = :SØGKOMNR                              
               AND    EEJDNR   = :SØGEJDNR                              
               AND    EENHEDLBNR = :SØGEENHEDLBNR                       
               AND    ELBNR    = :SØGLBNR;                              
                                                                        
         IF SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100                   
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: SELECT GL PNR RESULTAT';            
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
 END LÆS_GL_PNR_RESULTAT;                                               
 /********************************************************************/ 
 /* OPSÆT COMPLA & DOMPLACPR PÅ GAMMELT CPRNR NYESTE RÆKKE           */ 
 /********************************************************************/ 
 OPDAT_GL_PNR_PERSON: PROC;                                             
                                                                        
         EXEC SQL                                                       
              UPDATE BE30000T                                           
              SET    DOMPLACPR = :NYTPNR_CHAR,                          
                     COMPLA    = '1'                                    
                                                                        
              WHERE  DINDKAAR = :SØGDINDKAAR                            
              AND    DCPRN    = :GLPNR                                  
              AND    EKOMNR   = :SØGKOMNR                               
              AND    EEJDNR   = :SØGEJDNR                               
              AND    EENHEDLBNR = :SØGEENHEDLBNR                        
              AND    ELBNR    = :SØGLBNR                                
              AND    DTILGLD  = '9999-12-31-23.59.59.999999'            
          ;                                                             
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
               RETURKODE  = 0;                                          
               RETURTEKST = 'EJERSKABTABEL: GAMMELT PNR OPDATERET';     
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
               RETURKODE  = 1;                                          
               RETURTEKST = 'EJERSKABSTABEL: GAMMELT PNR EJ OPDATERET ';
               CALL SQL_FEJL;                                           
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               RETURKODE  = 2;                                          
               RETURTEKST = 'EJERSKABSTABEL: OPDATER GAMMELT PNR ';     
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* END-SELECT */                                          
                                                                        
 END OPDAT_GL_PNR_PERSON;                                               
 /********************************************************************/ 
 /* OPSÆT COMPLA & DOMPLACPR PÅ GAMMELT CPRNR NYESTE RÆKKE           */ 
 /********************************************************************/ 
 OPDAT_GL_PNR_RESULTAT: PROC;                                           
                                                                        
         EXEC SQL                                                       
              UPDATE BE40000T                                           
              SET    DOMPLACPR = :NYTPNR_CHAR,                          
                     COMPLA    = '1'                                    
                                                                        
              WHERE  DINDKAAR = :SØGDINDKAAR                            
              AND    DCPRN    = :GLPNR                                  
              AND    EKOMNR   = :SØGKOMNR                               
              AND    EEJDNR   = :SØGEJDNR                               
              AND    EENHEDLBNR = :SØGEENHEDLBNR                        
              AND    ELBNR    = :SØGLBNR                                
          ;                                                             
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
               RETURKODE  = 0;                                          
               RETURTEKST = 'RESULTATTABEL: GAMMELT PNR OPDATERET ';    
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
               RETURKODE  = 1;                                          
               RETURTEKST = 'RESULTATTABEL: GAMMELT PNR EJ OPDATERET '; 
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               RETURKODE  = 2;                                          
               RETURTEKST = 'RESULTATTABEL: OPDATER GAMMELT PNR ';      
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* END-SELECT */                                          
                                                                        
 END OPDAT_GL_PNR_RESULTAT;                                             
 /********************************************************************/ 
 /* KOPIER EJERSKABSTABEL BQ30000T                                   */ 
 /********************************************************************/ 
 KOPIER_ESK_TABEL: PROC;                                                
                                                                        
         CALL DECLARE_ESK_CUR;                                          
                                                                        
         EXEC SQL OPEN ESK_CUR;                                         
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: OPEN ESK_CUR';                      
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
         CALL FETCH_ESK_CUR;                                            
                                                                        
         DO WHILE (SQLCA.SQLCODE = 0);                                  
            DCLBE30000T.COMPLA = '2';                                   
            DCLBE30000T.DOMPLACPR = GLPNR_CHAR;                         
            DCLBE30000T.DCPRN = NYTPNR;                                 
      /* I Gl. EVS kopieres efterfølgende 3 felter ikke - FKH           
         fortæller det er felter der viser KMD har ændret i data        
         og det ikke er tilfælde i en omplaceret person ved kopiering */
            DCLBE30000T.CAJOUR = ' ';                                   
            DCLBE30000T.CSUPPL = ' ';                                   
            DCLBE30000T.FEJLNR = ' ';                                   
                                                                        
            CALL SKRIV_DCLBE30000T_TABEL;                               
            CALL FETCH_ESK_CUR;                                         
         END;                                                           
                                                                        
         EXEC SQL CLOSE ESK_CUR;                                        
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              RETURTEKST = 'SQLFEJL: CLOSE ESK_CUR';                    
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END KOPIER_ESK_TABEL;                                                  
 /********************************************************************/ 
 /* DECLARE CURSOR EJERSKABSTABEL BQ30000T                           */ 
 /********************************************************************/ 
 DECLARE_ESK_CUR: PROC;                                                 
                                                                        
         EXEC SQL                                                       
              DECLARE ESK_CUR CURSOR FOR                                
              SELECT DINDKAAR                                           
                    ,DCPRN                                              
                    ,EKOMNR                                             
                    ,EEJDNR                                             
                    ,EENHEDLBNR                                         
                    ,ELBNR                                              
                    ,EGENNR                                             
                    ,CDATAFRA                                           
                    ,DFRAGLD                                            
                    ,DTILGLD                                            
                    ,CSCREGISTMP                                        
                    ,PERSKOD                                            
                    ,MYNDNR                                             
                    ,COMPLA                                             
                    ,DOMPLACPR                                          
                    ,CAJOUR                                             
                    ,CSUPPL                                             
                    ,FEJLNR                                             
                    ,CEJBEVS                                            
                    ,DBRGN_MODT                                         
                    ,BEJBOL1                                            
                    ,BEJBOL2                                            
                    ,BEJBOLANV                                          
                    ,BERHVAN                                            
                    ,BEVSMAN                                            
                    ,BFORSKAT                                           
                    ,BFSKAT                                             
                    ,BGRPROM1                                           
                    ,BGRPROM2                                           
                    ,BMANNEDSL                                          
                    ,BNEDSL1                                            
                    ,BNEDSL2                                            
                    ,BNETTO                                             
                    ,BOBEHAKOD                                          
                    ,BPENSNED                                           
                    ,BPENSNÆ                                            
                    ,BPRIVAN                                            
                    ,BPROM1                                             
                    ,BPROM2                                             
                    ,BSUM1                                              
                    ,BSUM2                                              
                    ,BUDLSKC                                            
                    ,CANVEBOL                                           
                    ,CBERGRGLOP                                         
                    ,CBERGROP                                           
                    ,CEKSEMP                                            
                    ,CENKE                                              
                    ,CENKEBOH                                           
                    ,CERHV                                              
                    ,CFORSKAT                                           
                    ,CFRÅR                                              
                    ,CINDFLYT                                           
                    ,CIVILSTAND                                         
                    ,CKØBSALG                                           
                    ,CNEDSL1                                            
                    ,CNEDSL2                                            
                    ,CNULSTIL                                           
                    ,CPTYPSLUT                                          
                    ,CSKPLOMF                                           
                    ,CSKPLOMFGL                                         
                    ,CSLET                                              
                    ,CUDLDEL                                            
                    ,CUDLHEL                                            
                    ,CUDLMAN                                            
                    ,CÆGTOPR                                            
                    ,DAFSTAA                                            
                    ,DAFSTAAFOR                                         
                    ,DATO0107                                           
                    ,DFRAFLYT                                           
                    ,DHENVN                                             
                    ,DINDFLYT                                           
                    ,DOVTG                                              
                    ,DOVTGFOR                                           
                    ,FDAGERHV                                           
                    ,FDAGUDLE                                           
                    ,FERHVFLER                                          
                    ,FUBEBOELIG                                         
                    ,FUDL100                                            
                    ,GLPNR                                              
                    ,GPCTEJER                                           
                    ,GPCTEJERFOR                                        
                    ,GPCTERHV                                           
                    ,GPCTUDLE                                           
                    ,CTILKØB                                            
                    ,DRGNÅRFRA                                          
                    ,DRGNÅRTIL                                          
                    ,BBER2FAM_AKT                                       
                    ,BBERGRL_AKT                                        
                    ,BEJBOL1_AKT                                        
                    ,BEJBOL2_AKT                                        
                    ,BEJBOLANV_AKT                                      
                    ,BPENSNÆGL                                          
                    ,BSUM3                                              
                    ,CAFSTAA                                            
                    ,CANVEBOL_AKT                                       
                    ,CBOBHAKOD                                          
                    ,CDBER2FAM_AKT                                      
                    ,CDBERGRL_AKT                                       
                    ,CDEJBEVS                                           
                    ,CDEJDTYPE                                          
                    ,CDEKSEMP                                           
                    ,CDENKE                                             
                    ,CDINDFLYT                                          
                    ,CDPTYPGL                                           
                    ,CDPTYPSLUT                                         
                    ,CDÆGTOPR                                           
                    ,CEJDTYPE_AKT                                       
                    ,CERHVFLER                                          
                    ,CEVSGL                                             
                    ,CEVSMAN                                            
                    ,CFELT759                                           
                    ,CFELT760                                           
                    ,CFRAFLYTDTO                                        
                    ,CFRÅR_FOR                                          
                    ,CINDFLYTDTO                                        
                    ,COVTG                                              
                    ,CPCTEJER                                           
                    ,CPCTERHV                                           
                    ,CPCTUDLE                                           
                    ,CPENSNEDGL                                         
                    ,CUBEBOELIG                                         
                    ,CUDLSKC                                            
                    ,DERHVPER_FRA1                                      
                    ,DERHVPER_TIL1                                      
                    ,DERHVPER_FRA2                                      
                    ,DERHVPER_TIL2                                      
                    ,DERHVPER_FRA3                                      
                    ,DERHVPER_TIL3                                      
                    ,DERHVPER_FRA4                                      
                    ,DERHVPER_TIL4                                      
                    ,DERHVPER_FRA5                                      
                    ,DERHVPER_TIL5                                      
                    ,FERHVPER_ANT                                       
                    ,CNEDTAG158                                         
                    ,BEJDVPUSKTP                                        
                    ,BEJDVÆPUSKP                                        
                    ,CFELT762                                           
                    ,CFELT769                                           
                    ,DVURDÅR                                            
                    ,CRTEKORNS                                          
                    ,COPR_CRTEKORNS                                     
                    ,VURMARK_AKT                                        
                    ,VURMARK                                            
                    ,JUR_KATEGO_AKT                                     
                    ,JUR_KATEGO                                         
                    ,JUR_UKATEGO_AKT                                    
                    ,JUR_UKATEGO                                        
                    ,VURDATO_AKT                                        
                    ,VURDATO                                            
                    ,FORSIGT_EVS_AKT                                    
                    ,FORSIGT_EVS                                        
                    ,BESKAT_EVS_AKT                                     
                    ,BESKAT_EVS                                         
                    ,EJET20240101                                       
                    ,BEVSMANFSI                                         
                    ,COPR_BEVSMANFSI                                    
                    ,BTAKS                                              
                    ,BTAKSRABAT                                         
                    ,BTAKSEFTERRABAT                                    
                    ,BBER2FAM                                           
                    ,BBERGRL                                            
                                                                        
              FROM   BE30000T                                           
              WHERE DCPRN      = :GLPNR                                 
              AND   DINDKAAR   = :SØGDINDKAAR                           
              AND   EKOMNR     = :SØGKOMNR                              
              AND   EEJDNR     = :SØGEJDNR                              
              AND   EENHEDLBNR = :SØGEENHEDLBNR                         
              AND   ELBNR      = :SØGLBNR                               
                                                                        
              ORDER BY EGENNR                                           
              FOR FETCH ONLY                                            
         ;                                                              
                                                                        
 END DECLARE_ESK_CUR;                                                   
 /********************************************************************/ 
 /* FETCH CURSOR EJERSKABSTABEL BQ30000T                             */ 
 /********************************************************************/ 
 FETCH_ESK_CUR: PROC;                                                   
                                                                        
         EXEC SQL                                                       
              FETCH ESK_CUR                                             
              INTO :DCLBE30000T.DINDKAAR                                
                   ,:DCLBE30000T.DCPRN                                  
                   ,:DCLBE30000T.EKOMNR                                 
                   ,:DCLBE30000T.EEJDNR                                 
                   ,:DCLBE30000T.EENHEDLBNR                             
                   ,:DCLBE30000T.ELBNR                                  
                   ,:DCLBE30000T.EGENNR                                 
                   ,:DCLBE30000T.CDATAFRA                               
                   ,:DCLBE30000T.DFRAGLD                                
                   ,:DCLBE30000T.DTILGLD                                
                   ,:DCLBE30000T.CSCREGISTMP                            
                   ,:DCLBE30000T.PERSKOD                                
                   ,:DCLBE30000T.MYNDNR                                 
                   ,:DCLBE30000T.COMPLA                                 
                   ,:DCLBE30000T.DOMPLACPR                              
                   ,:DCLBE30000T.CAJOUR                                 
                   ,:DCLBE30000T.CSUPPL                                 
                   ,:DCLBE30000T.FEJLNR                                 
                   ,:DCLBE30000T.CEJBEVS                                
                   ,:DCLBE30000T.DBRGN_MODT                             
                   ,:DCLBE30000T.BEJBOL1                                
                     :BE300_SW.BEJBOL1_SW                               
                   ,:DCLBE30000T.BEJBOL2                                
                     :BE300_SW.BEJBOL2_SW                               
                   ,:DCLBE30000T.BEJBOLANV                              
                     :BE300_SW.BEJBOLANV_SW                             
                   ,:DCLBE30000T.BERHVAN                                
                   ,:DCLBE30000T.BEVSMAN                                
                     :BE300_SW.BEVSMAN_SW                               
                   ,:DCLBE30000T.BFORSKAT                               
                     :BE300_SW.BFORSKAT_SW                              
                   ,:DCLBE30000T.BFSKAT                                 
                   ,:DCLBE30000T.BGRPROM1                               
                     :BE300_SW.BGRPROM1_SW                              
                   ,:DCLBE30000T.BGRPROM2                               
                     :BE300_SW.BGRPROM2_SW                              
                   ,:DCLBE30000T.BMANNEDSL                              
                     :BE300_SW.BMANNEDSL_SW                             
                   ,:DCLBE30000T.BNEDSL1                                
                     :BE300_SW.BNEDSL1_SW                               
                   ,:DCLBE30000T.BNEDSL2                                
                     :BE300_SW.BNEDSL2_SW                               
                   ,:DCLBE30000T.BNETTO                                 
                     :BE300_SW.BNETTO_SW                                
                   ,:DCLBE30000T.BOBEHAKOD                              
                   ,:DCLBE30000T.BPENSNED                               
                     :BE300_SW.BPENSNED_SW                              
                   ,:DCLBE30000T.BPENSNÆ                                
                     :BE300_SW.BPENSNÆ_SW                               
                   ,:DCLBE30000T.BPRIVAN                                
                   ,:DCLBE30000T.BPROM1                                 
                     :BE300_SW.BPROM1_SW                                
                   ,:DCLBE30000T.BPROM2                                 
                     :BE300_SW.BPROM2_SW                                
                   ,:DCLBE30000T.BSUM1                                  
                     :BE300_SW.BSUM1_SW                                 
                   ,:DCLBE30000T.BSUM2                                  
                     :BE300_SW.BSUM2_SW                                 
                   ,:DCLBE30000T.BUDLSKC                                
                     :BE300_SW.BUDLSKC_SW                               
                   ,:DCLBE30000T.CANVEBOL                               
                   ,:DCLBE30000T.CBERGRGLOP                             
                   ,:DCLBE30000T.CBERGROP                               
                   ,:DCLBE30000T.CEKSEMP                                
                   ,:DCLBE30000T.CENKE                                  
                   ,:DCLBE30000T.CENKEBOH                               
                   ,:DCLBE30000T.CERHV                                  
                   ,:DCLBE30000T.CFORSKAT                               
                   ,:DCLBE30000T.CFRÅR                                  
                   ,:DCLBE30000T.CINDFLYT                               
                   ,:DCLBE30000T.CIVILSTAND                             
                   ,:DCLBE30000T.CKØBSALG                               
                   ,:DCLBE30000T.CNEDSL1                                
                   ,:DCLBE30000T.CNEDSL2                                
                   ,:DCLBE30000T.CNULSTIL                               
                   ,:DCLBE30000T.CPTYPSLUT                              
                   ,:DCLBE30000T.CSKPLOMF                               
                   ,:DCLBE30000T.CSKPLOMFGL                             
                   ,:DCLBE30000T.CSLET                                  
                   ,:DCLBE30000T.CUDLDEL                                
                   ,:DCLBE30000T.CUDLHEL                                
                   ,:DCLBE30000T.CUDLMAN                                
                   ,:DCLBE30000T.CÆGTOPR                                
                   ,:DCLBE30000T.DAFSTAA                                
                   ,:DCLBE30000T.DAFSTAAFOR                             
                   ,:DCLBE30000T.DATO0107                               
                   ,:DCLBE30000T.DFRAFLYT                               
                   ,:DCLBE30000T.DHENVN                                 
                   ,:DCLBE30000T.DINDFLYT                               
                   ,:DCLBE30000T.DOVTG                                  
                   ,:DCLBE30000T.DOVTGFOR                               
                   ,:DCLBE30000T.FDAGERHV                               
                   ,:DCLBE30000T.FDAGUDLE                               
                   ,:DCLBE30000T.FERHVFLER                              
                   ,:DCLBE30000T.FUBEBOELIG                             
                   ,:DCLBE30000T.FUDL100                                
                   ,:DCLBE30000T.GLPNR                                  
                   ,:DCLBE30000T.GPCTEJER                               
                     :BE300_SW.GPCTEJER_SW                              
                   ,:DCLBE30000T.GPCTEJERFOR                            
                   ,:DCLBE30000T.GPCTERHV                               
                   ,:DCLBE30000T.GPCTUDLE                               
                   ,:DCLBE30000T.CTILKØB                                
                   ,:DCLBE30000T.DRGNÅRFRA                              
                   ,:DCLBE30000T.DRGNÅRTIL                              
                   ,:DCLBE30000T.BBER2FAM_AKT                           
                     :BE300_SW.BBER2FAM_AKT_SW                          
                   ,:DCLBE30000T.BBERGRL_AKT                            
                     :BE300_SW.BBERGRL_AKT_SW                           
                   ,:DCLBE30000T.BEJBOL1_AKT                            
                     :BE300_SW.BEJBOL1_AKT_SW                           
                   ,:DCLBE30000T.BEJBOL2_AKT                            
                     :BE300_SW.BEJBOL2_AKT_SW                           
                   ,:DCLBE30000T.BEJBOLANV_AKT                          
                     :BE300_SW.BEJBOLANV_AKT_SW                         
                   ,:DCLBE30000T.BPENSNÆGL                              
                     :BE300_SW.BPENSNÆGL_SW                             
                   ,:DCLBE30000T.BSUM3                                  
                     :BE300_SW.BSUM3_SW                                 
                   ,:DCLBE30000T.CAFSTAA                                
                   ,:DCLBE30000T.CANVEBOL_AKT                           
                   ,:DCLBE30000T.CBOBHAKOD                              
                   ,:DCLBE30000T.CDBER2FAM_AKT                          
                   ,:DCLBE30000T.CDBERGRL_AKT                           
                   ,:DCLBE30000T.CDEJBEVS                               
                   ,:DCLBE30000T.CDEJDTYPE                              
                   ,:DCLBE30000T.CDEKSEMP                               
                   ,:DCLBE30000T.CDENKE                                 
                   ,:DCLBE30000T.CDINDFLYT                              
                   ,:DCLBE30000T.CDPTYPGL                               
                   ,:DCLBE30000T.CDPTYPSLUT                             
                   ,:DCLBE30000T.CDÆGTOPR                               
                   ,:DCLBE30000T.CEJDTYPE_AKT                           
                   ,:DCLBE30000T.CERHVFLER                              
                   ,:DCLBE30000T.CEVSGL                                 
                   ,:DCLBE30000T.CEVSMAN                                
                   ,:DCLBE30000T.CFELT759                               
                   ,:DCLBE30000T.CFELT760                               
                   ,:DCLBE30000T.CFRAFLYTDTO                            
                   ,:DCLBE30000T.CFRÅR_FOR                              
                   ,:DCLBE30000T.CINDFLYTDTO                            
                   ,:DCLBE30000T.COVTG                                  
                   ,:DCLBE30000T.CPCTEJER                               
                   ,:DCLBE30000T.CPCTERHV                               
                   ,:DCLBE30000T.CPCTUDLE                               
                   ,:DCLBE30000T.CPENSNEDGL                             
                   ,:DCLBE30000T.CUBEBOELIG                             
                   ,:DCLBE30000T.CUDLSKC                                
                   ,:DCLBE30000T.DERHVPER_FRA1                          
                   ,:DCLBE30000T.DERHVPER_TIL1                          
                   ,:DCLBE30000T.DERHVPER_FRA2                          
                   ,:DCLBE30000T.DERHVPER_TIL2                          
                   ,:DCLBE30000T.DERHVPER_FRA3                          
                   ,:DCLBE30000T.DERHVPER_TIL3                          
                   ,:DCLBE30000T.DERHVPER_FRA4                          
                   ,:DCLBE30000T.DERHVPER_TIL4                          
                   ,:DCLBE30000T.DERHVPER_FRA5                          
                   ,:DCLBE30000T.DERHVPER_TIL5                          
                   ,:DCLBE30000T.FERHVPER_ANT                           
                   ,:DCLBE30000T.CNEDTAG158                             
                   ,:DCLBE30000T.BEJDVPUSKTP                            
                     :BE300_SW.BEJDVPUSKTP_SW                           
                   ,:DCLBE30000T.BEJDVÆPUSKP                            
                     :BE300_SW.BEJDVÆPUSKP_SW                           
                   ,:DCLBE30000T.CFELT762                               
                   ,:DCLBE30000T.CFELT769                               
                   ,:DCLBE30000T.DVURDÅR                                
                   ,:DCLBE30000T.CRTEKORNS                              
                   ,:DCLBE30000T.COPR_CRTEKORNS                         
                   ,:DCLBE30000T.VURMARK_AKT                            
                   ,:DCLBE30000T.VURMARK                                
                   ,:DCLBE30000T.JUR_KATEGO_AKT                         
                   ,:DCLBE30000T.JUR_KATEGO                             
                   ,:DCLBE30000T.JUR_UKATEGO_AKT                        
                   ,:DCLBE30000T.JUR_UKATEGO                            
                   ,:DCLBE30000T.VURDATO_AKT                            
                   ,:DCLBE30000T.VURDATO                                
                   ,:DCLBE30000T.FORSIGT_EVS_AKT                        
                   ,:DCLBE30000T.FORSIGT_EVS                            
                   ,:DCLBE30000T.BESKAT_EVS_AKT                         
                   ,:DCLBE30000T.BESKAT_EVS                             
                   ,:DCLBE30000T.EJET20240101                           
                   ,:DCLBE30000T.BEVSMANFSI                             
                     :BE300_SW.BEVSMANFSI_SW                            
                   ,:DCLBE30000T.COPR_BEVSMANFSI                        
                   ,:DCLBE30000T.BTAKS                                  
                   ,:DCLBE30000T.BTAKSRABAT                             
                   ,:DCLBE30000T.BTAKSEFTERRABAT                        
                   ,:DCLBE30000T.BBER2FAM                               
                     :BE300_SW.BBER2FAM_SW                              
                   ,:DCLBE30000T.BBERGRL                                
                     :BE300_SW.BBERGRL_SW                               
                                                                        
         ;                                                              
         IF SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100                   
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: FETCH ESK_CUR';                     
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
 END FETCH_ESK_CUR;                                                     
 /********************************************************************/ 
 /* KOPIER RESULTATTABEL BQ40000T                                    */ 
 /********************************************************************/ 
 KOPIER_RES_TABEL: PROC;                                                
                                                                        
         CALL DECLARE_RES_CUR;                                          
                                                                        
         EXEC SQL OPEN RES_CUR;                                         
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: OPEN RES_CUR';                      
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
         CALL FETCH_RES_CUR;                                            
                                                                        
         DO WHILE (SQLCA.SQLCODE = 0);                                  
            DCLBE40000T.COMPLA = '2';                                   
            DCLBE40000T.DOMPLACPR = GLPNR_CHAR;                         
            DCLBE40000T.DCPRN = NYTPNR;                                 
                                                                        
            CALL SKRIV_DCLBE40000T_TABEL;                               
            CALL FETCH_RES_CUR;                                         
         END;                                                           
                                                                        
         EXEC SQL CLOSE RES_CUR;                                        
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              RETURTEKST = 'SQLFEJL: CLOSE RES_CUR';                    
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END KOPIER_RES_TABEL;                                                  
 /********************************************************************/ 
 /* DECLARE RESULTATTABEL BQ40000T                                   */ 
 /********************************************************************/ 
 DECLARE_RES_CUR: PROC;                                                 
                                                                        
         EXEC SQL                                                       
              DECLARE RES_CUR CURSOR FOR                                
              SELECT DINDKAAR                                           
                    ,DCPRN                                              
                    ,EKOMNR                                             
                    ,EEJDNR                                             
                    ,EENHEDLBNR                                         
                    ,ELBNR                                              
                    ,EGENNR                                             
                    ,DFRAGLD                                            
                    ,COMPLA                                             
                    ,DOMPLACPR                                          
                    ,UDSKRDTO                                           
                    ,DRESULTAT                                          
                    ,CKOERSEL                                           
                    ,BEJERAN                                            
                    ,BPENSIND                                           
                    ,BPENSRED                                           
                    ,CFRÅR                                              
                    ,KOERSTMP                                           
                                                                        
              FROM   BE40000T                                           
                                                                        
              WHERE DCPRN    = :GLPNR                                   
              AND   DINDKAAR = :SØGDINDKAAR                             
              AND   EKOMNR   = :SØGKOMNR                                
              AND   EEJDNR   = :SØGEJDNR                                
              AND   EENHEDLBNR = :SØGEENHEDLBNR                         
              AND   ELBNR    = :SØGLBNR                                 
                                                                        
              ORDER BY EGENNR                                           
              FOR FETCH ONLY                                            
         ;                                                              
                                                                        
 END DECLARE_RES_CUR;                                                   
 /********************************************************************/ 
 /* FETCH CURSOR RESULTATTABEL BQ40000T                              */ 
 /********************************************************************/ 
 FETCH_RES_CUR: PROC;                                                   
                                                                        
         EXEC SQL                                                       
              FETCH RES_CUR                                             
              INTO  :DCLBE40000T.DINDKAAR                               
                   ,:DCLBE40000T.DCPRN                                  
                   ,:DCLBE40000T.EKOMNR                                 
                   ,:DCLBE40000T.EEJDNR                                 
                   ,:DCLBE40000T.EENHEDLBNR                             
                   ,:DCLBE40000T.ELBNR                                  
                   ,:DCLBE40000T.EGENNR                                 
                   ,:DCLBE40000T.DFRAGLD                                
                   ,:DCLBE40000T.COMPLA                                 
                   ,:DCLBE40000T.DOMPLACPR                              
                   ,:DCLBE40000T.UDSKRDTO                               
                   ,:DCLBE40000T.DRESULTAT                              
                   ,:DCLBE40000T.CKOERSEL                               
                   ,:DCLBE40000T.BEJERAN                                
                     :BE400_SW.BEJERAN_SW                               
                   ,:DCLBE40000T.BPENSIND                               
                     :BE400_SW.BPENSIND_SW                              
                   ,:DCLBE40000T.BPENSRED                               
                   ,:DCLBE40000T.CFRÅR                                  
                   ,:DCLBE40000T.KOERSTMP                               
         ;                                                              
                                                                        
         IF SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100                   
         THEN                                                           
           DO;                                                          
             RETURTEKST = 'SQLFEJL: FETCH RES_CUR';                     
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
 END FETCH_RES_CUR;                                                     
 /********************************************************************/ 
 /* SKRIV RÆKKE PÅ EVS SLUT EJERSKABSTABELLEN BQ30000T               */ 
 /********************************************************************/ 
 SKRIV_DCLBE30000T_TABEL: PROC;                                         
                                                                        
         EXEC SQL                                                       
              INSERT INTO BE30000T                                      
                    (DINDKAAR                                           
                    ,DCPRN                                              
                    ,EKOMNR                                             
                    ,EEJDNR                                             
                    ,EENHEDLBNR                                         
                    ,ELBNR                                              
                    ,EGENNR                                             
                    ,CDATAFRA                                           
                    ,DFRAGLD                                            
                    ,DTILGLD                                            
                    ,CSCREGISTMP                                        
                    ,PERSKOD                                            
                    ,MYNDNR                                             
                    ,COMPLA                                             
                    ,DOMPLACPR                                          
                    ,CAJOUR                                             
                    ,CSUPPL                                             
                    ,FEJLNR                                             
                    ,CEJBEVS                                            
                    ,DBRGN_MODT                                         
                    ,BEJBOL1                                            
                    ,BEJBOL2                                            
                    ,BEJBOLANV                                          
                    ,BERHVAN                                            
                    ,BEVSMAN                                            
                    ,BFORSKAT                                           
                    ,BFSKAT                                             
                    ,BGRPROM1                                           
                    ,BGRPROM2                                           
                    ,BMANNEDSL                                          
                    ,BNEDSL1                                            
                    ,BNEDSL2                                            
                    ,BNETTO                                             
                    ,BOBEHAKOD                                          
                    ,BPENSNED                                           
                    ,BPENSNÆ                                            
                    ,BPRIVAN                                            
                    ,BPROM1                                             
                    ,BPROM2                                             
                    ,BSUM1                                              
                    ,BSUM2                                              
                    ,BUDLSKC                                            
                    ,CANVEBOL                                           
                    ,CBERGRGLOP                                         
                    ,CBERGROP                                           
                    ,CEKSEMP                                            
                    ,CENKE                                              
                    ,CENKEBOH                                           
                    ,CERHV                                              
                    ,CFORSKAT                                           
                    ,CFRÅR                                              
                    ,CINDFLYT                                           
                    ,CIVILSTAND                                         
                    ,CKØBSALG                                           
                    ,CNEDSL1                                            
                    ,CNEDSL2                                            
                    ,CNULSTIL                                           
                    ,CPTYPSLUT                                          
                    ,CSKPLOMF                                           
                    ,CSKPLOMFGL                                         
                    ,CSLET                                              
                    ,CUDLDEL                                            
                    ,CUDLHEL                                            
                    ,CUDLMAN                                            
                    ,CÆGTOPR                                            
                    ,DAFSTAA                                            
                    ,DAFSTAAFOR                                         
                    ,DATO0107                                           
                    ,DFRAFLYT                                           
                    ,DHENVN                                             
                    ,DINDFLYT                                           
                    ,DOVTG                                              
                    ,DOVTGFOR                                           
                    ,FDAGERHV                                           
                    ,FDAGUDLE                                           
                    ,FERHVFLER                                          
                    ,FUBEBOELIG                                         
                    ,FUDL100                                            
                    ,GLPNR                                              
                    ,GPCTEJER                                           
                    ,GPCTEJERFOR                                        
                    ,GPCTERHV                                           
                    ,GPCTUDLE                                           
                    ,CTILKØB                                            
                    ,DRGNÅRFRA                                          
                    ,DRGNÅRTIL                                          
                    ,BBER2FAM_AKT                                       
                    ,BBERGRL_AKT                                        
                    ,BEJBOL1_AKT                                        
                    ,BEJBOL2_AKT                                        
                    ,BEJBOLANV_AKT                                      
                    ,BPENSNÆGL                                          
                    ,BSUM3                                              
                    ,CAFSTAA                                            
                    ,CANVEBOL_AKT                                       
                    ,CBOBHAKOD                                          
                    ,CDBER2FAM_AKT                                      
                    ,CDBERGRL_AKT                                       
                    ,CDEJBEVS                                           
                    ,CDEJDTYPE                                          
                    ,CDEKSEMP                                           
                    ,CDENKE                                             
                    ,CDINDFLYT                                          
                    ,CDPTYPGL                                           
                    ,CDPTYPSLUT                                         
                    ,CDÆGTOPR                                           
                    ,CEJDTYPE_AKT                                       
                    ,CERHVFLER                                          
                    ,CEVSGL                                             
                    ,CEVSMAN                                            
                    ,CFELT759                                           
                    ,CFELT760                                           
                    ,CFRAFLYTDTO                                        
                    ,CFRÅR_FOR                                          
                    ,CINDFLYTDTO                                        
                    ,COVTG                                              
                    ,CPCTEJER                                           
                    ,CPCTERHV                                           
                    ,CPCTUDLE                                           
                    ,CPENSNEDGL                                         
                    ,CUBEBOELIG                                         
                    ,CUDLSKC                                            
                    ,DERHVPER_FRA1                                      
                    ,DERHVPER_TIL1                                      
                    ,DERHVPER_FRA2                                      
                    ,DERHVPER_TIL2                                      
                    ,DERHVPER_FRA3                                      
                    ,DERHVPER_TIL3                                      
                    ,DERHVPER_FRA4                                      
                    ,DERHVPER_TIL4                                      
                    ,DERHVPER_FRA5                                      
                    ,DERHVPER_TIL5                                      
                    ,FERHVPER_ANT                                       
                    ,CNEDTAG158                                         
                    ,BEJDVPUSKTP                                        
                    ,BEJDVÆPUSKP                                        
                    ,CFELT762                                           
                    ,CFELT769                                           
                    ,DVURDÅR                                            
                    ,CRTEKORNS                                          
                    ,COPR_CRTEKORNS                                     
                    ,VURMARK_AKT                                        
                    ,VURMARK                                            
                    ,JUR_KATEGO_AKT                                     
                    ,JUR_KATEGO                                         
                    ,JUR_UKATEGO_AKT                                    
                    ,JUR_UKATEGO                                        
                    ,VURDATO_AKT                                        
                    ,VURDATO                                            
                    ,FORSIGT_EVS_AKT                                    
                    ,FORSIGT_EVS                                        
                    ,BESKAT_EVS_AKT                                     
                    ,BESKAT_EVS                                         
                    ,EJET20240101                                       
                    ,BEVSMANFSI                                         
                    ,COPR_BEVSMANFSI                                    
                    ,BTAKS                                              
                    ,BTAKSRABAT                                         
                    ,BTAKSEFTERRABAT                                    
                    ,BBER2FAM                                           
                    ,BBERGRL)                                           
                                                                        
              VALUES                                                    
                   (:DCLBE30000T.DINDKAAR                               
                   ,:DCLBE30000T.DCPRN                                  
                   ,:DCLBE30000T.EKOMNR                                 
                   ,:DCLBE30000T.EEJDNR                                 
                   ,:DCLBE30000T.EENHEDLBNR                             
                   ,:DCLBE30000T.ELBNR                                  
                   ,:DCLBE30000T.EGENNR                                 
                   ,:DCLBE30000T.CDATAFRA                               
                   ,:DCLBE30000T.DFRAGLD                                
                   ,:DCLBE30000T.DTILGLD                                
                   ,:DCLBE30000T.CSCREGISTMP                            
                   ,:DCLBE30000T.PERSKOD                                
                   ,:DCLBE30000T.MYNDNR                                 
                   ,:DCLBE30000T.COMPLA                                 
                   ,:DCLBE30000T.DOMPLACPR                              
                   ,:DCLBE30000T.CAJOUR                                 
                   ,:DCLBE30000T.CSUPPL                                 
                   ,:DCLBE30000T.FEJLNR                                 
                   ,:DCLBE30000T.CEJBEVS                                
                   ,:DCLBE30000T.DBRGN_MODT                             
                   ,:DCLBE30000T.BEJBOL1                                
                     :BE300_SW.BEJBOL1_SW                               
                   ,:DCLBE30000T.BEJBOL2                                
                     :BE300_SW.BEJBOL2_SW                               
                   ,:DCLBE30000T.BEJBOLANV                              
                     :BE300_SW.BEJBOLANV_SW                             
                   ,:DCLBE30000T.BERHVAN                                
                   ,:DCLBE30000T.BEVSMAN                                
                     :BE300_SW.BEVSMAN_SW                               
                   ,:DCLBE30000T.BFORSKAT                               
                     :BE300_SW.BFORSKAT_SW                              
                   ,:DCLBE30000T.BFSKAT                                 
                   ,:DCLBE30000T.BGRPROM1                               
                     :BE300_SW.BGRPROM1_SW                              
                   ,:DCLBE30000T.BGRPROM2                               
                     :BE300_SW.BGRPROM2_SW                              
                   ,:DCLBE30000T.BMANNEDSL                              
                     :BE300_SW.BMANNEDSL_SW                             
                   ,:DCLBE30000T.BNEDSL1                                
                     :BE300_SW.BNEDSL1_SW                               
                   ,:DCLBE30000T.BNEDSL2                                
                     :BE300_SW.BNEDSL2_SW                               
                   ,:DCLBE30000T.BNETTO                                 
                     :BE300_SW.BNETTO_SW                                
                   ,:DCLBE30000T.BOBEHAKOD                              
                   ,:DCLBE30000T.BPENSNED                               
                     :BE300_SW.BPENSNED_SW                              
                   ,:DCLBE30000T.BPENSNÆ                                
                     :BE300_SW.BPENSNÆ_SW                               
                   ,:DCLBE30000T.BPRIVAN                                
                   ,:DCLBE30000T.BPROM1                                 
                     :BE300_SW.BPROM1_SW                                
                   ,:DCLBE30000T.BPROM2                                 
                     :BE300_SW.BPROM2_SW                                
                   ,:DCLBE30000T.BSUM1                                  
                     :BE300_SW.BSUM1_SW                                 
                   ,:DCLBE30000T.BSUM2                                  
                     :BE300_SW.BSUM2_SW                                 
                   ,:DCLBE30000T.BUDLSKC                                
                     :BE300_SW.BUDLSKC_SW                               
                   ,:DCLBE30000T.CANVEBOL                               
                   ,:DCLBE30000T.CBERGRGLOP                             
                   ,:DCLBE30000T.CBERGROP                               
                   ,:DCLBE30000T.CEKSEMP                                
                   ,:DCLBE30000T.CENKE                                  
                   ,:DCLBE30000T.CENKEBOH                               
                   ,:DCLBE30000T.CERHV                                  
                   ,:DCLBE30000T.CFORSKAT                               
                   ,:DCLBE30000T.CFRÅR                                  
                   ,:DCLBE30000T.CINDFLYT                               
                   ,:DCLBE30000T.CIVILSTAND                             
                   ,:DCLBE30000T.CKØBSALG                               
                   ,:DCLBE30000T.CNEDSL1                                
                   ,:DCLBE30000T.CNEDSL2                                
                   ,:DCLBE30000T.CNULSTIL                               
                   ,:DCLBE30000T.CPTYPSLUT                              
                   ,:DCLBE30000T.CSKPLOMF                               
                   ,:DCLBE30000T.CSKPLOMFGL                             
                   ,:DCLBE30000T.CSLET                                  
                   ,:DCLBE30000T.CUDLDEL                                
                   ,:DCLBE30000T.CUDLHEL                                
                   ,:DCLBE30000T.CUDLMAN                                
                   ,:DCLBE30000T.CÆGTOPR                                
                   ,:DCLBE30000T.DAFSTAA                                
                   ,:DCLBE30000T.DAFSTAAFOR                             
                   ,:DCLBE30000T.DATO0107                               
                   ,:DCLBE30000T.DFRAFLYT                               
                   ,:DCLBE30000T.DHENVN                                 
                   ,:DCLBE30000T.DINDFLYT                               
                   ,:DCLBE30000T.DOVTG                                  
                   ,:DCLBE30000T.DOVTGFOR                               
                   ,:DCLBE30000T.FDAGERHV                               
                   ,:DCLBE30000T.FDAGUDLE                               
                   ,:DCLBE30000T.FERHVFLER                              
                   ,:DCLBE30000T.FUBEBOELIG                             
                   ,:DCLBE30000T.FUDL100                                
                   ,:DCLBE30000T.GLPNR                                  
                   ,:DCLBE30000T.GPCTEJER                               
                     :BE300_SW.GPCTEJER_SW                              
                   ,:DCLBE30000T.GPCTEJERFOR                            
                   ,:DCLBE30000T.GPCTERHV                               
                   ,:DCLBE30000T.GPCTUDLE                               
                   ,:DCLBE30000T.CTILKØB                                
                   ,:DCLBE30000T.DRGNÅRFRA                              
                   ,:DCLBE30000T.DRGNÅRTIL                              
                   ,:DCLBE30000T.BBER2FAM_AKT                           
                     :BE300_SW.BBER2FAM_AKT_SW                          
                   ,:DCLBE30000T.BBERGRL_AKT                            
                     :BE300_SW.BBERGRL_AKT_SW                           
                   ,:DCLBE30000T.BEJBOL1_AKT                            
                     :BE300_SW.BEJBOL1_AKT_SW                           
                   ,:DCLBE30000T.BEJBOL2_AKT                            
                     :BE300_SW.BEJBOL2_AKT_SW                           
                   ,:DCLBE30000T.BEJBOLANV_AKT                          
                     :BE300_SW.BEJBOLANV_AKT_SW                         
                   ,:DCLBE30000T.BPENSNÆGL                              
                     :BE300_SW.BPENSNÆGL_SW                             
                   ,:DCLBE30000T.BSUM3                                  
                     :BE300_SW.BSUM3_SW                                 
                   ,:DCLBE30000T.CAFSTAA                                
                   ,:DCLBE30000T.CANVEBOL_AKT                           
                   ,:DCLBE30000T.CBOBHAKOD                              
                   ,:DCLBE30000T.CDBER2FAM_AKT                          
                   ,:DCLBE30000T.CDBERGRL_AKT                           
                   ,:DCLBE30000T.CDEJBEVS                               
                   ,:DCLBE30000T.CDEJDTYPE                              
                   ,:DCLBE30000T.CDEKSEMP                               
                   ,:DCLBE30000T.CDENKE                                 
                   ,:DCLBE30000T.CDINDFLYT                              
                   ,:DCLBE30000T.CDPTYPGL                               
                   ,:DCLBE30000T.CDPTYPSLUT                             
                   ,:DCLBE30000T.CDÆGTOPR                               
                   ,:DCLBE30000T.CEJDTYPE_AKT                           
                   ,:DCLBE30000T.CERHVFLER                              
                   ,:DCLBE30000T.CEVSGL                                 
                   ,:DCLBE30000T.CEVSMAN                                
                   ,:DCLBE30000T.CFELT759                               
                   ,:DCLBE30000T.CFELT760                               
                   ,:DCLBE30000T.CFRAFLYTDTO                            
                   ,:DCLBE30000T.CFRÅR_FOR                              
                   ,:DCLBE30000T.CINDFLYTDTO                            
                   ,:DCLBE30000T.COVTG                                  
                   ,:DCLBE30000T.CPCTEJER                               
                   ,:DCLBE30000T.CPCTERHV                               
                   ,:DCLBE30000T.CPCTUDLE                               
                   ,:DCLBE30000T.CPENSNEDGL                             
                   ,:DCLBE30000T.CUBEBOELIG                             
                   ,:DCLBE30000T.CUDLSKC                                
                   ,:DCLBE30000T.DERHVPER_FRA1                          
                   ,:DCLBE30000T.DERHVPER_TIL1                          
                   ,:DCLBE30000T.DERHVPER_FRA2                          
                   ,:DCLBE30000T.DERHVPER_TIL2                          
                   ,:DCLBE30000T.DERHVPER_FRA3                          
                   ,:DCLBE30000T.DERHVPER_TIL3                          
                   ,:DCLBE30000T.DERHVPER_FRA4                          
                   ,:DCLBE30000T.DERHVPER_TIL4                          
                   ,:DCLBE30000T.DERHVPER_FRA5                          
                   ,:DCLBE30000T.DERHVPER_TIL5                          
                   ,:DCLBE30000T.FERHVPER_ANT                           
                   ,:DCLBE30000T.CNEDTAG158                             
                   ,:DCLBE30000T.BEJDVPUSKTP                            
                     :BE300_SW.BEJDVPUSKTP_SW                           
                   ,:DCLBE30000T.BEJDVÆPUSKP                            
                     :BE300_SW.BEJDVÆPUSKP_SW                           
                   ,:DCLBE30000T.CFELT762                               
                   ,:DCLBE30000T.CFELT769                               
                   ,:DCLBE30000T.DVURDÅR                                
                   ,:DCLBE30000T.CRTEKORNS                              
                   ,:DCLBE30000T.COPR_CRTEKORNS                         
                   ,:DCLBE30000T.VURMARK_AKT                            
                   ,:DCLBE30000T.VURMARK                                
                   ,:DCLBE30000T.JUR_KATEGO_AKT                         
                   ,:DCLBE30000T.JUR_KATEGO                             
                   ,:DCLBE30000T.JUR_UKATEGO_AKT                        
                   ,:DCLBE30000T.JUR_UKATEGO                            
                   ,:DCLBE30000T.VURDATO_AKT                            
                   ,:DCLBE30000T.VURDATO                                
                   ,:DCLBE30000T.FORSIGT_EVS_AKT                        
                   ,:DCLBE30000T.FORSIGT_EVS                            
                   ,:DCLBE30000T.BESKAT_EVS_AKT                         
                   ,:DCLBE30000T.BESKAT_EVS                             
                   ,:DCLBE30000T.EJET20240101                           
                   ,:DCLBE30000T.BEVSMANFSI                             
                     :BE300_SW.BEVSMANFSI_SW                            
                   ,:DCLBE30000T.COPR_BEVSMANFSI                        
                   ,:DCLBE30000T.BTAKS                                  
                   ,:DCLBE30000T.BTAKSRABAT                             
                   ,:DCLBE30000T.BTAKSEFTERRABAT                        
                   ,:DCLBE30000T.BBER2FAM                               
                     :BE300_SW.BBER2FAM_SW                              
                   ,:DCLBE30000T.BBERGRL                                
                     :BE300_SW.BBERGRL_SW)                              
         ;                                                              
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0);                                                    
           OTHERWISE                                                    
             DO;                                                        
               RETURTEKST = 'EJERSKABSTABEL: SQLFEJL VED SKRIV';        
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* END-SELECT */                                          
                                                                        
 END SKRIV_DCLBE30000T_TABEL;                                           
 /********************************************************************/ 
 /* SKRIV 1 RÆKKE PÅ EVS SLUT RESULTATTABEL                          */ 
 /********************************************************************/ 
 SKRIV_DCLBE40000T_TABEL: PROC;                                         
                                                                        
         EXEC SQL                                                       
              INSERT INTO BE40000T                                      
                     (DINDKAAR                                          
                     ,DCPRN                                             
                     ,EKOMNR                                            
                     ,EEJDNR                                            
                     ,EENHEDLBNR                                        
                     ,ELBNR                                             
                     ,EGENNR                                            
                     ,DFRAGLD                                           
                     ,COMPLA                                            
                     ,DOMPLACPR                                         
                     ,UDSKRDTO                                          
                     ,DRESULTAT                                         
                     ,CKOERSEL                                          
                     ,BEJERAN                                           
                     ,BPENSIND                                          
                     ,BPENSRED                                          
                     ,CFRÅR                                             
                     ,KOERSTMP)                                         
                                                                        
              VALUES (:DCLBE40000T.DINDKAAR                             
                     ,:DCLBE40000T.DCPRN                                
                     ,:DCLBE40000T.EKOMNR                               
                     ,:DCLBE40000T.EEJDNR                               
                     ,:DCLBE40000T.EENHEDLBNR                           
                     ,:DCLBE40000T.ELBNR                                
                     ,:DCLBE40000T.EGENNR                               
                     ,:DCLBE40000T.DFRAGLD                              
                     ,:DCLBE40000T.COMPLA                               
                     ,:DCLBE40000T.DOMPLACPR                            
                     ,:DCLBE40000T.UDSKRDTO                             
                     ,:DCLBE40000T.DRESULTAT                            
                     ,:DCLBE40000T.CKOERSEL                             
                     ,:DCLBE40000T.BEJERAN                              
                       :BE400_SW.BEJERAN_SW                             
                     ,:DCLBE40000T.BPENSIND                             
                       :BE400_SW.BPENSIND_SW                            
                     ,:DCLBE40000T.BPENSRED                             
                     ,:DCLBE40000T.CFRÅR                                
                     ,:DCLBE40000T.KOERSTMP)                            
         ;                                                              
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
               RETURTEKST = 'RESULTATTABEL: SKRIV OK - ';               
           OTHERWISE                                                    
             DO;                                                        
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* END-SELECT */                                          
                                                                        
 END SKRIV_DCLBE40000T_TABEL;                                           
