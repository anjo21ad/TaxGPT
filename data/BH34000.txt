 BH34000: /* DAN DATA TIL EVS PERSONTABEL SAMT SLUT PÅ CSC */           
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 2000');       
 /**********************************************************************
 *                                                                     *
 * FORMÅL :  DAN DATA TIL EVS PERSONTABEL SAMT SLUT PÅ CSC             *
 *                                                                     *
 * INDDATA:     BQ00100T - EVS EJENDOMSTABEL.                          *
 *              BQ00700T - EVS TESTPERSONTABEL.                        *
 *                                                                     *
 * OUTPUT : B.H94100D  UDTRÆK - LOAD PERSONER                          *
 *          B.H94110D  UDTRÆK - LOAD EJENDOMSTABEL                     *
 *          B.H94120D  UDTRÆK - EVS DATA TIL SLUT PÅ CSC               *
 *          BH34001Y   KØRSELSKONTROLLISTE                             *
 *          BH34002Y   FEJLLISTE FRA MASKINEL AFSTEMNING               *
 *                                                                     *
 * PROGRAMMØR: HANS ERIK KJELDSEN  NOVEMBER 2001                       *
 * RETTET:                                                             *
 *                                                                     *
 **********************************************************************/
         DFT RANGE (*) STATIC;                                          
     /*  DEFAULT RANGE (*) STATIC UNALIGNED CONN;  */                   
 /*********************************************************************/
 /* DECLARE AF DB2                                                    */
 /*********************************************************************/
                                                                        
         EXEC SQL INCLUDE BQ00100T;           /* EVS EJENDOMSTABELLEN */
         EXEC SQL INCLUDE BQ00700T;           /* EVS PERSONTABELLEN   */
         EXEC SQL INCLUDE SQLCA;           /* SQL KOMMUNIKATIONSAREAL */
                                                                        
 DCL     1 INDK_PERS,                         /*INDIKATOR VARIABLE    */
         %INCLUDE BH34006N;                   /* TIL PERSONTABELLEN   */
                                                                        
 DCL     1 EJENDOM,                                                     
         %INCLUDE BQ00100N;;                                            
                                                                        
 DCL     1 PERSON,                                                      
         %INCLUDE BH34002N;                                             
                                                                        
 DCL     1 HUS,                                                         
         %INCLUDE BH34001N;                                             
                                                                        
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH3400O FILE RECORD OUTPUT;    /* LOAD-GRUNDLAG PERSONTABEL */ 
 DCL     BH3402O FILE RECORD OUTPUT;    /* EVS DATA TIL SLUT PÅ CSC  */ 
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (LOAD-GRUNDLAG)                            * 
 *********************************************************************/ 
 DCL     1 BH340,                                                       
           %INCLUDE BH34100N;;                                          
 DCL     1 BH341,                                                       
           %INCLUDE BH34110N;;                                          
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (SLUT PÅ CSC)                              * 
 *********************************************************************/ 
 DCL     1 BH342,                                                       
           %INCLUDE BH34120N;                                           
 /********************************************************************* 
 *               DECLARE STRUKTURE TIL BEREGNING                      * 
 *********************************************************************/ 
 DCL     1 BQ01905N,                                                    
           %INCLUDE BQ01905N;;                                          
 DCL     1 BQ01906N,                                                    
           %INCLUDE BQ01906N;;                                          
 DCL     1 BQ01907N,                                                    
           %INCLUDE BQ01907N;;                                          
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_BH960    FIXED DEC (7),                                
           2 KUN_EJDTAB   FIXED DEC (7),                                
           2 SKREVET_LOAD FIXED DEC (7),                                
           2 SKREVET      FIXED DEC (7),                                
           2 BEREGNET     FIXED DEC (7),                                
           2 EVS2000      FIXED DEC (15,2),                             
           2 BPROM1       FIXED DEC (7),                                
           2 BPROM2       FIXED DEC (7),                                
           2 BNEDSL1      FIXED DEC (7),                                
           2 BNEDSL2      FIXED DEC (7),                                
           2 CPENSN11     FIXED DEC (7),                                
           2 CPENSN14     FIXED DEC (7),                                
           2 CPENSN21     FIXED DEC (7),                                
           2 CSTIBLB(20)  FIXED DEC (7),                                
           2 BER_BOPÆL0   FIXED DEC (7),                                
           2 BER_BOPÆL1   FIXED DEC (7),                                
           2 BER_BOPÆL2   FIXED DEC (7),                                
           2 BER_BOPÆL3   FIXED DEC (7),                                
           2 BER_BOPÆL4   FIXED DEC (7),                                
           2 BER_BOPÆL5   FIXED DEC (7),                                
           2 BER_BOPÆL6   FIXED DEC (7),                                
           2 EJBEREGNET   FIXED DEC (7),                                
           2 EJBER_BOPÆL0 FIXED DEC (7),                                
           2 EJBER_BOPÆL1 FIXED DEC (7),                                
           2 EJBER_BOPÆL2 FIXED DEC (7),                                
           2 EJBER_BOPÆL3 FIXED DEC (7),                                
           2 EJBER_BOPÆL4 FIXED DEC (7),                                
           2 EJBER_BOPÆL5 FIXED DEC (7),                                
           2 EJBER_BOPÆL6 FIXED DEC (7),                                
           2 BEVSGL       FIXED DEC (15,2),                             
           2 FANT2000     FIXED DEC (7),                                
           2 FANT2000SOM  FIXED DEC (7);                                
                                                                        
 DCL     1 LÆST_FEJLNR(5001:5100), /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
                                                                        
 DCL     1 SKR_FEJLNR(5001:5100),  /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_EJBEVS(0:9),        /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_BERGRL(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_EJDTYP(0:8),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 TAB_PERSON(16),         /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 TEKST       CHAR      (60),                                
           2 ANTAL       FIXED DEC (7);                                 
 DCL     MAX_ANT_INDV    FIXED DEC (7) INIT (0);                        
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 DCL     NULL            BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS67000         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     ZS34900         ENTRY OPTIONS (INTER ASM);   /* FAKTURERING  */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    LIN_DEB          CHAR      (133);                               
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH34000L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (                
           'DAN DATA TIL EVS PERSONTABEL SAMT SLUT PÅ CSC'),            
           2 F2          CHAR      (12)      INIT      (' '),           
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (10)      INIT      (' '),           
           2 TEKST2      CHAR      (07)      INIT      ('BELØB: '),     
           2 BELØB       PIC       'Z.ZZZ.ZZZ.ZZZ.ZZ9,V99',             
           2 F3          CHAR      (24)      INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     INDEX           BIN FIXED (31);                                
 DCL     I               BIN FIXED (15);                                
 DCL     HJ_CHAR4        CHAR      (4);                                 
 DCL     HJ_PIC4         PIC       '(4)9'  BASED(ADDR(HJ_CHAR4));       
 DCL     HJ_FEJLNR       PIC       '(4)9';                              
 DCL     HJ_FEJLNRC      CHAR      (4)     BASED(ADDR(HJ_FEJLNR));      
 DCL     HJ_CHAR1        CHAR      (1);                                 
 DCL     HJ_PIC1         PIC       '9'     BASED(ADDR(HJ_CHAR1));       
 DCL     GLPNR           FIXED     (11)      INIT      (0);             
 DCL     FANTINDV    BIN FIXED     (31)      INIT      (0);             
 DCL     FEJLTABBIT (70)    BIT       (1);                              
 DCL     FEJLTEKST      CHAR (20)        INIT(' ');                     
 DCL     ABENDMEDD      CHAR (56)        INIT(' ');                     
 DCL     UDDATO          CHAR      (10);                                
 DCL     SQLKODE         PIC '9999';                                    
 DCL     DATO1           CHAR      (26);                                
 DCL     RETURKODE       BIN FIXED (31) INIT(0);                        
 DCL     HJ_RETURKODE    BIN FIXED (31) INIT(0);                        
 DCL     FEJLTAB(12)     BIN FIXED (31);                                
 DCL     PIC_FEJLNR      PIC '9999';                                    
 DCL     BEREGNES         CHAR (1) INIT(' ');                           
 DCL     MAX_TIMESTAMP   CHAR(26) INIT('9999-12-31-23.59.59.999999');   
 DCL     AKT_TIMESTAMP   CHAR(26);                                      
 DCL     AKT_DATO        CHAR(10) BASED(ADDR(AKT_TIMESTAMP));           
 DCL     SUPPL_KØR_DATO  CHAR(10) INIT('2001-02-22');                   
 DCL     GEM_DCPRN    DEC FIXED(11,0) INIT(0);                          
 DCL     GEM_EKOMNR   BIN FIXED(15)   INIT(0);                          
 DCL     GEM_EEJDNR   BIN FIXED(31)   INIT(0);                          
 DCL     HJ_ELBNR    BIN FIXED(15) INIT (0);                            
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *********************************************************************/ 
 DCL     BH960_ANT_INDV  FIXED     (7)       INIT      (0);             
 DCL     SWFEJL          CHAR      (1)       INIT      (' ');           
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (BH3400O) TITLE ('BH34000O');                        
         OPEN FILE (BH3402O) TITLE ('BH34020O');                        
                                                                        
         CALL ZZ20390 ('*OPEN','BH34001Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         PERSON = '';                                                   
         BH340 = '';                                                    
         BH341 = '';                                                    
         BH342 = '';                                                    
         BQ01905N = '';                                                 
         BQ01906N = '';                                                 
         BQ01907N = '';                                                 
                                                                        
         TV = 0;                                                        
                                                                        
         DO I = 1 TO 70;                                                
            FEJLTABBIT(I) = '0'B;                                       
         END;                                                           
                                                                        
         DO INDEX = 5001 TO 5100;                                       
            LÆST_FEJLNR(INDEX).ANTAL = 0;                               
            SKR_FEJLNR(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            SKR_EJBEVS(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_BERGRL(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 0 TO 8;                                             
            LÆST_EJDTYP(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 1 TO 16;                                            
            TAB_PERSON(INDEX).ANTAL  = 0;                               
         END;                                                           
                                                                        
         TAB_PERSON(1).TEKST  = 'ANTAL PERSONER TIL PERSONTABEL IALT:'; 
         TAB_PERSON(2).TEKST  = '      HERAF MED 1 EJENDOM           '; 
         TAB_PERSON(3).TEKST  = '      HERAF MED 2 EJENDOMME         '; 
         TAB_PERSON(4).TEKST  = '      HERAF MED 3 EJENDOMME         '; 
         TAB_PERSON(5).TEKST  = '      HERAF MED 4 EJENDOMME         '; 
         TAB_PERSON(6).TEKST  = '      HERAF MED 5 EJENDOMME         '; 
         TAB_PERSON(7).TEKST  = '      HERAF MED 6 EJENDOMME         '; 
         TAB_PERSON(8).TEKST  = '      HERAF MED 7 EJENDOMME         '; 
         TAB_PERSON(9).TEKST  = '      HERAF MED 8 EJENDOMME         '; 
         TAB_PERSON(10).TEKST = '      HERAF MED 9 EJENDOMME         '; 
         TAB_PERSON(11).TEKST = '      HERAF MED 10 EJENDOMME        '; 
         TAB_PERSON(12).TEKST = '      HERAF MED 11-20 EJENDOMME     '; 
         TAB_PERSON(13).TEKST = '      HERAF MED 21-30 EJENDOMME     '; 
         TAB_PERSON(14).TEKST = '      HERAF MED 31-40 EJENDOMME     '; 
         TAB_PERSON(15).TEKST = '      HERAF MED 41-50 EJENDOMME     '; 
         TAB_PERSON(16).TEKST = '      HERAF MED OVER 50 EJENDOMME   '; 
                                                                        
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
         CALL DECLARE_PERSONEJENDOMSOPL_TEST;                           
         CALL OPEN_PERSONEJENDOMSOPL_TEST;                              
         TESTPERSON = '';                                               
         CALL FETCH_PERSONEJENDOMSOPL_TEST;                             
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               DO WHILE (SQLCA.SQLCODE = 0);                            
                  PERSON = '';                                          
                  BH340 = '';                                           
                  BH341 = '';                                           
                  BH342 = '';                                           
                  BQ01905N = '';                                        
                  BQ01906N = '';                                        
                  BQ01907N = '';                                        
                  CALL FLYT_TIL_PERSON;                                 
                  CALL FLYT_TIL_HUS;                                    
               /* CALL BEREGN;  */                                      
                  CALL BEHANDELCSC;                                     
                  CALL DAN_LOAD_TIL_PERS;                               
                  TV.SKREVET_LOAD = TV.SKREVET_LOAD + 1;                
                  WRITE FILE (BH3400O) FROM (BH340);                    
                  TESTPERSON = '';                                      
                  CALL FETCH_PERSONEJENDOMSOPL_TEST;                    
               END;                                                     
             END;                                                       
                                                                        
           WHEN (100)                                                   
               PUT SKIP LIST ('INGEN RÆKKER LÆST');                     
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'FETCH PERSON_CURSOR ';                     
               CALL SQL_FEJL_TEST;                                      
             END;                                                       
                                                                        
         END; /* SELECT */                                              
         CALL CLOSE_PERSONEJENDOMSOPL_TEST;                             
         CALL LUK_PROG;                                                 
 /*********************************************************************/
 /* OPEN CURSOR TIL LÆS AF TESTPERSONTABEL BQ00700T            RUTINE */
 /*********************************************************************/
 OPEN_PERSONEJENDOMSOPL_TEST: PROC;                                     
                                                                        
         EXEC SQL OPEN PERSON_CURSOR;                                   
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'OPEN PERSON_CURSOR';                         
              CALL SQL_FEJL_TEST;                                       
            END;                                                        
                                                                        
 END OPEN_PERSONEJENDOMSOPL_TEST;                                       
 /*********************************************************************/
 /* CLOSE CURSOR TIL LÆS AF PERSONTABEL BQ00200T               RUTINE */
 /*********************************************************************/
 CLOSE_PERSONEJENDOMSOPL_TEST: PROC;                                    
                                                                        
         EXEC SQL CLOSE PERSON_CURSOR;                                  
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'CLOSE PERSON_CURSOR';                        
              CALL SQL_FEJL_TEST;                                       
            END;                                                        
                                                                        
 END CLOSE_PERSONEJENDOMSOPL_TEST;                                      
                                                                        
 /********************************************************************* 
 *       OPTÆL STATUS FOR DENNE PERSON                                * 
 *********************************************************************/ 
 OPTÆL_PERSON:                                                          
         PROC;                                                          
                                                                        
         SELECT;                                                        
           WHEN (FANTINDV = 1)                                          
              INDEX = 2;                                                
           WHEN (FANTINDV = 2)                                          
              INDEX = 3;                                                
           WHEN (FANTINDV = 3)                                          
              INDEX = 4;                                                
           WHEN (FANTINDV = 4)                                          
              INDEX = 5;                                                
           WHEN (FANTINDV = 5)                                          
              INDEX = 6;                                                
           WHEN (FANTINDV = 6)                                          
              INDEX = 7;                                                
           WHEN (FANTINDV = 7)                                          
              INDEX = 8;                                                
           WHEN (FANTINDV = 8)                                          
              INDEX = 9;                                                
           WHEN (FANTINDV = 9)                                          
              INDEX = 10;                                               
           WHEN (FANTINDV = 10)                                         
              INDEX = 11;                                               
           WHEN (FANTINDV >= 11 & FANTINDV  <= 20)                      
              INDEX = 12;                                               
           WHEN (FANTINDV >= 21 & FANTINDV  <= 30)                      
              INDEX = 13;                                               
           WHEN (FANTINDV >= 31 & FANTINDV  <= 40)                      
              INDEX = 14;                                               
           WHEN (FANTINDV >= 41 & FANTINDV  <= 50)                      
              INDEX = 15;                                               
           OTHERWISE                                                    
              INDEX = 16;                                               
         END;                                                           
                                                                        
         TAB_PERSON(1).ANTAL = TAB_PERSON(1).ANTAL + 1;                 
         TAB_PERSON(INDEX).ANTAL = TAB_PERSON(INDEX).ANTAL + 1;         
                                                                        
         IF MAX_ANT_INDV < FANTINDV                                     
         THEN                                                           
            MAX_ANT_INDV = FANTINDV;                                    
                                                                        
 END OPTÆL_PERSON;                                                      
                                                                        
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH960;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ PERSONTABEL BQ00700T        '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER TIL CSC   B.H96110D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKREVET_LOAD;                               
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER           B.H96100D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
  END TOTALLISTE;                                                       
 /*********************************************************************/
 /*      UDSKRIV FEJLLISTE VEDR. KONSTATERET AFSTEMNINGFEJL PÅ ???    */
 /*********************************************************************/
 FEJLLISTE: PROC(FEJL);                                                 
                                                                        
 DCL     FEJL            CHAR      (01);                                
         CALL ZZ20390 ('*OPEN','BH34002Y');                             
         CALL ZZ20300(SIDELIN,'02');                                    
         CALL ZZ20300(OVERLIN1,'02');                                   
         OVERLIN2.CCA = ZZWS3;                                          
         OVERLIN2.TEKST1 = 'FEJLLISTE VEDR. MASKINEL AFSTEMNING';       
         CALL ZZ20300(OVERLIN2,'02');                                   
         IF FEJL = '1'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  =                                         
               'AFSTEMNINGSINDIVID MANGLER PÅ B.H96000D';               
               DETLIN1.ANTAL = '';                                      
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '2'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST = 'ANTAL LÆSTE INDIVIDER PÅ B.H96000D';    
               DETLIN1.ANTAL = TV.LÆS_BH960;                            
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST =                                          
               'ANTAL IFØLGE AFSTEMNINGSINDIVID IALT  :';               
               DETLIN1.ANTAL = BH960_ANT_INDV;                          
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
            SWFEJL = '1';                                               
 END FEJLLISTE;                                                         
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL_TEST: PROC;                                                   
         SQLKODE = SQLCA.SQLCODE;                                       
         CLOSE FILE (BH3400O);                                          
         CLOSE FILE (BH3402O);                                          
         CALL CLOSE_PERSONEJENDOMSOPL_TEST;                             
         CALL ZS67000(SQLCA);                                           
                                                                        
         ABENDMEDD = 'BH34000 ** 250 ' !! FEJLTEKST !! SQLKODE;         
                                                                        
         CALL ZS30101 (5, ABENDMEDD, 2);                                
                                                                        
 END SQL_FEJL_TEST;                                                     
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 LUK_PROG: PROC;                                                        
         CALL OPTÆL_PERSON;                /* SIDSTE PERSON OPTÆLLES */ 
         CALL TOTALLISTE;                                               
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH3400O),                                          
               FILE (BH3402O);                                          
         IF SWFEJL = '1'                                                
         THEN                                                           
            CALL ZS30101(4,'BH34000 ** 251 ' !!                         
                 'MASKINEL KONSTATERET AFSTEMNINGSFEJL',2);             
 END LUK_PROG;                                                          
         %INCLUDE BH30002M;                    /* CHAR10_TIL_FIX11    */
         %INCLUDE BH34001M;                    /* FLYT_TIL_HUS        */
         %INCLUDE BH34002M;                    /* FLYT_TIL_PERSON     */
         %INCLUDE BH34003M;                    /* DAN_DATA_TIL_SLUT   */
         %INCLUDE BH34010M;                    /* BEHANDELCSC         */
         %INCLUDE BH34020M;                    /* DAN_LOAD_TIL_PERS   */
         %INCLUDE BH34000M;    /* DECLARE OG FETCH SQL STATEMENTS.TEST*/
     /*  %INCLUDE BH34040M;                    /* BEREGN              */
         %INCLUDE BQ01905M;                    /* UDFØR_KONTROLLER    */
     /*  %INCLUDE BQ01906M;                    /* SKAF_BEVSGL         */
     /*  %INCLUDE BQ01907M;                  /* BEREGN_EVS_KMD_DEL  */  
 END  BH34000;                                                          
