  PROCESS OPT(TIME);                                                    
 BE85010: /* BEREGN EVS -> SLUT-2020-SAMMENLIGN.GRL. TIL FORSKUD 2021 */
 PROCEDURE (PTR1_INPUT,PTR2_INPUT,PTR3_INPUT,PTR4_INPUT,PTR5_INPUT,     
            BE60101M)                                                   
            REORDER;                                                    
 /*********************************************************************/
                                                                        
 DCL COPYRIGHT CHAR (30) STATIC INIT ('COPYRIGHT KMD A/S 2018');        
                                                                        
 /*********************************************************************/
 /*      PROGRAMMERET AF AAGE RASMUSSEN, PUS T&S AUG. 2000            */
 /*      ÅRSRULLET    AF AAGE RASMUSSEN, LSU T&S AUG. 2001            */
 /*      ÅRSRULLET    AF AAGE RASMUSSEN, LSU T&S AUG. 2002            */
 /*      ÅRSRULLET    AF AAGE RASMUSSEN, LSU T&S AUG. 2003            */
 /*      ÅRSRULLET    AF BO SCHMIDT    , LSU T&S AUG. 2004            */
 /*      ÅRSRULLET    AF SUSANNE VILLUMSEN       JUL. 2005            */
 /*      ÅRSRULLET    AF BO SCHMIDT              JUL. 2006            */
 /*      ÅRSRULLET    AF BO SCHMIDT              JUL. 2007            */
 /*      ÅRSRULLET    AF BO SCHMIDT              JUL. 2008            */
 /*      ÅRSRULLET    AF GERD HOLM-PEDERSEN      MAJ  2009            */
 /*      ÅRSRULLET    AF GERD HOLM-PEDERSEN      MAJ  2010            */
 /*      RULLET BR0->BR1 OG RUL                                       */
 /*      ÅRSRULLET    AF GERD HOLM-PEDERSEN      MAJ  2011            */
 /*      RULLET BR1->BR2 OG RUL                                       */
 /*      ÅRSRULLET    AF ESBEN BRODERSEN         JUNI 2012            */
 /*      RULLET BR2->BR3 OG RUL                                       */
 /*      ÅRSRULLET    AF ESBEN BRODERSEN         MAJ  2013            */
 /*      RULLET BR3->BR4 OG RUL                                       */
 /*      ÅRSRULLET    AF JØRGEN SAUGMANN         JUL  2014            */
 /*      RULLET BR4->BR5 OG RUL                                       */
 /*      RETTET       AF JØRGEN SAUGMANN         AUG  2014            */
 /*                   VED OPRETTELSE MÅ DER IKKE BEREGNES             */
 /*                   PENSIONISTNEDSLAG                               */
 /*      ÅRSRULLET    AF JØRGEN SAUGMANN         JUN  2015            */
 /*      RULLET BR5->BR6 OG RUL                                       */
 /*      ÅRSRULLET    AF ESBEN BRODERSEN         JUN  2016            */
 /*      RULLET BR6->BR7 OG RUL                                       */
 /*      Lene Maj Jensen QLE                     JUN 2016             */
 /*           Hårdkodet årstal fjernet.  Istedet benyttes cstopår     */
 /*           eller glslutår fra BH65300M                             */
 /*      Esben Brodersen                                              */
 /*           Rettet afvisning 5002 til at bruge CUOP = 6 #01         */
 /*                                                                   */
 /*      DB2OMLÆGNING                                                 */
 /*         Lene Maj Jensen  QLE                 MAR 2017             */
 /*         Beregningsbånd omlagt til DB2                             */
 /*                                                                   */
 /* Forskud 2018 Årsrullet BR7 -> BR8            JUN 2017             */
 /* SLUT 2017 KS02-39-01 Tilretning af felt 705  OKT 2017             */
 /*           CEANV lig 521 og 522 lagt ind                           */
 /* Forskud 2019 Årsrullet BR8 -> BR9            MAJ 2018             */
 /* Forskud 2020 Årsrullet BR9 -> BR0            APR 2019             */
 /* Boligydelse BOY er taget ud                                       */
 /* Nulstilling af 2001 grundlag når der ikke findes akt vurdering    */
 /* defect 256. Ændring af fejlnummer 5001 defect 253                 */
 /* Fejlnummer                                                        */
 /* Forskud 2021 Årsrullet BR0 -> BR1            MAR 2020             */
 /* defect 96 (F2021).  Opsæt fejlnummer 5197     Maj 2020            */
 /* defect 203 (F2021).                           Juni 2020           */
 /*           Hvis felt 158(CEJBEVS) er 0/4/C og 735 er 0 /NULL/blank */
 /*           skal der opsættes et fejlnummer 5200                    */
 /* defect 234 (F2021).                           Juni 2020           */
 /*           Hvis felt 158(CEJBEVS) er blank                         */
 /*           skal der opsættes et fejlnummer 5202                    */
 /* Nye felter med vurdrings oprindelse (VURMARK) sat ind Juli 2020   */
 /* defect 242 fejlnr 5014 er udkommenteret               august 2020 */
 /* defect 424 fejlnr 5200 skal ikke overskrives          august 2020 */
 /* Forskud 2022 Årsrullet BR1 -> BR2 okt. 2020                       */
 /* Forskud 2022 Mellemperioden      EDL                              */
 /*              Per Brunk PBR                            01.02.2021  */
 /*              Nye felter i BE77000T                                */
 /* Slut2021     Steen Pedersen/SEP                       Maj 2021    */
 /*              Nyt felt DATA_ID oprettet efter AFVIKLINGS_ID        */
 /*              Definitionen af BH65300M er fjernet, BH55300M kommer */
 /*              nu fra input til program.                            */
 /*              Esben Brodersen/EBD variabel vurderingsår Maj 2021   */
 /*              Rettelserne er markeret med ##                       */
 /*                                                                   */
 /* Forskud 2022 Ole Nielsen one                          Juni 2021   */
 /*              Def 763 og 764 afvisning 5204 identisk enhedsadrr    */
 /*              samme fejlnummer af listen til Forskud               */
 /*              som der fremgår af listen til SLUT (BE86010)         */
 /*              Ole Nielsen one                          Juni 2021   */
 /*              D528/D530 fejlnummer 5200 nu også 158=7              */
 /*              Og åbnet op for at udenlandsk ejendomme              */
 /*              kan få fejlnummer 5200                               */
 /* Forskud 2022 Esben Brodersen                          Juli 2021   */
 /*              Defect 775 afvisning 5196 justering                  */
 /* Forskud 2022 Per Brunk                                August 2021 */
 /*              Defect 974 Ej fejl 5008 hvis CBANV = 540             */
 /* Forskud 2024 Tina Carstens (TIC)                     2021        */ 
 /*              BF17 Kopieret fra BH85010                            */
 /*              Fjernet udgåede lovelementer                         */
 /* Forskud2023 Esben Brodersen                           Juni 2022   */
 /*             Defect 1060 KS 21 afvisning 5017                      */
 /* Forskud2025 Tina Carstens (TIC)                       Maj 2023    */
 /* Forskud2025 JXT BF17 ÆA39 Kontrol 5306 5322         01-09-2023    */
 /* Forskud2025 US1549422 JXT CÆGTOPR test              01-11-2023    */
 /* Forskud2025 US1546814 1657187 JXT 5306 5322 5324    29-01-2024    */
 /* Forskud2025 US1546814 1657187 JXT 5326              31-01-2024    */
 /*             Ejer død men BOBEHANDLING forsinket fra slut.         */
 /* Forskud2025 JJJ BE55600M erstatter BE55300M         20-06-2024    */
 /*********************************************************************/
 /*********************************************************************/
         DEFAULT RANGE (*) STATIC;                                      
 /*********************************************************************/
 /*      DECLARE AF POINTERE TIL INPUT                                */
 /*********************************************************************/
 DCL     PTR1_INPUT                 PTR;                                
 DCL     1 DCLBE75000T        BASED     (PTR1_INPUT),                   
       %INCLUDE BE7500TN;                                               
                                                                        
 DCL     PTR2_INPUT                 PTR;                                
 DCL     1 DCLBE76000T        BASED     (PTR2_INPUT),                   
       %INCLUDE BE7600TN;                                               
                                                                        
 DCL     PTR3_INPUT                 PTR;                                
 DCL     1 DCLBE77000T        BASED     (PTR3_INPUT),                   
       %INCLUDE BE7700TN;                                               
                                                                        
 DCL     PTR4_INPUT                 PTR;                                
 DCL     1 DCLBE78000T        BASED     (PTR4_INPUT),                   
       %INCLUDE BE7800TN;                                               
                                                                        
 DCL     PTR5_INPUT                 PTR;                                
 DCL     1 BE55600M           BASED     (PTR5_INPUT),                   
       %INCLUDE BE55600N;;                                              
                                                                        
 /* Nye til Forskud 2020 kode skal eventuelt flyttes til BE85000 */     
 DCL     ZS67000         ENTRY;                                         
 DCL     ZS30101         ENTRY;                                         
 EXEC SQL INCLUDE SQLCA;                                                
 /*EXEC SQL INCLUDE BE78000T;  /* EVS_RESULTAT (FORSKUD)        */      
                                                                        
 /*********************************************************************/
 /*      DECLARE AF DIVERSE                                           */
 /*********************************************************************/
                                                                        
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 DCL     MULTIPLY        BUILTIN;                                       
 DCL     HJVÆRDI         FIXED     (15,2);                              
 DCL     HJVÆRDI1        FIXED     (15,2);                              
 DCL     HJVÆRDI2        FIXED     (15,2);                              
 DCL     HJ_CSTOP_DATO_CH  CHAR    (8) BASED(ADDR(HJ_CSTOP_DATO_NUM));  
 DCL     HJ_CSTOP_DATO_NUM PIC    '(8)9';                               
 DCL     HJ_ANVÆND_DATO  FIXED     (9);                                 
                                                                        
 DCL     HJBEGRÆNSET_TP  CHAR      (1);                                 
                                                                        
 DCL     HJ_CPENSNEDGL   CHAR  (1);   /* PENSIONISTNEDSLAGSKODE SLUTÅR*/
 DCL     HJ_CEJBEVS_AND_ENH CHAR(1);/* FELT 158 BER. KODE ANDEN ENHED */
 DCL     HJ_CEJDTYPE     CHAR  (1);                                     
 DCL     HJVÆRDI_PNS     FIXED (13,3);                                  
 DCL     HJ_RES_RABATEJERANDEL DEC FIXED (5,2);                         
                                                                        
 DCL     1 BE60101M,                                                    
           %INCLUDE BE60101M;                                           
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF ABEND STRUKTUR m.v.                               */
 /*                                                                   */
 /*********************************************************************/
 DCL     ABENDKODE     FIXED       (2) INIT(5);                         
 DCL     1 ABENDMEDD,                                                   
          2 ABENDMODUL CHAR      (7) INIT ('BE85010'),                  
          2 ABENDFILL1 CHAR      (1) INIT (' '),                        
          2 ABENDMEDNR CHAR      (2) INIT ('**'),                       
          2 ABENDFILL2 CHAR      (1) INIT (' '),                        
          2 ABENDTXT   CHAR      (45);                                  
                                                                        
 DCL     ABENDRTKODE   FIXED     (1) INIT (2);                          
 /*********************************************************************/
 /*      P R O C E S S                                                */
 /*********************************************************************/
                                                                        
         IF DCLBE78000T.TILEVS_CPTYPSLUT > '0'                          
         THEN                                                           
            DCLBE78000T.TILFORSK_COPR_CPTYPSLUT = 'F';                  
                                                                        
         IF DCLBE78000T.TILEVS_CPTYPFOR > '0'                           
         THEN                                                           
            DCLBE78000T.TILFORSK_COPR_CPTYPFOR = 'F';                   
                                                                        
         IF FINDES_ESR_STAM_OPL &                                       
            DCLBE78000T.EJENDOM_CEJDTYPE > '0'                          
         THEN                                                           
            DCLBE78000T.TILFORSK_COPR_CEJDTYPE = 'E';                   
                                                                        
         IF DCLBE78000T.EKOMNR < 999 &                                  
            DCLBE78000T.VURD_A_CBENYT_AKT ^= '  '                       
         THEN                                                           
            DO;                                                         
              DCLBE78000T.EJENDOM_BEJDVÆR =                             
              DCLBE78000T.VURD_A_BEJDVÆR_AKT;                           
              DCLBE78000T.EJENDOM_BEJDVÆR_SW =                          
              DCLBE78000T.VURD_A_BEJDVÆR_A_SW;                          
              DCLBE78000T.EJENDOM_BEJBOL1 =                             
              DCLBE78000T.VURD_A_BEJBOL1_AKT;                           
              DCLBE78000T.EJENDOM_BEJBOL1_SW =                          
              DCLBE78000T.VURD_A_BEJBOL1_A_SW;                          
              DCLBE78000T.EJENDOM_CEJBOLTYP1 =                          
              DCLBE78000T.VURD_A_CEJBOLTYP1_AKT;                        
              DCLBE78000T.EJENDOM_BEJBOL2 =                             
              DCLBE78000T.VURD_A_BEJBOL2_AKT;                           
              DCLBE78000T.EJENDOM_BEJBOL2_SW =                          
              DCLBE78000T.VURD_A_BEJBOL2_A_SW;                          
              DCLBE78000T.EJENDOM_CEJBOLTYP2 =                          
              DCLBE78000T.VURD_A_CEJBOLTYP2_AKT;                        
            END;                                                        
                                                                        
 /*********************************************************************/
 /*      OPSÆTNING AF BEREGNINGSGRUNDLAG FOR AKTUEL EJER              */
 /*********************************************************************/
                                                                        
         SELECT;                                                        
                                                                        
           WHEN (DCLBE78000T.VURD_A_BBERGRL_A_SW = 0)                   
             DO;                                                        
               DCLBE78000T.TILFORSK_COPR_BBERGRL = 'E';                 
               DCLBE78000T.TILFORSK_COPR_BBER2FAM = 'E';                
                                                                        
               /* Aktuel Årsvurdering                                 */
               DCLBE78000T.EJERSKAB_BBERGRL      =                      
                                     DCLBE78000T.VURD_A_BBERGRL_AKT;    
               DCLBE78000T.EJERSKAB_BBERGRL_SW   = 0;                   
               DCLBE78000T.EJERSKAB_VURMARK      =                      
                                     DCLBE78000T.VURD_A_VURMARK_AKT;    
               DCLBE78000T.EJERSKAB_BBER2FAM     =                      
                                     DCLBE78000T.VURD_A_BBER2FAM_AKT;   
               DCLBE78000T.EJERSKAB_BBER2FAM_SW  =                      
                                     DCLBE78000T.VURD_A_BBER2FAM_A_SW;  
               DCLBE78000T.EJERSKAB_BEJBOLANV    =                      
                                     DCLBE78000T.VURD_A_BEJBOLANV_AKT;  
               DCLBE78000T.EJERSKAB_BEJBOLANV_SW =                      
                                     DCLBE78000T.VURD_A_BEJBOLANV_A_SW; 
               DCLBE78000T.EJERSKAB_CANVEBOL     =                      
                                     DCLBE78000T.VURD_A_CANVEBOL_AKT;   
               DCLBE78000T.EJERSKAB_CBERGROP     = 'I';                 
               DCLBE78000T.EJERSKAB_JUR_KATEGO   =                      
                                     DCLBE78000T.VURD_A_JUR_KATEGO;     
               DCLBE78000T.EJERSKAB_JUR_UKATEGO  =                      
                                     DCLBE78000T.VURD_A_JUR_UKATEGO;    
               DCLBE78000T.EJERSKAB_JUR_VURDATO  =                      
                                     DCLBE78000T.VURD_A_VURDATO;        
               DCLBE78000T.EJERSKAB_FORSIGT_EVS =                       
                                     DCLBE78000T.VURD_A_FORSIGT_EVS;    
               DCLBE78000T.EJERSKAB_BESKAT      =                       
                                     DCLBE78000T.VURD_A_BESKAT_EVS ;    
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
             END;                                                       
         END;  /* SELECT */                                             
                                                                        
         CALL OPSÆT_FEJLNR; /*SAMT CEJBEVS OG CBERGRL*/                 
                                                                        
         IF DCLBE78000T.TILEVS_CEJBEVS = '7' !                          
            DCLBE78000T.TILEVS_CEJBEVS = '8' !                          
            DCLBE78000T.TILEVS_CEJBEVS = '9' !                          
            DCLBE78000T.TILEVS_CEJBEVS = 'B' !                          
            DCLBE78000T.TILEVS_CEJBEVS = 'C'                            
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
              IF DCLBE78000T.FEJLNR = 0        /* DENNE EJENDOM KAN */  
              THEN                             /* ÅBENBART BEREGNES */  
                 DCLBE78000T.TILEVS_CEJBEVS = '0';                      
              ELSE                                                      
                IF DCLBE78000T.EKOMNR < 999 &                           
                   DCLBE78000T.TILEVS_CINVPNR = '0' &                   
                   DCLBE77000T.EVSSEJ_DCPRN > 0 &                       
                   DCLBE77000T.EVSSEJ_SID_CSLET < '1' &                 
                   DCLBE77000T.EVSSEJ_SID_DAFSTAA = 0 &                 
                  (DCLBE77000T.EVSSEJ_SID_CEJBEVS = '0' !               
                   DCLBE77000T.EVSSEJ_SID_CEJBEVS = '4' !               
                   DCLBE77000T.EVSSEJ_SID_CEJBEVS = '5' !               
                   DCLBE77000T.EVSSEJ_SID_CEJBEVS = '6') &              
                   DCLBE78000T.TILEVS_CÆGTOPR = ' '  /*US1549422 JXT*/  
                THEN                           /* KAN MÅSKE BEREGNES */ 
                   DO;                                                  
                     IF DCLBE78000T.FEJLNR = 5001 !                     
                        DCLBE78000T.FEJLNR = 5002 !                     
                        DCLBE78000T.FEJLNR = 5003 !                     
                        DCLBE78000T.FEJLNR = 5004 !                     
                        DCLBE78000T.FEJLNR = 5017 !                     
                        DCLBE78000T.FEJLNR = 5020 !                     
                        DCLBE78000T.FEJLNR = 5024 !                     
                        DCLBE78000T.FEJLNR = 5025 !                     
                        DCLBE78000T.FEJLNR = 5059 !                     
                        DCLBE78000T.FEJLNR = 5060 !                     
                        DCLBE78000T.FEJLNR = 5155 !                     
                        DCLBE78000T.FEJLNR = 5164 !  /* SLUT 20 */      
                        DCLBE78000T.FEJLNR = 5180 !                     
                        DCLBE78000T.FEJLNR = 5181 !                     
                        DCLBE78000T.FEJLNR = 5184 !                     
                        DCLBE78000T.FEJLNR = 5185 !   /* KS02-23*/      
                        DCLBE78000T.FEJLNR = 5186 !   /* KS02-23*/      
                        DCLBE78000T.FEJLNR = 5187 !   /* KS02-23*/      
                        DCLBE78000T.FEJLNR = 5189 !   /* KS02-34*/      
                        DCLBE78000T.FEJLNR = 5195 !   /* KS02-34*/      
                        DCLBE78000T.FEJLNR = 5196 !   /* KS02-34*/      
                        DCLBE78000T.FEJLNR = 5198 !   /* KS02-34*/      
                        DCLBE78000T.FEJLNR = 5200 !                     
                        DCLBE78000T.FEJLNR = 5204 !   /* SLUT 20 D735 */
                        DCLBE78000T.FEJLNR = 5206 !   /* SLUT 20 */     
                        DCLBE78000T.FEJLNR = 5322 !   /* US1546814 */   
                        DCLBE78000T.FEJLNR = 5324 !   /* US1546814 */   
                        DCLBE78000T.FEJLNR = 5326 !   /* US1546814 */   
                        DCLBE78000T.EJERSKAB_BBERGRL_SW = -1 !          
                      ((DCLBE78000T.EJENDOM_CEJDTYPE = '4' !            
                        DCLBE78000T.EJENDOM_CEJDTYPE = '5') &           
                        DCLBE78000T.EJERSKAB_BBER2FAM_SW = -1)          
                     THEN;                                              
                     ELSE                                               
                        DO;                                             
                          DCLBE78000T.TILEVS_CDATAFRA = '1';            
                          DCLBE78000T.TILEVS_CEJBEVS = '0';             
                          DCLBE78000T.FEJLNR = 0;                       
                        END;                                            
                   END;                                                 
            END;                                                        
                                                                        
         IF DCLBE78000T.TILEVS_CEJBEVS ^= ' '                           
         THEN                                                           
            DCLBE78000T.TILFORSK_COPR_CEJBEVS = 'E';                    
                                                                        
         IF DCLBE78000T.EJERSKAB_BBERGRL_SW = 0                         
         THEN                                                           
            DCLBE78000T.TILFORSK_COPR_BBERGRL = 'E';                    
                                                                        
         IF DCLBE78000T.EJERSKAB_BBER2FAM_SW = 0                        
         THEN                                                           
            DCLBE78000T.TILFORSK_COPR_BBER2FAM = 'E';                   
                                                                        
         DCLBE78000T.TILEVS_CNEDSL2 = ' ';                              
                                                                        
         /* Ændret for ejendomstype = 4 EBD 20190905 */                 
         IF DCLBE78000T.TILEVS_CNEDSL1 >= '10' &                        
            DCLBE78000T.TILEVS_CNEDSL1 <  '30'                          
         THEN                                                           
            DO;                                                         
               /* DAN KODE FOR 4 PROMILLE NEDSLAG (TIDL. STDFRADRAG.) */
               SELECT;                                                  
                 WHEN (DCLBE78000T.TILEVS_CFRED = '1')                  
                    DCLBE78000T.TILEVS_CNEDSL2 = '3';                   
                 WHEN (DCLBE78000T.EJENDOM_CEJDTYPE = '4')              
                   DO;                                                  
                     IF DCLBE78000T.TILEVS_CEJBEVS = '0' !              
                        DCLBE78000T.TILEVS_CEJBEVS = '4'                
                     THEN                                               
                       DO;                                              
                         IF HENT_CEJBEVS_ANDEN_ENHED = 'C'              
                         THEN                                           
                           DCLBE78000T.TILEVS_CNEDSL2 = '4';            
                         ELSE                                           
                           DCLBE78000T.TILEVS_CNEDSL2 = '5';            
                       END;                                             
                     IF DCLBE78000T.TILEVS_CEJBEVS = 'B' !              
                        DCLBE78000T.TILEVS_CEJBEVS = '7'                
                     THEN                                               
                       DO;                                              
                         DCLBE78000T.TILEVS_CNEDSL2 = '0';              
                       END;                                             
                   END;                                                 
                 WHEN (DCLBE78000T.EJENDOM_CEJDTYPE = '5')              
                    DCLBE78000T.TILEVS_CNEDSL2 = '4';                   
                 WHEN (DCLBE78000T.EJENDOM_CEJDTYPE = '7' !             
                       DCLBE78000T.EJENDOM_CEJDTYPE = '8')              
                    DCLBE78000T.TILEVS_CNEDSL2 = '2';                   
                 OTHERWISE                                              
                    DCLBE78000T.TILEVS_CNEDSL2 = '1';                   
               END;                                                     
            END;                                                        
                                                                        
 /*********************************************************************/
 /*      REGULERING AF BEREGNINGSGRUNDLAG FOR ???? MED ÅRETS PCT.     */
 /*      HUSK AT HJ_PCT SKAL INDEHOLDE AKTUEL VÆRDI, SAMT AT          */
 /*      HJ_VÆRDI SKAL INDEHOLDE AKTUELT BEREGNINGSGRUNDLAG.          */
 /*********************************************************************/
 REGULER_GRUNDLAG:                                                      
 PROC(HJ_VÆRDI,HJ_PCT);                                                 
                                                                        
 DCL     HJ_VÆRDI         FIXED     (15,2);                             
 DCL     HJ_PCT           FIXED     (5,4);                              
                                                                        
      HJ_VÆRDI = MULTIPLY(HJ_VÆRDI,HJ_PCT,13,0);                        
                                                                        
 END REGULER_GRUNDLAG;                                                  
 /*********************************************************************/
 /*      OPSÆT CEJBEVS (BEREGNINGSKODE), FEJLNR M.V. TIL EVS FORSKUD  */
 /*      FOR BEREGNING AF EVS SLUT SOM IKKE ER KENDT NÅR EVS FORSKUD  */
 /*      SKAL BEREGNES                                                */
 /*      HVIS DER INDFØRES NY FEJLNUMMER I EVS SLUT SKAL DET OVERVEJES*/
 /*      OM DE SKAL TILFØJES HER.                                     */
 /*********************************************************************/
 OPSÆT_FEJLNR: PROC;                                                    
                                                                        
         /* FEJLNR. 5007,5008 OG/ELLER 5009 SKAL ALTID OPSÆTTES */      
         /* TO GANGE IDET DE BEVIRKER NULSTILLING AF DIVERSE    */      
         /* BEREGNINGSGRUNDLAG SÅ DISSE IKKE BENYTTES VED EVT.  */      
         /* SENERE OPRETTEDE EJERE.                             */      
                                                                        
         SELECT;                                                        
                                                                        
           WHEN (( DCLBE78000T.TILEVS_A_V_CBENYT = '06' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '07' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '13' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '34' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '03' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '04' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '23' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '24' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '31' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '33' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '43' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '44' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '49' ) &             
                   DCLBE78000T.TILEVS_A_V_CBANV ^= '540' )   /*D974*/   
             DO;                                                        
                IF (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0               
                THEN                                                    
                   DCLBE78000T.FEJLNR = 5008;                           
             END;                                                       
                                                                        
           WHEN (((DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_9) > 1) &             
                   DCLBE78000T.EJERSKAB_BBERGRL_SW = -1)                
             DO;                                                        
                DCLBE78000T.FEJLNR = 5007;                              
             END;                                                       
                                                                        
           WHEN (( DCLBE78000T.TILEVS_A_V_CBENYT = '02' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '05' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '22' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '42' ) &             
                   DCLBE78000T.TILEVS_A_V_CBANV ^= '540' )   /*D974*/   
             DO;                                                        
                IF (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0               
                THEN                                                    
                   DCLBE78000T.FEJLNR = 5008;                           
             END;                                                       
                                                                        
           WHEN (((DCLBE78000T.TILEVS_A_V_CBENYT = '02' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '22' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '42' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2)) &                 
                   DCLBE78000T.EJERSKAB_BBERGRL_SW = -1)                
             DO;                                                        
                DCLBE78000T.FEJLNR = 5009;                              
             END;                                                       
                                                                        
           WHEN (((DCLBE78000T.TILEVS_A_V_CBENYT = '01' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '41' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '45' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2))   &               
                   DCLBE78000T.TILEVS_A_V_CBANV ^= '540' )   /*D974*/   
             DO;                                                        
                IF (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0               
                THEN                                                    
                   DCLBE78000T.FEJLNR = 5008;                           
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF DCLBE78000T.FEJLNR = 5007 !                                 
            DCLBE78000T.FEJLNR = 5008 !                                 
            DCLBE78000T.FEJLNR = 5009                                   
         THEN                                                           
            DO;                                                         
               DCLBE78000T.EJERSKAB_CBERGROP = ' ';                     
            // DCLBE78000T.EJERSKAB_CBERGRGLOP = ' ';                   
               DCLBE78000T.EJENDOM_CBERGRL = '9';                       
                                                                        
               DCLBE78000T.EJERSKAB_BBERGRL = 0;                        
               DCLBE78000T.EJERSKAB_BBERGRL_SW = -1;                    
               DCLBE78000T.EJERSKAB_BBER2FAM = 0;                       
               DCLBE78000T.EJERSKAB_BBER2FAM_SW = -1;                   
               DCLBE78000T.EJERSKAB_BEJBOLANV = 0;                      
               DCLBE78000T.EJERSKAB_BEJBOLANV_SW = -1;                  
               DCLBE78000T.EJERSKAB_CANVEBOL = ' ';                     
                                                                        
               DCLBE78000T.VURD_A_BBERGRL_AKT = 0;                      
               DCLBE78000T.VURD_A_BBERGRL_A_SW = -1;                    
               DCLBE78000T.VURD_A_BBER2FAM_AKT = 0;                     
               DCLBE78000T.VURD_A_BBER2FAM_A_SW = -1;                   
               DCLBE78000T.VURD_A_CBERGRL_AKT = '9';                    
               DCLBE78000T.VURD_A_BEJBOLANV_AKT = 0;                    
               DCLBE78000T.VURD_A_BEJBOLANV_A_SW = -1;                  
               DCLBE78000T.VURD_A_CANVEBOL_AKT = ' ';                   
            END;                                                        
                                                                        
         IF (DCLBE78000T.TILEVS_CEJBEVS = '7' !                         
             DCLBE78000T.TILEVS_CEJBEVS = '8' !                         
             DCLBE78000T.TILEVS_CEJBEVS = '9' !                         
             DCLBE78000T.TILEVS_CEJBEVS = 'B' !                         
             DCLBE78000T.TILEVS_CEJBEVS = 'C') &                        
             DCLBE76000T.CCIVS ^= 'D'                                   
         THEN                                                           
            DO;                                                         
               /* CEJBEVS 7,8 OG 9 SKAL BEVARES  U D E N  FEJLNR. */    
               DCLBE78000T.FEJLNR = 0;                                  
               RETURN;                                                  
            END;                                                        
                                                                        
         /* NB. HEREFTER STARTER DEN 'NORMALE' OPSÆTNING AF */          
         /* FEJLNUMRE (OGSÅ FEJLNUMRENE 5007, 5008 OG 5009. */          
                                                                        
         SELECT;                                                        
                                                                        
           WHEN ( DCLBE78000T.TILEVS_CINVPNR ^= '0' )                   
             DO;                                                        
                DCLBE78000T.FEJLNR = 5020;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_EJ_CEJFORH = '50' !              
                  DCLBE78000T.TILEVS_A_EJ_CEJFORH = '60' !              
                  DCLBE78000T.TILEVS_A_EJ_CEJFORH = '70' !              
                  DCLBE78000T.TILEVS_A_EJ_CEJFORH = '80' )              
                   /* EJEREN ER OFFENTLIG D.V.S. KOMM./AMT/STAT */      
             DO;                                                        
                DCLBE78000T.FEJLNR = 5020;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_CBENYT = '09' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '17' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '98' )                
             DO;                                                        
                DCLBE78000T.FEJLNR = 5001;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE76000T.CCIVS = 'D' !         /* EJER ER DØD */   
                  DCLBE77000T.EVSSEJ_FST_CIVILSTAND = 'D' !             
                  DCLBE77000T.EVSSEJ_SID_CIVILSTAND = 'D' !             
                  DCLBE77000T.EVSSEJ_FST_FEJLNR = '5004' !              
                 (DCLBE77000T.EVSSEJ_FST_FEJLNR = '5027' &              
                  DCLBE76000T.DCPRN = 0) )             /* EJER ER DØD */
             DO;                                                        
                DCLBE78000T.FEJLNR = 5004;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_CBENYT = '03' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '04' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '23' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '24' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '31' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '33' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '43' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '44' !                
                  DCLBE78000T.TILEVS_A_V_CBENYT = '49' )                
             DO;                                                        
                IF (DCLBE77000T.EVSSEJ_SID_CEJBEVS = '0' !              
                    DCLBE77000T.EVSSEJ_SID_CEJBEVS = '4' !              
                    DCLBE77000T.EVSSEJ_SID_CEJBEVS = '5' !              
                    DCLBE77000T.EVSSEJ_SID_CEJBEVS = '6') &             
                    DCLBE77000T.EVSSEJ_SID_CSLET < '1' &                
                    DCLBE77000T.EVSSEJ_SID_CEJBEVS < '9' &              
                    DCLBE77000T.EVSSEJ_SID_DAFSTAA = 0 &                
                    DCLBE77000T.EVSSEJ_SID_DFRAFLYT = 0 &               
                                                     /*US1549422 JXT*/  
                    DCLBE77000T.EVSSEJ_SID_CÆGTOPR = ' ' &              
                   (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) > 0               
                THEN;                                                   
                ELSE                                                    
                   DO;                                                  
                      DCLBE78000T.FEJLNR = 5001;                        
                      DCLBE78000T.TILEVS_CEJBEVS = '1';                 
                   END;                                                 
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_ANT_FOR_2 > 0 )                
             DO;                                                        
                DCLBE78000T.FEJLNR = 5003;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
                DCLBE78000T.EJERSKAB_BBERGRL = 0;                       
                DCLBE78000T.EJERSKAB_BBERGRL_SW = -1;                   
                DCLBE78000T.EJENDOM_CBERGRL = '9';                      
             END;                                                       
                                                                        
           WHEN ( DCLBE75000T.OPL_VURDGL_CUOP = '5' )   /*FORSKUD06*/   
             DO;                                                        
                DCLBE78000T.FEJLNR = 5025;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_FLEJL > 2 &                    
                 (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0 &               
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_1 > 2 )                
             DO;                                                        
                DCLBE78000T.FEJLNR = 5003;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
                DCLBE78000T.EJERSKAB_BBERGRL = 0;                       
                DCLBE78000T.EJERSKAB_BBERGRL_SW = -1;                   
                DCLBE78000T.EJERSKAB_BBER2FAM = 0;                      
                DCLBE78000T.EJERSKAB_BBER2FAM_SW = -1;                  
                DCLBE78000T.EJENDOM_CBERGRL = '9';                      
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_FLEJL > 2 &                    
                 (DCLBE78000T.TILEVS_A_V_ANT_FOR_1 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0 )               
             DO;                                                        
                DCLBE78000T.FEJLNR = 5024;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_FLEJL > 2 &                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_1 = 0 &                
                 (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                    
                  DCLBE78000T.TILEVS_A_V_ANT_FOR_9) > 2 )               
             DO;                                                        
                DCLBE78000T.FEJLNR = 5024;                              
                DCLBE78000T.TILEVS_CEJBEVS = '1';                       
             END;                                                       
                                                                        
       /* Kode ændret i forbindelse med variabel vurderingsår ##EBD */  
           WHEN ( DCLBE78000T.TILEVS_A_V_CBENYT = '  ' !                
                 (DCLBE78000T.TILEVS_A_V_DVURDÅR ^= BE55600M.INDKÅR1 &  
                  DCLBE78000T.TILEVS_A_V_DVURDÅR ^= BE55600M.GLSLUTÅR1))
             DO;                                                        
                SELECT;                                                 
                  WHEN ( DCLBE75000T.OPL_VURDGL_CBENYT = '09' !         
                         DCLBE75000T.OPL_VURDGL_CBENYT = '17' !         
                         DCLBE75000T.OPL_VURDGL_CBENYT = '98' !         
                         DCLBE75000T.OPL_GL_CBENYT = '09'     !         
                         DCLBE75000T.OPL_GL_CBENYT = '17'     !         
                         DCLBE75000T.OPL_GL_CBENYT = '98' )             
                    DO;                                                 
                       DCLBE78000T.FEJLNR = 5001;                       
                       DCLBE78000T.TILEVS_CEJBEVS = '1';                
                    END;                                                
                  WHEN ( DCLBE75000T.OPL_FLEJL > 2 )                    
                    DO;                                                 
                       DCLBE78000T.FEJLNR = 5024;                       
                       DCLBE78000T.TILEVS_CEJBEVS = '1';                
                    END;                                                
                  OTHERWISE                                             
                    DO;                                                 
                       DCLBE78000T.FEJLNR = 5019;                       
                       DCLBE78000T.EJERSKAB_BBERGRL = 0;                
                       DCLBE78000T.EJERSKAB_BBERGRL_SW = -1;            
                       DCLBE78000T.EJENDOM_CBERGRL = '9';               
                       DCLBE78000T.TILEVS_CEJBEVS = '2';                
                    END;                                                
                END;                                                    
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_CBENYT = '45' &                
                  DCLBE78000T.TILEVS_A_V_FLEJL = 0 )                    
             DO;                                                        
                DCLBE78000T.FEJLNR = 5006;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_CBENYT = '29' &                
                  DCLBE78000T.TILEVS_A_V_FLEJL ^= 1 )                   
             DO;                                                        
                DCLBE78000T.FEJLNR = 5005;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           WHEN (((DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                   
                   DCLBE78000T.TILEVS_A_V_ANT_FOR_9) > 1) &             
                  (DCLBE78000T.FEJLNR = 5007 !                          
                   DCLBE78000T.FEJLNR = 5009))                          
                /* D.V.S. AT DCLBE78000T.EJERSKAB_BBERGRL_SW = -1 */    
             DO;                                                        
                DCLBE78000T.FEJLNR = 5007;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           WHEN (( DCLBE78000T.TILEVS_A_V_CBENYT = '02' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '05' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '07' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '22' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '42' ) &             
                   DCLBE78000T.TILEVS_A_V_CBANV ^= '540' )   /*D974*/   
             DO;                                                        
                IF (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0               
                THEN                                                    
                   DO;                                                  
                      IF DCLBE78000T.TILEVS_A_EJ_DINDFLYT > 0           
                       & DCLBE78000T.TILEVS_A_EJ_DINDFLYT <=            
                                                DCLBE76000T.DRGNÅRTIL   
                      THEN                                              
                         DO;                                            
                           DCLBE78000T.FEJLNR = 5008;                   
                           DCLBE78000T.TILEVS_CEJBEVS = '2';            
                         END;                                           
                      ELSE                                              
                      IF DCLBE78000T.TILEVS_A_EJ_DFRAFLYT > 0           
                       & DCLBE78000T.TILEVS_A_EJ_DFRAFLYT >=            
                                               DCLBE76000T.DRGNÅRFRA    
                      THEN                                              
                         DO;                                            
                           DCLBE78000T.FEJLNR = 5008;                   
                           DCLBE78000T.TILEVS_CEJBEVS = '2';            
                         END;                                           
                      ELSE                                              
                         DO;                                            
                           DCLBE78000T.FEJLNR = 5155;                   
                           DCLBE78000T.TILEVS_CEJBEVS = '1';            
                         END;                                           
                   END;                                                 
             END;                                                       
                                                                        
           WHEN (((DCLBE78000T.TILEVS_A_V_CBENYT = '02' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '22' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '42' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2)) &                 
                  (DCLBE78000T.FEJLNR = 5007 !                          
                   DCLBE78000T.FEJLNR = 5009))                          
                /* D.V.S. AT DCLBE78000T.EJERSKAB_BBERGRL_SW = -1 */    
             DO;                                                        
                DCLBE78000T.FEJLNR = 5009;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           WHEN (((DCLBE78000T.TILEVS_A_V_CBENYT = '01' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '41' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2) !                  
                  (DCLBE78000T.TILEVS_A_V_CBENYT = '45' &               
                   DCLBE78000T.TILEVS_A_V_FLEJL = 2))   &               
                   DCLBE78000T.TILEVS_A_V_CBANV ^= '540' )   /*D974*/   
             DO;                                                        
                IF (DCLBE78000T.TILEVS_A_V_ANT_FOR_1 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0               
                THEN                                                    
                   DO;                                                  
                      DCLBE78000T.FEJLNR = 5008;                        
                      DCLBE78000T.TILEVS_CEJBEVS = '2';                 
                   END;                                                 
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_CBENYT = '25' )                
             DO;                                                        
                IF DCLBE78000T.TILEVS_A_V_CEJERL = '1'                  
                                            /* D.V.S. ER UDLEJET */     
                THEN                                                    
                  DO;                                                   
                   /* Forskud 2021 opsæt fejlnr 5014 fjernet PBR D242 */
                   /*  DCLBE78000T.FEJLNR = 5014;                     */
                   /*  DCLBE78000T.TILEVS_CEJBEVS = '1';              */
                  END;                                                  
                ELSE /*Forskud 2017-KRAV 3201 CEANV */                  
                  DO;                                                   
                    IF (DCLBE75000T.OPL_CEANV = '150' !  /*KOLLEGIUM*/  
                        DCLBE75000T.OPL_CEANV = '510' !  /*SOMMERHUS*/  
                        DCLBE75000T.OPL_CEANV = '520' !  /*FERIEBYGN */ 
                        DCLBE75000T.OPL_CEANV = '521' !  /*FERIECENTER*/
                        DCLBE75000T.OPL_CEANV = '522') & /*FERIELEJL.*/ 
                        DCLBE78000T.EJERSKAB_BBERGRL_SW = 0             
                    THEN                                                
                      DO; /*SKAL IKKE AFVISES*/                         
                      END;                                              
                    ELSE                                                
                      DO;                                               
                        IF DCLBE78000T.TILEVS_A_V_BEJDVÆR <= 25000      
                        THEN                                            
                          DCLBE78000T.FEJLNR = 5010;                    
                        ELSE                                            
                          DCLBE78000T.FEJLNR = 5011;                    
                        DCLBE78000T.TILEVS_CEJBEVS = '3';               
                      END;                                              
                  END;                                                  
             END;                                                       
                                                                        
           WHEN (( DCLBE78000T.TILEVS_A_V_CBENYT = '06' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '07' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '13' !               
                   DCLBE78000T.TILEVS_A_V_CBENYT = '34')  &             
                   DCLBE78000T.TILEVS_A_V_CBANV ^= '540' )   /*D974*/   
             DO;                                                        
                IF (DCLBE78000T.TILEVS_A_V_ANT_FOR_4 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_5 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_6 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_8 +                  
                    DCLBE78000T.TILEVS_A_V_ANT_FOR_9) = 0               
                THEN                                                    
                   DO;                                                  
                      DCLBE78000T.FEJLNR = 5008;                        
                      DCLBE78000T.TILEVS_CEJBEVS = '1';                 
                   END;                                                 
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF (DCLBE78000T.FEJLNR = 5010 !                                
             DCLBE78000T.FEJLNR = 5011) &                               
           ((DCLBE77000T.EVSSEJ_SID_CEJBEVS = '0' !                     
             DCLBE77000T.EVSSEJ_SID_CEJBEVS = '4' !                     
             DCLBE77000T.EVSSEJ_SID_CEJBEVS = '5' !                     
             DCLBE77000T.EVSSEJ_SID_CEJBEVS = '6') &                    
             DCLBE77000T.EVSSEJ_SID_CSLET < '1') &                      
             DCLBE78000T.EJERSKAB_BBERGRL_SW = 0                        
         THEN                                                           
            DCLBE78000T.FEJLNR = 0;                                     
                                                                        
         IF DCLBE78000T.FEJLNR ^= 0                                     
         THEN                                                           
            RETURN;                                                     
                                                                        
         SELECT;                                                        
           WHEN ( DCLBE78000T.TILEVS_A_V_BEJDVÆR < 0 )                  
             DO;                                                        
                DCLBE78000T.FEJLNR = 5016;                              
                DCLBE78000T.TILEVS_CEJBEVS = '3';                       
                DCLBE78000T.EJERSKAB_BBERGRL = 0;                       
                DCLBE78000T.EJERSKAB_BBERGRL_SW = -1;                   
                DCLBE78000T.EJENDOM_CBERGRL = '9';                      
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF DCLBE78000T.FEJLNR ^= 0                                     
         THEN                                                           
            RETURN;                                                     
                                                                        
         SELECT;                                                        
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_EJ_FEJER = 1 &                   
                  DCLBE78000T.EENHEDLBNR = 0 &   /* F23  defect 1060 */ 
                 (DCLBE78000T.TILEVS_A_EJ_GANE > 10000 !                
                 (DCLBE78000T.TILEVS_A_EJ_GANE > 0 &                    
                  DCLBE78000T.TILEVS_A_EJ_GANE < 10000)) )              
             DO;                                                        
                DCLBE78000T.FEJLNR = 5017;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_A_EJ_FEJER = 2 &                   
                  DCLBE78000T.EENHEDLBNR = 0 &   /* F23  defect 1060 */ 
                 (DCLBE78000T.TILEVS_A_EJ_GANE = 0 !                    
                 (DCLBE78000T.TILEVS_A_EJ_CEJ_100 ^= '1' &              
                  DCLBE78000T.TILEVS_A_EJ_CEJ_100 ^= '2')) )            
             DO;                                                        
                DCLBE78000T.FEJLNR = 5017;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
       /* 5059 Ejerskabet er overført fra EVS-SLUT  og */               
       /*  ejerskabet i EVS-SLUT mangler ejerandel,    */               
       /*  1/7-98 kode eller persontype 2008           */               
       /*  ejeren ikke ejer ejendommen ifølge ESR.     */               
                                                                        
       /* Betingelser for fejlnummer 5059 er omlagt i forbindelse med */
       /* DB2 omlægningen da der altid vil findes en mandtals række   */
       /* F angiver at mandtallet er fiktivt */                         
                                                                        
           WHEN ( DCLBE76000T.DB2FUNKTION = 'F' &  /* EJER EJ PÅ MT  */ 
                  DCLBE78000T.TILEVS_A_EJ_DCPRCIR > 0 )                 
                                                  /* EJER JVF. ESR  */  
             DO;                                  /* ELLER OPRETTET */  
                DCLBE78000T.FEJLNR = 5059;        /* P.G.A. GL. SLUT*/  
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           WHEN ( DCLBE78000T.TILEVS_C5060 = '5060' &                   
                 (DCLBE77000T.EVSSEJ_SID_GPCTEJER = 0 !                 
                  DCLBE77000T.EVSSEJ_SID_CNEDSL1 = '  ' !               
                  DCLBE77000T.EVSSEJ_SID_CPTYPSLUT = ' ') )             
             DO;                                                        
                /* EJER OPRETTET MANGELFULDT P.G.A. GL. SLUT */         
                DCLBE78000T.FEJLNR = 5059;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           /* KS30 Forskud 2017 afvisning 5164 */                       
           WHEN (DCLBE78000T.TILEVS_CENKE = '5'  &                      
                 DCLBE78000T.TILEVS_HJ_67 ^= '1'  &                     
                 DCLBE77000T.EVSSEJ_SID_CSLET < '1' &                   
                 ER_BEGRÆNSET_SKATTEPLIGTIG = NEJ)                      
             DO;                                                        
                DCLBE78000T.FEJLNR = 5164;                              
                DCLBE78000T.TILEVS_CEJBEVS = '2';                       
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF DCLBE78000T.FEJLNR = 5017 &                                 
            DCLBE77000T.EVSSEJ_DCPRN > 0 &                              
          ((DCLBE77000T.EVSSEJ_SID_CEJBEVS = '0' !                      
            DCLBE77000T.EVSSEJ_SID_CEJBEVS = '4' !                      
            DCLBE77000T.EVSSEJ_SID_CEJBEVS = '5' !                      
            DCLBE77000T.EVSSEJ_SID_CEJBEVS = '6') &                     
            DCLBE77000T.EVSSEJ_SID_CSLET < '1') &                       
            DCLBE78000T.EJERSKAB_BBERGRL_SW = 0 &                       
            DCLBE78000T.TILEVS_DOVTG < DCLBE76000T.DRGNÅRFRA &          
            DCLBE77000T.EVSSEJ_SID_GPCTEJER_SW = 0 &                    
           (DCLBE78000T.TILEVS_GPCTEJER_SW = -1 !                       
           (DCLBE78000T.TILEVS_GPCTEJER ^=                              
            DCLBE77000T.EVSSEJ_SID_GPCTEJER))                           
         THEN                                                           
            DO;                                                         
               DCLBE78000T.TILEVS_GPCTEJER =                            
               DCLBE77000T.EVSSEJ_SID_GPCTEJER;                         
               DCLBE78000T.TILEVS_GPCTEJER_SW = 0;                      
               DCLBE78000T.TILFORSK_COPR_GPCTEJER = 'S';                
               DCLBE78000T.TILEVS_CDATAFRA = '3';                       
               DCLBE78000T.FEJLNR = 0;                                  
            END;                                                        
                                                                        
                                                                        
         /* Defect 203                                              */  
         /* Hvis felt 158(CEJBEVS) er 0/4/C og 735 er 0 /NULL/blank */  
         /* skal der opsættes et fejlnummer 5200                    */  
         IF ((DCLBE78000T.TILEVS_CEJBEVS = '0' !                        
              DCLBE78000T.TILEVS_CEJBEVS = '4' !                        
              DCLBE78000T.TILEVS_CEJBEVS = '7' !      // D528/530       
              DCLBE78000T.TILEVS_CEJBEVS = 'A' !      // D960           
              DCLBE78000T.TILEVS_CEJBEVS = 'C') &                       
             (DCLBE78000T.TILEVS_GPCTEJER = 0  !                        
              DCLBE78000T.TILEVS_GPCTEJER_SW = -1)   )                  
         THEN                                                           
           DO;                                                          
             DCLBE78000T.FEJLNR = 5200;                                 
             DCLBE78000T.TILEVS_CEJBEVS = '2'; /* EBD 13/8-2021 */      
           END;                                                         
                                                                        
         /* JXT BF17 ÆA39 01-09-2023                           */       
         /* RBEA må ikke overstige ejerhforholdets ejerandel   */       
         /* samme kontrol som i BR42384M                       */       
                                                                        
         IF DCLBE78000T.RES_RABATEJERANDEL      > 0                     
          & DCLBE78000T.COPR_RES_RABATEJERANDEL = 'L'                   
         THEN DO;                                                       
            /*       DEC(5,2)             DEC(5,0)                    */
            HJ_RES_RABATEJERANDEL = DCLBE78000T.RES_RABATEJERANDEL/100; 
                                                                        
            IF DCLBE78000T.TILEVS_GPCTEJER_SW = 0                       
            THEN DO;                                                    
               IF HJ_RES_RABATEJERANDEL > DCLBE78000T.TILEVS_GPCTEJER   
               THEN DO;                                                 
                  DCLBE78000T.FEJLNR         = 5306;                    
                  DCLBE78000T.TILEVS_CEJBEVS = '2';    //US1546814      
                  END;                                                  
               END;                                                     
            ELSE DO;                                                    
               IF DCLBE78000T.RES_RABATEJERANDEL > 0                    
               THEN DO;                                                 
                  DCLBE78000T.FEJLNR         = 5306;                    
                  DCLBE78000T.TILEVS_CEJBEVS = '2';    //US1546814      
                  END;                                                  
               END;                                                     
            END;                                                        
                                                                        
  /* Defect 2426 - EVSFEJ_OVERFØRT_ÆGTEF var blank, nu testes der på    
     om den er forskellig fra 1 dvs den kan være blank, 2, 3 og 4       
     Løsning diskuteret med TIC / MBS                               */  
         IF DCLBE78000T.OVERFØRT_ÆGTEF_RABAT = '3'                      
          ! DCLBE78000T.OVERFØRT_ÆGTEF_RABAT = '4'                      
         THEN DO;                                                       
            /* DCLBE78000T.OVERFØRT_ÆGTEF_RABAT = 3/4 kommer fra      */
            /* BE90100, Ejerforhold er interessant ift. til Bo-opg.   */
                                                                        
            /* Sættes til intet overført                            */  
            DCLBE78000T.OVERFØRT_ÆGTEF_RABAT  = '2';                    
                                                                        
           IF DCLBE77000T.EKOMNR               < 999   &                
              DCLBE77000T.EVSSEJ_DCPRN         > 0     &                
              DCLBE77000T.EVSSEJ_SID_BOBEHAKOD = 'C'   &                
                                                                        
              DCLBE77000T.EVSSEJ_SID_CSLET     < '1'   &                
              DCLBE77000T.EVSSEJ_SID_CEJBEVS   < '9'   &                
              DCLBE78000T.TILEVS_A_ÆG_DAFSTÅ   = 0     &                
              DCLBE78000T.TILEVS_A_EJ_DAFSTÅ   = 0                      
           THEN DO;                                                     
             /* JXT BF17 ÆA39 Kontrol 5322 01-09-2023    */             
             /* skiftet bo */                                           
             /* fejl opsættes uanset fordel. af andele   */             
             /* fordi evt.overførsel ikke er foretaget   */             
             DCLBE78000T.FEJLNR         = 5322;                         
             DCLBE78000T.TILEVS_CEJBEVS = '2';       // US1546814       
           END;                                                         
                                                                        
         END;                                                           
         /* END   JXT BF17 ÆA39 01-09-2023  */                          
                                                                        
         IF   DCLBE78000T.OVERFØRT_ÆGTEF_RABAT ^= '1'                   
          &   DCLBE78000T.FEJLNR               = 0                      
          &   DCLBE78000T.TILEVS_A_EJ_CITYP    > 0                      
          &   DCLBE78000T.TILEVS_A_EJ_DCPRCIR  > 0                      
          & ((DCLBE78000T.TILEVS_A_EJ_DOVTG    > 0                      
          &   DCLBE78000T.TILEVS_A_EJ_DOVTG    < 20240101)              
          !  (DCLBE78000T.TILEVS_A_EJ_DOVTG_GL > 0                      
          &   DCLBE78000T.TILEVS_A_EJ_DOVTG_GL < 20240101))             
          &   DCLBE77000T.EVSFEJ_DCPRN         = 0                      
          &   DCLBE77000T.EVSSEJ_DCPRN         = 0                      
         THEN DO;                                                       
            DCLBE78000T.FEJLNR         = 5324;                          
            DCLBE78000T.TILEVS_CEJBEVS = '2';     //US1546814           
            END;                                                        
         ELSE                                                           
            IF   DCLBE78000T.OVERFØRT_ÆGTEF_RABAT ^= '1'                
             &   DCLBE78000T.FEJLNR               = 0                   
             &   DCLBE78000T.TILEVS_A_EJ_CITYP    > 0                   
             &   DCLBE78000T.TILEVS_A_EJ_DCPRCIR  > 0                   
             & ((DCLBE78000T.TILEVS_A_EJ_DOVTG    > 0                   
             &   DCLBE78000T.TILEVS_A_EJ_DOVTG    < 20240101)           
             !  (DCLBE78000T.TILEVS_A_EJ_DOVTG_GL > 0                   
             &   DCLBE78000T.TILEVS_A_EJ_DOVTG_GL < 20240101))          
             &   DCLBE77000T.EVSFEJ_DCPRN         > 0                   
             &   DCLBE77000T.EVSFEJ_EJET20240101  = '2'                 
            THEN DO;                                                    
               /* Nyt Ejerforhold fra ESR før 20240101                */
               /* Kendt ejerforhold har ingen rabat                   */
               DCLBE78000T.FEJLNR         = 5324;                       
               DCLBE78000T.TILEVS_CEJBEVS = '2';     //US1546814        
               END;                                                     
                                                                        
       /* IF DCLBE78000T.FEJLNR       = 0                               
           & DCLBE75000T.EJER_DCPRCIR > 0                               
           & DCLBE75000T.EJER_DOVTG   > 0                               
           & DCLBE75000T.EJER_DOVTG   < 20240101                        
           & DCLBE77000T.EVSFEJ_DCPRN = 0                               
           & DCLBE77000T.EVSSEJ_DCPRN = 0                               
           THEN DO;                                                     
               * Nyt ukendt Ejerforhold fra ESR                      *  
              DCLBE78000T.FEJLNR         = 5324;                        
              DCLBE78000T.TILEVS_CEJBEVS = '2';     US1546814           
              END;                                                      
          ELSE                                                          
             IF DCLBE78000T.FEJLNR       = 0                            
              & DCLBE75000T.EJER_DCPRCIR > 0                            
              & DCLBE75000T.EJER_DOVTG   > 0                            
              & DCLBE75000T.EJER_DOVTG   < 20240101                     
              & DCLBE77000T.EVSFEJ_DCPRN > 0                            
              & DCLBE77000T.EVSFEJ_EJET20240101 = '2'                   
           THEN DO;                                                     
               * Nyt Ejerforhold fra ESR før 20240101                 * 
               * Kendt ejerforhold har ingen rabat                    * 
              DCLBE78000T.FEJLNR         = 5324;                        
              DCLBE78000T.TILEVS_CEJBEVS = '2';     US1546814           
              END;                                                      
        */                                                              
                                                                        
         IF DCLBE78000T.OVERFØRT_ÆGTEF_RABAT = '5'                      
         THEN DO;                                                       
            /* Har afdøde ikke en Simpel Basisrabat af overføre       */
            /* og det skyldes, at bo-opgørelsen ikke nåede at komme   */
            /* til forskud oprettes fejl 5326.                        */
                                                                        
            /* DCLBE78000T.OVERFØRT_ÆGTEF_RABAT = '5' kommer fra      */
            /* BE90100, Ejerforhold er interessant ift. til Bo-opg.   */
                                                                        
            /* Sættes til intet overført                              */
            DCLBE78000T.OVERFØRT_ÆGTEF_RABAT  = '2';                    
                                                                        
            IF DCLBE77000T.EKOMNR                < 999  &               
               DCLBE77000T.EVSSEJ_DCPRN          > 0    &               
               DCLBE77000T.EVSSÆG_DCPRN          > 0    &               
               DCLBE77000T.EVSSÆG_SID_BOBEHAKOD  = ' '  &               
               DCLBE77000T.EVSSÆG_SID_CSLET     < '1'   &               
               DCLBE77000T.EVSSÆG_SID_CEJBEVS   < '9'   &               
               DCLBE78000T.TILEVS_A_ÆG_DAFSTÅ   = 0     &               
               DCLBE78000T.TILEVS_A_EJ_DAFSTÅ   = 0                     
            THEN DO;                                                    
               DCLBE78000T.FEJLNR         = 5326;                       
               DCLBE78000T.TILEVS_CEJBEVS = '2'; // US1546814           
               END;                                                     
            END;                                                        
                                                                        
 END OPSÆT_FEJLNR;                                                      
 /********************************************************************/ 
 /* UNDERSØG OM EN BORGER ER BEGRÆNSET SKATTEPLIGTIG. FINDES MT DATA */ 
 /* ANVENDES DE ELLERS UNDERSØGES SIDSTE EVS SLUT ÅR                 */ 
 /********************************************************************/ 
 ER_BEGRÆNSET_SKATTEPLIGTIG:PROC RETURNS(BIT(1));                       
                                                                        
   DCL HJBEGRÆNSET_BIT BIT(1);                                          
                                                                        
   HJBEGRÆNSET_BIT = NEJ;                                               
   HJBEGRÆNSET_TP = '0';                                                
                                                                        
   IF DCLBE76000T.HIST_OPD_DETTE_CSKPLOM >= '0'                         
   THEN                                                                 
     DO;                                                                
       IF DCLBE76000T.HIST_OPD_DETTE_CSKPLOM = '1' !                    
          DCLBE76000T.HIST_OPD_DETTE_CSKPLOM = '3' !                    
          DCLBE76000T.HIST_OPD_DETTE_CSKPLOM = '8'                      
       THEN                                                             
         DO;                                                            
           HJBEGRÆNSET_BIT = JA;                                        
           HJBEGRÆNSET_TP = DCLBE76000T.HIST_OPD_DETTE_CSKPLOM;         
         END;                                                           
     END;                                                               
   ELSE                                                                 
     DO;                                                                
       IF DCLBE77000T.EVSSEJ_SID_CSKPLOMF = '1' !                       
          DCLBE77000T.EVSSEJ_SID_CSKPLOMF = '3' !                       
          DCLBE77000T.EVSSEJ_SID_CSKPLOMF = '8'                         
       THEN                                                             
         DO;                                                            
           HJBEGRÆNSET_BIT = JA;                                        
           HJBEGRÆNSET_TP =                                             
                DCLBE77000T.EVSSEJ_SID_CSKPLOMF;                        
         END;                                                           
     END;                                                               
                                                                        
   RETURN(HJBEGRÆNSET_BIT);                                             
                                                                        
                                                                        
 END ER_BEGRÆNSET_SKATTEPLIGTIG;                                        
 /*********************************************************************/
 /* HENT BEREGNINGSKODE PÅ ANDEN ENHED FOR EJER AF 2FAMILIHUS         */
 /* FOR PERIODEN (ANGIVET VED SORTDATO) F2020 KS28-03 C1.7            */
 /*********************************************************************/
 HENT_CEJBEVS_ANDEN_ENHED:PROC RETURNS(CHAR(1));                        
                                                                        
   DCL HJCEJBEVS_ANDEN_ENHED CHAR(1);                                   
                                                                        
   HJCEJBEVS_ANDEN_ENHED = ' ';                                         
                                                                        
   IF DCLBE78000T.EENHEDLBNR > 0 &                                      
      DCLBE78000T.EENHEDLBNR < 3                                        
   THEN                                                                 
     DO;                                                                
                                                                        
       EXEC SQL                                                         
          SELECT                                                        
              TILEVS_CEJBEVS                                            
            INTO                                                        
              :HJCEJBEVS_ANDEN_ENHED                                    
                                                                        
          FROM BE78000T                                                 
          WHERE TIL_EVS_AAR     = :DCLBE78000T.TIL_EVS_AAR              
            AND   DCPRN         = :DCLBE78000T.DCPRN                    
            AND   AFVIKLINGS_ID = :DCLBE78000T.AFVIKLINGS_ID            
            AND   DATA_ID       = :DCLBE78000T.DATA_ID                  
            AND   EKOMNR        = :DCLBE78000T.EKOMNR                   
            AND   EEJDNR        = :DCLBE78000T.EEJDNR                   
            AND   EENHEDLBNR    <> :DCLBE78000T.EENHEDLBNR              
            AND   EENHEDLBNR    IN (1,2)                                
            AND   SORT_DATO     = :DCLBE78000T.SORT_DATO;               
                                                                        
          SELECT(SQLCA.SQLCODE);                                        
             WHEN(0)                                                    
               DO;                                                      
               END;                                                     
             WHEN(100)                                                  
               DO;                                                      
                 PUT SKIP LIST('ANDEN ENHED IKKE FUNDET');              
               END;                                                     
             WHEN(-811)                                                 
               DO;                                                      
                 PUT SKIP LIST('FOR MANGE RESULTATER');                 
               END;                                                     
             OTHERWISE DO;                                              
               ABENDTXT = '101 SELECT ANDEN ENHED BE78000T';            
               CALL SQL_FEJL;                                           
             END;                                                       
          END;  /*SELECT*/                                              
     END;                                                               
                                                                        
                                                                        
   RETURN(HJCEJBEVS_ANDEN_ENHED);                                       
                                                                        
 END HENT_CEJBEVS_ANDEN_ENHED;                                          
 /********************************************************************/ 
 /* FINDES DER STAM OPLYSNINGER FRA ESR                              */ 
 /* LAGT IND I FORBINDELSE MED DB2 OMLÆGNING QEB                     */ 
 /********************************************************************/ 
 FINDES_ESR_STAM_OPL:PROC RETURNS(BIT(1));                              
                                                                        
   DCL HJFINDES_ESR_STAM_OPL_BIT BIT(1);                                
                                                                        
   HJFINDES_ESR_STAM_OPL_BIT = NEJ;                                     
                                                                        
   IF DCLBE75000T.EJER_DCPRCIR > 0  !                                   
      DCLBE75000T.ÆGTE_DCPRCIR > 0  !                                   
      DCLBE75000T.OPL_VURDNY_DVURDÅR > 0   !                            
      DCLBE75000T.OPL_VURDGL_DVURDÅR > 0   !                            
      SUBSTR(DCLBE75000T.OPL_ABELMAT,1,1) > ' '                         
   THEN                                                                 
     HJFINDES_ESR_STAM_OPL_BIT = JA;                                    
                                                                        
   RETURN(HJFINDES_ESR_STAM_OPL_BIT);                                   
                                                                        
 END FINDES_ESR_STAM_OPL;                                               
 /********************************************************************/ 
 /* FINDES DER DATA FRA EVS                                          */ 
 /* LAGT IND I FORBINDELSE MED DB2 OMLÆGNING QEB                     */ 
 /********************************************************************/ 
 FINDES_EVS_OPL:PROC RETURNS(BIT(1));                                   
                                                                        
   DCL HJFINDES_EVS_OPL_BIT BIT(1);                                     
                                                                        
   HJFINDES_EVS_OPL_BIT = NEJ;                                          
                                                                        
   IF DCLBE77000T.EVSSEJ_DCPRN > 0 !                                    
      DCLBE77000T.EVSSÆG_DCPRN > 0 !                                    
      DCLBE77000T.EVSFEJ_DCPRN > 0 !                                    
      DCLBE77000T.EVSFÆG_DCPRN > 0                                      
   THEN                                                                 
     HJFINDES_EVS_OPL_BIT = JA;                                         
                                                                        
   RETURN(HJFINDES_EVS_OPL_BIT);                                        
                                                                        
                                                                        
 END FINDES_EVS_OPL;                                                    
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED SQLCODE: ' !! SQLCA.SQLCODE);  
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
                                                                        
         CALL ZS67000(SQLCA);                                           
                                                                        
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* HER UDSKRIVES ØVRIGE FEJL                                  RUTINE */
 /*********************************************************************/
 PROGRAM_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED PROGRAMFEJL');                 
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END PROGRAM_FEJL;                                                      
                                                                        
 END BE85010;                                                           
