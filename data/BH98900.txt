 BH98900:  /** Sletning af testdata for et bestemt år.            **/   
         PROC OPTIONS (MAIN);                                           
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /* Program   : BH989000 , Slet i EVS. Bruges ved test i SLUT        */ 
 /*                                                                  */ 
 /* Funktion  : Programmet kan med fordel køres, når der skal loades */ 
 /*             om i test.                                           */ 
 /*                                                                  */ 
 /* Tabeller  : BQ20000T - EVS slut ejendomstabel                    */ 
 /*             BQ21000T - evs slut ejendomsfelttabel                */ 
 /*             BQ30000T - slut ejerskabstabel                       */ 
 /*             BQ31000T - slut ejerskabsfelttabel                   */ 
 /*                                                                  */ 
 /* Programmør: GEH, PKF, marts 2011.                                */ 
 /*             Søg på år-ret ved start på nyt år.                   */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Erklæring af tabeller                                          */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
      EXEC SQL INCLUDE SQLCA;           /* SQL kommunikationsareal   */ 
      EXEC SQL INCLUDE BQ20000T;        /* EVS slut ejendomstabel    */ 
      EXEC SQL INCLUDE BQ21000T;        /* EVS slut ejendomsfelttabel*/ 
      EXEC SQL INCLUDE BQ30000T;        /* EVS slut ejerskabstabel   */ 
      EXEC SQL INCLUDE BQ31000T;        /* EVS slut ejerskabsfelttabe*/ 
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*      DECLARE AF STANDARDRUTINER                                  */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
                                                                        
 DCL  ZS30101         ENTRY;    /* INTERN KONTROLLISTE               */ 
 DCL  ZS61900         ENTRY;    /* UDSKRIV KST INFORMATION           */ 
 DCL  ZS67000         ENTRY;    /* FORMATERING AF DB2 FEJLMEDDELELSE */ 
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*      DECLARE AF DIVERSE FELTER                                   */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DCL  DMPTXT            CHAR      (56);      /* DUMP TEKST           */ 
 DCL  TXT               CHAR      (04);                                 
 DCL  DATO10            CHAR      (10);                                 
 DCL  KØRSELSDATO       CHAR      (10);                                 
 DCL  HJ_AAR            FIXED BIN (15) INIT (2015);             /*RUL*/ 
 DCL  IX                PIC       '(2)9';                               
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*      DCL AF DIVERSE HJÆLPEAREALER                                */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DCL  1 ABEND,                                                          
        2 HMODUL      CHAR      (11)      INIT      ('BH95000 ** '),    
        2 HFEJL       CHAR      (45);                                   
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*      DECLARE AF DIV. RUTINER                                     */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DCL   ( ADDR,                                                          
         DATETIME,                                                      
         INDEX,                                                         
         NULL,                                                          
         LOW,                                                           
         ONCODE,                                                        
         PLIDUMP,                                                       
         PLIRETV,                                                       
         VERIFY,                                                        
         TRANSLATE,                                                     
         STRING,                                                        
         SUBSTR  )     BUILTIN;                                         
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Housekeeping                                                   */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
      ON ERROR                                                          
      BEGIN;                                                            
        CALL PLIDUMP ('SBHO','BH98900');                                
      END;                                                              
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Initer kørselsinformation                                      */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
      CALL INITIER;                                                     
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Hovedprogram                                                   */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
                                                                        
      CALL DELETE_BQ31000T;                                             
      CALL DELETE_BQ30000T;                                             
      CALL DELETE_BQ21000T;                                             
      CALL DELETE_BQ20000T;                                             
 /*   CALL DELETE_BQ20000T_DEL1;                                        
      CALL DELETE_BQ20000T_DEL2; */                                     
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Sletter rækker i BQ20000T-tabellen                             */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DELETE_BQ20000T: PROC;                                                 
                                                                        
      PUT SKIP LIST ('Delete_BQ20000T');                                
      TXT   = '2000';                                                   
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
 END DELETE_BQ20000T;                                                   
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Sletter rækker i BQ20000T-tabellen                             */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DELETE_BQ20000T_DEL1: PROC;                                            
                                                                        
      PUT SKIP LIST ('Delete_BQ20000T_DEL1');                           
      TXT   = 'DEL1';                                                   
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   <  200                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   <  400                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   <  600                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   <  5000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 15000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 20000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 25000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 30000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 35000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 40000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 45000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 55000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  753                                          
         AND   EEJDNR   < 60000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   <  500                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 1000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 1500                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 2000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 2500                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 3000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 3500                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 4000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 4500                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 5000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 5500                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 6000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 7000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 8000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 9000                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 15000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 20000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 30000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 40000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 50000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
 END DELETE_BQ20000T_DEL1;                                              
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Sletter rækker i BQ20000T-tabellen                             */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DELETE_BQ20000T_DEL2: PROC;                                            
                                                                        
      PUT SKIP LIST ('Delete_BQ20000T_DEL2');                           
      TXT   = 'DEL2';                                                   
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 10000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 11000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 13000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 14000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 15000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 16000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 17000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 18000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 19000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 20000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 21000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 22000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 23000                                         
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
         AND   EEJDNR   < 24000                                         
      ;                                                                 
      IF SQLCODE ^= 0   &   SQLCODE ^= 100                              
      THEN                                                              
         CALL DB2FEJL;                                                  
                                                                        
      PUT SKIP LIST ('14. antal slettede på BQ20000T: ', SQLERRD(3));   
      IX  = IX + 1;                                                     
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
         AND   EKOMNR   =  881                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
         /*----------------------------------*/                         
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ20000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
   /*    AND   EKOMNR   =  881  */                                      
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
 END DELETE_BQ20000T_DEL2;                                              
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Sletter rækker i BQ21000T-tabellen                             */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DELETE_BQ21000T: PROC;                                                 
                                                                        
      TXT   = '2100';                                                   
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ21000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
  /*     AND   EKOMNR   = 999                                           
         AND   EEJDNR   = 1 */                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
 END DELETE_BQ21000T;                                                   
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Sletter rækker i BQ30000T-tabellen                             */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DELETE_BQ30000T: PROC;                                                 
                                                                        
      TXT   = '3000';                                                   
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ30000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
  /*     AND   EKOMNR   = 999                                           
         AND   EEJDNR   = 1 */                                          
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
 END DELETE_BQ30000T;                                                   
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Sletter rækker i BQ31000T-tabellen                             */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DELETE_BQ31000T: PROC;                                                 
                                                                        
      TXT   = '3100';                                                   
                                                                        
      EXEC SQL DELETE                                                   
         FROM  BQ31000T                                                 
         WHERE DINDKAAR = :HJ_AAR                                       
   /*    AND   EKOMNR   = 999                                           
         AND   EEJDNR   = 1     */                                      
      ;                                                                 
      CALL SQLCODE_BEHANDLING;                                          
                                                                        
 END DELETE_BQ31000T;                                                   
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Initier                                                        */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 INITIER: PROC;                                                         
 DCL  PIC_AAR  PIC 'ZZZ9';                                              
                                                                        
      CALL ZS61900;                                                     
      EXEC SQL SET :KØRSELSDATO = CURRENT DATE;                         
                                                                        
 END INITIER;                                                           
                                                                        
                                                                        
 /*------------------------------------------------------------------*/ 
 SQLCODE_BEHANDLING: PROC;                                              
                                                                        
    IF SQLCODE ^= 0   &   SQLCODE ^= 100                                
    THEN                                                                
       CALL DB2FEJL;                                                    
                                                                        
    IF TXT = 'DEL1'                                                     
     ! TXT = 'DEL2' THEN DO;                                            
       IX  = IX + 1;                                                    
       PUT SKIP LIST(IX !!' antal slettede på BQ20000T: ', SQLERRD(3)); 
    END;                                                                
                                                                        
    IF TXT = '2000' THEN                                                
       PUT SKIP LIST('Antal slettede på BQ20000T: ', SQLERRD(3));       
                                                                        
    IF TXT = '2100' THEN                                                
       PUT SKIP LIST('Antal slettede på BQ21000T: ', SQLERRD(3));       
                                                                        
    IF TXT = '3000' THEN                                                
       PUT SKIP LIST('Antal slettede på BQ30000T: ', SQLERRD(3));       
                                                                        
    IF TXT = '3100' THEN                                                
       PUT SKIP LIST('Antal slettede på BQ31000T: ', SQLERRD(3));       
                                                                        
    IF  (TXT = 'DEL2'   &    IX = 14)                                   
    THEN;                                                               
    ELSE DO;                                                            
       EXEC SQL COMMIT;                                                 
       IF SQLCODE ^= 0   &   SQLCODE ^= 100                             
       THEN                                                             
          CALL DB2FEJL;                                                 
    END;                                                                
                                                                        
 END SQLCODE_BEHANDLING;                                                
                                                                        
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /*   Kald DB2 ABEND                                                 */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 DB2FEJL: PROC;                                                         
      CALL ZS67000(SQLCA);                                              
      IF SQLCODE ^= 0                                                   
      THEN                                                              
         CALL ZS67000(SQLCA);                                           
      DMPTXT = 'BH98900 ** 251 FEJL I SQL KALD ';                       
      CALL ZS30101 (5,DMPTXT,2);                                        
                                                                        
 END DB2FEJL;                                                           
                                                                        
 END BH98900;                                                           
