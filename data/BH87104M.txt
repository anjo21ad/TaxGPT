 /*********************************************************************/
 /*      DANNE DATA TIL SLUT CSC VEDR. SUPPLEMENTSLEVERINGEN          */
 /*      OPDATERING AF DATA/RÆKKE FRA GRUNDLEVERINGEN D.V.S.          */
 /*      ÆNDRING AF CSLET                                             */
 /*                                                                   */
 /*   SLUT09    GERD HOLM-PEDERSEN                        22/11-2009  */
 /*             TILRETTET SLUT 2009 SAMT                              */
 /*   SLUT11    GERD HOLM-PEDERSEN                        02/10-2011  */
 /*             TILRETTET SLUT 2011 SAMT                              */
 /*   SLUT13    ESBEN BRODERSEN                           29/11-2013  */
 /*             TILRETTET SLUT 2013                                   */
 /*   SLUT15    JØRGEN SAUGMANN                           28712-2015  */
 /*             TILRETTET SLUT 2015                                   */
 /*  SLUT15    ESBEN BRODERSEN                             22/02-2016 */
 /*  UDVIDET BRUG AF DATO INCLUDE BH65300M #01                        */
 /*  SLUT16     ESBEN BRODERSEN QEB                        10/10-2016 */
 /*             NYE FELTER: BLANDVÆR_015ANV, BLANDVÆR_02ANV,          */
 /*                         BLANDVÆR_AKT                              */
 /*             UDGÅEDE FELTER: BPROM2, BPROM1, BSTIBEGR, BNEDSL1,    */
 /*             BPENSNED, BNEDSL2, BGRPROM2, CSTIBLB, BGRPROM1        */
 /*  SLUT17     ESBEN BRODERSEN                            OKT 2017   */
 /*             UDGÅEDE FELTER: CSCREGISTMP, BGLSUM1, CNULSTIL        */
 /*  SLUT18     ESBEN BRODERSEN                            DEC 2018   */
 /*             Udgåede felter: CSKPLOMF, BOBEHAKOD,CELØNCOR          */
 /*                             EKOMNR_EJDNR_GL, CSKPLOMFGL           */
 /*             Nye felter:     EENHEDLBNR, VURDOPRIDKOD, EJDBLIGEKMNR*/
 /*                             VEJKOD, HUSNR, HUSBOSTAADR, ETAGENR,  */
 /*                             SIDEDOERNR                            */
 /*  SLUT20     Skift til INDKÅR1 da årstal DINDKAAR ikke blev opsat  */
 /* Slut 2020:  Elena Flygenring EFL                      marts 2021  */
 /*              - struktur BH65300M erstattes med BH55300M           */
 /*********************************************************************/
 OPDAT_DATA_TIL_SLUT: PROC;                                             
                                                                        
         BH871.INDVNR            = 810;                                 
         BH871.INDVLGD           = 499;                                 
         BH871.FELTLGD           = 499;                                 
         BH871.HEADER            = 'EVSGRUND';                          
         BH871.DINDKAAR          = BH55300M.INDKÅR1; /*#01*/            
         BH871.DCPRN             = BQ_UD.PERSON.DCPRN;                  
         BH871.EKOMNR            = BQ_UD.PERSON.EKOMNR;                 
         BH871.EEJDNR            = BQ_UD.PERSON.EEJDNR;                 
         BH871.EENHEDLBNR        = BQ_UD.PERSON.EENHEDLBNR;             
         BH871.ELBNR             = BQ_UD.PERSON.ELBNR;                  
                                                                        
         BH871.EJDBLIGEKMNR      = BQ_UD.PERSON.EKOMNR;                 
                                                                        
         BH871.VURDOPRIKOD       = 'ESR';                               
                                                                        
         BH871.CSLET             = BQ_UD.PERSON.CSLET;                  
         BH871.CLANDEKODE        = BQ_UD.EJENDOM.CLANDEKODE;            
         BH871.CEJBEVS           = BQ_UD.PERSON.CEJBEVS;                
         BH871.MANPENSSTI_I      = BQ_UD.INDK_PERS.MANPENSSTI_I;        
         BH871.MANPENSSTI        = BQ_UD.PERSON.MANPENSSTI;             
         BH871.BBERGRL_015ANV_I  = BQ_UD.INDK_PERS.BBERGRL_015ANV_I;    
         BH871.BBERGRL_015ANV    = BQ_UD.PERSON.BBERGRL_015ANV;         
         BH871.BBERGRL_02ANV_I   = BQ_UD.INDK_PERS.BBERGRL_02ANV_I;     
         BH871.BBERGRL_02ANV     = BQ_UD.PERSON.BBERGRL_02ANV;          
         BH871.BBERGRL_AKT_I     = BQ_UD.INDK_PERS.BBERGRL_AKT_I;       
         BH871.BBERGRL_AKT       = BQ_UD.PERSON.BBERGRL_AKT;            
         BH871.BBER2FAM_015ANV_I = BQ_UD.INDK_PERS.BBER2FAM_015ANV_I;   
         BH871.BBER2FAM_015ANV   = BQ_UD.PERSON.BBER2FAM_015ANV;        
         BH871.BBER2FAM_02ANV_I  = BQ_UD.INDK_PERS.BBER2FAM_02ANV_I;    
         BH871.BBER2FAM_02ANV    = BQ_UD.PERSON.BBER2FAM_02ANV;         
         BH871.BBER2FAM_AKT_I    = BQ_UD.INDK_PERS.BBER2FAM_AKT_I;      
         BH871.BBER2FAM_AKT      = BQ_UD.PERSON.BBER2FAM_AKT;           
                                                                        
         IF BQ_UD.EJENDOM.EENHEDLBNR = 0                                
         THEN                                                           
           DO;                                                          
             BH871.EJDBELIG     = BQ_UD.EJENDOM.EJDBELIG;               
             BH871.VEJKOD       = BQ_UD.EJENDOM.VEJK_EJD;               
             BH871.HUSNR        = SUBSTR(BQ_UD.EJENDOM.HUSNR_EJD,1,3);  
             BH871.HUSBOSTAADR  = SUBSTR(BQ_UD.EJENDOM.HUSNR_EJD,4,1);  
             BH871.ETAGENR      = BQ_UD.EJENDOM.ETAGE_EJD;              
             BH871.SIDEDOERNR   = BQ_UD.EJENDOM.SDØR_EJD;               
           END;                                                         
         ELSE                                                           
           DO;                                                          
             BH871.EJDBELIG     = BQ_UD.EJENDOM.ENHEDBELIG;             
             BH871.VEJKOD       = BQ_UD.EJENDOM.VEJK_ENHED;             
             BH871.HUSNR        = SUBSTR(BQ_UD.EJENDOM.HUSNR_ENHED,1,3);
             BH871.HUSBOSTAADR  = SUBSTR(BQ_UD.EJENDOM.HUSNR_ENHED,4,1);
             BH871.ETAGENR      = BQ_UD.EJENDOM.ETAGE_ENHED;            
             BH871.SIDEDOERNR   = BQ_UD.EJENDOM.SDØR_ENHED;             
           END;                                                         
                                                                        
         BH871.CEJDTYPE          = BQ_UD.PERSON.CEJDTYPE_AKT;           
         BH871.CÆGTOPR           = BQ_UD.PERSON.CÆGTOPR;                
         BH871.DOVTG             = BQ_UD.PERSON.DOVTG;                  
         BH871.DAFSTAA           = BQ_UD.PERSON.DAFSTAA;                
         BH871.GPCTEJER_I        = BQ_UD.INDK_PERS.GPCTEJER_I;          
         BH871.GPCTEJER          = BQ_UD.PERSON.GPCTEJER;               
         BH871.FDAGUDLE          = BQ_UD.PERSON.FDAGUDLE;               
         BH871.GPCTUDLE          = BQ_UD.PERSON.GPCTUDLE;               
         BH871.FUDL100           = BQ_UD.PERSON.FUDL100;                
         BH871.GPCTERHV          = BQ_UD.PERSON.GPCTERHV;               
         BH871.FDAGERHV          = BQ_UD.PERSON.FDAGERHV;               
         BH871.FERHVFLER         = BQ_UD.PERSON.FERHVFLER;              
         BH871.CENKE             = BQ_UD.PERSON.CENKE;                  
         BH871.CPTYPSLUT         = BQ_UD.PERSON.CPTYPSLUT;              
         BH871.CPTYPGL           = BQ_UD.PERSON.CPTYPGL;                
         BH871.FELT759           = BQ_UD.PERSON.FELT759;                
         BH871.FELT760           = BQ_UD.PERSON.FELT760;                
         BH871.BEVSGL_I          = BQ_UD.INDK_PERS.BEVSGL_I;            
         BH871.BEVSGL            = BQ_UD.PERSON.BEVSGL;                 
         BH871.BPENSNEDGL_I      = BQ_UD.INDK_PERS.BPENSNEDGL_I;        
         BH871.BPENSNEDGL        = BQ_UD.PERSON.BPENSNEDGL;             
         BH871.DINDFLYT          = BQ_UD.PERSON.DINDFLYT;               
         BH871.DFRAFLYT          = BQ_UD.PERSON.DFRAFLYT;               
         BH871.FUBEBOELIG        = BQ_UD.PERSON.FUBEBOELIG;             
         BH871.BFASTSTIGBGR_I    = BQ_UD.INDK_PERS.BFASTSTIGBGR_I;      
         BH871.BFASTSTIGBGR      = BQ_UD.PERSON.BFASTSTIGBGR;           
         BH871.CINDFLYT          = BQ_UD.PERSON.CINDFLYT;               
         BH871.CBERGRGLOP        = BQ_UD.PERSON.CBERGRGLOP;             
         BH871.BMANEVSSTI_I      = BQ_UD.INDK_PERS.BMANEVSSTI_I;        
         BH871.BMANEVSSTI        = BQ_UD.PERSON.BMANEVSSTI;             
         BH871.BEVSMAN_I         = BQ_UD.INDK_PERS.BEVSMAN_I;           
         BH871.BEVSMAN           = BQ_UD.PERSON.BEVSMAN;                
         BH871.BMANNEDSL_I       = BQ_UD.INDK_PERS.BMANNEDSL_I;         
         BH871.BMANNEDSL         = BQ_UD.PERSON.BMANNEDSL;              
         BH871.CEKSEMP           = BQ_UD.PERSON.CEKSEMP;                
         BH871.MANNEDSLSTI_I     = BQ_UD.INDK_PERS.MANNEDSLSTI_I;       
         BH871.MANNEDSLSTI       = BQ_UD.PERSON.MANNEDSLSTI;            
         BH871.BUDLSKC_I         = BQ_UD.INDK_PERS.BUDLSKC_I;           
         BH871.BUDLSKC           = BQ_UD.PERSON.BUDLSKC;                
         BH871.BEJBOL1_AKT_I     = BQ_UD.INDK_PERS.BEJBOL1_AKT_I;       
         BH871.BEJBOL1_AKT       = BQ_UD.PERSON.BEJBOL1_AKT;            
         BH871.BEJBOL2_AKT_I     = BQ_UD.INDK_PERS.BEJBOL2_AKT_I;       
         BH871.BEJBOL2_AKT       = BQ_UD.PERSON.BEJBOL2_AKT;            
         BH871.DAFSTAAFOR        = BQ_UD.PERSON.DAFSTAAFOR;             
         BH871.BEJBOL1_02ANV_I   = BQ_UD.INDK_PERS.BEJBOL1_02ANV_I;     
         BH871.BEJBOL1_02ANV     = BQ_UD.PERSON.BEJBOL1_02ANV;          
         BH871.BEJBOL2_02ANV_I   = BQ_UD.INDK_PERS.BEJBOL2_02ANV_I;     
         BH871.BEJBOL2_02ANV     = BQ_UD.PERSON.BEJBOL2_02ANV;          
         BH871.CBENYT            = BQ_UD.EJENDOM.CBENYT;                
         BH871.CBERGRL           = BQ_UD.EJENDOM.CBERGRL;               
         BH871.GPCTEJERFOR       = BQ_UD.PERSON.GPCTEJERFOR;            
         BH871.CERHV             = BQ_UD.PERSON.CERHV;                  
         BH871.CVURDOPR          = BQ_UD.EJENDOM.CVURDOPR;              
         BH871.COMBYG            = BQ_UD.EJENDOM.COMBYG;                
                                                                        
         /* 3 Nye felter slut 2016 til overførsel af landbrugs opl #01*/
         IF BH871.CEJDTYPE = '9' &                                      
            BH871.EKOMNR ^= 999                                         
         THEN                                                           
           DO;                                                          
             BH871.BLANDVÆR_015ANV_I = BQ_UD.INDK_PERS.BEJDVÆR_015ANV_I;
             BH871.BLANDVÆR_015ANV   = BQ_UD.PERSON.BEJDVÆR_015ANV;     
             BH871.BLANDVÆR_02ANV_I  = BQ_UD.INDK_PERS.BEJDVÆR_02ANV_I; 
             BH871.BLANDVÆR_02ANV    = BQ_UD.PERSON.BEJDVÆR_02ANV;      
             BH871.BLANDVÆR_AKT_I    = BQ_UD.INDK_EJD.BEJDVÆR_AKT_I;    
             BH871.BLANDVÆR_AKT      = BQ_UD.EJENDOM.BEJDVÆR_AKT;       
           END;                                                         
         ELSE                                                           
           DO;                                                          
             BH871.BLANDVÆR_015ANV_I = -1;                              
             BH871.BLANDVÆR_015ANV   = 0;                               
             BH871.BLANDVÆR_02ANV_I  = -1;                              
             BH871.BLANDVÆR_02ANV    = 0;                               
             BH871.BLANDVÆR_AKT_I    = -1;                              
             BH871.BLANDVÆR_AKT      = 0;                               
           END;                                                         
                                                                        
         BH871.BBERGRL_I         = BQ_UD.INDK_PERS.BBERGRL_I;           
         BH871.BBERGRL           = BQ_UD.PERSON.BBERGRL;                
         BH871.CBERGROP          = BQ_UD.PERSON.CBERGROP;               
         BH871.BFORSKAT_I        = BQ_UD.INDK_PERS.BFORSKAT_I;          
         BH871.BFORSKAT          = BQ_UD.PERSON.BFORSKAT;               
         BH871.CFORSKAT          = BQ_UD.PERSON.CFORSKAT;               
         BH871.CUDLMAN           = BQ_UD.PERSON.CUDLMAN;                
         BH871.BBER2FAM_I        = BQ_UD.INDK_PERS.BBER2FAM_I;          
         BH871.BBER2FAM          = BQ_UD.PERSON.BBER2FAM;               
         BH871.FEJLNR            = BQ_UD.PERSON.FEJLNR;                 
         BH871.BEJBOL1_015ANV_I  = BQ_UD.INDK_PERS.BEJBOL1_015ANV_I;    
         BH871.BEJBOL1_015ANV    = BQ_UD.PERSON.BEJBOL1_015ANV;         
         BH871.BEJBOL2_015ANV_I  = BQ_UD.INDK_PERS.BEJBOL2_015ANV_I;    
         BH871.BEJBOL2_015ANV    = BQ_UD.PERSON.BEJBOL2_015ANV;         
                                                                        
         BH871.DFRAGLD           = BQ_UD.PERSON.DFRAGLD;                
         BH871.CNEDSL1           = BQ_UD.PERSON.CNEDSL1;                
         BH871.FLEJL             = BQ_UD.EJENDOM.FLEJL;                 
         BH871.DOVTGFOR          = BQ_UD.PERSON.DOVTGFOR;               
         BH871.CDATAFRA          = BQ_UD.PERSON.CDATAFRA;               
         BH871.CUDLHEL           = BQ_UD.PERSON.CUDLHEL;                
         BH871.CUDLDEL           = BQ_UD.PERSON.CUDLDEL;                
                                                                        
         TV.SKREVET = TV.SKREVET + 1;                                   
                                                                        
         WRITE FILE (BH8710O) FROM (BH871);                             
                                                                        
 END OPDAT_DATA_TIL_SLUT;                                               
