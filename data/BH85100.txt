  PROCESS OPT(TIME);                                                    
 BH85100: /* DAN DATA TIL EVS PERSONTABEL TIL FORSKUD */                
         PROCEDURE (EXECPARM) OPTIONS (MAIN) REORDER;                   
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 2002');       
 /**********************************************************************
 *                                                                     *
 * FORMÅL :                                                            *
 * LEVERING AF OPLYSNINGER TIL FORSKUDS EVS-PERSONTABEL (DB2).         *
 *                                                                     *
 * INPUT  : BEREGNINGSBÅND TIL NYT FORSKUDS ÅR                         *
 *          BQ75000T                                                   *
 *          BQ76000T                                                   *
 *          BQ77000T                                                   *
 *          BQ78000T                                                   *
 *                                                                     *
 * OUTPUT : B.H85100D  UDTRÆK - ALLE PERSONER                          *
 *          B.H85110D  UDTRÆK - FEJLNUMRE TIL BN04000T                 *
 *          BH85101Y   KØRSELSKONTROLLISTE                             *
 *          BH85102Y   FEJLLISTE FRA MASKINEL AFSTEMNING               *
 *                                                                     *
 * PROGRAMMØR: AAGE RASMUSSEN  AUG       1999                          *
 * RETTET:     AAGE RASMUSSEN  AUG       2000                          *
 * RETTET:     AAGE RASMUSSEN  AUG       2001       SE SEKV 1 I POS 80 *
 * RETTET:     OLUF MØRK       AUG       2002                          *
 * RETTET:     BO SCHMIDT      JUL       2003                          *
 * RETTET:     BO SCHMIDT      JUL       2004                          *
 * RETTET:     SUSANNE VILLUMSEN  JUL    2005     *FORSKUD06*          *
 * RETTET:     BO SCHMIDT         JUL    2006     *FORSKUD07*          *
 * RETTET:     BO SCHMIDT         JUL    2007     *FORSKUD08*          *
 * RETTET:     BO SCHMIDT         JUL    2008     *FORSKUD09*          *
 * RETTET:     GERD HOLM-PEDERSEN APR    2009     *FORSKUD10*          *
 * RETTET:     GERD HOLM-PEDERSEN JUN    2010     *FORSKUD11*          *
 * #6.1        SAMT KRAVNR. 6.1 EVS-FEJLR ÆNDRES TIL ADVIS I FORSKUD   *
 *             DESUDEN ÆNDRET B243 TIL BN00200T, DA B243 ER UDGÅET     *
 *             BNX6300, HVOR X ER FORKUDSÅRET, ER DET FORSKUDSPROGRAM, *
 *             DER KALDER BS330000 SOM OPDATER FORSKUDS FEJLTABEL      *
 *             BN00200T.                                               *
 * RETTET:     GERD HOLM-PEDERSEN MAJ    2011     *FORSKUD12*          *
 *                                                                     *
 * RETTET:     LARS KAAE HARRITSHØJ MAJ  2012     *FORSKUD13*          *
 *             ÆNDRINGER FORETAGET I BH90100N                          *
 * RETTET:     LARS KAAE HARRITSHØJ MAJ  2013     *FORSKUD14*          *
 * RETTET:     JØRGEN SAUGMANN      JUNI 2014     *FORSKUD15*          *
 * RETTET:     JØRGEN SAUGMANN      JUNI 2015     *FORSKUD16*          *
 * RETTET:     ESBEN BRODERSEN      MARTS 2016                         *
 *             INDLAGT DATO INCLUDE BH65300M  #01                      *
 * RETTET:     ESBEN BRODERSEN      JUNI 2016     *FORSKUD17*          *
 *             KUN KOMPILE                                             *
 * FORSKUD18   OPRETTET SOM KOPI AF BH95100 TIL DB2 OMLÆGNING          *
 *             BEREGNINGSBÅND ERSTATTET AF DB2 TABELLER                *
 * SLUT17      FAKTURERING ER PILLET UD  QEB 26-01-2018                *
 * RETTET:     JØRGEN SAUGMANN      FEB 2018    DB2 OMLÆGNING          *
 *             LAGT LÆSE TÆLLER IND                                    *
 * FORSKUD20   ESBEN BRODERSEN                  APR 2019               *
 *             SKIFTET struktur navne BH95100N -> BH85100N             *
 *                                    BH95110N -> BH85110N             *
 *             Tilrettet til ny ejertabel BS00600T                     *
 *             Ændret navngivning BN00200T -> BN04000T                 *
 *             BNX6300, kalder BS33051 (dette er kun en kommentar)     *
 * Forskud2021 Per Brunk                               Marts 2020      *
 *               Nye felter i BQ75000T VURMARK og VUR2001              *
 *             Per Brunk                               Juni 2020       *
 *             defect 285 frasortering af ejendomme med benyttelse 34  *
 *             Per Brunk                               Juli 2020       *
 *             KS25 EVS-oprettelsen begrænset skattepligtige           *
 *             Defect 521 fejlnummer 5200 til 5999 skal skrives        *
 *             til Forskud 2021  #02                                   *
 *             Optæling på felt 158 CEJBEVS = B of C                   *
 * Forskud2022 Per Brunk                               01.02.2021      *
 *               Nye felter i BQ77000T mellemperiode                   *
 * SLUT 2021   Steen Pedersen SEP                      Mar 2021        *
 *             BH65300M rettet til BH55300M                            *
 *             Fil BH851I er fjernet                                   *
 *             Brug af BH851_PARM er erstattet af BH55300M             *
 *             Parameter 2 i kald til OPDATER_KØRSELSTABEL fjernet     *
 *             INCLUDE BH54999M er fjernet                             *
 *                                                                     *
 * SLUT 2021  Finn Andersen FIA                         2021-06-18     *
 *            Der er lavet 4 nye tællere:                              *
 *            - LÆST_VURMARK                                           *
 *            - LÆST_DVURDÅR                                           *
 *            - LÆST_FORSIGT                                           *
 *            - LÆST_BESKAT                                            *
 *                                                                     *
 *                                                                     *
 * Forskud2022 Defect 782 og Defect 864  EBD           Juli 2021       *
 *                                                                     *
 * Forskud2022 KS46 PBR                                August 2021     *
 * Forskud2022 PBR                                     14-09-2021      *
 *             Ændret optælling på bopælskode                          *
 *             TILEVS_BOPÆLSKODE til TILEVS_A_EJ_BOPÆLSKODE            *
 * Forskud2023 Per Brunk   Årsrul                      08.06.2022      *
 * FORSKUD2023 Udgåede ejendomme         PBR           08.09.2022      *
 * Forskud2024 årstal i fejlnummer fil   EBD           26.02.2023      *
 * Forskud2024 defect 1910 BF17          EBD           10.05.2023      *
 **********************************************************************/
         DEFAULT RANGE (*) STATIC;                                      
 /*********************************************************************/
 /*      PARAMETER TIL ANGIVELSE AF OM DET ER PRODUKTION ELLER        */
 /*      TESTKØRSEL AF HENSYN TIL MASKINEL AFSTEMNING                 */
 /*********************************************************************/
 DCL     EXECPARM        CHAR      (6) VAR;                             
 DCL     EX_PARM         CHAR      (4);                                 
         EX_PARM = EXECPARM;                                            
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH8510O FILE RECORD OUTPUT;    /* LOAD-GRUNDLAG TIL EVS     */ 
 DCL     BH8511O FILE RECORD OUTPUT;    /* FEJLNUMRE TIL BN04000T    */ 
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (LOAD-GRUNDLAG)                            * 
 *********************************************************************/ 
 DCL     1 BH851,                                                       
           %INCLUDE BH85100N;                                           
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (FEJL TIL BN04000T)                        * 
 *********************************************************************/ 
 DCL     1 BH8511,                                                      
           %INCLUDE BH85110N;                                           
 /********************************************************************* 
 *       DECLARE AF DB2                                               * 
 *********************************************************************/ 
         EXEC SQL INCLUDE SQLCA;     /* SQL KOMMUNIKATIONSAREAL       */
         EXEC SQL INCLUDE BQ75000T;  /* ESR (FORSKUD)                 */
         EXEC SQL INCLUDE BQ76000T;  /* MANDTAL (FORSKUD)             */
         EXEC SQL INCLUDE BQ77000T;  /* EVS_UDTRÆK (FORSKUD)          */
         EXEC SQL INCLUDE BQ78000T;  /* EVS_RESULTAT (FORSKUD)        */
                                                                        
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 KUN_EJDTAB  FIXED DEC (7),                                 
           2 SKREVET     FIXED DEC (7),                                 
           2 SKRFEJL     FIXED DEC (7),                                 
           2 BEREGNET    FIXED DEC (7),                                 
           2 BEREJD      FIXED DEC (15,2),                              
           2 FREMSKREVET FIXED DEC (7),                                 
           2 EJDFREM     FIXED DEC (15,2),                              
           2 BPROM1      FIXED DEC (7),                                 
           2 BPROM2      FIXED DEC (7),                                 
           2 BNEDSL1     FIXED DEC (7),                                 
           2 BNEDSL2     FIXED DEC (7),                                 
           2 CPENSN6000  FIXED DEC (7),                                 
           2 CPENSN2000  FIXED DEC (7),                                 
           2 BER_BOPÆL0  FIXED DEC (7),                                 
           2 BER_BOPÆL1  FIXED DEC (7),                                 
           2 BER_BOPÆL2  FIXED DEC (7),                                 
           2 BER_BOPÆL3  FIXED DEC (7),                                 
           2 BER_BOPÆL4  FIXED DEC (7),                                 
           2 BER_BOPÆL5  FIXED DEC (7),                                 
           2 BER_BOPÆL6  FIXED DEC (7),                                 
           2 EJBEREGNET  FIXED DEC (7),                                 
           2 EJBER_BOPÆL0 FIXED DEC (7),                                
           2 EJBER_BOPÆL1 FIXED DEC (7),                                
           2 EJBER_BOPÆL2 FIXED DEC (7),                                
           2 EJBER_BOPÆL3 FIXED DEC (7),                                
           2 EJBER_BOPÆL4 FIXED DEC (7),                                
           2 EJBER_BOPÆL5 FIXED DEC (7),                                
           2 EJBER_BOPÆL6 FIXED DEC (7),                                
           2 BFASTSTIGBGR FIXED DEC (15,2),                             
           2 FASTSTIG     FIXED DEC (7),                                
           2 FANTSOM      FIXED DEC (7),                                
           2 LÆST_BQ75000T FIXED DEC (7),   /*DUPLET ->*/               
           2 LÆST_BQ76000T FIXED DEC (7),                               
           2 LÆST_BQ77000T FIXED DEC (7),                               
           2 LÆST_BQ78000T FIXED DEC (7),                               
           2 FETCH_RESULT  FIXED DEC (7),                               
           2 SELECT_MT     FIXED DEC (7),                               
           2 SELECT_ESR    FIXED DEC (7),                               
           2 SELECT_SLUT   FIXED DEC (7),                               
           2 ANT_COMM      FIXED DEC (7),                               
           2 ANT_UPD       FIXED DEC (7);                               
                                                                        
 DCL     1 LÆST_FEJLNR(5000:6000), /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_FEJLNR(5000:6000),  /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_EJBEVS(0:10),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_BERGRL(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_EJDTYP(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
                                                                        
 /* FIA - 4 nye tælle strukturer pr. 2021-06-18 */                      
 DCL     1 LÆST_VURMARK(0:99),     /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_DVURDÅR(2000:2050),/* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_FORSIGT(10:12),    /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_BESKAT(10:12),     /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
                                                                        
 DCL     1 TAB_PERSON(16),         /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 TEKST       CHAR      (60),                                
           2 ANTAL       FIXED DEC (7),                                 
           2 ERKL        FIXED DEC (7),                                 
           2 EJERKL      FIXED DEC (7);                                 
 DCL     MAX_ANT_INDV    FIXED DEC (7) INIT (0);                        
                                                                        
 /*********************************************************************/
 /* TIL BH85111M                                                      */
 /*********************************************************************/
 DCL     RESULT_FUNDET         BIT       (1);                           
 DCL     MT_FUNDET             BIT       (1);                           
 DCL     SLUT_FUNDET           BIT       (1);                           
 DCL     ESR_FUNDET            BIT       (1);                           
                                                                        
                                                                        
                                                                        
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS67000         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    LIN_DEB          CHAR      (133);                               
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH85100L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (' '),           
           2 F2          CHAR      (12)      INIT      (' '),           
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (10)      INIT      (' '),           
           2 TEKST2      CHAR      (07)      INIT      ('BELØB: '),     
           2 BELØB       PIC       'Z.ZZZ.ZZZ.ZZZ.ZZ9,V99',             
           2 F3          CHAR      (24)      INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
                                                                        
  DCL     PLIXOPT         CHAR      (40)      VAR STATIC                
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     ERKLÆRBAR       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     INDEX           BIN FIXED (31);                                
 DCL     I               BIN FIXED (15);                                
 DCL     HJ_CHAR4        CHAR      (4);                                 
 DCL     HJ_PIC4         PIC       '(4)9'  BASED(ADDR(HJ_CHAR4));       
 DCL     HJ_CHAR2        CHAR      (2);                                 
 DCL     HJ_PIC2         PIC       '(2)9'  BASED(ADDR(HJ_CHAR2));       
 DCL     HJ_CHAR1        CHAR      (1);                                 
 DCL     HJ_PIC1         PIC       '9'     BASED(ADDR(HJ_CHAR1));       
 DCL     GEM_PNR         FIXED     (11)      INIT      (0);             
 DCL     GEM_KOMNR       FIXED     (3);                                 
 DCL     GEM_EJDNR       FIXED     (7);                                 
 DCL     GEM_EENHEDLBNR  BIN FIXED(15);                                 
 DCL     HJ_EPLBNR       BIN FIXED(15)      INIT      (0);              
 DCL     HJ_ERLBNR       BIN FIXED(15)      INIT      (0);              
 DCL     FANTINDV    BIN FIXED     (31)     INIT      (0);              
 DCL     FEJLTAB (1000)   BIT       (1);   /*#02*/                      
                                                                        
 /* FIA */                                                              
 DCL     HJ_P3           PIC       '999';                               
 DCL     HJ_CHAR_4_PIC PIC '9999';                                      
 DCL     HJ_CHAR_4     CHAR (4) DEF HJ_CHAR_4_PIC;                      
                                                                        
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     FTYPE          CHAR(1);          /* #6.1       /* A = ADVIS */ 
                                                        /* B = FEJL  */ 
 DCL     1 BH55300M,                                                    
           %INCLUDE BH55300M;        /*#01*/                            
                                                                        
 DCL     WS_FORSKUD_SLUT_TXT            CHAR(16) INIT (' ');            
                                                                        
 DCL     WS_TIL_EVS_AAR                 BIN FIXED (15);                 
 DCL     WS_GLSLUTÅR                    BIN FIXED (15);                 
                                                                        
 DCL     WS_PROGRAMNAVN                 CHAR(8)  INIT ('BH85100');      
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF ABEND STRUKTUR m.v.                               */
 /*                                                                   */
 /*********************************************************************/
 DCL     FEJLTEKST      CHAR (20)        INIT(' ');                     
 DCL     ABENDKODE     FIXED       (2) INIT(5);                         
 DCL     1 ABENDMEDD,                                                   
          2 ABENDMODUL CHAR      (7) INIT ('BH85100'),                  
          2 ABENDFILL1 CHAR      (1) INIT (' '),                        
          2 ABENDMEDNR CHAR      (2) INIT ('**'),                       
          2 ABENDFILL2 CHAR      (1) INIT (' '),                        
          2 ABENDTXT   CHAR      (45);                                  
                                                                        
 DCL     ABENDRTKODE   FIXED     (1) INIT (2);                          
                                                                        
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         OPEN FILE (BH8510O) TITLE ('BH85100O');                        
         OPEN FILE (BH8511O) TITLE ('BH85110O');                        
                                                                        
         CALL ZZ20390 ('*OPEN','BH85101Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         TV = 0;                                                        
         OVERLIN1.TEKST2 = 'DAN LOADGRUNDLAG TIL EVS-PERSONTAB ' !!     
                           'FORSKUD ' !! BH55300M.INDKÅR2; /*#01*/      
                                                                        
         DO I = 1 TO 1000;  /*#02*/                                     
            FEJLTAB(I) = NEJ;                                           
         END;                                                           
                                                                        
         DO INDEX = 5000 TO 6000;                                       
            LÆST_FEJLNR(INDEX).ANTAL = 0;                               
            SKR_FEJLNR(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 12;                                            
            SKR_EJBEVS(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_BERGRL(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_EJDTYP(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         /* FIA - 4 nye tællere */                                      
         LÆST_VURMARK(*).ANTAL = 0;                                     
         LÆST_DVURDÅR(*).ANTAL = 0;                                     
         LÆST_FORSIGT(*).ANTAL = 0;                                     
         LÆST_BESKAT(*).ANTAL  = 0;                                     
                                                                        
         DO INDEX = 1 TO 16;                                            
            TAB_PERSON(INDEX).ANTAL  = 0;                               
            TAB_PERSON(INDEX).ERKL   = 0;                               
            TAB_PERSON(INDEX).EJERKL = 0;                               
         END;                                                           
                                                                        
         TAB_PERSON(1).TEKST  = 'ANTAL PERSONER TIL PERSONTABEL IALT:'; 
         TAB_PERSON(2).TEKST  = '      HERAF MED 1 EJENDOM           '; 
         TAB_PERSON(3).TEKST  = '      HERAF MED 2 EJENDOMME         '; 
         TAB_PERSON(4).TEKST  = '      HERAF MED 3 EJENDOMME         '; 
         TAB_PERSON(5).TEKST  = '      HERAF MED 4 EJENDOMME         '; 
         TAB_PERSON(6).TEKST  = '      HERAF MED 5 EJENDOMME         '; 
         TAB_PERSON(7).TEKST  = '      HERAF MED 6 EJENDOMME         '; 
         TAB_PERSON(8).TEKST  = '      HERAF MED 7 EJENDOMME         '; 
         TAB_PERSON(9).TEKST  = '      HERAF MED 8 EJENDOMME         '; 
         TAB_PERSON(10).TEKST = '      HERAF MED 9 EJENDOMME         '; 
         TAB_PERSON(11).TEKST = '      HERAF MED 10 EJENDOMME        '; 
         TAB_PERSON(12).TEKST = '      HERAF MED 11-20 EJENDOMME     '; 
         TAB_PERSON(13).TEKST = '      HERAF MED 21-30 EJENDOMME     '; 
         TAB_PERSON(14).TEKST = '      HERAF MED 31-40 EJENDOMME     '; 
         TAB_PERSON(15).TEKST = '      HERAF MED 41-50 EJENDOMME     '; 
         TAB_PERSON(16).TEKST = '      HERAF MED OVER 50 EJENDOMME   '; 
                                                                        
         ERKLÆRBAR = JA;                                                
                                                                        
 /*********************************************************************/
 /* ON - CONDITIONS                                                   */
 /*********************************************************************/
                                                                        
         PUT SKIP LIST ('START ' !! WS_PROGRAMNAVN);                    
                                                                        
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
                ON ERROR SYSTEM;                                        
                PUT SKIP LIST ('PROGRAMFEJL');                          
                CALL PLIDUMP  ('SNHOB','PROGRAM BH85100L');             
            END;                                                        
                                                                        
 /*********************************************************************/
 /* HOUSEKEEPING                                                      */
 /*********************************************************************/
         SELECT (BH55300M.AFVIKLINGS_ID);                               
            WHEN ('OPRET_EVS_FORSK')                                    
               DO;                                                      
                  WS_FORSKUD_SLUT_TXT = BH55300M.AFVIKLINGS_ID;         
                  WS_TIL_EVS_AAR = BH55300M.FORSKÅR;                    
               END;                                                     
            WHEN ('OPRET_EVS_SLUT')                                     
               DO;                                                      
                  WS_FORSKUD_SLUT_TXT = BH55300M.AFVIKLINGS_ID;         
                  WS_TIL_EVS_AAR = BH55300M.SLUTÅR;                     
               END;                                                     
            WHEN ('SUPPL_EVS_SLUT')                                     
               DO;                                                      
                  WS_FORSKUD_SLUT_TXT = BH55300M.AFVIKLINGS_ID;         
                  WS_TIL_EVS_AAR = BH55300M.SLUTÅR;                     
               END;                                                     
            OTHERWISE                                                   
               DO;                                                      
                  ABENDTXT = '101 PARAMETERFEJL';                       
                  CALL PROGRAM_FEJL;                                    
               END;                                                     
         END; /* select */                                              
                                                                        
         /********************************************************/     
         /*  NU STARTER CHECK AF OMKØRSEL                        */     
         /********************************************************/     
         PUT SKIP LIST ('Normal kørsel af ' !! WS_PROGRAMNAVN);         
                                                                        
         /********************************************************/     
         /*  NU STARTER NORMALT FLOW                             */     
         /********************************************************/     
         CALL OPDATER_KØRSELSTABEL('START');                            
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL CLOSE_RESULTCURS;                                         
         CALL OPEN_RESULTCURS;                                          
         CALL FETCH_RESULT;       /* BQ78 */                            
                                                                        
         DO WHILE (RESULT_FUNDET);                                      
            CALL SELECT_ESR;      /* BQ75 */                            
            CALL SELECT_MT;       /* BQ76 */                            
            CALL SELECT_SLUT;     /* BQ77 */                            
            CALL BEHANDL;                                               
            CALL FETCH_RESULT;    /* BQ78 */                            
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       UDSØG PERSONER SOM SKAL OPRETTES PÅ PERSONTABELLEN           * 
 *********************************************************************/ 
 BEHANDL: PROC;                                                         
                                                                        
        /* IKKE EVS RELEVANT EJD. SKULLE HAVDE VÆRET    */              
        /* OVERLÆST I BH31800L.                         */              
        IF DCLBQ78000T.TILEVS_A_V_CBENYT = '78'                         
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF DCLBQ78000T.TILEVS_A_EJ_COMPLA = '1'                         
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF DCLBQ76000T.CSTATUS = '2'           /* OMPLACERET */         
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF DCLBQ76000T.CCIVS = 'D'            /* ALTID HVIS DØD */      
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* Disse skal ikke oprettes fejlnummer 5060 findes */           
        /* kun internt i EVS oprettelsen se BH85000        */           
        IF DCLBQ78000T.FEJLNR = 5060                                    
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* Disse skal ikke oprettes fejlnummer 5500 findes */           
        /* kun internt i EVS oprettelsen se BH85000 KS25   */           
        IF DCLBQ78000T.FEJLNR = 5500 &                                  
           DCLBQ78000T.EKOMNR = 999                                     
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* Disse skal ikke oprettes fejlnummer 5502 findes */           
        /* kun internt i EVS oprettelsen se BH85000  D864  */           
        /* Disse skal nu oprettes får senere fejlnummer 5001 */         
     //   IF DCLBQ78000T.FEJLNR = 5502                                  
     //   THEN                                                          
     //      RETURN;                                                    
                                                                        
                                                                        
        /* Disse skal ikke oprettes fejlnummer 5503 findes */           
        /* kun internt i EVS oprettelsen se BH85000  D782  */           
        IF DCLBQ78000T.FEJLNR = 5503                                    
        THEN                                                            
           RETURN;                                                      
                                                                        
                                                                        
        IF DCLBQ78000T.FEJLNR > 0                                       
        THEN                                                            
           DO;                                                          
              INDEX = DCLBQ78000T.FEJLNR;                               
              LÆST_FEJLNR(INDEX).ANTAL = LÆST_FEJLNR(INDEX).ANTAL + 1;  
           END;                                                         
                                                                        
                                                                        
        IF DCLBQ78000T.TILEVS_CEJBEVS ^= 'A' &                          
          (DCLBQ78000T.FEJLNR = 5001 !                                  
           DCLBQ78000T.FEJLNR = 5020)                                   
        THEN                                                            
           RETURN; /* HVIS IKKE FREMSKREVET */                          
                                                                        
        IF DCLBQ78000T.TILEVS_CINVPNR ^= '0'                            
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF DCLBQ78000T.TILEVS_A_EJ_DCPRCIR > 0 &                        
          (DCLBQ78000T.TILEVS_A_EJ_DAFSTÅ > 0 &                         
           DCLBQ78000T.TILEVS_A_EJ_DAFSTÅ <=                            
                                DCLBQ76000T.DRGNÅRTIL)                  
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* F2005 */                                                     
        IF DCLBQ78000T.TILEVS_A_EJ_DCPRCIR > 0 &                        
          (DCLBQ78000T.TILEVS_CEJBEVS = '0' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '1' !/*Forskud 2020 defect 15*/ 
           DCLBQ78000T.TILEVS_CEJBEVS = '2' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '3' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '7' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '8' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = 'A' ! /* defect 1910 F24 */     
           DCLBQ78000T.TILEVS_CEJBEVS = 'B' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = 'C') &                          
           DCLBQ77000T.EVSSEJ_DCPRN > 0 &                               
           DCLBQ77000T.EVSSEJ_SID_CSLET < '1' &                         
          (DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '0' !                       
           DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '4' !                       
           DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '5') &                      
         ((DCLBQ77000T.EVSSEJ_SID_DAFSTAA > 0 &                         
           DCLBQ77000T.EVSSEJ_SID_DAFSTAA <=                            
                                        DCLBQ76000T.DRGNÅRTIL) !        
          (DCLBQ77000T.EVSSEJ_SID_DFRAFLYT > 0 &                        
           DCLBQ77000T.EVSSEJ_SID_DFRAFLYT <=                           
                                        DCLBQ76000T.DRGNÅRTIL))         
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* F2005 */                                                     
        IF DCLBQ78000T.TILEVS_A_EJ_DCPRCIR > 0 &                        
          (DCLBQ78000T.TILEVS_CEJBEVS = '0' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '1' !/*Forskud 2020 defect 15*/ 
           DCLBQ78000T.TILEVS_CEJBEVS = '2' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '3' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '7' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = '8' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = 'A' ! /* defect 1910 F24 */     
           DCLBQ78000T.TILEVS_CEJBEVS = 'B' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = 'C') &                          
           DCLBQ77000T.EVSFEJ_DCPRN > 0 &                               
          (DCLBQ77000T.EVSFEJ_CEJBEVS = '0' !                           
           DCLBQ77000T.EVSFEJ_CEJBEVS = '4') &                          
         ((DCLBQ77000T.EVSFEJ_DAFSTAA > 0 &                             
           DCLBQ77000T.EVSFEJ_DAFSTAA <=                                
                                      DCLBQ76000T.DRGNÅRTIL) !          
          (DCLBQ77000T.EVSFEJ_DFRAFLYT > 0 &                            
           DCLBQ77000T.EVSFEJ_DFRAFLYT <=                               
                                      DCLBQ76000T.DRGNÅRTIL))           
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* F2005 */                                                     
        /* F2020 Denne regl er taget ud i forbindelse med defect 15 */  
        /*                                                              
        IF DCLBQ78000T.TILEVS_A_EJ_DCPRCIR > 0 &                        
           DCLBQ78000T.TILEVS_CEJBEVS = '1'                             
        THEN                                                            
          DO;                                                           
            IF DCLBQ77000T.EVSSEJ_DCPRN > 0 &                           
               DCLBQ77000T.EVSSEJ_SID_CSLET < '1'                       
            THEN                                                        
              DO;                                                       
                IF DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '0' !               
                   DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '4' !               
                   DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '5' !               
                   DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '6' !               
                   DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '7' !               
                   DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '8'                 
                THEN;                                                   
                ELSE                                                    
                   RETURN;                                              
                IF (DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '0' !              
                    DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '4' !              
                    DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '5') &             
                  ((DCLBQ77000T.EVSSEJ_SID_DAFSTAA  > 0 &               
                    DCLBQ77000T.EVSSEJ_SID_DAFSTAA  <=                  
                                           DCLBQ76000T.DRGNÅRTIL) !     
                   (DCLBQ77000T.EVSSEJ_SID_DFRAFLYT > 0 &               
                    DCLBQ77000T.EVSSEJ_SID_DFRAFLYT <=                  
                                           DCLBQ76000T.DRGNÅRTIL))      
                 THEN                                                   
                    RETURN;                                             
              END;                                                      
            IF DCLBQ77000T.EVSFEJ_DCPRN > 0                             
            THEN                                                        
              DO;                                                       
                 IF (DCLBQ77000T.EVSFEJ_CEJBEVS = '0' !                 
                     DCLBQ77000T.EVSFEJ_CEJBEVS = '4') &                
                   ((DCLBQ77000T.EVSFEJ_DAFSTAA  > 0 &                  
                     DCLBQ77000T.EVSFEJ_DAFSTAA  <=                     
                                      DCLBQ76000T.DRGNÅRTIL) !          
                    (DCLBQ77000T.EVSFEJ_DFRAFLYT > 0 &                  
                     DCLBQ77000T.EVSFEJ_DFRAFLYT <=                     
                                      DCLBQ76000T.DRGNÅRTIL))           
                 THEN                                                   
                    RETURN;                                             
                 IF DCLBQ77000T.EVSFEJ_CEJBEVS = '1' !                  
                    DCLBQ77000T.EVSFEJ_CEJBEVS = '2' !                  
                    DCLBQ77000T.EVSFEJ_CEJBEVS = '3'                    
                 THEN                                                   
                    RETURN;                                             
              END;                                                      
          END; */                                                       
                                                                        
        /* F2005 */                                                     
        IF DCLBQ78000T.TILEVS_A_EJ_DCPRCIR = 0 &                        
           DCLBQ78000T.EKOMNR < 999                                     
        THEN                                                            
          DO;                                                           
            IF (DCLBQ77000T.EVSSEJ_DCPRN > 0 &                          
                DCLBQ77000T.EVSSEJ_SID_CSLET < '1' &                    
               (DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '0' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '4' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '5' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '6' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '7' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = '8' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = 'A' ! /* defect 1910 */
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = 'B' !                  
                DCLBQ77000T.EVSSEJ_SID_CEJBEVS = 'C')) !                
               (DCLBQ77000T.EVSFEJ_DCPRN > 0 &                          
               (DCLBQ77000T.EVSFEJ_CEJBEVS = '0' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = '4' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = '5' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = '6' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = '7' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = '8' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = 'A' !    /* defect 1910 */ 
                DCLBQ77000T.EVSFEJ_CEJBEVS = 'B' !                      
                DCLBQ77000T.EVSFEJ_CEJBEVS = 'C'))                      
            THEN                                                        
              DO;                                                       
                IF DCLBQ77000T.EVSSEJ_DCPRN > 0 &                       
                   DCLBQ77000T.EVSSEJ_SID_CSLET < '1' &                 
                 ((DCLBQ77000T.EVSSEJ_SID_DAFSTAA  > 0 &                
                   DCLBQ77000T.EVSSEJ_SID_DAFSTAA  <=                   
                                           DCLBQ76000T.DRGNÅRTIL) !     
                  (DCLBQ77000T.EVSSEJ_SID_DFRAFLYT > 0 &                
                   DCLBQ77000T.EVSSEJ_SID_DFRAFLYT <=                   
                                           DCLBQ76000T.DRGNÅRTIL))      
                THEN                                                    
                   RETURN;                                              
                                                                        
                IF DCLBQ77000T.EVSFEJ_DCPRN > 0 &                       
                 ((DCLBQ77000T.EVSFEJ_DAFSTAA  > 0 &                    
                   DCLBQ77000T.EVSFEJ_DAFSTAA  <=                       
                                           DCLBQ76000T.DRGNÅRTIL) !     
                  (DCLBQ77000T.EVSFEJ_DFRAFLYT > 0 &                    
                   DCLBQ77000T.EVSFEJ_DFRAFLYT <=                       
                                           DCLBQ76000T.DRGNÅRTIL))      
                THEN                                                    
                   RETURN;                                              
              END;                                                      
            ELSE                                                        
               RETURN;                                                  
          END;                                                          
                                                                        
        IF DCLBQ78000T.EKOMNR = 999 &                                   
          (DCLBQ78000T.TILEVS_DAFSTAA > 0 !                             
           DCLBQ78000T.TILEVS_DFRAFLYT > 0)                             
        THEN                                                            
           RETURN;                                                      
                                                                        
       /* ny kode til Forskud 2020 defect 15 */                         
       IF DCLBQ78000T.FEJLNR = 5001 !                                   
          DCLBQ78000T.FEJLNR = 5014 !                                   
          DCLBQ78000T.FEJLNR = 5055                                     
       THEN                                                             
          RETURN;                                                       
                                                                        
       /* defect 285 frasortering af ejendomme med benyttelse 34 */     
       IF  DCLBQ78000T.TILEVS_A_V_CBENYT = '34'  &                      
          (DCLBQ78000T.TILEVS_A_V_ANT_FOR_4 +                           
           DCLBQ78000T.TILEVS_A_V_ANT_FOR_5 +                           
           DCLBQ78000T.TILEVS_A_V_ANT_FOR_6 +                           
           DCLBQ78000T.TILEVS_A_V_ANT_FOR_8 +                           
           DCLBQ78000T.TILEVS_A_V_ANT_FOR_9) = 0                        
       then                                                             
          RETURN;                                                       
                                                                        
        HJ_CHAR1 = DCLBQ78000T.EJENDOM_CEJDTYPE;                        
                                                                        
        IF HJ_CHAR1 < '1'                                               
        THEN                                                            
           INDEX = 0;                                                   
        ELSE                                                            
           INDEX = HJ_PIC1;                                             
                                                                        
        LÆST_EJDTYP(INDEX).ANTAL = LÆST_EJDTYP(INDEX).ANTAL + 1;        
                                                                        
        HJ_CHAR1 = DCLBQ78000T.EJENDOM_CBERGRL;                         
                                                                        
        IF HJ_CHAR1 < '1'                                               
        THEN                                                            
           INDEX = 0;                                                   
        ELSE                                                            
           INDEX = HJ_PIC1;                                             
                                                                        
        LÆST_BERGRL(INDEX).ANTAL = LÆST_BERGRL(INDEX).ANTAL + 1;        
                                                                        
                                                                        
         /* FIA - 4 nye tællere herunder pr. 2021-06-17 */              
         /* LÆST_VURMARK */                                             
         HJ_P3 = DCLBQ78000T.EJERSKAB_VURMARK;                          
         INDEX = HJ_P3;                                                 
         LÆST_VURMARK(INDEX).ANTAL = LÆST_VURMARK(INDEX).ANTAL + 1;     
                                                                        
         /* LÆST_DVURDÅR */                                             
         HJ_CHAR_4 = DCLBQ75000T.OPL_VURDGL_DVURDÅR;                    
         INDEX = HJ_CHAR_4_PIC;                                         
         IF INDEX = 0                                                   
            ! INDEX <= 2000                                             
            ! INDEX > 2050 THEN                                         
           LÆST_DVURDÅR(2000).ANTAL = LÆST_DVURDÅR(2000).ANTAL + 1;     
         ELSE                                                           
           LÆST_DVURDÅR(INDEX).ANTAL = LÆST_DVURDÅR(INDEX).ANTAL + 1;   
                                                                        
         /* LÆST_FORSIGT */                                             
         IF DCLBQ78000T.EJERSKAB_FORSIGT_EVS = 'N' THEN                 
           INDEX = 10;                                                  
         ELSE IF DCLBQ78000T.EJERSKAB_FORSIGT_EVS = 'J' THEN            
           INDEX = 11;                                                  
         ELSE                                                           
           INDEX = 12;                                                  
         LÆST_FORSIGT(INDEX).ANTAL = LÆST_FORSIGT(INDEX).ANTAL + 1;     
                                                                        
         /* LÆST_BESKAT */                                              
         IF DCLBQ78000T.EJERSKAB_BESKAT = 'N' THEN                      
           INDEX = 10;                                                  
         ELSE IF DCLBQ78000T.EJERSKAB_BESKAT = 'J' THEN                 
           INDEX = 11;                                                  
         ELSE                                                           
           INDEX = 12;                                                  
         LÆST_BESKAT(INDEX).ANTAL = LÆST_BESKAT(INDEX).ANTAL + 1;       
                                                                        
                                                                        
        /* Der opsæætes nu EPLBNR - periodeløbenummer              */   
        /*              og ERLBNR - rækkeløbenumer inde for person */   
        /* Ny regl for bestemmelse af ELBNR (HJLBNR) til BS00600T  */   
        IF GEM_PNR ^= DCLBQ78000T.DCPRN                                 
        THEN                                                            
           DO;                                                          
              IF FANTINDV > 0                                           
              THEN                                                      
                 DO;                                                    
                    CALL OPTÆL_PERSON;                                  
                    CALL SKRIV_TIL_BN04000T;                            
                 END;                                                   
              ERKLÆRBAR = JA;                                           
              FANTINDV = 1;                                             
              GEM_PNR   = DCLBQ78000T.DCPRN;                            
              GEM_PNR   = DCLBQ78000T.DCPRN;                            
              GEM_KOMNR = DCLBQ78000T.EKOMNR;                           
              GEM_EJDNR = DCLBQ78000T.EEJDNR;                           
              GEM_EENHEDLBNR = DCLBQ78000T.EENHEDLBNR;                  
              HJ_EPLBNR = 1;                                            
              HJ_ERLBNR = 1;                                            
           END;                                                         
        ELSE                                                            
           DO;                                                          
             /* Ny række på samme person */                             
             HJ_ERLBNR = HJ_ERLBNR + 1;                                 
              /* Ny række indenfor samme person og ejendom */           
             IF GEM_KOMNR   = DCLBQ78000T.EKOMNR &                      
                GEM_EJDNR   = DCLBQ78000T.EEJDNR &                      
                GEM_EENHEDLBNR = DCLBQ78000T.EENHEDLBNR                 
             THEN                                                       
               HJ_EPLBNR = HJ_EPLBNR + 1;                               
             ELSE                                                       
               DO;                                                      
                 GEM_KOMNR = DCLBQ78000T.EKOMNR;                        
                 GEM_EJDNR = DCLBQ78000T.EEJDNR;                        
                 GEM_EENHEDLBNR = DCLBQ78000T.EENHEDLBNR;               
                 /* Ny ejendom indenfor samme person */                 
                 HJ_EPLBNR = 1;                                         
               END;                                                     
              FANTINDV = FANTINDV + 1;                                  
           END;                                                         
                                                                        
        CALL UDSØG_TIL_BN04000T;                                        
                                                                        
        IF DCLBQ78000T.TILEVS_CEJBEVS = '0' !                           
           DCLBQ78000T.TILEVS_CEJBEVS = 'A'                             
        THEN;                                                           
        ELSE                                                            
           ERKLÆRBAR = NEJ;                                             
                                                                        
         BH851 = '';                                                    
                                                                        
         BH851.DINDKAAR     = BH55300M.FORSKÅR;        /*#01*/          
         BH851.PERSONNUMMER = DCLBQ78000T.DCPRN;                        
         BH851.EKOMNR       = DCLBQ78000T.EKOMNR;                       
         BH851.EEJDNR       = DCLBQ78000T.EEJDNR;                       
         BH851.EENHEDLBNR   = DCLBQ78000T.EENHEDLBNR;                   
         BH851.EPLBNR       = HJ_EPLBNR;                                
         BH851.DFRAGLD = DATO2.ÅR !! '-' !! DATO2.MD !! '-' !!          
                         DATO2.DG !! '-01.01.01.000001';                
         BH851.DTILGLD  = '9999-12-31-23.59.59.999999';                 
         BH851.DKØRT    = '1900-12-31-00.00.00.000001';                 
         BH851.ERLBNR       = HJ_ERLBNR;                                
         BH851.CEVSBENY = '1'; /* SÆTTES NUL HVIS ANVENDES I BEREGNING*/
                               /* NÅR FORSKUD AFVIKLES */               
         BH851.CEJBEVS  = DCLBQ78000T.TILEVS_CEJBEVS;                   
         BH851.FEJLNR   = DCLBQ78000T.FEJLNR;                           
         /* Udgåede ejendomme    PBR 08.09.2022 */                      
         IF DCLBQ78000T.FEJLNR = 5502 &                                 
            DCLBQ78000T.TILEVS_A_V_CBENYT = '16'                        
          THEN DO;                                                      
             BH851.FEJLNR     = 5001;                                   
             BH851.CSLET      = '1';                                    
             BH851.COPR_CSLET = 'F';                                    
             END;                                                       
         BH851.CDATAFRA = DCLBQ78000T.TILEVS_CDATAFRA;                  
         BH851.DOVTG    = DCLBQ78000T.TILEVS_DOVTG;                     
         BH851.DAFSTAA  = DCLBQ78000T.TILEVS_DAFSTAA;                   
         IF DCLBQ78000T.EJERSKAB_CEJDTYPE > '0'                         
         THEN                                                           
           BH851.CEJDTYPE = DCLBQ78000T.EJERSKAB_CEJDTYPE;              
         ELSE                                                           
           BH851.CEJDTYPE = DCLBQ78000T.EJENDOM_CEJDTYPE;               
         BH851.GPCTEJER = DCLBQ78000T.TILEVS_GPCTEJER * 100;            
         BH851.BBERGRL  = DCLBQ78000T.EJERSKAB_BBERGRL;                 
         BH851.CBERGRL  = DCLBQ78000T.EJENDOM_CBERGRL;                  
         BH851.BGRPROM1 = DCLBQ78000T.FRAEVS_FOR_BGRPROM1;              
         BH851.BPROM1   = DCLBQ78000T.FRAEVS_FOR_BPROM1;                
         BH851.BGRPROM2 = DCLBQ78000T.FRAEVS_FOR_BGRPROM2;              
         BH851.BPROM2   = DCLBQ78000T.FRAEVS_FOR_BPROM2;                
         BH851.CNEDSL1  = DCLBQ78000T.TILEVS_CNEDSL1;                   
         BH851.BNEDSL1  = DCLBQ78000T.FRAEVS_FOR_BNEDSL1;               
         BH851.CNEDSL2  = DCLBQ78000T.FRAEVS_FOR_CNEDSL2;               
         BH851.BNEDSL2  = DCLBQ78000T.FRAEVS_FOR_BNEDSL2;               
         BH851.BPENSNED = DCLBQ78000T.FRAEVS_FOR_BPENSNED;              
         BH851.BPENSIND = DCLBQ78000T.TILEVS_BPENSIND;                  
         BH851.BPENSRED = DCLBQ78000T.FRAEVS_FOR_BPENSRED;              
         BH851.BSTIBGR  = DCLBQ78000T.FRAEVS_FOR_BSTIBGR;               
         BH851.CSTIBLB  = DCLBQ78000T.FRAEVS_FOR_CSTIBLB;               
         BH851.BSTITIL  = DCLBQ78000T.FRAEVS_FOR_BSTITIL;               
         BH851.BUDLSKC  = DCLBQ78000T.TILEVS_FOR_BUDLSKC;               
         BH851.DATO0107 = DCLBQ78000T.TILEVS_DATO0107;                  
         BH851.FDAGEJ   = DCLBQ78000T.FRAEVS_FOR_FDAGEJ;                
         BH851.FDAGEJEJ = DCLBQ78000T.FRAEVS_FOR_FDAGEJEJ;              
         BH851.FDAGUDLE = DCLBQ78000T.TILEVS_FOR_FDAGUDLE;              
         BH851.GPCTUDLE = DCLBQ78000T.TILEVS_FOR_GPCTUDLE;              
         BH851.FDAGERHV = DCLBQ78000T.TILEVS_FOR_FDAGERHV;              
         BH851.GPCTERHV = DCLBQ78000T.TILEVS_FOR_GPCTERHV;              
         BH851.BSUM1    = DCLBQ78000T.FRAEVS_FOR_BSUM1;                 
         BH851.BNETTO   = DCLBQ78000T.FRAEVS_FOR_BNETTO;                
         BH851.BBRUTTO  = DCLBQ78000T.FRAEVS_FOR_BBRUTTO;               
         BH851.BEJERED  = DCLBQ78000T.FRAEVS_FOR_BEJERED;               
         BH851.BERHVRED = DCLBQ78000T.FRAEVS_FOR_BERHVRED;              
         BH851.BUDLERED = DCLBQ78000T.FRAEVS_FOR_BUDLERED;              
         BH851.B100     = DCLBQ78000T.FRAEVS_FOR_B100;                  
         BH851.BEJERAN  = DCLBQ78000T.FRAEVS_FOR_BEJERAN;               
         BH851.BEJBOL1  = DCLBQ78000T.EJENDOM_BEJBOL1;                  
         BH851.BEJBOL2  = DCLBQ78000T.EJENDOM_BEJBOL2;                  
         BH851.CFRED    = DCLBQ78000T.TILEVS_CFRED;                     
         BH851.CTYPSLUT = DCLBQ78000T.TILEVS_CPTYPSLUT;                 
         BH851.CTYPFOR  = DCLBQ78000T.TILEVS_CPTYPFOR;                  
         BH851.BGLEVS10 = DCLBQ78000T.FRAEVS_SLUT_BGLEVS10;             
         BH851.BGLEVS2  = DCLBQ78000T.FRAEVS_SLUT_BGLEVS2;              
         BH851.BGLEVS4  =  DCLBQ78000T.FRAEVS_SLUT_BGLEVS4;             
         BH851.BGLEVSP  =  DCLBQ78000T.FRAEVS_SLUT_BGLEVSP;             
         BH851.BGLSUM1   = DCLBQ78000T.FRAEVS_SLUT_BGLSUM1;             
         BH851.BGLSTIBGR = DCLBQ78000T.FRAEVS_SLUT_BGLSTIBGR;           
         BH851.BGLSTITIL = DCLBQ78000T.FRAEVS_SLUT_BGLSTITIL;           
         BH851.BGLSUM    = DCLBQ78000T.FRAEVS_FOR_BGLSUM;               
         IF DCLBQ78000T.FRAEVS_FOR_BGLSUM_SW = -1                       
         THEN                                                           
            BH851.BGLSUM_NULL = '?';                                    
         BH851.BNYMAN    = DCLBQ78000T.TILEVS_BNYMAN;                   
         BH851.BNYMAN_NULL = '?'; /* BNYMAN KAN IKKE KOMME I.F.M. */    
                                  /* OPRETTELSEN                  */    
         BH851.CGLANV    = DCLBQ78000T.FRAEVS_SLUT_CGLANV;              
         BH851.CENKE     = DCLBQ78000T.TILEVS_CENKE;                    
         BH851.CÆGTOPR   = DCLBQ78000T.TILEVS_CÆGTOPR;                  
         BH851.CGLSLUTEVS     = DCLBQ78000T.TILEVS_CGLSLUTEVS;          
         BH851.BGLSLUTEVS     = DCLBQ78000T.TILEVS_BGLSLUTEVS;          
         BH851.BGLPENSNED     = DCLBQ78000T.TILEVS_BGLPENSNED;          
         BH851.BGLSUM2        = DCLBQ78000T.FRAEVS_SLUT_BGLSUM2;        
         BH851.BGLSLUTSTI     = DCLBQ78000T.FRAEVS_SLUT_BGLSLUTSTI;     
         BH851.BSUM2          = DCLBQ78000T.FRAEVS_FOR_BSUM2;           
         BH851.COPR_CEJDTYPE  = DCLBQ78000T.TILFORSK_COPR_CEJDTYPE;     
         BH851.COPR_BBERGRL   = DCLBQ78000T.TILFORSK_COPR_BBERGRL;      
         /* Defect 30 forskud 2023 EBD */                               
         /* felt 611 må kun opsættes 2 familie ejendomme */             
         IF BH851.CEJDTYPE = '4' !                                      
            BH851.CEJDTYPE = '5'                                        
         THEN                                                           
           BH851.COPR_BBER2FAM  = DCLBQ78000T.TILFORSK_COPR_BBER2FAM;   
         ELSE                                                           
           BH851.COPR_BBER2FAM  = '';                                   
         BH851.COPR_GPCTEJER  = DCLBQ78000T.TILFORSK_COPR_GPCTEJER;     
         BH851.COPR_DOVTG     = DCLBQ78000T.TILFORSK_COPR_DOVTG;        
         BH851.COPR_DAFSTAA   = DCLBQ78000T.TILFORSK_COPR_DAFSTAA;      
         BH851.COPR_CNEDSL1   = DCLBQ78000T.TILFORSK_COPR_CNEDSL1;      
         BH851.COPR_CPTYPSLUT = DCLBQ78000T.TILFORSK_COPR_CPTYPSLUT;    
         BH851.COPR_CPTYPFOR  = DCLBQ78000T.TILFORSK_COPR_CPTYPFOR;     
         BH851.COPR_CEJBEVS   = DCLBQ78000T.TILFORSK_COPR_CEJBEVS;      
         BH851.COPR_CFRED     = DCLBQ78000T.TILFORSK_COPR_CFRED;        
         BH851.COPR_GPCTUDLE  = DCLBQ78000T.TILFORSK_COPR_GPCTUDLE;     
         BH851.COPR_FDAGUDLE  = DCLBQ78000T.TILFORSK_COPR_FDAGUDLE;     
         BH851.COPR_GPCTERHV  = DCLBQ78000T.TILFORSK_COPR_GPCTERHV;     
         BH851.COPR_FDAGERHV  = DCLBQ78000T.TILFORSK_COPR_FDAGERHV;     
         BH851.COPR_BUDLSKC   = DCLBQ78000T.TILFORSK_COPR_BUDLSKC;      
         BH851.COPR_CENKE     = DCLBQ78000T.TILFORSK_COPR_CENKE;        
         BH851.DINDFLYT       = DCLBQ78000T.TILEVS_DINDFLYT;            
         BH851.DFRAFLYT       = DCLBQ78000T.TILEVS_DFRAFLYT;            
         BH851.FUBEBOELIG     = DCLBQ78000T.TILEVS_FOR_FUBEBOELIG;      
         BH851.BFASTSTIGBGR   = DCLBQ78000T.TILEVS_BFASTSTIGBGR;        
         IF DCLBQ78000T.TILEVS_BFASTSTIGBGR_SW = -1                     
         THEN                                                           
            BH851.BFASTSTIGBGR_NULL = '?';                              
         BH851.COPR_BFASTSTIGBGR =                                      
                             DCLBQ78000T.TILFORSK_COPR_BFASTSTIGBGR;    
         BH851.CBERGRLANV     = DCLBQ78000T.EJERSKAB_CBERGRLANV;        
         BH851.CHELÅR         = DCLBQ78000T.TILEVS_CHELÅR;              
         BH851.CPENSNED1      = DCLBQ78000T.TILEVS_FOR_CPENSNED1;       
         BH851.COPR_CPENSNED1 = DCLBQ78000T.TILFORSK_COPR_CPENSNED1;    
         BH851.BEJBOLANV         = DCLBQ78000T.EJERSKAB_BEJBOLANV;      
         BH851.CANVEBOL          = DCLBQ78000T.EJERSKAB_CANVEBOL;       
         IF DCLBQ78000T.EJERSKAB_BEJBOLANV_SW = -1                      
         THEN                                                           
            BH851.BEJBOLANV_NULL = '?';                                 
         BH851.BUBEBOLRED        = DCLBQ78000T.FRAEVS_FOR_BUBEBOLRED;   
         BH851.CFORSKEL          = DCLBQ78000T.EJENDOM_CFORSKEL;        
         BH851.BEJDVÆR_015ANV    = DCLBQ78000T.VURD_015ANV_BEJDVÆR;     
         IF DCLBQ78000T.VURD_015ANV_BEJDVÆR_SW = -1                     
         THEN                                                           
            BH851.BEJDVÆR_015ANV_NULL = '?';                            
         BH851.BEJBOL1_015ANV    = DCLBQ78000T.VURD_015ANV_BEJBOL1;     
         BH851.CEJBOLTYP1_015ANV = DCLBQ78000T.VURD_015ANV_CEJBOLTYP1;  
         BH851.BEJBOL2_015ANV    = DCLBQ78000T.VURD_015ANV_BEJBOL2;     
         BH851.CEJBOLTYP2_015ANV = DCLBQ78000T.VURD_015ANV_CEJBOLTYP2;  
         BH851.BEVSGL            = DCLBQ78000T.FRAEVS_SLUT_BEVSGL;      
         IF DCLBQ78000T.FRAEVS_SLUT_BEVSGL_SW = -1                      
         THEN                                                           
            BH851.BEVSGL_NULL = '?';                                    
         BH851.COPR_BEVSGL       = DCLBQ78000T.TILFORSK_COPR_BEVSGL;    
         BH851.BPENSNEDGL        = DCLBQ78000T.FRAEVS_SLUT_BPENSNEDGL;  
         IF DCLBQ78000T.FRAEVS_SLUT_BPENSNEDGL_SW = -1                  
         THEN                                                           
            BH851.BPENSNEDGL_NULL = '?';                                
         BH851.COPR_BPENSNEDGL  = DCLBQ78000T.TILFORSK_COPR_BPENSNEDGL; 
         BH851.BGLSUM3          = DCLBQ78000T.FRAEVS_SLUT_BGLSUM3;      
         BH851.BSUM3            = DCLBQ78000T.FRAEVS_FOR_BSUM3;         
         BH851.BBERGRLGL        = DCLBQ78000T.EJERSKAB_BBERGRLGL;       
         IF DCLBQ78000T.EJERSKAB_BBERGRLGL_SW = -1                      
         THEN                                                           
            BH851.BBERGRLGL_NULL = '?';                                 
                                                                        
         /* Defect 30 forskud 2023 EBD */                               
         /* felt 611 må kun opsættes på 2familie ejendomme */           
         IF BH851.CEJDTYPE = '4' !                                      
            BH851.CEJDTYPE = '5'                                        
         THEN                                                           
           DO;                                                          
             BH851.BBER2FAMGL       = DCLBQ78000T.EJERSKAB_BBER2FAMGL;  
             IF DCLBQ78000T.EJERSKAB_BBER2FAMGL_SW = -1                 
             THEN                                                       
               BH851.BBER2FAMGL_NULL = '?';                             
             BH851.BBER2FAM         = DCLBQ78000T.EJERSKAB_BBER2FAM;    
           END;                                                         
         ELSE                                                           
           DO;                                                          
             BH851.BBER2FAMGL       = 0;                                
             BH851.BBER2FAMGL_NULL  = '?';                              
             BH851.BBER2FAM         = 0;                                
           END;                                                         
                                                                        
         BH851.BEVSFREM         = DCLBQ78000T.TILEVS_FOR_BEVSFREM;      
         IF DCLBQ78000T.TILEVS_FOR_BEVSFREM_SW = -1                     
         THEN                                                           
            DO;                                                         
               DCLBQ78000T.TILEVS_FOR_BEVSFREM = 0;                     
               BH851.BEVSFREM_NULL = '?';                               
            END;                                                        
         BH851.COPR_BEVSFREM    = DCLBQ78000T.TILFORSK_COPR_BEVSFREM;   
         BH851.BEJDVÆR_02ANV    = DCLBQ78000T.VURD_02ANV_BEJDVÆR;       
         IF DCLBQ78000T.VURD_02ANV_BEJDVÆR_SW = -1                      
         THEN                                                           
            BH851.BEJDVÆR_02ANV_NULL = '?';                             
         BH851.BEJBOL1_02ANV    = DCLBQ78000T.VURD_02ANV_BEJBOL1;       
         BH851.CEJBOLTYP1_02ANV = DCLBQ78000T.VURD_02ANV_CEJBOLTYP1;    
         BH851.BEJBOL2_02ANV    = DCLBQ78000T.VURD_02ANV_BEJBOL2;       
         BH851.CEJBOLTYP2_02ANV = DCLBQ78000T.VURD_02ANV_CEJBOLTYP2;    
         BH851.CEJDTYPE_AKT     = DCLBQ78000T.EJERSKAB_CEJDTYPE_AKT;    
         BH851.CPTYPGL          = DCLBQ78000T.TILEVS_CPTYPGL;           
         BH851.CEKSEMP          = DCLBQ78000T.TILEVS_FOR_CEKSEMP;       
         BH851.COPR_EKSEMP      = DCLBQ78000T.TILFORSK_COPR_EKSEMP;     
         BH851.BBERGRL_015ANV   = DCLBQ78000T.VURD_015ANV_BBERGRL;      
         IF DCLBQ78000T.VURD_015ANV_BBERGRL_SW = -1                     
         THEN                                                           
            BH851.BBERGRL_015ANV_NULL = '?';                            
         BH851.BBERGRL_02ANV    = DCLBQ78000T.VURD_02ANV_BBERGRL;       
         IF DCLBQ78000T.VURD_02ANV_BBERGRL_SW = -1                      
         THEN                                                           
            BH851.BBERGRL_02ANV_NULL = '?';                             
         BH851.BBERGRL_AKT      = DCLBQ78000T.VURD_A_BBERGRL_AKT;       
         IF DCLBQ78000T.VURD_A_BBERGRL_A_SW = -1                        
         THEN                                                           
            BH851.BBERGRL_AKT_NULL = '?';                               
                                                                        
        /* SLUT PÅ NY KODE TIL FLYTNING AF VÆRDIER*/                    
                                                                        
         IF DCLBQ78000T.TILEVS_A_EJ_COMPLA = '2'                        
         THEN                                                           
            DO;                                                         
               BH851.COMPLA = DCLBQ78000T.TILEVS_A_EJ_COMPLA;           
               BH851.DOMPLACPR = DCLBQ78000T.TILEVS_A_EJ_DOMPLACPR;     
            END;                                                        
                                                                        
        BH851.CFORSKEL = DCLBQ78000T.TILEVS_A_V_CFORSKEL;               
                                                                        
        //Tidligere  DCLBQ78000T.FEJLNR > 0                             
        IF BH851.FEJLNR > 0                                             
        THEN                                                            
           DO;                                                          
              //BH851.FEJLNR = DCLBQ78000T.FEJLNR;                      
              INDEX = BH851.FEJLNR;                                     
              SKR_FEJLNR(INDEX).ANTAL = SKR_FEJLNR(INDEX).ANTAL + 1;    
           END;                                                         
                                                                        
        /* NYE FELT FORSKUD 2021 */                                     
        BH851.VURMARK_AKT    = DCLBQ78000T.VURD_A_VURMARK_AKT;          
        BH851.VURMARK_02ANV  = DCLBQ78000T.VURD_02ANV_VURMARK;          
        BH851.VURMARK_015ANV = DCLBQ78000T.VURD_015ANV_VURMARK;         
        BH851.VURMARK        = DCLBQ78000T.EJERSKAB_VURMARK;            
                                                                        
        /* NYE FELT FORSKUD 2021 SLUT */                                
                                                                        
        /* NYE FELT FORSKUD 2022 mellemperiode */                       
        BH851.JUR_KATEGO_AKT    = DCLBQ78000T.VURD_A_JUR_KATEGO;        
        BH851.JUR_KATEGO_02ANV  = DCLBQ78000T.VURD_02ANY_JUR_KATEGO;    
        BH851.JUR_KATEGO_015ANV = DCLBQ78000T.VURD_015ANY_JUR_KATEGO;   
        BH851.JUR_KATEGO        = DCLBQ78000T.EJERSKAB_JUR_KATEGO;      
                                                                        
        BH851.JUR_UKATEGO_AKT    = DCLBQ78000T.VURD_A_JUR_UKATEGO;      
        BH851.JUR_UKATEGO_02ANV  = DCLBQ78000T.VURD_02ANY_JUR_UKATEGO;  
        BH851.JUR_UKATEGO_015ANV = DCLBQ78000T.VURD_015ANY_JUR_UKATEGO; 
        BH851.JUR_UKATEGO        = DCLBQ78000T.EJERSKAB_JUR_UKATEGO;    
                                                                        
        BH851.VURDATO_AKT    = DCLBQ78000T.VURD_A_VURDATO;              
        BH851.VURDATO_02ANV  = DCLBQ78000T.VURD_02ANY_VURDATO;          
        BH851.VURDATO_015ANV = DCLBQ78000T.VURD_015ANY_VURDATO;         
        BH851.VURDATO        = DCLBQ78000T.EJERSKAB_JUR_VURDATO;        
                                                                        
        BH851.FORSIGT_EVS_AKT    = DCLBQ78000T.VURD_A_FORSIGT_EVS;      
        BH851.FORSIGT_EVS_02ANV  = DCLBQ78000T.VURD_02ANY_FORSIGT_EVS;  
        BH851.FORSIGT_EVS_015ANV = DCLBQ78000T.VURD_015ANY_FORSIGT_EVS; 
        BH851.FORSIGT_EVS        = DCLBQ78000T.EJERSKAB_FORSIGT_EVS;    
                                                                        
        BH851.BESKAT_EVS_AKT    = DCLBQ78000T.VURD_A_BESKAT_EVS;        
        BH851.BESKAT_EVS_02ANV  = DCLBQ78000T.VURD_02ANY_BESKAT_EVS;    
        BH851.BESKAT_EVS_015ANV = DCLBQ78000T.VURD_015ANY_BESKAT_EVS;   
        BH851.BESKAT_EVS        = DCLBQ78000T.EJERSKAB_BESKAT;          
        /* NYE FELT FORSKUD 2022 mellemperiode SLUT */                  
                                                                        
        /* KS46 */                                                      
        BH851.CRTEKORNS      = DCLBQ78000T.EJERSKAB_CRTEKORNS;          
        BH851.COPR_CRTEKORNS = DCLBQ78000T.EJERSKAB_COPR_CRTEKORNS;     
                                                                        
                                                                        
                                                                        
        /* Rettet 2020-10-28 EBD */                                     
        IF DCLBQ78000T.TILEVS_CEJBEVS >= '0' !                          
           DCLBQ78000T.TILEVS_CEJBEVS = 'A'  !                          
           DCLBQ78000T.TILEVS_CEJBEVS = 'B'  !                          
           DCLBQ78000T.TILEVS_CEJBEVS = 'C'                             
        THEN                                                            
           DO;                                                          
             SELECT(DCLBQ78000T.TILEVS_CEJBEVS);                        
               WHEN('A')                                                
                 DO;                                                    
                   INDEX = 10;                                          
                 END;                                                   
               WHEN('B')                                                
                 DO;                                                    
                   INDEX = 11;                                          
                 END;                                                   
               WHEN('C')                                                
                 DO;                                                    
                   INDEX = 12;                                          
                 END;                                                   
               OTHER                                                    
                 DO;                                                    
                   HJ_CHAR1 = DCLBQ78000T.TILEVS_CEJBEVS;               
                   INDEX = HJ_PIC1;                                     
                 END;                                                   
             END; /*SELECT*/                                            
             SKR_EJBEVS(INDEX).ANTAL = SKR_EJBEVS(INDEX).ANTAL + 1;     
           END;                                                         
                                                                        
         IF DCLBQ78000T.TILEVS_CEJBEVS = '0'                            
         THEN                                                           
            DO;                                                         
              TV.BEREGNET = TV.BEREGNET + 1;                            
              IF DCLBQ78000T.TILEVS_CHELÅR > '3'                        
              THEN                                                      
                 TV.FANTSOM = TV.FANTSOM + 1;                           
              IF DCLBQ78000T.FRAEVS_FOR_BPROM1 > 0                      
              THEN                                                      
                 TV.BPROM1 = TV.BPROM1 + 1;                             
              IF DCLBQ78000T.FRAEVS_FOR_BPROM2 > 0                      
              THEN                                                      
                 TV.BPROM2 = TV.BPROM2 + 1;                             
              IF DCLBQ78000T.FRAEVS_FOR_BNEDSL1 > 0                     
              THEN                                                      
                 TV.BNEDSL1 = TV.BNEDSL1 + 1;                           
              IF DCLBQ78000T.FRAEVS_FOR_BNEDSL2 > 0                     
              THEN                                                      
                 TV.BNEDSL2 = TV.BNEDSL2 + 1;                           
                                                                        
              IF DCLBQ78000T.FRAEVS_FOR_BPENSNED > 0                    
              THEN                                                      
                 DO;                                                    
                    IF DCLBQ78000T.TILEVS_FOR_CPENSNED1 = '1'           
                    THEN                                                
                       TV.CPENSN6000 = TV.CPENSN6000 + 1;               
                    ELSE                                                
                       TV.CPENSN2000 = TV.CPENSN2000 + 1;               
                 END;                                                   
                                                                        
              IF DCLBQ78000T.FRAEVS_FOR_BPROM1 > 0                      
              THEN                                                      
                 DO;                                                    
                    IF DCLBQ78000T.FRAEVS_FOR_BEJERAN = 0               
                    THEN                                                
                       TV.BEREJD = TV.BEREJD +                          
                       DCLBQ78000T.FRAEVS_FOR_B100;                     
                    ELSE                                                
                       TV.BEREJD = TV.BEREJD +                          
                       DCLBQ78000T.FRAEVS_FOR_BEJERAN;                  
                 END;                                                   
                                                                        
              /* 14-09-2001 PBR */                                      
              SELECT (DCLBQ78000T.TILEVS_A_EJ_BOPÆLSKODE);              
                WHEN ('1')                                              
                  TV.BER_BOPÆL1 = TV.BER_BOPÆL1 + 1;                    
                WHEN ('2')                                              
                  TV.BER_BOPÆL2 = TV.BER_BOPÆL2 + 1;                    
                WHEN ('3')                                              
                  TV.BER_BOPÆL3 = TV.BER_BOPÆL3 + 1;                    
                WHEN ('4')                                              
                  TV.BER_BOPÆL4 = TV.BER_BOPÆL4 + 1;                    
                WHEN ('5')                                              
                  TV.BER_BOPÆL5 = TV.BER_BOPÆL5 + 1;                    
                WHEN ('6')                                              
                  TV.BER_BOPÆL6 = TV.BER_BOPÆL6 + 1;                    
                OTHERWISE                                               
                  TV.BER_BOPÆL0 = TV.BER_BOPÆL0 + 1;                    
              END;                                                      
            END;                                                        
         ELSE                                                           
            DO;                                                         
              TV.EJBEREGNET = TV.EJBEREGNET + 1;                        
              /* 14-09-2001 PBR */                                      
              SELECT (DCLBQ78000T.TILEVS_A_EJ_BOPÆLSKODE);              
                WHEN ('1')                                              
                  TV.EJBER_BOPÆL1 = TV.EJBER_BOPÆL1 + 1;                
                WHEN ('2')                                              
                  TV.EJBER_BOPÆL2 = TV.EJBER_BOPÆL2 + 1;                
                WHEN ('3')                                              
                  TV.EJBER_BOPÆL3 = TV.EJBER_BOPÆL3 + 1;                
                WHEN ('4')                                              
                  TV.EJBER_BOPÆL4 = TV.EJBER_BOPÆL4 + 1;                
                WHEN ('5')                                              
                  TV.EJBER_BOPÆL5 = TV.EJBER_BOPÆL5 + 1;                
                WHEN ('6')                                              
                  TV.EJBER_BOPÆL6 = TV.EJBER_BOPÆL6 + 1;                
                OTHERWISE                                               
                  TV.EJBER_BOPÆL0 = TV.EJBER_BOPÆL0 + 1;                
              END;                                                      
            END;                                                        
                                                                        
         IF DCLBQ78000T.TILEVS_FOR_BEVSFREM_SW = 0                      
         THEN                                                           
            DO;                                                         
               TV.FREMSKREVET = TV.FREMSKREVET + 1;                     
               TV.EJDFREM = TV.EJDFREM +                                
               DCLBQ78000T.TILEVS_FOR_BEVSFREM;                         
            END;                                                        
                                                                        
         IF DCLBQ78000T.TILEVS_BFASTSTIGBGR_SW = 0                      
         THEN                                                           
            DO;                                                         
               TV.FASTSTIG = TV.FASTSTIG + 1;                           
               TV.BFASTSTIGBGR =                                        
               TV.BFASTSTIGBGR + DCLBQ78000T.TILEVS_BFASTSTIGBGR;       
            END;                                                        
                                                                        
                                                                        
                                                                        
         TV.SKREVET = TV.SKREVET + 1;                                   
                                                                        
         WRITE FILE (BH8510O) FROM (BH851);                             
                                                                        
 END BEHANDL;                                                           
                                                                        
 /********************************************************************* 
 *       FIND FEJLNUMRE TIL BN04000T PR. PERSON                       * 
 *********************************************************************/ 
 UDSØG_TIL_BN04000T: PROC;                                              
                                                                        
   /* #6.1  5010 SKAL NU VÆRE ADVIS, 5045 UDGÅET /*                     
   /* #6.1  DER OPSÆTTES KUN FEJLNUMRE, NÅR CEJBEVS = 2 ELLER 3 */      
         IF DCLBQ78000T.TILEVS_CEJBEVS = '1' !                          
            DCLBQ78000T.TILEVS_CEJBEVS = 'A' !                          
            DCLBQ78000T.TILEVS_CEJBEVS = '7' !                          
            DCLBQ78000T.TILEVS_CEJBEVS = '8' !                          
            DCLBQ78000T.FEJLNR = 0                                      
         THEN                                                           
            RETURN;                                                     
                                                                        
         I = DCLBQ78000T.FEJLNR - 5000;                                 
         FEJLTAB(I) = JA;                                               
                                                                        
 END UDSØG_TIL_BN04000T;                                                
 /********************************************************************* 
 *       SKRIV FEJLNUMRE TIL BN04000T PR. PERSON                      * 
 *********************************************************************/ 
 SKRIV_TIL_BN04000T:PROC;                                               
                                                                        
         DO I = 1 TO 1000;  /* fejlnummer 5001 til 6000 */              
            IF FEJLTAB(I) = JA                                          
            THEN                                                        
               DO;                                                      
                  BH8511.INDKOMSTÅR = WS_TIL_EVS_AAR;   /*F2024*/       
                  BH8511.DCPRN = GEM_PNR;                               
                  BH8511.FEJLNR = 5000 + I;                             
                  IF ADVIS_OK(BH8511.FEJLNR)                 /* #6.1 */ 
                  THEN                                                  
                     BH8511.FTYPE = 'A';                                
                  ELSE                                                  
                     BH8511.FTYPE = 'B';                                
                  WRITE FILE (BH8511O) FROM (BH8511);                   
                                                                        
                  TV.SKRFEJL = TV.SKRFEJL + 1;                          
                  FEJLTAB(I) = NEJ;                                     
               END;                                                     
         END;                                                           
                                                                        
 END SKRIV_TIL_BN04000T;                                                
 /********************************************************************* 
 *       OPTÆL STATUS FOR DENNE PERSON                                * 
 *********************************************************************/ 
 OPTÆL_PERSON:PROC;                                                     
                                                                        
         SELECT;                                                        
           WHEN (FANTINDV = 1)                                          
              INDEX = 2;                                                
           WHEN (FANTINDV = 2)                                          
              INDEX = 3;                                                
           WHEN (FANTINDV = 3)                                          
              INDEX = 4;                                                
           WHEN (FANTINDV = 4)                                          
              INDEX = 5;                                                
           WHEN (FANTINDV = 5)                                          
              INDEX = 6;                                                
           WHEN (FANTINDV = 6)                                          
              INDEX = 7;                                                
           WHEN (FANTINDV = 7)                                          
              INDEX = 8;                                                
           WHEN (FANTINDV = 8)                                          
              INDEX = 9;                                                
           WHEN (FANTINDV = 9)                                          
              INDEX = 10;                                               
           WHEN (FANTINDV = 10)                                         
              INDEX = 11;                                               
           WHEN (FANTINDV >= 11 & FANTINDV  <= 20)                      
              INDEX = 12;                                               
           WHEN (FANTINDV >= 21 & FANTINDV  <= 30)                      
              INDEX = 13;                                               
           WHEN (FANTINDV >= 31 & FANTINDV  <= 40)                      
              INDEX = 14;                                               
           WHEN (FANTINDV >= 41 & FANTINDV  <= 50)                      
              INDEX = 15;                                               
           OTHERWISE                                                    
              INDEX = 16;                                               
         END;                                                           
                                                                        
         TAB_PERSON(1).ANTAL = TAB_PERSON(1).ANTAL + 1;                 
         TAB_PERSON(INDEX).ANTAL = TAB_PERSON(INDEX).ANTAL + 1;         
                                                                        
         IF ERKLÆRBAR = JA                                              
         THEN                                                           
            DO;                                                         
               TAB_PERSON(1).ERKL = TAB_PERSON(1).ERKL + 1;             
               TAB_PERSON(INDEX).ERKL = TAB_PERSON(INDEX).ERKL + 1;     
            END;                                                        
         ELSE                                                           
            DO;                                                         
               TAB_PERSON(1).EJERKL = TAB_PERSON(1).EJERKL + 1;         
               TAB_PERSON(INDEX).EJERKL = TAB_PERSON(INDEX).EJERKL + 1; 
            END;                                                        
                                                                        
         IF MAX_ANT_INDV < FANTINDV                                     
         THEN                                                           
            MAX_ANT_INDV = FANTINDV;                                    
                                                                        
 END OPTÆL_PERSON;                                                      
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE: PROC;                                                      
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
 /*      DETLIN1.ANTAL = TV.LÆST_BQ78000T;                         */   
         DETLIN1.ANTAL = TV.ANT_COMM;                                   
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ BQ78000T';                     
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF LÆST_EJDTYP(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJENDOMSTYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_EJDTYP(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF LÆST_BERGRL(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED BER.GRL.TYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_BERGRL(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
                                                                        
         /* FIA - HER udskrives de 4 nye tællere pr. 2021-06-17 */      
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 99;                                            
            IF LÆST_VURMARK(INDEX).ANTAL > 0                            
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC2 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJERSKAB_VURMARK ' !! HJ_CHAR2;      
                  DETLIN1.ANTAL = LÆST_VURMARK(INDEX).ANTAL;            
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         /* Index 2000 indeholder både OPL_VURDNY_DVURDÅR = 2000  */    
         /* samt alle andre der enten ligger uden for intervallet */    
         /* eller hvor feltet er blank.                           */    
         DO INDEX = 2000 TO 2050;                                       
            IF LÆST_DVURDÅR(INDEX).ANTAL > 0                            
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_CHAR_4_PIC = INDEX;                                
                  IF INDEX > 2000                                       
                  then                                                  
                     DETLIN1.TEKST =                                    
                     '      HERAF MED OPL_VURDNY_DVURDÅR ' !! HJ_CHAR_4;
                  else                                                  
                     DETLIN1.TEKST =                                    
                     '      HERAF MED OPL_VURDNY_DVURDÅR ' !!           
                     '0 ELLER UGYLDIG';                                 
                                                                        
                  DETLIN1.ANTAL = LÆST_DVURDÅR(INDEX).ANTAL;            
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 10 TO 12;                                           
            IF LÆST_FORSIGT(INDEX).ANTAL > 0                            
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  IF INDEX = 10 THEN                                    
                    HJ_CHAR1 = 'N'; /* Nej */                           
                  ELSE IF INDEX = 11 THEN                               
                    HJ_CHAR1 = 'J'; /* Ja */                            
                  ELSE                                                  
                    HJ_CHAR1 = 'U'; /* Ugyldig */                       
                                                                        
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJERSKAB_FORSIGT_EVS ' !! HJ_CHAR1;  
                  DETLIN1.ANTAL = LÆST_FORSIGT(INDEX).ANTAL;            
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 10 TO 12;                                           
            IF LÆST_BESKAT(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  IF INDEX = 10 THEN                                    
                    HJ_CHAR1 = 'N'; /* Nej */                           
                  ELSE IF INDEX = 11 THEN                               
                    HJ_CHAR1 = 'J'; /* Ja */                            
                  ELSE                                                  
                    HJ_CHAR1 = 'U'; /* Ugyldig */                       
                                                                        
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJERSKAB_BESKAT ' !! HJ_CHAR1;       
                  DETLIN1.ANTAL = LÆST_BESKAT(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 5000 TO 6000;                                       
            IF LÆST_FEJLNR(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = LÆST_FEJLNR(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.KUN_EJDTAB;                                 
         DETLIN1.TEKST = 'HERAF INDIVIDER KUN TIL EVS-EJENDOMSTABEL  '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKRFEJL;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIV. TIL BN04000T B.H85110D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER           B.H85100D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 5000 TO 6000;                                       
            IF SKR_FEJLNR(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = SKR_FEJLNR(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 12;                                            
            IF SKR_EJBEVS(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  IF INDEX = 10                                         
                  THEN                                                  
                    HJ_CHAR1 = 'A';                                     
                  IF INDEX = 11                                         
                  THEN                                                  
                    HJ_CHAR1 = 'B';                                     
                  IF INDEX = 12                                         
                  THEN                                                  
                    HJ_CHAR1 = 'C';                                     
                  DETLIN1.TEKST =                                       
                     '      HERAF MED CEJBEVS ' !! HJ_CHAR1;            
                  DETLIN1.ANTAL = SKR_EJBEVS(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(1).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(1).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '      HERAF ERKLÆRBARE';                      
         DETLIN1.ANTAL = TAB_PERSON(1).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '      HERAF IKKE ERKLÆRBARE';                 
         DETLIN1.ANTAL = TAB_PERSON(1).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(2).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(2).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(2).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(2).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(3).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(3).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(3).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(3).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(4).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(4).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(4).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(4).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(5).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(5).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(5).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(5).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(6).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(6).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(6).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(6).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(7).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(7).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(7).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(7).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(8).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(8).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(8).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(8).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(9).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(9).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(9).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(9).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(10).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(10).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(10).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(10).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(11).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(11).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(11).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(11).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(12).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(12).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(12).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(12).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(13).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(13).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(13).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(13).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(14).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(14).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(14).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(14).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(15).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(15).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(15).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(15).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(16).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(16).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(16).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(16).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = MAX_ANT_INDV;                                  
         DETLIN1.TEKST = 'MAX. ANTAL EJENDOMME TIL SAMME PERSON';       
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS1;                                           
         DETLIN2.ANTAL = TV.FASTSTIG;                    /*FORSKUD06*/  
         DETLIN2.TEKST = 'BEREGNET FASTFROSSEN STIGN.BEGR.     ANTAL:'; 
         DETLIN2.BELØB = TV.BFASTSTIGBGR;                               
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.FREMSKREVET;                                
         DETLIN2.TEKST = 'ANTAL FREMSKREVNE EJENDOMME (EVS)          '; 
         DETLIN2.BELØB = TV.EJDFREM;                     /*FORSKUD06 */ 
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.BEREGNET;                                   
         DETLIN2.TEKST = 'ANTAL BEREGNEDE EJENDOMME (EVS)            '; 
         DETLIN2.BELØB = TV.BEREJD;                       /*FORSKUD06*/ 
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS1;                                           
         DETLIN2.ANTAL = TV.FANTSOM;                       /*FORSKUD06*/
         DETLIN2.TEKST = '    HERAF HELÅRSSOMMERHUSE           ANTAL:'; 
         DETLIN2.BELØB = 0;                                             
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM1;                                     
         DETLIN1.TEKST = '    HERAF MED 10 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM2;                                     
         DETLIN1.TEKST = '    HERAF MED 30 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL1;                                    
         DETLIN1.TEKST = '    HERAF MED 2 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL2;                                    
         DETLIN1.TEKST = '    HERAF MED 4 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN6000;                                 
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG 6000 KR.  ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.CPENSN2000;                                 
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG 2000 KR.  ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL1;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL2;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL3;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL4;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL5;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL6;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL0;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.EJBEREGNET;                                 
         DETLIN1.TEKST = 'ANTAL IKKE BEREGNEDE EJENDOMME (EVS)       '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL1;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL2;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL3;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL4;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL5;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL6;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL0;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
 END TOTALLISTE;                                                        
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT: PROC;                                                          
                                                                        
 /*?*/   CALL OPTÆL_PERSON;                /* SIDSTE PERSON OPTÆLLES */ 
 /*?*/   CALL SKRIV_TIL_BN04000T;          /* SIDSTE PERSON SKRIVES  */ 
         CALL TOTALLISTE;                                               
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH8510O),                                          
               FILE (BH8511O);                                          
         CALL OPDATER_KØRSELSTABEL('SLUT');                             
                                                                        
                                                                        
 END AFSLUT;                                                            
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED SQLCODE: ' !! SQLCA.SQLCODE);  
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
                                                                        
         CALL ZS67000(SQLCA);                                           
                                                                        
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* HER UDSKRIVES ØVRIGE FEJL                                  RUTINE */
 /*********************************************************************/
 PROGRAM_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED PROGRAMFEJL');                 
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END PROGRAM_FEJL;                                                      
 /*********************************************************************/
 /* %INCLUDE BH54997M; */ /* ER FORGÆNGERE KØRT. STOP HVIS IKKE */      
 %INCLUDE BH54998M; /* OPDATER KØRSELSTABEL */                          
 %INCLUDE BH95100M; /* TJEK OM DET ER ADVIS      #6.1 */                
 /*%INCLUDE BH85111M; /* SQL TIL LÆS AF TABELLER */                     
 %INCLUDE BH85101M; /* SQL TIL LÆS AF TABELLER QEB 20170426*/           
 END  BH85100;                                                          
