 /********************************************************************/ 
 /* Projekt:     EVS Forskud/Slut                                    */ 
 /* Programnavn: BH33701M                                            */ 
 /* Programtype: Makro                                               */ 
 /* Bruges af:   BH33600, BH33700 & BH33800                          */ 
 /* Funktion:    Initier felterne EN_EJERBOLIG, TO_EJERBOLIG,        */ 
 /*              GL_VURDERING og NY_VURDERING                        */ 
 /*                                                                  */ 
 /*              Anvender ud over felterne:                          */ 
 /*                DCL EN_EJERBOLIG  BIT(01)  INIT('0'B)             */ 
 /*                DCL TO_EJERBOLIG  BIT(01)  INIT('0'B)             */ 
 /*                DCL GL_VURDERING  BIT(01)  INIT('0'B)             */ 
 /*                DCL NY_VURDERING  BIT(01)  INIT('0'B)             */ 
 /*                DCL EVS_KOERSEL   CHAR(07) INIT(' ')              */ 
 /*                DCL EVS_KOERSEL_F CHAR(07) INIT('FORSKUD')        */ 
 /*                DCL EVS_KOERSEL_S CHAR(07) INIT('SLUT   ')        */ 
 /*                DCL EVS_KOERSEL_U CHAR(07) INIT('SUPPL  ')        */ 
 /*                                                                  */ 
 /*              også strukturerne:                                  */ 
 /*                BH31800N - 01 level CN570                         */ 
 /*                BH33700N - 01 level CN570 BASED(ADDR(BH337_AREA)) */ 
 /*                                                                  */ 
 /*------------------------------------------------------------------*/ 
 /*                                                                  */ 
 /* Rettelse #01: Gitte Jensen, GJN                       25-01-2019 */ 
 /*               Tilføjet nye felter NY_VURDERING & NY_VURDERING    */ 
 /* Rettelse #02: Edward Laryea, EDL                       27-03-2019 */
 /*               Tilføjet ny felt STRAKS_EVS                         */
 /* Slut 2020   : Per Brunk KS2-45                         Nov 2020   */
 /* Forskud2022 : Per Brunk                                22-02-2021 */
 /*               CBENYT '1 ' behandles som '01'                      */
 /********************************************************************/ 
 DCL HJ_CUOP CHAR(1) INIT('');                                          
                                                                        
 HJ_CUOP = '';                                                          
                                                                        
 EN_EJERBOLIG = NEJ;                                                    
 TO_EJERBOLIG = NEJ;                                                    
 GL_VURDERING = NEJ; /*#01*/                                            
 NY_VURDERING = NEJ; /*#01*/                                            
                                                                        
 IF EVS_KOERSEL = EVS_KOERSEL_F THEN DO;                                
   IF (  CN570.VURDOPLGL.CBENYT    = '01'                               
       ! CN570.VURDOPLGL.CBENYT    = '1 '     /* pbr */                 
       ! CN570.VURDOPLGL.CBENYT    = '41')                              
    & (  CN570.VURDOPLGL.FLEJL     = 2   )                              
    & (  CN570.VURDOPLGL.ANT_FOR_4 = 0   ) THEN DO;                     
                                                                        
     IF (  CN570.VURDOPLGL.ANT_FOR_5                                    
         + CN570.VURDOPLGL.ANT_FOR_6                                    
         + CN570.VURDOPLGL.ANT_FOR_8                                    
         + CN570.VURDOPLGL.ANT_FOR_9 = 1) THEN DO;                      
       EN_EJERBOLIG = JA;                                               
     END;                                                               
                                                                        
     IF (  CN570.VURDOPLGL.ANT_FOR_5                                    
         + CN570.VURDOPLGL.ANT_FOR_6                                    
         + CN570.VURDOPLGL.ANT_FOR_8                                    
         + CN570.VURDOPLGL.ANT_FOR_9 = 2) THEN DO;                      
       TO_EJERBOLIG = JA;                                               
     END;                                                               
   END;                                                                 
 END;                                                                   
                                                                        
 IF EVS_KOERSEL = EVS_KOERSEL_S                                         
  ! EVS_KOERSEL = EVS_KOERSEL_U THEN DO;                                
   /*IF (  CN570.VURDOPLNY.OMBER01.KONSEKVENS(1)  = 'J'                 
       ! CN570.VURDOPLNY.OMBER01.KONSEKVENS(1)  = 'N'                   
       ! CN570.VURDOPLNY.OMBER01.KONSEKVENS(2)  = 'J'                   
       ! CN570.VURDOPLNY.OMBER01.KONSEKVENS(2)  = 'N')                  
    & (  CN570.VURDOPLNY.CUOP                  ^= '6')                  
    & (  CN570.VURDOPLGL.DVURDÅR                = '' )                  
    & (  CN570.VURDOPLGL.CBENYT                 = '' ) THEN DO;         
     HJ_CUOP = '6';                                                     
   END; KS2-45 */                                                       
                                                                        
   /* IF (  CN570.VURDOPLNY.OMBER01.KONSEKVENS(1)  = 'J'                
       ! CN570.VURDOPLNY.OMBER01.KONSEKVENS(1)  = 'N'                   
       ! CN570.VURDOPLNY.OMBER01.KONSEKVENS(2)  = 'J'                   
       ! CN570.VURDOPLNY.OMBER01.KONSEKVENS(2)  = 'N')                  
       &   HJ_CUOP                               ^= '6'                 
       &   CN570.STRAKS_EVS ^= 'J' #02 edl                              
     THEN DO; */                                                        
     /* IF (  CN570.VURDOPLGL.CBENYT    = '01'                          
         ! CN570.VURDOPLGL.CBENYT    = '41')                            
      & (  CN570.VURDOPLGL.FLEJL     = 2   )                            
      & (  CN570.VURDOPLGL.ANT_FOR_4 = 0   ) THEN DO;                   
       GL_VURDERING = JA; #01 */                                        
                                                                        
       /* IF (  CN570.VURDOPLGL.ANT_FOR_5                               
           + CN570.VURDOPLGL.ANT_FOR_6                                  
           + CN570.VURDOPLGL.ANT_FOR_8                                  
           + CN570.VURDOPLGL.ANT_FOR_9 = 1) THEN DO;                    
         EN_EJERBOLIG = JA;                                             
       END; KS2-45 */                                                   
                                                                        
       /* IF (  CN570.VURDOPLGL.ANT_FOR_5                               
           + CN570.VURDOPLGL.ANT_FOR_6                                  
           + CN570.VURDOPLGL.ANT_FOR_8                                  
           + CN570.VURDOPLGL.ANT_FOR_9 = 2) THEN DO;                    
         TO_EJERBOLIG = JA;                                             
       END; KS2-45 */                                                   
     /* END; KS2-45 */                                                  
   /*END;                                                               
   ELSE DO; KS2-45 */                                                   
     IF (  CN570.VURDOPLNY.CBENYT    = '01'                             
         ! CN570.VURDOPLNY.CBENYT    = '1 '     /* pbr */               
         ! CN570.VURDOPLNY.CBENYT    = '41')                            
      & (  CN570.VURDOPLNY.FLEJL     = 2   )                            
      & (  CN570.VURDOPLNY.ANT_FOR_4 = 0   ) THEN DO;                   
       NY_VURDERING = JA; /*#01*/                                       
                                                                        
       IF (  CN570.VURDOPLNY.ANT_FOR_5                                  
           + CN570.VURDOPLNY.ANT_FOR_6                                  
           + CN570.VURDOPLNY.ANT_FOR_8                                  
           + CN570.VURDOPLNY.ANT_FOR_9 = 1) THEN DO;                    
         EN_EJERBOLIG = JA;                                             
       END;                                                             
                                                                        
       IF (  CN570.VURDOPLNY.ANT_FOR_5                                  
           + CN570.VURDOPLNY.ANT_FOR_6                                  
           + CN570.VURDOPLNY.ANT_FOR_8                                  
           + CN570.VURDOPLNY.ANT_FOR_9 = 2) THEN DO;                    
         TO_EJERBOLIG = JA;                                             
       END;                                                             
     END;                                                               
   /*END; KS2-45 */                                                     
 END;                                                                   
