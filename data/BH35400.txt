 PROCESS OPT(TIME);                                                     
 BH35400: PROCEDURE OPTIONS (MAIN) REORDER;                             
 /*********************************************************************/
         DCL COPYRIGHT CHAR (30) STATIC INIT ('COPYRIGHT KMD A/S 2019');
 /********************************************************************* 
 *                                                                    * 
 * FORMÅL: HVIS DER ER FORSKEL I EJENDOMSTYPEN MELLEM ESR             * 
 *         OG FORSKUD OPLYSNINGER FOR 2 FAMILEHUSE SÅ SKAL            * 
 *         FORSKUD OPLYSNINGER IKKE ANVENDES                          * 
 *                                                                    * 
 * INPUT:  B.H30100D  EVS FORSKUD UDTRÆK                              * 
 *         B.H33901D  BEHANDLET ESR DATA                              * 
 *                                                                    * 
 * OUTPUT: B.H35400D EVS FORSKUD- UDTRÆK                              * 
 *         B.H35410D FRAVALGTE EVS FORSKUD- UDTRÆK                    * 
 *                                                                    * 
 * PROGRAMMØR: Per Brunk PBR                        Maj 2020          * 
 * PROGRAMMØR: Per Brunk PBR Ny struktur BH33700N   Okt 2020          * 
 *--------------------------------------------------------------------* 
 *********************************************************************/ 
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /********************************************************************* 
 *       DECLARE AF REGISTRE                                          * 
 *********************************************************************/ 
 DCL     BH301I FILE RECORD INPUT;      /* EVS FORSKUD UDTRÆK        */ 
 DCL     BH339I FILE RECORD INPUT;      /* ESR DATA MED ENHEDSLBNR   */ 
 DCL     BH354O FILE RECORD OUTPUT;     /* EVS FORSKUD UDTRÆK        */ 
 DCL     BH3541O FILE RECORD OUTPUT;    /* FRAVALGTE FORSKUD DATA    */ 
                                                                        
 DCL     BH354I FILE RECORD INPUT;      /* PARAMETERINPUT            */ 
                                                                        
 DCL     SYSPRINT FILE EXTERNAL PRINT;                                  
 /*********************************************************************/
                                                                        
 DCL     WS_FORSKUD_SLUT_TXT    CHAR(16) INIT (' ');                    
                                                                        
 DCL     WS_TIL_EVS_AAR         BIN FIXED (15);                         
                                                                        
 DCL     WS_TIL_EVS_AAR_GL      BIN FIXED (15);                         
 DCL     WS_SLUT_AFVIKLINGS_ID  CHAR(16) INIT (' ');                    
                                                                        
 DCL     WS_PROGRAMNAVN         CHAR(8)  INIT ('BH35400');              
 DCL     EOF_BH354             BIT(1)   INIT ('0'B);                    
                                                                        
 DCL     1 BH354_PARM,                                                  
           %INCLUDE BH54900N;                                           
                                                                        
 DCL     BH339_AR        CHAR      (3000) VAR;                          
                                                                        
 DCL     1 BH339    BASED      (ADDR(BH339_AR)),                        
           4 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH33700N;;                                          
                                                                        
 DCL     1 BH65300M,                                                    
           %INCLUDE BH65300M;                                           
                                                                        
 /***************************************************************       
 /*      DECLARE AF ABEND-RUTINE                                        
 /**************************************************************/       
 DCL     ABENDKODE     FIXED       (2) INIT(5);                         
 DCL     1 ABENDMEDD,                                                   
          2 ABENDMODUL CHAR      (7) INIT ('BH35400'),                  
          2 ABENDFILL1 CHAR      (1) INIT (' '),                        
          2 ABENDMEDNR CHAR      (2) INIT ('**'),                       
          2 ABENDFILL2 CHAR      (1) INIT (' '),                        
          2 ABENDTXT   CHAR      (45);                                  
                                                                        
 DCL     ABENDRTKODE   FIXED     (1) INIT (2);                          
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     ZS67000         ENTRY;                       /* SQL-ABEND    */
                                                                        
 /********************************************************************* 
 *       DECLARE AF EVS UDTRÆK INPUT                                  * 
 *********************************************************************/ 
 DCL     1 BH301,                                                       
           %INCLUDE BH30100N;;                                          
                                                                        
                                                                        
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     STG             BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     VERIFY          BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
                                                                        
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    1 LINIE,                                                        
          2 CCA         CHAR      (01),                                 
          2 TEKST       CHAR      (132)     INIT      (' ');            
                                                                        
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     TV_LÆS_EVS        BIN FIXED (31)    INIT (0);                  
 DCL     TV_SKRIV_EVS      BIN FIXED (31)    INIT (0);                  
 DCL     TV_LÆS_ESR          BIN FIXED (31)    INIT (0);                
 DCL     TV_LOG_EVS        BIN FIXED (31)    INIT (0);                  
                                                                        
 DCL     TV_ESR_OVF        BIN FIXED (31)    INIT (0);                  
 DCL     TV_FORSKUD_OVF       BIN FIXED (31)    INIT (0);               
 DCL     PUT_SKIP_TV       BIN FIXED (31)    INIT (0);                  
 DCL     EOF_BH301         BIT       (1)     INIT ('0'B);               
 DCL     EOF_BH339         BIT       (1)     INIT ('0'B);               
                                                                        
                                                                        
 DCL     JA                BIT       (1)     INIT ('1'B);               
 DCL     NEJ               BIT       (1)     INIT ('0'B);               
 DCL     EJER_FRA_ESR      BIT       (1)     INIT ('0'B);               
 DCL     SKRIV_FORSKUD_OPL BIT       (1)     INIT ('0'B);               
 DCL     ESR_2FAMILIE      BIT       (1)     INIT ('0'B);               
 DCL     FØRSTE_ESR        BIT       (1)     INIT ('0'B);               
                                                                        
                                                                        
 DCL     UDDATO            CHAR      (10);                              
 DCL     DATO1             CHAR      (26);                              
 DCL     1 DATO2           DEF DATO1,                                   
           2 ÅR            CHAR      (04),                              
           2 F1            CHAR      (01),                              
           2 MD            CHAR      (02),                              
           2 F2            CHAR      (01),                              
           2 DG            CHAR      (02);                              
                                                                        
                                                                        
 EXEC SQL INCLUDE SQLCA;        /* SQL KOMMUNIKATIONSAREAL    */        
 EXEC SQL INCLUDE BQ65000T;     /* MODTAGET ESR OPLYSNINGER   */        
 EXEC SQL INCLUDE BQ80000T;     /* 2 FAMILIE EJENDOMME        */        
                                                                        
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         ON ERROR                                                       
           PUT SKIP LIST('ERROR');                                      
                                                                        
         OPEN FILE (BH301I)  TITLE ('BH30100I');                        
         OPEN FILE (BH339I)  TITLE ('BH33900I'); /*ESR data*/           
         OPEN FILE (BH354O)  TITLE ('BH35400O'); /*evs data*/           
         OPEN FILE (BH3541O) TITLE ('BH35410O'); /*fravalgte evs data*/ 
                                                                        
                                                                        
         ON ENDFILE (BH301I)                                            
            EOF_BH301 = JA;                                             
                                                                        
         ON ENDFILE (BH339I)                                            
            EOF_BH339 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH35401Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
                                                                        
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !! '-' !! DATO2.ÅR;       
                                                                        
         LINIE.CCA    = ZZIK1;                                          
         LINIE.TEKST = 'BH35400 LISTE OVER EJERFORHOLD MED FJERNED ' !! 
                       'FORSKUD OPL ' !! UDDATO;                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         OPEN FILE (BH354I)  TITLE ('BH35400P');                        
                                                                        
         ON ENDFILE (BH354I)                                            
         BEGIN;                                                         
            EOF_BH354= JA;                                              
         END;                                                           
                                                                        
         READ FILE (BH354I) INTO (BH354_PARM);                          
                                                                        
         SELECT (BH354_PARM.FS_MRK);                                    
            WHEN ('S')                                                  
              DO;                                                       
                 PUT SKIP LIST ('Dette er en EVS SLUT kørsel');         
              END;                                                      
            WHEN ('F')                                                  
              DO;                                                       
                 PUT SKIP LIST ('Dette er en EVS FORSKUD kørsel');      
              END;                                                      
            WHEN ('U')                                                  
              DO;                                                       
                 PUT SKIP LIST ('Dette er en EVS SUPPLEMENT kørsel');   
              END;                                                      
            OTHERWISE                                                   
              DO;                                                       
                 ABENDTXT = '101 Parameter skal være S,F,U';            
                 CALL PROGRAM_FEJL;                                     
              END;                                                      
         END;                                                           
                                                                        
         IF EOF_BH354= NEJ                                              
         THEN DO;                                                       
            SELECT (BH354_PARM.FS_MRK);                                 
               WHEN ('F')                                               
                  DO;                                                   
                     WS_FORSKUD_SLUT_TXT = BH354_PARM.FORSKUD_TXT;      
                     WS_TIL_EVS_AAR = BH65300M.FORSKÅR;                 
                     /* N.B.  til_evs_aar_GL Tages ALTID fra SLUT */    
                     WS_TIL_EVS_AAR_GL = BH65300M.SLUTÅR - 1;           
                     /* afviklings-id til læs gammelt år altid SLUT */  
                     WS_SLUT_AFVIKLINGS_ID = BH354_PARM.SLUT_TXT;       
                  END;                                                  
               WHEN ('S')                                               
                  DO;                                                   
                     WS_FORSKUD_SLUT_TXT = BH354_PARM.SLUT_TXT;         
                     WS_TIL_EVS_AAR = BH65300M.SLUTÅR;                  
                     /* N.B.  til_evs_aar_GL Tages ALTID fra SLUT */    
                     WS_TIL_EVS_AAR_GL = BH65300M.SLUTÅR - 1;           
                     /* afviklings-id til læs gammelt år altid SLUT */  
                     WS_SLUT_AFVIKLINGS_ID = BH354_PARM.SLUT_TXT;       
                  END;                                                  
               WHEN ('U')                                               
                  DO;                                                   
                     WS_FORSKUD_SLUT_TXT = BH354_PARM.SUPPL_TXT;        
                     WS_TIL_EVS_AAR = BH65300M.SLUTÅR;                  
                     /* N.B.  til_evs_aar_GL Tages ALTID fra SLUT */    
                     WS_TIL_EVS_AAR_GL = BH65300M.SLUTÅR - 1;           
                     /* afviklings-id til læs gammelt år altid SLUT */  
                     WS_SLUT_AFVIKLINGS_ID = BH354_PARM.SLUT_TXT;       
                  END;                                                  
               OTHERWISE                                                
                  DO;                                                   
                     ABENDTXT = '101 PARAMETERFEJL';                    
                     CALL PROGRAM_FEJL;                                 
                  END;                                                  
            END; /* select */                                           
         END;                                                           
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_EVS_UDTRÆK;                                           
         CALL LÆS_BH339;                                                
                                                                        
         SKRIV_FORSKUD_OPL = JA;                                        
                                                                        
                                                                        
         DO WHILE (EOF_BH301 = NEJ);                                    
                                                                        
           /* ESR MINDRE END EVS */                                     
           DO WHILE (EOF_BH339 = NEJ  &                                 
                    ( BH339.DCPRCIR < BH301.DCPRN   !                   
                     (BH339.DCPRCIR = BH301.DCPRN   &                   
                      BH339.EKOMNR  < BH301.EKOMNR) !                   
                     (BH339.DCPRCIR = BH301.DCPRN   &                   
                      BH339.EKOMNR  = BH301.EKOMNR  &                   
                      BH339.EEJDNR  < BH301.EEJDNR)));                  
             CALL LÆS_BH339; /*LÆS ESR*/                                
           END;                                                         
                                                                        
           SELECT;                                                      
                                                                        
              /* ESR STØRRE END EVS */                                  
              WHEN ( BH339.DCPRCIR > BH301.DCPRN   !                    
                    (BH339.DCPRCIR = BH301.DCPRN  &                     
                     BH339.EKOMNR  > BH301.EKOMNR) !                    
                    (BH339.DCPRCIR = BH301.DCPRN  &                     
                     BH339.EKOMNR  = BH301.EKOMNR  &                    
                     BH339.EEJDNR  > BH301.EEJDNR))                     
                DO;                                                     
                  EJER_FRA_ESR = NEJ;                                   
                END;                                                    
                                                                        
              WHEN (BH339.DCPRCIR = BH301.DCPRN  &                      
                    BH339.EKOMNR  = BH301.EKOMNR  &                     
                    BH339.EEJDNR  = BH301.EEJDNR)                       
                DO;                                                     
                  EJER_FRA_ESR = JA;                                    
                END;                                                    
                                                                        
              OTHER                                                     
                DO; /* EVS STØRRE END ESR og EOF_BH339 */               
                  EJER_FRA_ESR = NEJ;                                   
                  PUT SKIP LIST('BH339.DCPRCIR =',BH339.DCPRCIR);       
                  PUT SKIP LIST('BH339.EKOMNR  =',BH339.EKOMNR);        
                  PUT SKIP LIST('BH339.EEJDNR  =',BH339.EEJDNR);        
                  PUT SKIP LIST('BH301.DCPRN   =',BH301.DCPRN );        
                  PUT SKIP LIST('BH301.EKOMNR  =',BH301.EKOMNR);        
                  PUT SKIP LIST('BH301.EEJDNR  =',BH301.EEJDNR);        
                END;                                                    
                                                                        
           END;                                                         
                                                                        
           /* Hvis ejer er fra ESR kan ejendomstype */                  
           /* hentes i BQ80000T for 2familie        */                  
           IF EJER_FRA_ESR = JA                                         
           THEN                                                         
             DO;                                                        
               CALL RET_FORSKUD_OPLYSNINGER;                            
             END;                                                       
                                                                        
           CALL SKRIV_EVS_UDTRÆK;                                       
                                                                        
           CALL LÆS_EVS_UDTRÆK;                                         
           SKRIV_FORSKUD_OPL = JA;                                      
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /*********************************************************************/
 /* Hvis der findes ESR oplysninger på et ejerforhold og der er       */
 /* forskel på cejdtypen i mellem ESR og slut for 2 familie huse      */
 /* så fravælges slut oplysninger                                     */
 /*********************************************************************/
 RET_FORSKUD_OPLYSNINGER: PROC;                                         
                                                                        
       CALL HENT_ESR_CEJDTYPE;                                          
                                                                        
       IF (BH301.CEJDTYPE = '4' !                                       
           BH301.CEJDTYPE = '5' !                                       
           DCLBQ80000T.CEJDTYPE  = '4' !                                
           DCLBQ80000T.CEJDTYPE  = '5' ) &                              
           EJER_FRA_ESR = JA                                            
       THEN                                                             
         DO;                                                            
           IF DCLBQ80000T.CEJDTYPE = BH301.CEJDTYPE                     
           THEN                                                         
             DO;                                                        
             END;                                                       
           ELSE                                                         
             DO;                                                        
               LINIE = '';                                              
               LINIE.CCA   = ZZWS1;                                     
               LINIE.TEKST = 'FORSKEL 2FAM '  !!                        
                             BH301.DCPRN      !!                        
                             BH301.EKOMNR     !! '-' !!                 
                             BH301.EEJDNR     !! '-' !!                 
                             BH301.EENHEDLBNR !!                        
                             ' CEJDTYPE ' !!                            
                                     BH301.CEJDTYPE  !!                 
                              ' BQ80000T.CEJDTYPE ' !!                  
                                     DCLBQ80000T.CEJDTYPE;              
               CALL ZZ20300(LINIE,'01');                                
               SKRIV_FORSKUD_OPL  = NEJ;                                
             END;                                                       
         END;                                                           
                                                                        
                                                                        
 HENT_ESR_CEJDTYPE:PROC;                                                
                                                                        
       DCLBQ80000T.CEJDTYPE = '';                                       
       ESR_2FAMILIE         = NEJ;                                      
                                                                        
                                                                        
       DCLBQ80000T.TIL_EVS_AAR   = WS_TIL_EVS_AAR;                      
       DCLBQ80000T.AFVIKLINGS_ID = WS_FORSKUD_SLUT_TXT;                 
       DCLBQ80000T.EKOMNR        = BH301.EKOMNR;                        
       DCLBQ80000T.EEJDNR        = BH301.EEJDNR;                        
                                                                        
                                                                        
       EXEC SQL SELECT                                                  
          BQ80000T.CEJDTYPE                                             
       INTO  :DCLBQ80000T.CEJDTYPE                                      
       FROM BQ80000T                                                    
       WHERE TIL_EVS_AAR    = :DCLBQ80000T.TIL_EVS_AAR                  
         AND AFVIKLINGS_ID  = :DCLBQ80000T.AFVIKLINGS_ID                
         AND EKOMNR         = :DCLBQ80000T.EKOMNR                       
         AND EEJDNR         = :DCLBQ80000T.EEJDNR                       
       FETCH FIRST 1 ROW ONLY;                                          
                                                                        
       SELECT (SQLCA.SQLCODE);                                          
          WHEN (0)                                                      
            DO;                                                         
              ESR_2FAMILIE         = JA;                                
            END;                                                        
          WHEN (100)                                                    
            DO;                                                         
            END;                                                        
          OTHERWISE                                                     
            DO;                                                         
              ABENDTXT = '101 SELECT CEJDTYPE';                         
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
       END; /* SELECT*/                                                 
                                                                        
 END HENT_ESR_CEJDTYPE;                                                 
 END RET_FORSKUD_OPLYSNINGER;                                           
 /********************************************************************* 
 *       LÆS EVS UDTRÆK                                               * 
 *********************************************************************/ 
 LÆS_EVS_UDTRÆK:PROC;                                                   
                                                                        
        READ FILE (BH301I) INTO (BH301);                                
                                                                        
        IF EOF_BH301 = NEJ                                              
        THEN                                                            
          TV_LÆS_EVS =  TV_LÆS_EVS + 1;                                 
                                                                        
                                                                        
 END LÆS_EVS_UDTRÆK;                                                    
 /*********************************************************************/
 LÆS_BH339: PROC;                                                       
                                                                        
        IF FØRSTE_ESR = JA                                              
        THEN                                                            
          DO;                                                           
            READ FILE (BH339I) INTO (BH339_AR);                         
            TV_LÆS_ESR = TV_LÆS_ESR + 1;                                
    /*      GEM_ESR_DCPRCIR     = BH339.DCPRCIR;                        
            GEM_ESR_EKOMNR      = BH339.EKOMNR;                         
            GEM_ESR_EEJDNR      = BH339.EEJDNR;                         
            GEM_ESR_EENHEDLBNR  = BH339.EENHEDLBNR;*/                   
            FØRSTE_ESR = NEJ;                                           
          END;                                                          
        ELSE                                                            
          DO;                                                           
            READ FILE (BH339I) INTO (BH339_AR);                         
            TV_LÆS_ESR = TV_LÆS_ESR + 1;                                
          END;                                                          
                                                                        
    /*  GEM_ESR_DCPRCIR     = BH339.DCPRCIR;                            
        GEM_ESR_EKOMNR      = BH339.EKOMNR;                             
        GEM_ESR_EEJDNR      = BH339.EEJDNR;                             
        GEM_ESR_EENHEDLBNR  = BH339.EENHEDLBNR; */                      
                                                                        
 END LÆS_BH339;                                                         
 /********************************************************************* 
 *       SKRIV UDTRÆK FRA EVS                                         * 
 *********************************************************************/ 
 SKRIV_EVS_UDTRÆK: PROC;                                                
                                                                        
        IF SKRIV_FORSKUD_OPL = JA                                       
        THEN                                                            
          DO;                                                           
            WRITE FILE (BH354O) FROM (BH301);                           
            TV_SKRIV_EVS = TV_SKRIV_EVS + 1;                            
          END;                                                          
        ELSE                                                            
          DO;                                                           
            WRITE FILE (BH3541O) FROM (BH301);                          
            TV_LOG_EVS = TV_LOG_EVS + 1;                                
          END;                                                          
                                                                        
 END SKRIV_EVS_UDTRÆK;                                                  
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE: PROC;                                                      
                                                                        
         LINIE.CCA    = ZZWS1;                                          
         LINIE.TEKST = 'ANTAL LÆST FORSKUD OPLYSNINGER   =  ' !!        
                       TV_LÆS_EVS;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE.CCA    = ZZWS1;                                          
         LINIE.TEKST = 'ANTAL SKREVET FORSKUD OPLYSNINGER = ' !!        
                        TV_SKRIV_EVS ;                                  
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE.CCA    = ZZWS1;                                          
         LINIE.TEKST = 'ANTAL FRAVALGTE FORSKUD OPLYSNINGER='  !!       
                       TV_LOG_EVS;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE.CCA    = ZZWS1;                                          
         LINIE.TEKST = 'ANTAL LÆST PÅ ESR                 = ' !!        
                        TV_LÆS_ESR;                                     
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
 END TOTALLISTE;                                                        
 /**********************************************************************
 * HER UDSKRIVES SQL FEJL VED HJÆLP AF STANDARD RUTINE          RUTINE *
 **********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED SQLCODE: ' !! SQLCA.SQLCODE);  
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
                                                                        
         CALL ZS67000(SQLCA);                                           
                                                                        
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* HER UDSKRIVES ØVRIGE FEJL                                  RUTINE */
 /*********************************************************************/
 PROGRAM_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED PROGRAMFEJL');                 
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END PROGRAM_FEJL;                                                      
 /*********************************************************************/
 /*       AFSLUT PROGRAM                                              */
 /*********************************************************************/
 AFSLUT: PROC;                                                          
                                                                        
         CALL TOTALLISTE;                                               
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH301I);                                           
         CLOSE FILE (BH339I);                                           
         CLOSE FILE (BH354O);                                           
         CLOSE FILE (BH3541O);                                          
                                                                        
 END AFSLUT;                                                            
 /*********************************************************************/
 END  BH35400;                                                          
