 /*********************************************************************/
 /* Indlæsning/Opdatering af tabeller i forbindelse med beregning af  */
 /* EVS Basisrabat og Faktisk rabat.                                  */
 /*                                                                   */
 /* Tabeller: BE78000T - EVS_RESULTAT (FORSKUD)                       */
 /*           BE75000T - ESR (FORSKUD)                                */
 /*           BE76000T - MANDTAL (FORSKUD)                            */
 /*           BE77000T - EVS_UDTRÆK (FORSKUD)                         */
 /*                                                                   */
 /* Forskud 2024: BF17 Tina Carstens    Marts 2022                    */
 /*                                                                   */
 /*********************************************************************/
 /*********************************************************************/
 /*      DECLARE AF CURSORS                                           */
 /*********************************************************************/
                                                                        
         /* Hent resultat til rabatberegning fra Ny EVS               */
         /* Indikatorvariable BE780_SW er i BE85501N                  */
         EXEC SQL DECLARE RESULTCURS CURSOR WITH HOLD FOR               
                   SELECT BE78.TIL_EVS_AAR,                             
                          BE78.AFVIKLINGS_ID,                           
                          BE78.DATA_ID,                                 
                          BE78.DCPRN,                                   
                          BE78.EKOMNR,                                  
                          BE78.EEJDNR,                                  
                          BE78.EENHEDLBNR,                              
                          BE78.EGENNR,                                  
                          BE78.SORT_DATO,                               
                          BE78.FEJLNR,                                  
                          BE78.TILEVS_A_EJ_DCPRCIR,                     
                          BE78.TILEVS_A_EJ_DAFSTÅ,                      
                          BE78.TILEVS_A_EJ_COMPLA,                      
                          BE78.TILEVS_A_V_CBENYT,                       
                          BE78.TILEVS_A_V_ANT_FOR_4,                    
                          BE78.TILEVS_A_V_ANT_FOR_5,                    
                          BE78.TILEVS_A_V_ANT_FOR_6,                    
                          BE78.TILEVS_A_V_ANT_FOR_8,                    
                          BE78.TILEVS_A_V_ANT_FOR_9,                    
                          BE78.TILEVS_CINVPNR,                          
                          BE78.TILEVS_CEJBEVS,                          
                          BE78.TILEVS_GPCTEJER,                         
                          BE78.TILEVS_GPCTEJER_SW,                      
                          BE78.TILEVS_DOVTG,                            
                          BE78.TILEVS_DAFSTAA,                          
                          BE78.TILEVS_DFRAFLYT,                         
                          BE78.EJERSKAB_VURMARK,                        
                          BE78.EJERSKAB_FORSIGT_EVS,                    
                          BE78.EJERSKAB_BESKAT,                         
                          BE78.EJENDOM_CBERGRL,                         
                          BE78.EJENDOM_CEJDTYPE,                        
                          BE78.TILEVS_BNYMAN,                           
                          BE78.TILEVS_BNYMAN_SW,                        
                          BE78.TILEVS_FOR_BEVSFREM,                     
                          BE78.TILEVS_FOR_BEVSFREM_SW,                  
                          BE78.TILFORSK_COPR_BEVSFREM,                  
                          BE78.FRAEVS_FOR_BSUM2,                        
                          BE78.FRAEVS_FOR_BBRUTTO,                      
                          BE78.FRAEVS_FOR_B100,                         
                          BE78.FRAEVS_FOR_BEJERAN,                      
                          BE78.EJET20240101,                            
                          BE78.RES_RABATGRDL_NYLOV,                     
                          BE78.RES_EVSFØRREDUKTION,                     
                          BE78.RES_EVSEFTERREDUKTION,                   
                          BE78.RES_EJERANDEL,                           
                          BE78.RES_RABATGRDL_GLLOV,                     
                          BE78.RES_FAST_STIGNINGSBEGR_NEDSLAG,          
                          BE78.RES_STIGNINGSBEGR_NEDSLAG,               
                          BE78.RES_RABATEJERANDEL,                      
                          BE78.RES_FAKTISKRABAT,                        
                          BE78.RES_EVSEFTERRABAT,                       
                          BE78.RES_BNETTO_EVS_EJERREL,                  
                          BE78.OVERFØRT_ÆGTEF_RABAT,                    
                          BE78.RABATEJERANDEL,                          
                          BE78.R24_SIMPELBASISRABAT,                    
                          BE78.R24_SIMPELBASISRABAT_NEG,                
                          BE78.R24_BASISRABAT_REGUL,                    
                          BE78.R24_BASISRABAT,                          
                          BE78.R24_FAST_STIGNINGSBEGR_NEDSLAG,          
                          BE78.R24_STIGNINGSBEGR_NEDSLAG,               
                          BE78.R24_EJERANDEL,                           
                          BE78.GRDL_BASISRABATREGULERING,               
                          BE78.COPR_GRDL_BASISRABATREGUL,               
                          BE78.COPR_EJET20240101,                       
                          BE78.COPR_RES_RABATEJERANDEL,                 
                          BE78.COPR_R24_BASISRABAT_REGUL,               
                          BE78.TILEVS_BTAKS,                            
                          BE78.TILEVS_BTAKSRABAT,                       
                          BE78.TILEVS_BTAKSEFTERRABAT                   
                     FROM BE78000T BE78                                 
                    WHERE BE78.TIL_EVS_AAR   = :WS_TIL_EVS_AAR          
                      AND BE78.AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT     
                      AND BE78.DATA_ID       = :BE55600M.DATA_ID        
                   ORDER BY BE78.DCPRN, BE78.EKOMNR, BE78.EEJDNR,       
                            BE78.EENHEDLBNR, BE78.SORT_DATO;            
                                                                        
 /*********************************************************************/
 /*      FETCH CURSOR TIL LÆS AF ESR-OPLYSNINGER                      */
 /*********************************************************************/
 FETCH_RESULTCURS: PROC;                                                
                                                                        
         RESULT_FUNDET = '0'B;                                          
                                                                        
         DCLBE78000T   = '';                                            
                                                                        
         /* Indikatorvariable BE780_SW er i BE85501N                  */
                                                                        
         EXEC SQL FETCH RESULTCURS INTO                                 
                         :DCLBE78000T.TIL_EVS_AAR,                      
                         :DCLBE78000T.AFVIKLINGS_ID,                    
                         :DCLBE78000T.DATA_ID,                          
                         :DCLBE78000T.DCPRN,                            
                         :DCLBE78000T.EKOMNR,                           
                         :DCLBE78000T.EEJDNR,                           
                         :DCLBE78000T.EENHEDLBNR,                       
                         :DCLBE78000T.EGENNR,                           
                         :DCLBE78000T.SORT_DATO,                        
                         :DCLBE78000T.FEJLNR,                           
                         :DCLBE78000T.TILEVS_A_EJ_DCPRCIR,              
                         :DCLBE78000T.TILEVS_A_EJ_DAFSTÅ,               
                         :DCLBE78000T.TILEVS_A_EJ_COMPLA,               
                         :DCLBE78000T.TILEVS_A_V_CBENYT,                
                         :DCLBE78000T.TILEVS_A_V_ANT_FOR_4,             
                         :DCLBE78000T.TILEVS_A_V_ANT_FOR_5,             
                         :DCLBE78000T.TILEVS_A_V_ANT_FOR_6,             
                         :DCLBE78000T.TILEVS_A_V_ANT_FOR_8,             
                         :DCLBE78000T.TILEVS_A_V_ANT_FOR_9,             
                         :DCLBE78000T.TILEVS_CINVPNR,                   
                         :DCLBE78000T.TILEVS_CEJBEVS,                   
                         :DCLBE78000T.TILEVS_GPCTEJER,                  
                         :DCLBE78000T.TILEVS_GPCTEJER_SW,               
                         :DCLBE78000T.TILEVS_DOVTG,                     
                         :DCLBE78000T.TILEVS_DAFSTAA,                   
                         :DCLBE78000T.TILEVS_DFRAFLYT,                  
                         :DCLBE78000T.EJERSKAB_VURMARK,                 
                         :DCLBE78000T.EJERSKAB_FORSIGT_EVS,             
                         :DCLBE78000T.EJERSKAB_BESKAT,                  
                         :DCLBE78000T.EJENDOM_CBERGRL,                  
                         :DCLBE78000T.EJENDOM_CEJDTYPE,                 
                         :DCLBE78000T.TILEVS_BNYMAN,                    
                         :DCLBE78000T.TILEVS_BNYMAN_SW,                 
                         :DCLBE78000T.TILEVS_FOR_BEVSFREM,              
                         :DCLBE78000T.TILEVS_FOR_BEVSFREM_SW,           
                         :DCLBE78000T.TILFORSK_COPR_BEVSFREM,           
                         :DCLBE78000T.FRAEVS_FOR_BSUM2,                 
                         :DCLBE78000T.FRAEVS_FOR_BBRUTTO,               
                         :DCLBE78000T.FRAEVS_FOR_B100,                  
                         :DCLBE78000T.FRAEVS_FOR_BEJERAN,               
                         :DCLBE78000T.EJET20240101,                     
                         :DCLBE78000T.RES_RABATGRDL_NYLOV               
                                :BE780_SW.RES_RABATGRDL_NYLOV_SW,       
                         :DCLBE78000T.RES_EVSFØRREDUKTION               
                                :BE780_SW.RES_EVSFØRREDUKTION_SW,       
                         :DCLBE78000T.RES_EVSEFTERREDUKTION             
                                :BE780_SW.RES_EVSEFTERREDUKTION_SW,     
                         :DCLBE78000T.RES_EJERANDEL                     
                                :BE780_SW.RES_EJERANDEL_SW,             
                         :DCLBE78000T.RES_RABATGRDL_GLLOV               
                                :BE780_SW.RES_RABATGRDL_GLLOV_SW,       
                         :DCLBE78000T.RES_FAST_STIGNINGSBEGR_NEDSLAG    
                                :BE780_SW.RES_FAST_STIGNINGSBEGR_NED_SW,
                         :DCLBE78000T.RES_STIGNINGSBEGR_NEDSLAG         
                                :BE780_SW.RES_STIGNINGSBEGR_NEDSLAG_SW, 
                         :DCLBE78000T.RES_RABATEJERANDEL                
                                :BE780_SW.RES_RABATEJERANDEL_SW,        
                         :DCLBE78000T.RES_FAKTISKRABAT                  
                                :BE780_SW.RES_FAKTISKRABAT_SW,          
                         :DCLBE78000T.RES_EVSEFTERRABAT                 
                                :BE780_SW.RES_EVSEFTERRABAT_SW,         
                         :DCLBE78000T.RES_BNETTO_EVS_EJERREL,           
                         :DCLBE78000T.OVERFØRT_ÆGTEF_RABAT,             
                         :DCLBE78000T.RABATEJERANDEL                    
                                          :BE780_SW.RABATEJERANDEL_SW,  
                         :DCLBE78000T.R24_SIMPELBASISRABAT,             
                         :DCLBE78000T.R24_SIMPELBASISRABAT_NEG,         
                         :DCLBE78000T.R24_BASISRABAT_REGUL,             
                         :DCLBE78000T.R24_BASISRABAT,                   
                         :DCLBE78000T.R24_FAST_STIGNINGSBEGR_NEDSLAG    
                                :BE780_SW.R24_FAST_STIGNINGSBEGR_NED_SW,
                         :DCLBE78000T.R24_STIGNINGSBEGR_NEDSLAG         
                                :BE780_SW.R24_STIGNINGSBEGR_NEDSLAG_SW, 
                         :DCLBE78000T.R24_EJERANDEL                     
                                :BE780_SW.R24_EJERANDEL_SW,             
                         :DCLBE78000T.GRDL_BASISRABATREGULERING,        
                         :DCLBE78000T.COPR_GRDL_BASISRABATREGUL,        
                         :DCLBE78000T.COPR_EJET20240101,                
                         :DCLBE78000T.COPR_RES_RABATEJERANDEL           
                                :BE780_SW.COPR_RES_RABATEJERANDEL_SW,   
                         :DCLBE78000T.COPR_R24_BASISRABAT_REGUL,        
                         :DCLBE78000T.TILEVS_BTAKS,                     
                         :DCLBE78000T.TILEVS_BTAKSRABAT,                
                         :DCLBE78000T.TILEVS_BTAKSEFTERRABAT;           
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0) DO;                                                 
               RESULT_FUNDET   = '1'B;                                  
               TV.FETCH_RESULT = TV.FETCH_RESULT + 1;                   
               TV.ANT_COMM     = TV.ANT_COMM + 1;                       
             END;                                                       
           WHEN (100) DO;                                               
             END;                                                       
           OTHERWISE DO;                                                
               ABENDTXT = '101 FETCH RESULTCURS';                       
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
 END FETCH_RESULTCURS;                                                  
 /*********************************************************************/
 /*      OPEN CURSOR TIL LÆS AF ESR-OPLYSNINGER                       */
 /*********************************************************************/
 OPEN_RESULTCURS: PROC;                                                 
                                                                        
         EXEC SQL OPEN RESULTCURS;                                      
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN DO;                                                       
            ABENDTXT = '101 OPEN RESULTCURS';                           
            CALL SQL_FEJL;                                              
            END;                                                        
                                                                        
 END OPEN_RESULTCURS;                                                   
 /*********************************************************************/
 /*      CURSOR TIL LÆS AF ESR                                        */
 /*********************************************************************/
 CLOSE_RESULTCURS: PROC;                                                
                                                                        
         EXEC SQL CLOSE RESULTCURS;                                     
                                                                        
 END CLOSE_RESULTCURS;                                                  
 /*********************************************************************/
 /* Opdater   BE78000T                                         RUTINE */
 /*********************************************************************/
 OPDATER_RESULTAT: PROC;                                                
                                                                        
         EXEC SQL UPDATE BE78000T                                       
                    SET FEJLNR                = :DCLBE78000T.FEJLNR,    
                        TILEVS_CEJBEVS        =                         
                                          :DCLBE78000T.TILEVS_CEJBEVS,  
                        PROGRAMNAVN           = :WS_PROGRAMNAVN,        
                        RES_RABATGRDL_NYLOV   =                         
                            :DCLBE78000T.RES_RABATGRDL_NYLOV            
                            :BE780_SW.RES_RABATGRDL_NYLOV_SW,           
                        RES_EVSFØRREDUKTION   =                         
                            :DCLBE78000T.RES_EVSFØRREDUKTION            
                            :BE780_SW.RES_EVSFØRREDUKTION_SW,           
                        RES_EVSEFTERREDUKTION =                         
                            :DCLBE78000T.RES_EVSEFTERREDUKTION          
                            :BE780_SW.RES_EVSEFTERREDUKTION_SW,         
                        RES_EJERANDEL         =                         
                            :DCLBE78000T.RES_EJERANDEL                  
                            :BE780_SW.RES_EJERANDEL_SW,                 
                        RES_RABATEJERANDEL    =                         
                            :DCLBE78000T.RES_RABATEJERANDEL             
                            :BE780_SW.RES_RABATEJERANDEL_SW,            
                        RES_FAKTISKRABAT      =                         
                            :DCLBE78000T.RES_FAKTISKRABAT               
                            :BE780_SW.RES_FAKTISKRABAT_SW,              
                        RES_EVSEFTERRABAT     =                         
                            :DCLBE78000T.RES_EVSEFTERRABAT              
                            :BE780_SW.RES_EVSEFTERRABAT_SW,             
                        RES_BNETTO_EVS_EJERREL =                        
                            :DCLBE78000T.RES_BNETTO_EVS_EJERREL,        
                        COPR_RES_RABATEJERANDEL   =                     
                            :DCLBE78000T.COPR_RES_RABATEJERANDEL        
                            :BE780_SW.COPR_RES_RABATEJERANDEL_SW        
                  WHERE TIL_EVS_AAR    = :DCLBE78000T.TIL_EVS_AAR       
                    AND AFVIKLINGS_ID  = :DCLBE78000T.AFVIKLINGS_ID     
                    AND DATA_ID        = :DCLBE78000T.DATA_ID           
                    AND DCPRN          = :DCLBE78000T.DCPRN             
                    AND EKOMNR         = :DCLBE78000T.EKOMNR            
                    AND EEJDNR         = :DCLBE78000T.EEJDNR            
                    AND EENHEDLBNR     = :DCLBE78000T.EENHEDLBNR        
                    AND EGENNR         = :DCLBE78000T.EGENNR;           
                                                                        
         SELECT (SQLCODE);                                              
            WHEN (0) DO;                                                
               TV.ANT_UPD = TV.ANT_UPD + 1;                             
               END;                                                     
            OTHERWISE DO;                                               
               ABENDTXT = '101 OPDATER RESULTAT ';                      
               CALL SQL_FEJL;                                           
               END;                                                     
         END;                                                           
                                                                        
 END OPDATER_RESULTAT;                                                  
 /*********************************************************************/
 /* Læs ESR   BE75000T                                         RUTINE */
 /*********************************************************************/
 SELECT_ESR: PROC;                                                      
                                                                        
         /* Indlæser kun oplysninger til brug for BE85103M, som ved   */
         /* indlæsning af EVS oplysninger frasorterer fejlsager       */
                                                                        
         ESR_FUNDET = NEJ;                                              
                                                                        
         DCLBE75000T                = '';                               
         DCLBE75000T.TIL_EVS_AAR    = DCLBE78000T.TIL_EVS_AAR;          
         DCLBE75000T.AFVIKLINGS_ID  = DCLBE78000T.AFVIKLINGS_ID;        
         DCLBE75000T.DATA_ID        = DCLBE78000T.DATA_ID;              
         DCLBE75000T.DCPRN          = DCLBE78000T.DCPRN;                
         DCLBE75000T.EKOMNR         = DCLBE78000T.EKOMNR;               
         DCLBE75000T.EEJDNR         = DCLBE78000T.EEJDNR;               
         DCLBE75000T.EENHEDLBNR     = DCLBE78000T.EENHEDLBNR;           
         DCLBE75000T.EGENNR         = DCLBE78000T.EGENNR;               
                                                                        
         EXEC SQL                                                       
            SELECT                                                      
               TIL_EVS_AAR,                                             
               AFVIKLINGS_ID,                                           
               DATA_ID,                                                 
               DCPRN,                                                   
               EKOMNR,                                                  
               EEJDNR,                                                  
               EENHEDLBNR,                                              
               EGENNR,                                                  
               OPL_VURDGL_DVURDÅR                                       
            INTO                                                        
               :DCLBE75000T.TIL_EVS_AAR,                                
               :DCLBE75000T.AFVIKLINGS_ID,                              
               :DCLBE75000T.DATA_ID,                                    
               :DCLBE75000T.DCPRN,                                      
               :DCLBE75000T.EKOMNR,                                     
               :DCLBE75000T.EEJDNR,                                     
               :DCLBE75000T.EENHEDLBNR,                                 
               :DCLBE75000T.EGENNR,                                     
               :DCLBE75000T.OPL_VURDGL_DVURDÅR                          
            FROM BE75000T                                               
            WHERE TIL_EVS_AAR   = :DCLBE75000T.TIL_EVS_AAR              
            AND   DCPRN         = :DCLBE75000T.DCPRN                    
            AND   AFVIKLINGS_ID = :DCLBE75000T.AFVIKLINGS_ID            
            AND   DATA_ID       = :DCLBE75000T.DATA_ID                  
            AND   EKOMNR        = :DCLBE75000T.EKOMNR                   
            AND   EEJDNR        = :DCLBE75000T.EEJDNR                   
            AND   EENHEDLBNR    = :DCLBE75000T.EENHEDLBNR               
            AND   EGENNR        = :DCLBE75000T.EGENNR;                  
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
            WHEN(0) DO;                                                 
               ESR_FUNDET    = '1'B;                                    
               TV.SELECT_ESR = TV.SELECT_ESR + 1;                       
            END;                                                        
            WHEN(100) DO;                                               
               ABENDTXT = '101 SELECT BE75000T EJ FUNDET';              
               CALL SQL_FEJL;                                           
            END;                                                        
            OTHERWISE DO;                                               
               ABENDTXT = '101 SELECT BE75000T';                        
               CALL SQL_FEJL;                                           
            END;                                                        
         END;                                                           
                                                                        
 END SELECT_ESR;                                                        
 /*********************************************************************/
 /* Læs Mandtal BE76000T                                       RUTINE */
 /*********************************************************************/
 SELECT_MT: PROC;                                                       
                                                                        
         /* Indlæser kun oplysninger til brug for BE85103M, som ved   */
         /* indlæsning af EVS oplysninger frasorterer fejlsager       */
                                                                        
         MT_FUNDET                  = NEJ;                              
                                                                        
         DCLBE76000T                = '';                               
         DCLBE76000T.TIL_EVS_AAR    = DCLBE78000T.TIL_EVS_AAR;          
         DCLBE76000T.AFVIKLINGS_ID  = DCLBE78000T.AFVIKLINGS_ID;        
         DCLBE76000T.DATA_ID        = DCLBE78000T.DATA_ID;              
         DCLBE76000T.DCPRN          = DCLBE78000T.DCPRN;                
         DCLBE76000T.EKOMNR         = DCLBE78000T.EKOMNR;               
         DCLBE76000T.EEJDNR         = DCLBE78000T.EEJDNR;               
         DCLBE76000T.EENHEDLBNR     = DCLBE78000T.EENHEDLBNR;           
         DCLBE76000T.EGENNR         = DCLBE78000T.EGENNR;               
                                                                        
         EXEC SQL                                                       
            SELECT                                                      
               TIL_EVS_AAR,                                             
               AFVIKLINGS_ID,                                           
               DATA_ID,                                                 
               DCPRN,                                                   
               EKOMNR,                                                  
               EEJDNR,                                                  
               EENHEDLBNR,                                              
               EGENNR,                                                  
               CSTATUS,                                                 
               CCIVS,                                                   
               DRGNÅRTIL                                                
            INTO                                                        
               :DCLBE76000T.TIL_EVS_AAR,                                
               :DCLBE76000T.AFVIKLINGS_ID,                              
               :DCLBE76000T.DATA_ID,                                    
               :DCLBE76000T.DCPRN,                                      
               :DCLBE76000T.EKOMNR,                                     
               :DCLBE76000T.EEJDNR,                                     
               :DCLBE76000T.EENHEDLBNR,                                 
               :DCLBE76000T.EGENNR,                                     
               :DCLBE76000T.CSTATUS,                                    
               :DCLBE76000T.CCIVS,                                      
               :DCLBE76000T.DRGNÅRTIL                                   
            FROM BE76000T                                               
            WHERE TIL_EVS_AAR   = :DCLBE76000T.TIL_EVS_AAR              
              AND AFVIKLINGS_ID = :DCLBE76000T.AFVIKLINGS_ID            
              AND DATA_ID       = :DCLBE76000T.DATA_ID                  
              AND DCPRN         = :DCLBE76000T.DCPRN                    
              AND EKOMNR        = :DCLBE76000T.EKOMNR                   
              AND EEJDNR        = :DCLBE76000T.EEJDNR                   
              AND EENHEDLBNR    = :DCLBE76000T.EENHEDLBNR               
              AND EGENNR        = :DCLBE76000T.EGENNR;                  
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
            WHEN(0) DO;                                                 
               MT_FUNDET    = '1'B;                                     
               TV.SELECT_MT = TV.SELECT_MT + 1;                         
            END;                                                        
            WHEN(100) DO;                                               
               ABENDTXT = '101 SELECT BE76000T EJ FUNDET';              
               CALL SQL_FEJL;                                           
            END;                                                        
            OTHERWISE DO;                                               
               ABENDTXT = '101 SELECT BE76000T';                        
               CALL SQL_FEJL;                                           
            END;                                                        
         END;                                                           
                                                                        
 END SELECT_MT;                                                         
 /*********************************************************************/
 /* Læs EVS SLUT BE77000T                                      RUTINE */
 /*********************************************************************/
 SELECT_SLUT: PROC;                                                     
                                                                        
         /* Indlæser kun oplysninger til brug for BE85103M, som ved   */
         /* indlæsning af EVS oplysninger frasorterer fejlsager       */
                                                                        
         SLUT_FUNDET                = NEJ;                              
                                                                        
         DCLBE77000T                = '';                               
         DCLBE77000T.TIL_EVS_AAR    = DCLBE78000T.TIL_EVS_AAR;          
         DCLBE77000T.AFVIKLINGS_ID  = DCLBE78000T.AFVIKLINGS_ID;        
         DCLBE77000T.DATA_ID        = DCLBE78000T.DATA_ID;              
         DCLBE77000T.DCPRN          = DCLBE78000T.DCPRN;                
         DCLBE77000T.EKOMNR         = DCLBE78000T.EKOMNR;               
         DCLBE77000T.EEJDNR         = DCLBE78000T.EEJDNR;               
         DCLBE77000T.EENHEDLBNR     = DCLBE78000T.EENHEDLBNR;           
         DCLBE77000T.EGENNR         = DCLBE78000T.EGENNR;               
                                                                        
         EXEC SQL                                                       
            SELECT                                                      
             TIL_EVS_AAR                                                
            ,AFVIKLINGS_ID                                              
            ,DATA_ID                                                    
            ,DCPRN                                                      
            ,EKOMNR                                                     
            ,EEJDNR                                                     
            ,EENHEDLBNR                                                 
            ,EGENNR                                                     
            ,EVSFEJ_DCPRN                                               
            ,EVSFEJ_CEJBEVS                                             
            ,EVSFEJ_DAFSTAA                                             
            ,EVSFEJ_DFRAFLYT                                            
            ,EVSSEJ_DCPRN                                               
            ,EVSSEJ_SID_CSLET                                           
            ,EVSSEJ_SID_CEJBEVS                                         
            ,EVSSEJ_SID_DAFSTAA                                         
            ,EVSSEJ_SID_DFRAFLYT                                        
            INTO                                                        
               :DCLBE77000T.TIL_EVS_AAR,                                
               :DCLBE77000T.AFVIKLINGS_ID,                              
               :DCLBE77000T.DATA_ID,                                    
               :DCLBE77000T.DCPRN,                                      
               :DCLBE77000T.EKOMNR,                                     
               :DCLBE77000T.EEJDNR,                                     
               :DCLBE77000T.EENHEDLBNR,                                 
               :DCLBE77000T.EGENNR,                                     
               :DCLBE77000T.EVSFEJ_DCPRN,                               
               :DCLBE77000T.EVSFEJ_CEJBEVS,                             
               :DCLBE77000T.EVSFEJ_DAFSTAA,                             
               :DCLBE77000T.EVSFEJ_DFRAFLYT,                            
               :DCLBE77000T.EVSSEJ_DCPRN,                               
               :DCLBE77000T.EVSSEJ_SID_CSLET,                           
               :DCLBE77000T.EVSSEJ_SID_CEJBEVS,                         
               :DCLBE77000T.EVSSEJ_SID_DAFSTAA,                         
               :DCLBE77000T.EVSSEJ_SID_DFRAFLYT                         
            FROM BE77000T                                               
            WHERE TIL_EVS_AAR   = :DCLBE77000T.TIL_EVS_AAR              
            AND   DCPRN         = :DCLBE77000T.DCPRN                    
            AND   AFVIKLINGS_ID = :DCLBE77000T.AFVIKLINGS_ID            
            AND   DATA_ID       = :DCLBE77000T.DATA_ID                  
            AND   EKOMNR        = :DCLBE77000T.EKOMNR                   
            AND   EEJDNR        = :DCLBE77000T.EEJDNR                   
            AND   EENHEDLBNR    = :DCLBE77000T.EENHEDLBNR               
            AND   EGENNR        = :DCLBE77000T.EGENNR;                  
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
            WHEN(0) DO;                                                 
               SLUT_FUNDET    = '1'B;                                   
               TV.SELECT_SLUT = TV.SELECT_SLUT + 1;                     
            END;                                                        
            WHEN(100) DO;                                               
               ABENDTXT = '101 SELECT BE77000T EJ FUNDET';              
               CALL SQL_FEJL;                                           
            END;                                                        
            OTHERWISE DO;                                               
               ABENDTXT = '101 SELECT BE77000T';                        
               CALL SQL_FEJL;                                           
            END;                                                        
         END;                                                           
                                                                        
 END SELECT_SLUT;                                                       
