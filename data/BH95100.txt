  PROCESS OPT(TIME);                                                    
 BH95100: /* DAN DATA TIL EVS PERSONTABEL TIL FORSKUD */                
         PROCEDURE (EXECPARM) OPTIONS (MAIN) REORDER;                   
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 2002');       
 /**********************************************************************
 *                                                                     *
 * FORMÅL :                                                            *
 * LEVERING AF OPLYSNINGER TIL FORSKUDS EVS-PERSONTABEL (DB2).         *
 *                                                                     *
 * INPUT  : B.H95000D  BEREGNINGSBÅND TIL NYT FORSKUDS ÅR              *
 *                                                                     *
 * OUTPUT : B.H95100D  UDTRÆK - ALLE PERSONER                          *
 *          B.H95110D  UDTRÆK - FEJLNUMRE TIL BN00200T                 *
 *          BH95101Y   KØRSELSKONTROLLISTE                             *
 *          BH95102Y   FEJLLISTE FRA MASKINEL AFSTEMNING               *
 *                                                                     *
 * PROGRAMMØR: AAGE RASMUSSEN  AUG       1999                          *
 * RETTET:     AAGE RASMUSSEN  AUG       2000                          *
 * RETTET:     AAGE RASMUSSEN  AUG       2001       SE SEKV 1 I POS 80 *
 * RETTET:     OLUF MØRK       AUG       2002                          *
 * RETTET:     BO SCHMIDT      JUL       2003                          *
 * RETTET:     BO SCHMIDT      JUL       2004                          *
 * RETTET:     SUSANNE VILLUMSEN  JUL    2005     *FORSKUD06*          *
 * RETTET:     BO SCHMIDT         JUL    2006     *FORSKUD07*          *
 * RETTET:     BO SCHMIDT         JUL    2007     *FORSKUD08*          *
 * RETTET:     BO SCHMIDT         JUL    2008     *FORSKUD09*          *
 * RETTET:     GERD HOLM-PEDERSEN APR    2009     *FORSKUD10*          *
 * RETTET:     GERD HOLM-PEDERSEN JUN    2010     *FORSKUD11*          *
 * #6.1        SAMT KRAVNR. 6.1 EVS-FEJLR ÆNDRES TIL ADVIS I FORSKUD   *
 *             DESUDEN ÆNDRET B243 TIL BN00200T, DA B243 ER UDGÅET     *
 *             BNX6300, HVOR X ER FORKUDSÅRET, ER DET FORSKUDSPROGRAM, *
 *             DER KALDER BS330000 SOM OPDATER FORSKUDS FEJLTABEL      *
 *             BN00200T.                                               *
 * RETTET:     GERD HOLM-PEDERSEN MAJ    2011     *FORSKUD12*          *
 *                                                                     *
 * RETTET:     LARS KAAE HARRITSHØJ MAJ  2012     *FORSKUD13*          *
 *             ÆNDRINGER FORETAGET I BH90100N                          *
 * RETTET:     LARS KAAE HARRITSHØJ MAJ  2013     *FORSKUD14*          *
 * RETTET:     JØRGEN SAUGMANN      JUNI 2014     *FORSKUD15*          *
 * RETTET:     JØRGEN SAUGMANN      JUNI 2015     *FORSKUD16*          *
 * RETTET:     ESBEN BRODERSEN      MARTS 2016                         *
 *             INDLAGT DATO INCLUDE BH65300M  #01                      *
 * RETTET:     ESBEN BRODERSEN      JUNI 2016     *FORSKUD17*          *
 *             KUN KOMPILE                                             *
 **********************************************************************/
         DEFAULT RANGE (*) STATIC;                                      
 /*********************************************************************/
 /*      PARAMETER TIL ANGIVELSE AF OM DET ER PRODUKTION ELLER        */
 /*      TESTKØRSEL AF HENSYN TIL MASKINEL AFSTEMNING                 */
 /*********************************************************************/
 DCL     EXECPARM        CHAR      (6) VAR;                             
 DCL     EX_PARM         CHAR      (4);                                 
         EX_PARM = EXECPARM;                                            
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH950I FILE RECORD INPUT;      /* BEREGN.BÅND EFTER BEREGN. */ 
 DCL     BH9510O FILE RECORD OUTPUT;    /* LOAD-GRUNDLAG TIL EVS     */ 
 DCL     BH9511O FILE RECORD OUTPUT;    /* FEJLNUMRE TIL BN00200T    */ 
 /********************************************************************* 
 *       DECLARE AF UDTRÆK                                            * 
 *********************************************************************/ 
 DCL     BH950_AR        CHAR      (6000) VAR;                          
 DCL     1 BH950         BASED     (ADDR(BH950_AR)),                    
           2 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH90100N;;                                          
 DCL     1 BH95099       BASED     (ADDR(BH950_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH90099N;                                           
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (LOAD-GRUNDLAG)                            * 
 *********************************************************************/ 
 DCL     1 BH951,                                                       
           %INCLUDE BH95100N;;                              /* F2005 */ 
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (FEJL TIL BN00200T)                        * 
 *********************************************************************/ 
 DCL     1 BH9511,                                                      
           %INCLUDE BH95110N;                                           
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_BH950   FIXED DEC (7),                                 
           2 KUN_EJDTAB  FIXED DEC (7),                                 
           2 SKREVET     FIXED DEC (7),                                 
           2 SKRFEJL     FIXED DEC (7),                                 
           2 BEREGNET    FIXED DEC (7),                                 
           2 BEREJD      FIXED DEC (15,2),                              
           2 FREMSKREVET FIXED DEC (7),                                 
           2 EJDFREM     FIXED DEC (15,2),                              
           2 BPROM1      FIXED DEC (7),                                 
           2 BPROM2      FIXED DEC (7),                                 
           2 BNEDSL1     FIXED DEC (7),                                 
           2 BNEDSL2     FIXED DEC (7),                                 
           2 CPENSN6000  FIXED DEC (7),                                 
           2 CPENSN2000  FIXED DEC (7),                                 
           2 BER_BOPÆL0  FIXED DEC (7),                                 
           2 BER_BOPÆL1  FIXED DEC (7),                                 
           2 BER_BOPÆL2  FIXED DEC (7),                                 
           2 BER_BOPÆL3  FIXED DEC (7),                                 
           2 BER_BOPÆL4  FIXED DEC (7),                                 
           2 BER_BOPÆL5  FIXED DEC (7),                                 
           2 BER_BOPÆL6  FIXED DEC (7),                                 
           2 EJBEREGNET  FIXED DEC (7),                                 
           2 EJBER_BOPÆL0 FIXED DEC (7),                                
           2 EJBER_BOPÆL1 FIXED DEC (7),                                
           2 EJBER_BOPÆL2 FIXED DEC (7),                                
           2 EJBER_BOPÆL3 FIXED DEC (7),                                
           2 EJBER_BOPÆL4 FIXED DEC (7),                                
           2 EJBER_BOPÆL5 FIXED DEC (7),                                
           2 EJBER_BOPÆL6 FIXED DEC (7),                                
           2 BFASTSTIGBGR FIXED DEC (15,2),                             
           2 FASTSTIG    FIXED DEC (7),                                 
           2 FANTSOM     FIXED DEC (7);                                 
 DCL     1 LÆST_FEJLNR(5000:6000), /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_FEJLNR(5000:6000),  /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_EJBEVS(0:10),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_BERGRL(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_EJDTYP(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 TAB_PERSON(16),         /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 TEKST       CHAR      (60),                                
           2 ANTAL       FIXED DEC (7),                                 
           2 ERKL        FIXED DEC (7),                                 
           2 EJERKL      FIXED DEC (7);                                 
 DCL     MAX_ANT_INDV    FIXED DEC (7) INIT (0);                        
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS34900         ENTRY OPTIONS (INTER ASM);   /* FAKTURERING  */
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    LIN_DEB          CHAR      (133);                               
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH95100L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (' '),           
           2 F2          CHAR      (12)      INIT      (' '),           
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (10)      INIT      (' '),           
           2 TEKST2      CHAR      (07)      INIT      ('BELØB: '),     
           2 BELØB       PIC       'Z.ZZZ.ZZZ.ZZZ.ZZ9,V99',             
           2 F3          CHAR      (24)      INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     EOF_BH950       BIT       (1);                                 
 DCL     ERKLÆRBAR       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     INDEX           BIN FIXED (31);                                
 DCL     I               BIN FIXED (15);                                
 DCL     HJ_CHAR4        CHAR      (4);                                 
 DCL     HJ_PIC4         PIC       '(4)9'  BASED(ADDR(HJ_CHAR4));       
 DCL     HJ_CHAR2        CHAR      (2);                                 
 DCL     HJ_PIC2         PIC       '(2)9'  BASED(ADDR(HJ_CHAR2));       
 DCL     HJ_CHAR1        CHAR      (1);                                 
 DCL     HJ_PIC1         PIC       '9'     BASED(ADDR(HJ_CHAR1));       
 DCL     GLPNR           FIXED     (11)      INIT      (0);             
 DCL     HJLBNR      BIN FIXED     (15)      INIT      (0);             
 DCL     FANTINDV    BIN FIXED     (31)      INIT      (0);             
 DCL     FEJLTAB (200)   BIT       (1);                                 
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     FTYPE          CHAR(1);          /* #6.1       /* A = ADVIS */ 
                                                        /* B = FEJL  */ 
 DCL     1 BH65300M,                                                    
           %INCLUDE BH65300M;        /*#01*/                            
                                                                        
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *********************************************************************/ 
 DCL     BH950_ANT_INDV  FIXED     (7)       INIT      (0);             
 DCL     SWFEJL          CHAR      (1)       INIT      (' ');           
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
         EOF_BH950 = NEJ;                                               
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (BH950I) TITLE ('BH95000I');                         
         OPEN FILE (BH9510O) TITLE ('BH95100O');                        
         OPEN FILE (BH9511O) TITLE ('BH95110O');                        
                                                                        
         ON ENDFILE (BH950I)                                            
            EOF_BH950 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH95101Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         TV = 0;                                                        
         OVERLIN1.TEKST2 = 'DAN LOADGRUNDLAG TIL EVS-PERSONTAB ' !!     
                           'FORSKUD ' !! BH65300M.INDKÅR2; /*#01*/      
                                                                        
         DO I = 1 TO 200;                                               
            FEJLTAB(I) = NEJ;                                           
         END;                                                           
                                                                        
         DO INDEX = 5000 TO 6000;                                       
            LÆST_FEJLNR(INDEX).ANTAL = 0;                               
            SKR_FEJLNR(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 10;                                            
            SKR_EJBEVS(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_BERGRL(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_EJDTYP(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 1 TO 16;                                            
            TAB_PERSON(INDEX).ANTAL  = 0;                               
            TAB_PERSON(INDEX).ERKL   = 0;                               
            TAB_PERSON(INDEX).EJERKL = 0;                               
         END;                                                           
                                                                        
         TAB_PERSON(1).TEKST  = 'ANTAL PERSONER TIL PERSONTABEL IALT:'; 
         TAB_PERSON(2).TEKST  = '      HERAF MED 1 EJENDOM           '; 
         TAB_PERSON(3).TEKST  = '      HERAF MED 2 EJENDOMME         '; 
         TAB_PERSON(4).TEKST  = '      HERAF MED 3 EJENDOMME         '; 
         TAB_PERSON(5).TEKST  = '      HERAF MED 4 EJENDOMME         '; 
         TAB_PERSON(6).TEKST  = '      HERAF MED 5 EJENDOMME         '; 
         TAB_PERSON(7).TEKST  = '      HERAF MED 6 EJENDOMME         '; 
         TAB_PERSON(8).TEKST  = '      HERAF MED 7 EJENDOMME         '; 
         TAB_PERSON(9).TEKST  = '      HERAF MED 8 EJENDOMME         '; 
         TAB_PERSON(10).TEKST = '      HERAF MED 9 EJENDOMME         '; 
         TAB_PERSON(11).TEKST = '      HERAF MED 10 EJENDOMME        '; 
         TAB_PERSON(12).TEKST = '      HERAF MED 11-20 EJENDOMME     '; 
         TAB_PERSON(13).TEKST = '      HERAF MED 21-30 EJENDOMME     '; 
         TAB_PERSON(14).TEKST = '      HERAF MED 31-40 EJENDOMME     '; 
         TAB_PERSON(15).TEKST = '      HERAF MED 41-50 EJENDOMME     '; 
         TAB_PERSON(16).TEKST = '      HERAF MED OVER 50 EJENDOMME   '; 
                                                                        
         ERKLÆRBAR = JA;                                                
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_BH950;                                                
                                                                        
         DO WHILE ( EOF_BH950 = NEJ );                                  
                                                                        
            CALL BEHANDL;                                               
                                                                        
            CALL LÆS_BH950;                                             
                                                                        
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR                                           * 
 *********************************************************************/ 
 LÆS_BH950:                                                             
         PROC;                                                          
                                                                        
         READ FILE (BH950I) INTO (BH950_AR);                            
                                                                        
         IF BH950.SORT_CPR = 99999999999     /* OPTÆLL.INDV. 1 */       
         THEN                                                           
            DO;                                                         
               BH950_ANT_INDV = BH95099.ANT_INDV;                       
               READ FILE (BH950I) INTO (BH950_AR);                      
            END;                                                        
                                                                        
         IF EOF_BH950 = NEJ                                             
         THEN                                                           
            TV.LÆS_BH950 = TV.LÆS_BH950 + 1;                            
                                                                        
 END LÆS_BH950;                                                         
 /********************************************************************* 
 *       UDSØG PERSONER SOM SKAL OPRETTES PÅ PERSONTABELLEN           * 
 *********************************************************************/ 
 BEHANDL:                                                               
         PROC;                                                          
                                                                        
        IF BH950.AKT_VURD.CBENYT = '78'    /* IKKE EVS RELEVANT EJD.*/  
        THEN                               /* SKULLE HAVDE VÆRET    */  
           RETURN;                         /* OVERLÆST I BH31800L.  */  
                                                                        
        IF BH950.TIL_EVS.AKT_EJER.COMPLA = '1'                          
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF BH950.MT.CSTATUS = '2'           /* OMPLACERET */            
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF BH950.MT.CCIVS = 'D'            /* ALTID HVIS DØD */         
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF BH950.FEJLNR > 0                                             
        THEN                                                            
           DO;                                                          
              INDEX = BH950.FEJLNR;                                     
              LÆST_FEJLNR(INDEX).ANTAL = LÆST_FEJLNR(INDEX).ANTAL + 1;  
           END;                                                         
                                                                        
        IF BH950.TIL_EVS.CEJBEVS ^= 'A' &  /* HVIS IKKE FREMSKREVET */  
          (BH950.FEJLNR = 5001 !                                        
           BH950.FEJLNR = 5020)                                         
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF BH950.TIL_EVS.CINVPNR ^= '0'                                 
        THEN                                                            
           RETURN;                                                      
                                                                        
        IF BH950.TIL_EVS.AKT_EJER.DCPRCIR > 0 &                         
          (BH950.TIL_EVS.AKT_EJER.DAFSTÅ > 0 &                          
           BH950.TIL_EVS.AKT_EJER.DAFSTÅ <=                             
                                BH950.MT.DRGNÅRTIL)                     
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* F2005 */                                                     
        IF BH950.TIL_EVS.AKT_EJER.DCPRCIR > 0 &                         
          (BH950.TIL_EVS.CEJBEVS = '0' !                                
           BH950.TIL_EVS.CEJBEVS = '2' !                                
           BH950.TIL_EVS.CEJBEVS = '3' !                                
           BH950.TIL_EVS.CEJBEVS = '7' !                                
           BH950.TIL_EVS.CEJBEVS = '8') &                               
           BH950.EVS_SLUT_EJER.DCPRN > 0 &                              
           BH950.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                     
          (BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !                   
           BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !                   
           BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5') &                  
         ((BH950.EVS_SLUT_EJER.SIDSTE.DAFSTAA > 0 &                     
           BH950.EVS_SLUT_EJER.SIDSTE.DAFSTAA <=                        
                                        BH950.MT.DRGNÅRTIL) !           
          (BH950.EVS_SLUT_EJER.SIDSTE.DFRAFLYT > 0 &                    
           BH950.EVS_SLUT_EJER.SIDSTE.DFRAFLYT <=                       
                                        BH950.MT.DRGNÅRTIL))            
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* F2005 */                                                     
        IF BH950.TIL_EVS.AKT_EJER.DCPRCIR > 0 &                         
          (BH950.TIL_EVS.CEJBEVS = '0' !                                
           BH950.TIL_EVS.CEJBEVS = '2' !                                
           BH950.TIL_EVS.CEJBEVS = '3' !                                
           BH950.TIL_EVS.CEJBEVS = '7' !                                
           BH950.TIL_EVS.CEJBEVS = '8') &                               
           BH950.EVS_FORSK_EJER.DCPRN > 0 &                             
          (BH950.EVS_FORSK_EJER.CEJBEVS = '0' !                         
           BH950.EVS_FORSK_EJER.CEJBEVS = '4') &                        
         ((BH950.EVS_FORSK_EJER.DAFSTAA > 0 &                           
           BH950.EVS_FORSK_EJER.DAFSTAA <=                              
                                      BH950.MT.DRGNÅRTIL) !             
          (BH950.EVS_FORSK_EJER.DFRAFLYT > 0 &                          
           BH950.EVS_FORSK_EJER.DFRAFLYT <=                             
                                      BH950.MT.DRGNÅRTIL))              
        THEN                                                            
           RETURN;                                                      
                                                                        
        /* F2005 */                                                     
        IF BH950.TIL_EVS.AKT_EJER.DCPRCIR > 0 &                         
           BH950.TIL_EVS.CEJBEVS = '1'                                  
        THEN                                                            
          DO;                                                           
            IF BH950.EVS_SLUT_EJER.DCPRN > 0 &                          
               BH950.EVS_SLUT_EJER.SIDSTE.CSLET < '1'                   
            THEN                                                        
              DO;                                                       
                IF BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !           
                   BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !           
                   BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' !           
                   BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '6' !           
                   BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '7' !           
                   BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '8'             
                THEN;                                                   
                ELSE                                                    
                   RETURN;                                              
                IF (BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !          
                    BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !          
                    BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5') &         
                  ((BH950.EVS_SLUT_EJER.SIDSTE.DAFSTAA  > 0 &           
                    BH950.EVS_SLUT_EJER.SIDSTE.DAFSTAA  <=              
                                           BH950.MT.DRGNÅRTIL) !        
                   (BH950.EVS_SLUT_EJER.SIDSTE.DFRAFLYT > 0 &           
                    BH950.EVS_SLUT_EJER.SIDSTE.DFRAFLYT <=              
                                           BH950.MT.DRGNÅRTIL))         
                 THEN                                                   
                    RETURN;                                             
              END;                                                      
            IF BH950.EVS_FORSK_EJER.DCPRN > 0                           
            THEN                                                        
              DO;                                                       
                 IF (BH950.EVS_FORSK_EJER.CEJBEVS = '0' !               
                     BH950.EVS_FORSK_EJER.CEJBEVS = '4') &              
                   ((BH950.EVS_FORSK_EJER.DAFSTAA  > 0 &                
                     BH950.EVS_FORSK_EJER.DAFSTAA  <=                   
                                      BH950.MT.DRGNÅRTIL) !             
                    (BH950.EVS_FORSK_EJER.DFRAFLYT > 0 &                
                     BH950.EVS_FORSK_EJER.DFRAFLYT <=                   
                                      BH950.MT.DRGNÅRTIL))              
                 THEN                                                   
                    RETURN;                                             
                 IF BH950.EVS_FORSK_EJER.CEJBEVS = '1' !                
                    BH950.EVS_FORSK_EJER.CEJBEVS = '2' !                
                    BH950.EVS_FORSK_EJER.CEJBEVS = '3'                  
                 THEN                                                   
                    RETURN;                                             
              END;                                                      
          END;                                                          
                                                                        
        /* F2005 */                                                     
        IF BH950.TIL_EVS.AKT_EJER.DCPRCIR = 0 &                         
           BH950.SORT_KOMNR < 999                                       
        THEN                                                            
          DO;                                                           
            IF (BH950.EVS_SLUT_EJER.DCPRN > 0 &                         
                BH950.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                
               (BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !              
                BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !              
                BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' !              
                BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '6' !              
                BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '7' !              
                BH950.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '8')) !            
               (BH950.EVS_FORSK_EJER.DCPRN > 0 &                        
               (BH950.EVS_FORSK_EJER.CEJBEVS = '0' !                    
                BH950.EVS_FORSK_EJER.CEJBEVS = '4' !                    
                BH950.EVS_FORSK_EJER.CEJBEVS = '5' !                    
                BH950.EVS_FORSK_EJER.CEJBEVS = '6' !                    
                BH950.EVS_FORSK_EJER.CEJBEVS = '7' !                    
                BH950.EVS_FORSK_EJER.CEJBEVS = '8'))                    
            THEN                                                        
              DO;                                                       
                IF BH950.EVS_SLUT_EJER.DCPRN > 0 &                      
                   BH950.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &             
                 ((BH950.EVS_SLUT_EJER.SIDSTE.DAFSTAA  > 0 &            
                   BH950.EVS_SLUT_EJER.SIDSTE.DAFSTAA  <=               
                                           BH950.MT.DRGNÅRTIL) !        
                  (BH950.EVS_SLUT_EJER.SIDSTE.DFRAFLYT > 0 &            
                   BH950.EVS_SLUT_EJER.SIDSTE.DFRAFLYT <=               
                                           BH950.MT.DRGNÅRTIL))         
                THEN                                                    
                   RETURN;                                              
                IF BH950.EVS_FORSK_EJER.DCPRN > 0 &                     
                 ((BH950.EVS_FORSK_EJER.DAFSTAA  > 0 &                  
                   BH950.EVS_FORSK_EJER.DAFSTAA  <=                     
                                           BH950.MT.DRGNÅRTIL) !        
                  (BH950.EVS_FORSK_EJER.DFRAFLYT > 0 &                  
                   BH950.EVS_FORSK_EJER.DFRAFLYT <=                     
                                           BH950.MT.DRGNÅRTIL))         
                THEN                                                    
                   RETURN;                                              
              END;                                                      
            ELSE                                                        
               RETURN;                                                  
          END;                                                          
                                                                        
        IF BH950.SORT_KOMNR = 999 &                                     
          (BH950.TIL_EVS.DAFSTAA > 0 !                                  
           BH950.TIL_EVS.DFRAFLYT > 0)                                  
        THEN                                                            
           RETURN;                                                      
                                                                        
        HJ_CHAR1 = BH950.EJENDOM.CEJDTYPE;                              
                                                                        
        IF HJ_CHAR1 < '1'                                               
        THEN                                                            
           INDEX = 0;                                                   
        ELSE                                                            
           INDEX = HJ_PIC1;                                             
                                                                        
        LÆST_EJDTYP(INDEX).ANTAL = LÆST_EJDTYP(INDEX).ANTAL + 1;        
                                                                        
        HJ_CHAR1 = BH950.EJENDOM.CBERGRL;                               
                                                                        
        IF HJ_CHAR1 < '1'                                               
        THEN                                                            
           INDEX = 0;                                                   
        ELSE                                                            
           INDEX = HJ_PIC1;                                             
                                                                        
        LÆST_BERGRL(INDEX).ANTAL = LÆST_BERGRL(INDEX).ANTAL + 1;        
                                                                        
        IF GLPNR ^= BH950.SORT_CPR                                      
        THEN                                                            
           DO;                                                          
              IF FANTINDV > 0                                           
              THEN                                                      
                 DO;                                                    
                    CALL OPTÆL_PERSON;                                  
                    CALL SKRIV_TIL_BN00200T;                            
                 END;                                                   
              ERKLÆRBAR = JA;                                           
              HJLBNR = 1;                                               
              FANTINDV = 1;                                             
              GLPNR = BH950.SORT_CPR;                                   
           END;                                                         
        ELSE                                                            
           DO;                                                          
              HJLBNR = HJLBNR + 1;                                      
              FANTINDV = FANTINDV + 1;                                  
           END;                                                         
                                                                        
        CALL UDSØG_TIL_BN00200T;                                        
                                                                        
        IF BH950.TIL_EVS.CEJBEVS = '0' !                                
           BH950.TIL_EVS.CEJBEVS = 'A'                                  
        THEN;                                                           
        ELSE                                                            
           ERKLÆRBAR = NEJ;                                             
                                                                        
         BH951 = '';                                                    
                                                                        
         BH951 = BH950.VURD_015ANV, BY NAME;                            
         BH951 = BH950.VURD_02ANV, BY NAME;                             
         BH951 = BH950.VURD_AKT, BY NAME;                               
         BH951 = BH950.TIL_EVS, BY NAME;                                
         BH951 = BH950.EJERSKAB, BY NAME;                               
         BH951 = BH950.EJENDOM, BY NAME;                                
         BH951 = BH950.FRA_EVS_SLUT, BY NAME;                           
         BH951 = BH950.TIL_EVS_FOR, BY NAME;                            
         BH951 = BH950.FRA_EVS_FOR, BY NAME;                            
         BH951 = BH950.TIL_FORSKUD, BY NAME;                            
                                                                        
         IF BH950.EJERSKAB.CEJDTYPE > '0'                               
         THEN                                                           
            BH951.CEJDTYPE = BH950.EJERSKAB.CEJDTYPE;                   
         ELSE                                                           
            BH951.CEJDTYPE = BH950.EJENDOM.CEJDTYPE;                    
                                                                        
         BH951.GPCTEJER = BH950.TIL_EVS.GPCTEJER * 100;                 
                                                                        
         /* HER NULSTILLES/BLANKES DATA SOM IKKE SKAL MEDTAGES, HVIS  */
         /* DE 'FANGES' AF OVENNÆVNTE 'BY NAMES' F.EKS. FORDI DE KOM- */
         /* MER FRA EVS-UDTRÆKKENE FRA SLUT OG/ELLER GL. FORSKUD      */
         /*  E L L E R  AT DER ER TALE OM UDGÅEDE DATA I NYT FORSKUD. */
                                                                        
         BH951.BEVSMAN = 0;                                             
                                                                        
         BH951.DINDKAAR = BH65300M.FORSKÅR;        /*#01*/              
         BH951.DCPRN  = BH950.SORT_CPR;                                 
         BH951.EKOMNR = BH950.SORT_KOMNR;                               
         BH951.EEJDNR = BH950.SORT_EJDNR;                               
                                                                        
         BH951.ELBNR = HJLBNR;                                          
         BH951.DFRAGLD = DATO2.ÅR !! '-' !! DATO2.MD !! '-' !!          
                         DATO2.DG !! '-01.01.01.000001';                
         BH951.DKØRT = '1900-12-31-00.00.00.000001';                    
         BH951.CEVSBENY = '1';                                          
         BH951.CEJDAKTI = '0';                                          
         BH951.DTILGLD = '9999-12-31-23.59.59.999999';                  
                                                                        
         BH951.B_NULL1 = '?'; /* BENYTTES IKKE MERE */                  
         BH951.B_NULL2 = '?'; /* BENYTTES IKKE MERE */                  
         BH951.B_NULL3 = '?'; /* BENYTTES IKKE MERE */                  
         BH951.B_NULL4 = '?'; /* BENYTTES IKKE MERE */                  
                                                                        
         IF BH950.FRA_EVS_FOR.BGLSUM_SW = -1                            
         THEN                                                           
            BH951.B_NULL5 = '?';                                        
                                                                        
         BH951.B_NULL6 = '?'; /* BENYTTES IKKE MERE */                  
                                                                        
         BH951.B_NULL7 = '?'; /* BNYMAN KAN IKKE KOMME I.F.M. */        
                              /* OPRETTELSEN                  */        
                                                                        
         IF BH950.TIL_EVS.BFASTSTIGBGR_SW = -1                          
         THEN                                                           
            BH951.B_NULL8 = '?';                                        
                                                                        
         BH951.B_NULL9 = '?'; /* BENYTTES IKKE MERE */                  
                                                                        
         IF BH950.EJERSKAB.BEJBOLANV_SW = -1                            
         THEN                                                           
            BH951.B_NULL10 = '?';                                       
                                                                        
         IF BH950.VURD_015ANV.BEJDVÆR_015ANV_SW = -1                    
         THEN                                                           
            BH951.B_NULL11 = '?';                                       
                                                                        
         IF BH950.FRA_EVS_SLUT.BEVSGL_SW = -1                           
         THEN                                                           
            BH951.B_NULL12 = '?';                                       
                                                                        
         IF BH950.FRA_EVS_SLUT.BPENSNEDGL_SW = -1                       
         THEN                                                           
            BH951.B_NULL13 = '?';                                       
                                                                        
         IF BH950.EJERSKAB.BBERGRLGL_SW = -1                            
         THEN                                                           
            BH951.B_NULL14 = '?';                                       
                                                                        
         IF BH950.TIL_EVS.AKT_EJER.COMPLA = '2'                         
         THEN                                                           
            DO;                                                         
               BH951.COMPLA = BH950.TIL_EVS.AKT_EJER.COMPLA;            
               BH951.DOMPLACPR = BH950.TIL_EVS.AKT_EJER.DOMPLACPR;      
            END;                                                        
                                                                        
         IF BH950.EJERSKAB.BBER2FAMGL_SW = -1                           
         THEN                                                           
            BH951.B_NULL15 = '?';                                       
                                                                        
         BH951.CFORSKEL = BH950.AKT_VURD.CFORSKEL;                      
                                                                        
         IF BH950.TIL_EVS_FOR.BEVSFREM_SW = -1                          
         THEN                                                           
            DO;                                                         
               BH950.TIL_EVS_FOR.BEVSFREM = 0;                          
               BH951.B_NULL16 = '?';                                    
            END;                                                        
                                                                        
         IF BH950.VURD_02ANV.BEJDVÆR_02ANV_SW = -1                      
         THEN                                                           
            BH951.B_NULL17 = '?';                                       
                                                                        
         IF BH950.VURD_015ANV.BBERGRL_015ANV_SW = -1                    
         THEN                                                           
            BH951.B_NULL18 = '?';                                       
                                                                        
         IF BH950.VURD_02ANV.BBERGRL_02ANV_SW = -1                      
         THEN                                                           
            BH951.B_NULL19 = '?';                                       
                                                                        
         IF BH950.VURD_AKT.BBERGRL_AKT_SW = -1                          
         THEN                                                           
            BH951.B_NULL20 = '?';                                       
                                                                        
        IF BH950.FEJLNR > 0                                             
        THEN                                                            
           DO;                                                          
              BH951.FEJLNR = BH950.FEJLNR;                              
              INDEX = BH951.FEJLNR;                                     
              SKR_FEJLNR(INDEX).ANTAL = SKR_FEJLNR(INDEX).ANTAL + 1;    
           END;                                                         
                                                                        
        IF BH950.TIL_EVS.CEJBEVS >= '0' !                               
           BH950.TIL_EVS.CEJBEVS = 'A'                                  
        THEN                                                            
           DO;                                                          
              IF BH950.TIL_EVS.CEJBEVS = 'A'                            
              THEN                                                      
                 INDEX = 10;                                            
              ELSE                                                      
                 DO;                                                    
                   HJ_CHAR1 = BH950.TIL_EVS.CEJBEVS;                    
                   INDEX = HJ_PIC1;                                     
                 END;                                                   
              SKR_EJBEVS(INDEX).ANTAL = SKR_EJBEVS(INDEX).ANTAL + 1;    
           END;                                                         
                                                                        
         IF BH950.TIL_EVS.CEJBEVS = '0'                                 
         THEN                                                           
            DO;                                                         
              TV.BEREGNET = TV.BEREGNET + 1;                            
              IF BH950.CHELÅR > '3'                                     
              THEN                                                      
                 TV.FANTSOM = TV.FANTSOM + 1;                           
              IF BH950.FRA_EVS_FOR.BPROM1 > 0                           
              THEN                                                      
                 TV.BPROM1 = TV.BPROM1 + 1;                             
              IF BH950.FRA_EVS_FOR.BPROM2 > 0                           
              THEN                                                      
                 TV.BPROM2 = TV.BPROM2 + 1;                             
              IF BH950.FRA_EVS_FOR.BNEDSL1 > 0                          
              THEN                                                      
                 TV.BNEDSL1 = TV.BNEDSL1 + 1;                           
              IF BH950.FRA_EVS_FOR.BNEDSL2 > 0                          
              THEN                                                      
                 TV.BNEDSL2 = TV.BNEDSL2 + 1;                           
              IF BH950.FRA_EVS_FOR.BPENSNED > 0                         
              THEN                                                      
                 DO;                                                    
                    IF BH950.TIL_EVS_FOR.CPENSNED1 = '1'                
                    THEN                                                
                       TV.CPENSN6000 = TV.CPENSN6000 + 1;               
                    ELSE                                                
                       TV.CPENSN2000 = TV.CPENSN2000 + 1;               
                 END;                                                   
                                                                        
              IF BH950.FRA_EVS_FOR.BPROM1 > 0                           
              THEN                                                      
                 DO;                                                    
                    IF BH950.FRA_EVS_FOR.BEJERAN = 0                    
                    THEN                                                
                       TV.BEREJD = TV.BEREJD +                          
                       BH950.FRA_EVS_FOR.B100;                          
                    ELSE                                                
                       TV.BEREJD = TV.BEREJD +                          
                       BH950.FRA_EVS_FOR.BEJERAN;                       
                 END;                                                   
                                                                        
              SELECT (BH950.TIL_EVS.BOPÆLSKODE);                        
                WHEN ('1')                                              
                  TV.BER_BOPÆL1 = TV.BER_BOPÆL1 + 1;                    
                WHEN ('2')                                              
                  TV.BER_BOPÆL2 = TV.BER_BOPÆL2 + 1;                    
                WHEN ('3')                                              
                  TV.BER_BOPÆL3 = TV.BER_BOPÆL3 + 1;                    
                WHEN ('4')                                              
                  TV.BER_BOPÆL4 = TV.BER_BOPÆL4 + 1;                    
                WHEN ('5')                                              
                  TV.BER_BOPÆL5 = TV.BER_BOPÆL5 + 1;                    
                WHEN ('6')                                              
                  TV.BER_BOPÆL6 = TV.BER_BOPÆL6 + 1;                    
                OTHERWISE                                               
                  TV.BER_BOPÆL0 = TV.BER_BOPÆL0 + 1;                    
              END;                                                      
            END;                                                        
         ELSE                                                           
            DO;                                                         
              TV.EJBEREGNET = TV.EJBEREGNET + 1;                        
              SELECT (BH950.TIL_EVS.BOPÆLSKODE);                        
                WHEN ('1')                                              
                  TV.EJBER_BOPÆL1 = TV.EJBER_BOPÆL1 + 1;                
                WHEN ('2')                                              
                  TV.EJBER_BOPÆL2 = TV.EJBER_BOPÆL2 + 1;                
                WHEN ('3')                                              
                  TV.EJBER_BOPÆL3 = TV.EJBER_BOPÆL3 + 1;                
                WHEN ('4')                                              
                  TV.EJBER_BOPÆL4 = TV.EJBER_BOPÆL4 + 1;                
                WHEN ('5')                                              
                  TV.EJBER_BOPÆL5 = TV.EJBER_BOPÆL5 + 1;                
                WHEN ('6')                                              
                  TV.EJBER_BOPÆL6 = TV.EJBER_BOPÆL6 + 1;                
                OTHERWISE                                               
                  TV.EJBER_BOPÆL0 = TV.EJBER_BOPÆL0 + 1;                
              END;                                                      
            END;                                                        
                                                                        
         IF BH950.TIL_EVS_FOR.BEVSFREM_SW = 0                           
         THEN                                                           
            DO;                                                         
               TV.FREMSKREVET = TV.FREMSKREVET + 1;                     
               TV.EJDFREM = TV.EJDFREM +                                
               BH950.TIL_EVS_FOR.BEVSFREM;                              
            END;                                                        
                                                                        
         IF BH950.TIL_EVS.BFASTSTIGBGR_SW = 0                           
         THEN                                                           
            DO;                                                         
               TV.FASTSTIG = TV.FASTSTIG + 1;                           
               TV.BFASTSTIGBGR =                                        
               TV.BFASTSTIGBGR + BH950.TIL_EVS.BFASTSTIGBGR;            
            END;                                                        
                                                                        
         TV.SKREVET = TV.SKREVET + 1;                                   
                                                                        
         WRITE FILE (BH9510O) FROM (BH951);                             
                                                                        
 END BEHANDL;                                                           
                                                                        
 /********************************************************************* 
 *       FIND FEJLNUMRE TIL BN00200T PR. PERSON                       * 
 *********************************************************************/ 
 UDSØG_TIL_BN00200T:                                                    
         PROC;                                                          
                                                                        
   /*    IF BH950.TIL_EVS.CEJBEVS = '1' !                               
            BH950.TIL_EVS.CEJBEVS = 'A' !                               
            BH950.FEJLNR = 5010         !                               
            BH950.FEJLNR = 5045         !                               
            BH950.FEJLNR = 0                                            
         THEN                                                           
            RETURN;                                          #6.1     */
                                                                        
   /* #6.1  5010 SKAL NU VÆRE ADVIS, 5045 UDGÅET /*                     
   /* #6.1  DER OPSÆTTES KUN FEJLNUMRE, NÅR CEJBEVS = 2 ELLER 3 */      
         IF BH950.TIL_EVS.CEJBEVS = '1' !                               
            BH950.TIL_EVS.CEJBEVS = 'A' !                               
            BH950.TIL_EVS.CEJBEVS = '7' !                    /* #6.1  */
            BH950.TIL_EVS.CEJBEVS = '8' !                    /* #6.1  */
            BH950.FEJLNR = 0                        /* => CEJBEVS = 0 */
         THEN                                                           
            RETURN;                                                     
                                                                        
         I = BH950.FEJLNR - 5000;                                       
         FEJLTAB(I) = JA;                                               
                                                                        
 END UDSØG_TIL_BN00200T;                                                
 /********************************************************************* 
 *       SKRIV FEJLNUMRE TIL BN00200T PR. PERSON                      * 
 *********************************************************************/ 
 SKRIV_TIL_BN00200T:                                                    
         PROC;                                                          
                                                                        
                                                                        
         DO I = 1 TO 200;                                               
            IF FEJLTAB(I) = JA                                          
            THEN                                                        
               DO;                                                      
                  BH9511.DCPRN = GLPNR;                                 
                  BH9511.FEJLNR = 5000 + I;                             
                  IF ADVIS_OK(BH9511.FEJLNR)                 /* #6.1 */ 
                  THEN                                                  
                     BH9511.FTYPE = 'A';                                
                  ELSE                                                  
                     BH9511.FTYPE = 'B';                                
                  WRITE FILE (BH9511O) FROM (BH9511);                   
                                                                        
                  TV.SKRFEJL = TV.SKRFEJL + 1;                          
                  FEJLTAB(I) = NEJ;                                     
               END;                                                     
         END;                                                           
                                                                        
 END SKRIV_TIL_BN00200T;                                                
 /********************************************************************* 
 *       OPTÆL STATUS FOR DENNE PERSON                                * 
 *********************************************************************/ 
 OPTÆL_PERSON:                                                          
         PROC;                                                          
                                                                        
         SELECT;                                                        
           WHEN (FANTINDV = 1)                                          
              INDEX = 2;                                                
           WHEN (FANTINDV = 2)                                          
              INDEX = 3;                                                
           WHEN (FANTINDV = 3)                                          
              INDEX = 4;                                                
           WHEN (FANTINDV = 4)                                          
              INDEX = 5;                                                
           WHEN (FANTINDV = 5)                                          
              INDEX = 6;                                                
           WHEN (FANTINDV = 6)                                          
              INDEX = 7;                                                
           WHEN (FANTINDV = 7)                                          
              INDEX = 8;                                                
           WHEN (FANTINDV = 8)                                          
              INDEX = 9;                                                
           WHEN (FANTINDV = 9)                                          
              INDEX = 10;                                               
           WHEN (FANTINDV = 10)                                         
              INDEX = 11;                                               
           WHEN (FANTINDV >= 11 & FANTINDV  <= 20)                      
              INDEX = 12;                                               
           WHEN (FANTINDV >= 21 & FANTINDV  <= 30)                      
              INDEX = 13;                                               
           WHEN (FANTINDV >= 31 & FANTINDV  <= 40)                      
              INDEX = 14;                                               
           WHEN (FANTINDV >= 41 & FANTINDV  <= 50)                      
              INDEX = 15;                                               
           OTHERWISE                                                    
              INDEX = 16;                                               
         END;                                                           
                                                                        
         TAB_PERSON(1).ANTAL = TAB_PERSON(1).ANTAL + 1;                 
         TAB_PERSON(INDEX).ANTAL = TAB_PERSON(INDEX).ANTAL + 1;         
                                                                        
         IF ERKLÆRBAR = JA                                              
         THEN                                                           
            DO;                                                         
               TAB_PERSON(1).ERKL = TAB_PERSON(1).ERKL + 1;             
               TAB_PERSON(INDEX).ERKL = TAB_PERSON(INDEX).ERKL + 1;     
            END;                                                        
         ELSE                                                           
            DO;                                                         
               TAB_PERSON(1).EJERKL = TAB_PERSON(1).EJERKL + 1;         
               TAB_PERSON(INDEX).EJERKL = TAB_PERSON(INDEX).EJERKL + 1; 
            END;                                                        
                                                                        
         IF MAX_ANT_INDV < FANTINDV                                     
         THEN                                                           
            MAX_ANT_INDV = FANTINDV;                                    
                                                                        
 END OPTÆL_PERSON;                                                      
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH950;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK             B.H95000D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF LÆST_EJDTYP(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJENDOMSTYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_EJDTYP(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 9;                                             
            IF LÆST_BERGRL(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED BER.GRL.TYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_BERGRL(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 5000 TO 6000;                                       
            IF LÆST_FEJLNR(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = LÆST_FEJLNR(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.KUN_EJDTAB;                                 
         DETLIN1.TEKST = 'HERAF INDIVIDER KUN TIL EVS-EJENDOMSTABEL  '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKRFEJL;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIV. TIL BN00200T B.H95110D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER           B.H95100D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 5000 TO 6000;                                       
            IF SKR_FEJLNR(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = SKR_FEJLNR(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DO INDEX = 0 TO 10;                                            
            IF SKR_EJBEVS(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  IF INDEX = 10                                         
                  THEN                                                  
                     DETLIN1.TEKST =                                    
                     '      HERAF MED CEJBEVS A';                       
                  ELSE                                                  
                     DETLIN1.TEKST =                                    
                     '      HERAF MED CEJBEVS ' !! HJ_CHAR1;            
                  DETLIN1.ANTAL = SKR_EJBEVS(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(1).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(1).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '      HERAF ERKLÆRBARE';                      
         DETLIN1.ANTAL = TAB_PERSON(1).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '      HERAF IKKE ERKLÆRBARE';                 
         DETLIN1.ANTAL = TAB_PERSON(1).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(2).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(2).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(2).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(2).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(3).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(3).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(3).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(3).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(4).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(4).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(4).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(4).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(5).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(5).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(5).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(5).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(6).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(6).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(6).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(6).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(7).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(7).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(7).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(7).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(8).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(8).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(8).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(8).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(9).TEKST;                           
         DETLIN1.ANTAL = TAB_PERSON(9).ANTAL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(9).ERKL;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(9).EJERKL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(10).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(10).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(10).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(10).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(11).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(11).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(11).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(11).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(12).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(12).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(12).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(12).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(13).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(13).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(13).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(13).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(14).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(14).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(14).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(14).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(15).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(15).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(15).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(15).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = TAB_PERSON(16).TEKST;                          
         DETLIN1.ANTAL = TAB_PERSON(16).ANTAL;                          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '            HERAF ERKLÆRBARE';                
         DETLIN1.ANTAL = TAB_PERSON(16).ERKL;                           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.TEKST = '            HERAF IKKE ERKLÆRBARE';           
         DETLIN1.ANTAL = TAB_PERSON(16).EJERKL;                         
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = MAX_ANT_INDV;                                  
         DETLIN1.TEKST = 'MAX. ANTAL EJENDOMME TIL SAMME PERSON';       
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS1;                                           
         DETLIN2.ANTAL = TV.FASTSTIG;                    /*FORSKUD06*/  
         DETLIN2.TEKST = 'BEREGNET FASTFROSSEN STIGN.BEGR.     ANTAL:'; 
         DETLIN2.BELØB = TV.BFASTSTIGBGR;                               
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.FREMSKREVET;                                
         DETLIN2.TEKST = 'ANTAL FREMSKREVNE EJENDOMME (EVS)          '; 
         DETLIN2.BELØB = TV.EJDFREM;                     /*FORSKUD06 */ 
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.BEREGNET;                                   
         DETLIN2.TEKST = 'ANTAL BEREGNEDE EJENDOMME (EVS)            '; 
         DETLIN2.BELØB = TV.BEREJD;                       /*FORSKUD06*/ 
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN2.CCA = ZZWS1;                                           
         DETLIN2.ANTAL = TV.FANTSOM;                       /*FORSKUD06*/
         DETLIN2.TEKST = '    HERAF HELÅRSSOMMERHUSE           ANTAL:'; 
         DETLIN2.BELØB = 0;                                             
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM1;                                     
         DETLIN1.TEKST = '    HERAF MED 10 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM2;                                     
         DETLIN1.TEKST = '    HERAF MED 30 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL1;                                    
         DETLIN1.TEKST = '    HERAF MED 2 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL2;                                    
         DETLIN1.TEKST = '    HERAF MED 4 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN6000;                                 
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG 6000 KR.  ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.CPENSN2000;                                 
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG 2000 KR.  ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL1;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL2;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL3;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL4;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL5;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL6;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL0;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.EJBEREGNET;                                 
         DETLIN1.TEKST = 'ANTAL IKKE BEREGNEDE EJENDOMME (EVS)       '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL1;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL2;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL3;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL4;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL5;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL6;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL0;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
  END TOTALLISTE;                                                       
 /*********************************************************************/
 /*      HALVAUTOMATISK FAKTURERING AF DANNELSE AF EVS-OPLYSNINGER.   */
 /*      FAKTURERING SKER KUN TIL T&S.                                */
 /*********************************************************************/
 FAKTURER_TS:  PROC;                                                    
                                                                        
 DCL   1 SMF,                                                           
         2 RETURKODE     BIT       (8),                                 
         2 EKOMNR        PIC       '9999',                              
         2 EINST         CHAR      (3),                                 
         2 ANTENH        PIC       '(7)9',                              
         2 CENHED        CHAR      (3),                                 
         2 AENHED        CHAR      (20);                                
                                                                        
         SMF.EKOMNR = 6989; /*T&S*/                                     
         SMF.EINST  = '000';                                            
                                                                        
         SMF.ANTENH = TV.SKREVET;                                       
         SMF.CENHED = '901';                                            
         SMF.AENHED = 'ANT EVS FORSKUD OPL ';                           
         CALL ZS34900 (SMF);                                            
                                                                        
         LIN_DEB =  ZZWS2 !!                                            
                    (43)'*'  !! ' FEJL I HALVAUTO. FAKTURE' !!          
                    'RING EVS-OPLYSNINGER TIL FORSKUD      '            
                    !! (24)'*';                                         
                                                                        
         IF SMF.RETURKODE ^= '00000000'B                                
         THEN                                                           
            CALL ZZ20300 (LIN_DEB,'01');                                
                                                                        
 END FAKTURER_TS;                                                       
 /********************************************************************* 
 *       MASKINEL AFSTEMNING                                          * 
 *********************************************************************/ 
 MASK_AFSTEMNING:                                                       
         PROC;                                                          
         IF BH95099.SORT_KOMNR ^= 999                                   
         THEN                                                           
            CALL FEJLLISTE('1');                                        
         IF BH950_ANT_INDV ^= TV.LÆS_BH950 &                            
            EX_PARM ^= 'TEST'                                           
         THEN                                                           
            CALL FEJLLISTE('2');                                        
 END MASK_AFSTEMNING;                                                   
 /*********************************************************************/
 /*      UDSKRIV FEJLLISTE VEDR. KONSTATERET AFSTEMNINGFEJL PÅ ???    */
 /*********************************************************************/
 FEJLLISTE:                                                             
         PROC(FEJL);                                                    
 DCL     FEJL            CHAR      (01);                                
         CALL ZZ20390 ('*OPEN','BH95102Y');                             
         CALL ZZ20300(SIDELIN,'02');                                    
         CALL ZZ20300(OVERLIN1,'02');                                   
         OVERLIN2.CCA = ZZWS3;                                          
         OVERLIN2.TEKST1 = 'FEJLLISTE VEDR. MASKINEL AFSTEMNING';       
         CALL ZZ20300(OVERLIN2,'02');                                   
         IF FEJL = '1'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  =                                         
               'AFSTEMNINGSINDIVID MANGLER PÅ B.H95000D';               
               DETLIN1.ANTAL = '';                                      
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '2'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST = 'ANTAL LÆSTE INDIVIDER PÅ B.H95000D';    
               DETLIN1.ANTAL = TV.LÆS_BH950;                            
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST =                                          
               'ANTAL IFØLGE AFSTEMNINGSINDIVID IALT  :';               
               DETLIN1.ANTAL = BH950_ANT_INDV;                          
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
            SWFEJL = '1';                                               
 END FEJLLISTE;                                                         
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
         CALL OPTÆL_PERSON;                /* SIDSTE PERSON OPTÆLLES */ 
         CALL SKRIV_TIL_BN00200T;          /* SIDSTE PERSON SKRIVES  */ 
         CALL FAKTURER_TS;                                              
         CALL TOTALLISTE;                                               
         CALL MASK_AFSTEMNING;                                          
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH950I),                                           
               FILE (BH9510O),                                          
               FILE (BH9511O);                                          
     /*  IF SWFEJL = '1'                                                
         THEN                                                           
            CALL ZS30101(4,'BH95100 ** 251 ' !!                         
                 'MASKINEL KONSTATERET AFSTEMNINGSFEJL',2); */          
 END AFSLUT;                                                            
                                                                        
 %INCLUDE BH95100M;                 /* TJEK OM DET ER ADVIS      #6.1 */
 END  BH95100;                                                          
