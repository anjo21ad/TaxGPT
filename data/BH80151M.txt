                                                                        
 /*********************************************************************/
 /*        BH80151M UNDERSØG GENERELLE UNDTAGELSER VEDR.              */
 /*                 BEREGNING AF LEJEVÆRDI FOR  P E R S O N E N       */
 /*                 FÆLLES MACRO TIL :                                */
 /*                 BH80110 FORSKUD                                   */
 /* OBS.:  DENNE PROC SKAL KUN AKTIVERES HVIS DER ER BEREGNET DE TRE  */
 /*        LEJEVÆRDIER FOR EJENDOMMEN.                                */
 /*        DER TESTES IKKE FOR FORSKUDT REGNSKABSÅR HVIS FORSKUD      */
 /*********************************************************************/
 UNDTAGELSER_LEJEVÆRDI_PERSON:                                          
         PROC;                                                          
                                                                        
         BEREGN = NEJ;                                                  
                                                                        
 /*********************************************************************/
 /* OBS.: DER TESTES IKKE FOR BENYTTELSESKODER, GENERELLE UNDTAGELSER */
 /*       SAMT BENYTTELSESKODE-BESTEMTE UNDTAGELSER, SOM ALLEREDE ER  */
 /*       UNDERSØGT VED BEREGNING AF EJENDOMMENS LEJEVÆRDIER          */
 /*********************************************************************/
                                                                        
         IF BH801.CINVPNR ^= '0'            /*  K U N  BEREGNING HVIS */
         THEN                               /*  VALIDT PERSONNUMMER   */
            RETURN;                                                     
                                                                        
         /* DET ER KUN INDIVIDER MED ET VALIDT CPRNR., DER   */         
         /* KAN FÅ BEREGNET EN PERSONLIG LEJEVÆRDI.          */         
                                                                        
         IF BH801.CLEJE_FESR = '6' !             /* UNDTAGELSE  3 */    
            BH801.CLEJE_FESR = '7'                                      
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH801.FEJER > 2                 /* UNDTAGELSE  8 OG */      
         THEN                               /* UNDTAGELSE  10   */      
            DO;                                                         
               IF BH801.CBENYT  = '08' ! BH801.CBENYT = '48'            
               THEN                                                     
                  DO;                                                   
                     IF BH801.CEJ_100 = '1'                             
                     THEN;                                              
                     /* SOMMERHUS OG SAMLET EJERANDEL */                
                     /* ER LIG 100%   -   KAN BEREGNES*/                
                     ELSE                                               
                        RETURN;                                         
                  END;                                                  
               ELSE                                                     
                  IF BH801.FEJER > 3 !                                  
                     BH801.CEJ_100 ^= '1'                               
                  THEN                                                  
                     RETURN;                                            
            END;                                                        
                                                                        
         IF BH801.FEJER = 2                 /* UNDTAGELSE  10   */      
         THEN                                                           
            DO;                                                         
               IF BH801.CEJ_100 = '1' !  /* EJERANDELE IALT = 100 % */  
                  BH801.CEJ_100 = '2'    /* DEN ENE EJERANDEL = O   */  
               THEN;                                                    
               ELSE                                                     
                  RETURN;                                               
            END;                                                        
                                                                        
         IF BH801.FEJER < 2                       /* UNDTAGELSE  ?? */  
         THEN                                                           
            DO;                                                         
               IF BH801.GANE > 0 &              /* EJERANDELEN FOR  */  
               BH801.GANE < 10000               /* EN ENEEJER ER    */  
               THEN                             /* MINDRE END 100 % */  
                  RETURN;                                               
            END;                                                        
                                                                        
 /***    DER SKAL ALTSÅ FORETAGES LEJEVÆRDIBEREGNING FOR PERSONEN   ***/
         BEREGN = JA;                                                   
                                                                        
 END UNDTAGELSER_LEJEVÆRDI_PERSON;                                      
                                                                        
