  PROCESS OPT(TIME);                                                    
 BH62500:  /* UDSKRIV STATISTIKKER VEDR E-SKEMA                       */
         PROC OPTIONS (MAIN) REORDER;                                   
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 1999');       
 /*********************************************************************/
 /* FORMÅL: AT UDSKRIVE 2 STATISTIKER PÅ GRUNDLAG AF BEREGN.BÅND      */
 /*                                                                   */
 /* INPUT : B.H61101D      BEREGNINGSBÅND                             */
 /*         Z.D30201D      KOMMUNEREGISTER                            */
 /*                                                                   */
 /* OUTPUT: BH62501Y       SPECIFIKATION AF EJENDOMSVÆRDIER           */
 /*         BH62502Y       OVERSIGT OVER EJENDOMME FORDELT PÅ         */
 /*                        BENYTTELSESKODER                           */
 /*         BH62503Y       RC-TOTALER FOR OVENNÆVNTE                  */
 /*         BH62504Y       FEJLLISTE FRA MASKINEL AFSTEMNING          */
 /*                                                                   */
 /* PROGRAMMØR : MARGIT PEDERSBÆK   SEPT.   1987                      */
 /* RETTET     : MARGIT PEDERSBÆK   SEPT.   1988                      */
 /*              PALLE CHRISTIANSEN,  UC-SKAT, BRØNDBY    SEPT. 1989  */
 /*              MARGIT PEDERSBÆK   OKT.     1990                     */
 /*              AAGE RASMUSSEN     NOV.     1991                     */
 /*              AAGE RASMUSSEN     NOV.     1992                     */
 /*              AAGE RASMUSSEN     DEC.     1993                     */
 /*              AAGE RASMUSSEN     DEC.     1994                     */
 /*              AAGE RASMUSSEN     DEC.     1995                     */
 /*              AAGE RASMUSSEN     AUG.     1996                     */
 /*              AAGE RASMUSSEN     JAN.     1997                     */
 /*              AAGE RASMUSSEN     JAN.     1998                     */
 /*              AAGE RASMUSSEN     JAN.     1999                     */
 /*              AAGE RASMUSSEN     JAN.     2000                     */
 /*                                                                   */
 /*********************************************************************/
 /*********************************************************************/
 /*                                                                   */
 /*          ÅRSBESTEMTE VARIABLE......                               */
 /*                                                                   */
 /*   S K A L  R E T T E S  Å R L I G T                               */
 /*   *********************************                               */
 /*                                                                   */
 /*********************************************************************/
 DCL     ÅR_PCT_GRÆNSE_1  FIXED     (15)  INIT (2393000);               
 DCL     ÅR_PCT_GRÆNSE_2  FIXED     (15)  INIT (2650000);               
 DCL     ÅR_ULTIMO        CHAR      (16)  INIT ('       1999');         
 /*********************************************************************/
 /*                                                                   */
 /*          ÅRSBESTEMTE VARIABLE INITIERES EFTER EVT. BEREGNING      */
 /*                                       (INDSAT AF PSC I 1989)      */
 /*********************************************************************/
 DCL     1 O_SEV2_HEADEREN,                                             
           2  TXT1         CHAR (24)         INIT (' '),                
           2  INTERVAL1,                                                
              3  PART1     CHAR  (7)         INIT ('INDTIL '),          
              3  GRÆNSE1   PIC '9.999.999'   INIT (0),                  
           2  INTERVAL2,                                                
              3  PART1     CHAR (11)         INIT ('           '),      
              3  GRÆNSE11  PIC '9.999.999'   INIT (0),                  
              3  STREG     CHAR  (1)         INIT ('-'),                
              3  GRÆNSE2   PIC '9.999.999'   INIT (0),                  
           2  INTERVAL3,                                                
              3  PART1     CHAR (11)         INIT ('           '),      
              3  GRÆNSE21  PIC '9.999.999'   INIT (0),                  
              3  PART2     CHAR (17)         INIT (' OG DEROVER      '),
              3  PART3     CHAR  (9)         INIT ('     IALT'),        
              3  PART4     CHAR (16)         INIT ('                '); 
 DCL     O_SEV2_HEADER     CHAR (132)  BASED (ADDR(O_SEV2_HEADEREN));   
 DCL     ÅR_ULTIMO_TEKST   CHAR (48)         INIT (' ');                
 /********************************************************************* 
 *                                                                    * 
 *                 FILES  OG INPUTSTRUKTUR                            * 
 *                                                                    * 
 *********************************************************************/ 
 DCL     BH611I  FILE RECORD INPUT;                /* BEREGNINGSBÅND */ 
 DCL     BH611_AR        CHAR      (4000) VAR;                          
 DCL     1 BH611                          BASED(ADDR(BH611_AR)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH60100N;                                           
 DCL     1 BH61199                        BASED(ADDR(BH611_AR)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH60199N;                                           
 DCL     HJ_CBENYT       PIC       '99' BASED(ADDR(BH611.CBENYT));      
 /********************************************************************* 
 *                                                                    * 
 *           TÆLLEVÆRKER TIL SPECIFIKATION AF EJDVÆRDI  BH62501Y      * 
 *                                                                    * 
 *********************************************************************/ 
 DCL     TVPTR2 PTR;                         /* PÅ KOMMUNENIVEAU     */ 
 DCL     VÆRTAB (70,4)   CHAR      (12);     /* FELTER TIL BH62501Y  */ 
 DCL     1 SUM1 BASED (TVPTR2),                                         
           2 TREC        FIXED     (7),                                 
           2 TVÆR        FIXED     (15);                                
 /********************************************************************* 
 *                                                                    * 
 *         TÆLLEVÆRKER TIL OVERSIGT PR. BENYTT. KODE    BH62502Y      * 
 *                                                                    * 
 *********************************************************************/ 
 DCL     TVPTR1 PTR;                         /* PÅ KOMMUNENIVEAU     */ 
 DCL     ANTTAB (34)     CHAR      (58);     /* FELTER TIL BH62502Y  */ 
 DCL     1 TÆL BASED (TVPTR1),                                          
           2 TIDV        FIXED     (7),      /* ANTAL INDIVIDER      */ 
           2 TEJDVÆR     FIXED     (15),     /* EJENDOMSVÆRDI        */ 
           2 TSTUVÆR     FIXED     (15),     /* STUEHUSVÆRDI         */ 
           2 TEJEBOL     FIXED     (15),     /* EJERBOLIGVÆRDI       */ 
           2 TLEJEVÆR    FIXED     (15),     /* BEREGNET LEJEVÆRDI   */ 
           2 TSTDFRA     FIXED     (13),     /* STANDARDFRADRAG      */ 
           2 TEJDSKA     FIXED     (13),     /* EJENDOMSSKAT         */ 
           2 TCPR_0      FIXED     (7),      /* ANTAL CPR = 0        */ 
           2 TFSKKNR     FIXED     (7); /* ANT EJD MED EKOMNR^=EÆKNR */ 
 /*********************************************************************/
 /*                                                                   */
 /*           TABELLER MED RC-TOTALER                                 */
 /*                                                                   */
 /*********************************************************************/
 DCL     RCTOT4(33,9)    FIXED     (15) INIT((297)0); /* BH62502Y     */
 DCL     KOMSUM(9)       FIXED     (15) INIT((9)0);   /* OPSUM SØJLER */
 DCL     1 RCTOT3(70,4),                              /* BH62503Y     */
          2 RCIND        FIXED     (7)  INIT((280)0),                   
          2 RCVÆR        FIXED     (15) INIT((280)0);                   
 /*********************************************************************/
 /*                                                                   */
 /*           OVERSKRIFTSLINIE TIL BH62501Y OG BH62502Y               */
 /*                                                                   */
 /*********************************************************************/
 DCL     O_INDGÅR        CHAR      (133);                               
 /*********************************************************************/
 /*                                                                   */
 /*           PRINTLINIER TIL BH62501Y - SPEC EJD.VÆRDI               */
 /*                                                                   */
 /*********************************************************************/
 DCL     O_SEV1          CHAR      (133);     /* OVERSK. BH62501Y     */
 DCL     1 RC_LIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 HTEKST1     CHAR      (39)      INIT                       
             ('PROGRAM: BH62500L'),                                     
           2 HTEKST2     CHAR      (59),                                
           2 HTEKST3     CHAR      (14)      INIT                       
             ('UDSKREVET DEN '),                                        
           2 DATO        CHAR      (10),                                
           2 HTEKST4     CHAR      (07)      INIT                       
             ('  SIDE'),                                                
           2 ESIDE       PIC       'ZZZ';                               
 DCL     1 RC_LIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 ERC         CHAR      (04),                                
           2 HTEKST      CHAR      (69)      INIT      ('RC-TOTAL'),    
           2 FILLER      CHAR      (59)      INIT      (' ');           
 DCL     1 O5            DEF O_SEV1,                                    
           2 CCJ         CHAR      (1),                                 
           2 S_KNR       CHAR      (4),                                 
           2 S_KNA       CHAR      (35),                                
           2 S_TXT1      CHAR      (59),                                
           2 S_TXT2      CHAR      (14),                                
           2 S_DATO      CHAR      (10),                                
           2 S_TXT3      CHAR      (7),                                 
           2 S_SIDE      PIC       'ZZZ',                               
         O_SEV2          CHAR      (133),                               
         O_SEV3          CHAR      (133),                               
         O_SEV4          CHAR      (133),                               
         O_SEV5          CHAR      (133);                               
 DCL     1 L6            DEF LIN1,            /* DETAIL-LINIER        */
           2 CCF         CHAR      (1),                                 
           2 KONST2      CHAR      (15),                                
           2 UDTAB (4),                                                 
             3 BL1       CHAR      (4),                                 
             3 ANTAL     PIC       'ZZZZZZZ',                           
             3 BL2       CHAR      (3),                                 
             3 EJDVDI    PIC       'ZZZZZZZZZZZZZZZ';                   
 /*********************************************************************/
 /*                                                                   */
 /*      TEKSTER TIL       - BH62501Y - SPEC EJD.VÆRDI - SIDE 1-3     */
 /*                                                                   */
 /*********************************************************************/
 DCL     TXT(3)          CHAR      (15)                                 
         INIT ('BEREGNET',                                              
               '67-ÅRIGE',                                              
               'EJ BEREGNET');                                          
 DCL     TXT_SOM(4)      CHAR      (15)                                 
         INIT ('BEREGNET 2,5%',                                         
               'BEREGNET 2%',                                           
               '67-ÅRIGE',                                              
               'EJ BEREGNET');                                          
 DCL     TEKST(54)       CHAR      (15)                                 
         INIT('SIDE 1', 'BENYT.KODE 01', 'ENFAM.HUSE', ' ',             
              'BENYT.KODE 08', ' ',                                     
              'BENYT.KODE 21', ' ',                                     
              'BENYT.KODE 26', ' ',                                     
              'BENYT.KODE 27', ' ',                                     
              'BENYT.KODE 28', ' ',                                     
              'BENYT.KODE 41','EN LEJLIGHED',' ',                       
              'BENYT.KODE 48', ' ',                                     
              'SIDE 2', 'BENYT.KODE 01', 'ENFAM.HUSE', ' ',             
              'BENYT.KODE 05', ' ',                                     
              'BENYT.KODE 06', ' ',                                     
              'BENYT.KODE 07', ' ',                                     
              'BENYT.KODE 13', ' ',                                     
              'SIDE 3', 'BENYT.KODE 01', 'ENFAM.HUSE', ' ',             
                        'BENYT.KODE 01', 'TOFAM.HUSE', ' ',             
              'BENYT.KODE 02', ' ',                                     
              'BENYT.KODE 06', ' ',                                     
              'BENYT.KODE 13', ' ',                                     
              'BENYT.KODE 22', ' ',                                     
              'BENYT.KODE 29', ' ',                                     
              'BENYT.KODE 42', ' ',                                     
              'BENYT.KODE 45', ' ');                                    
 /*********************************************************************/
 /*                                                                   */
 /*           PRINTLINIER TIL BH62502Y - OVERSIGT EJD.VÆRDI           */
 /*                                                                   */
 /*********************************************************************/
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 HTEKST1     CHAR      (39)      INIT                       
                         ('PROGRAM: BH62500L'),                         
           2 HTEKST2     CHAR      (59),                                
           2 HTEKST3     CHAR      (14)      INIT ('UDSKREVET DEN '),   
           2 DATO        CHAR      (10),                                
           2 HTEKST4     CHAR      (07)      INIT ('  SIDE '),          
           2 ESIDE       PIC       'ZZZ';                               
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 CRC         CHAR      (04),                                
           2 HTEKST      CHAR      (69),                                
           2 FILLER      CHAR      (59)      INIT     (' ');            
 DCL     LIN1            CHAR      (133);                               
 DCL     O_EVÆ1          CHAR      (133);     /* OVSKR. BH62502Y      */
 DCL     1 O3            DEF O_EVÆ1,          /* SIDE 1               */
           2 CCI         CHAR      (1),                                 
           2 E_KNR       CHAR      (4),                                 
           2 E_KNA       CHAR      (35),                                
           2 E_TXT1      CHAR      (59),                                
           2 E_TXT2      CHAR      (14),                                
           2 E_DATO      CHAR      (10),                                
           2 E_TXT3      CHAR      (7),                                 
           2 E_SIDE      PIC       'ZZZ';                               
 DCL     O_EVÆ2          CHAR      (133);                               
 DCL     O_EVÆ3          CHAR      (133);                               
 DCL     1 L4 DEF LIN1,                       /* DETAIL-LINIE         */
           2 CCD         CHAR      (2),                                 
           2 BENYT       CHAR      (5),                                 
           2 LÆSIDV      PIC       'ZZZZZZZ',                           
           2 BL1         CHAR      (1),                                 
           2 EJDVÆR      PIC       'ZZZZZZZZZZZZZZZ',                   
           2 BL2         CHAR      (1),                                 
           2 STHUS       PIC       'ZZZZZZZZZZZZZZZ',                   
           2 BL3         CHAR      (1),                                 
           2 EJEBOLV     PIC       'ZZZZZZZZZZZZZZZ',                   
           2 BL4         CHAR      (1),                                 
           2 LEJEVÆR     PIC       'ZZZZZZZZZZZZZZ',                    
           2 BL5         CHAR      (1),                                 
           2 STDFRAD     PIC       'ZZZZZZZZZZZZZ',                     
           2 BL6         CHAR      (1),                                 
           2 EJDSKAT     PIC       'ZZZZZZZZZZZZZ',                     
           2 BL7         CHAR      (5),                                 
           2 CPR_0       PIC       'ZZZZZZZ',                           
           2 BL8         CHAR      (9),                                 
           2 FORSKOM     PIC       'ZZZZZZZ',                           
         1 L5 DEF LIN1,                                                 
           2 CCE         CHAR      (1),                                 
           2 KONST1      CHAR      (35),                                
           2 SIDER       PIC       'ZZZZZZZZZZZZZZZ',                   
           2 FYLD1       CHAR      (2),                                 
           2 LINIER      PIC       'ZZZZZZZZZZZZZZZ',                   
           2 FYLD2       CHAR      (9),                                 
           2 KONST1A     CHAR      (15),                                
           2 ENEEJ       PIC       'ZZZZZZZZZZZ',                       
           2 FYLD3       CHAR      (5),                                 
           2 FLEREJ      PIC       'ZZZZZZZZZZZ';                       
 DCL     1 L7  DEF LIN1,                                                
           2 CCE         CHAR      (01),                                
           2 TXT1        CHAR      (40),                                
           2 TXT2        CHAR      (68),                                
           2 TXT3        CHAR      (14),                                
           2 DATO        CHAR      (10);                                
 /*********************************************************************/
 /*                                                                   */
 /*      TEKSTER TIL       - BH62502Y - OVERSIGT EJD.VÆRDI            */
 /*                                                                   */
 /*********************************************************************/
 DCL     BENKODE(33)     CHAR      (2)                                  
         INIT('01','02','03','04','05','06','07','08','09','13',        
              '17','21','22','23','24','25','26','27','28','29',        
              '31','33','34','41','42','43','44','45','48','49',        
              '70','71');                                               
 /********************************************************************* 
 *                                                                    * 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *                                                                    * 
 *********************************************************************/ 
 DCL     EOF_BH611       BIT       (01);                                
 DCL     FØRSTE_GANG     BIT       (01);                                
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     1 HJGL_NØGLE,                                 /* SEKV.TEST */  
           2 SORT_EÆKNR  FIXED     (3)  INIT (0),                       
           2 SORT_CPR    FIXED     (11) INIT (0);                       
 DCL     GL_NØGLE        CHAR      (8)  BASED(ADDR(HJGL_NØGLE));        
 DCL     INDEX1 (0:99)   BIN FIXED (15);         /* BENYT.KODER       */
 DCL     GEMKOM          PIC       '999';                               
 DCL     KOMNAVN         CHAR      (35);                                
 DCL     SP_KNR          CHAR      (08);                                
 DCL     ANTDAGE         FIXED     (7) INIT(0);                         
 DCL     (HJEJDVÆR,HJSTUE)  FIXED  (15);                                
 DCL     (HJEJEBOL,HJVÆRDI) FIXED  (15);                                
 DCL     (N,NR,J)        BIN FIXED (15);                                
 DCL     I               BIN FIXED (15);                                
 DCL     ANT_LÆS         FIXED     (7)    INIT (0);                     
 DCL     ANT_KOM         FIXED     (7)    INIT (0);                     
 /*********************************************************************/
 /*                                                                   */
 /*          DECLARE AF ENTRY OG BUILTIN                              */
 /*                                                                   */
 /*********************************************************************/
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);  /* TIMESTAMP    */ 
 DCL     ZS30101         ENTRY;            /* ABEND-RUTINE           */ 
 DCL     ZS32601         ENTRY;            /* ACCESS KOMMUNETABEL    */ 
 DCL     ZS61900         ENTRY;            /* SKRIV SSI-DATO I LOG   */ 
 DCL     ADDR            BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     REPEAT          BUILTIN;                                       
 DCL     SUM             BUILTIN;                                       
  %INCLUDE ZZ20301M;                                                    
 /********************************************************************* 
 *                                                                    * 
 *                       HOUSEKEEPING.                                * 
 *                                                                    * 
 *********************************************************************/ 
         CALL ZS61900;                     /* SKRIV SSI-DATO I LOG   */ 
         EOF_BH611    = '0'B;                                           
         ON ERROR CALL PLIDUMP ('SNHOB');                               
         OPEN FILE (BH611I)  TITLE ('BH61101I');                        
         ON ENDFILE (BH611I)                                            
            EOF_BH611 = '1'B;                                           
         CALL ZZ20390 ('*OPEN','BH62501Y');                             
         CALL ZZ20390 ('*OPEN','BH62502Y');                             
         CALL ZZ20390 ('*OPEN','BH62503Y');                             
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         /* INITERING AF OVERSKRIFT PÅ BH62501Y */                      
         CCJ = ZZWS1;                                                   
         S_TXT1 = 'SPEC. AF EJENDOMME FORDELT PÅ ' !!                   
                  'BENYT.KODE, ANTAL OG VÆRDI';                         
         S_TXT2 = 'UDSKREVET DEN ';                                     
         S_DATO = UDDATO;                                               
         O_SEV2_HEADEREN.INTERVAL1.GRÆNSE1  =  ÅR_PCT_GRÆNSE_1;         
         O_SEV2_HEADEREN.INTERVAL2.GRÆNSE11 =  ÅR_PCT_GRÆNSE_1 + 1;     
         O_SEV2_HEADEREN.INTERVAL2.GRÆNSE2  =  ÅR_PCT_GRÆNSE_2;         
         O_SEV2_HEADEREN.INTERVAL3.GRÆNSE21 =  ÅR_PCT_GRÆNSE_2 + 1;     
         S_TXT3 = '  SIDE ';                                            
         O_SEV2 = ZZWS1 !! O_SEV2_HEADER;                               
         O_SEV3 = ZZWS2!!(15)' '!!(4)'      ANTAL        EJD. VÆRDI';   
         O_SEV4 = ZZWS2!!(15)' '!!(4)'      ANTAL      STUEHUSVÆRDI';   
         O_SEV5 = ZZWS2!!(15)' '!!(4)'      ANTAL     EJERBOL.VÆRDI';   
         O_INDGÅR = ZZWS2 !! (31)' ' !!                                 
                    '(K U N  NUVÆRENDE HOVEDEJERE - EXCL. SE-NUMRE - IND
 GÅR I STATISTIKKEN)';                                                  
         ÅR_ULTIMO_TEKST   =  REPEAT (ÅR_ULTIMO,3);                     
         /* INITIERING AF OVERSKRIFT PÅ BH62502Y */                     
         CCI = ZZWS1;                                                   
         E_TXT1 = 'OVERSIGT OVER EJENDOMME FORDELT PÅ BENYTTELSESKODE'; 
         E_TXT2 = 'UDSKREVET DEN ';                                     
         E_DATO = UDDATO;                                               
         E_TXT3 = '  SIDE ';                                            
         O_EVÆ2 = ZZWS1 !! 'BENYT   ANTAL   EJENDOMSVÆRDI    STUEHUS' !!
                  'VÆRDI  EJERBOLIGVÆRDI       BEREGNET      ' !!       
                  'STANDARD        SAMLET    ANT.EJD.     FORSK.SLUT/'; 
         O_EVÆ3 = ZZWS2 !! ' KODE    EJD.' !!     ÅR_ULTIMO_TEKST !!    
                           '      LEJEVÆRDI       FRADRAG '       !!    
                           '     EJD.SKAT    U.CPRNR.     BELIG.KOMM.'; 
         INDEX1(*) = 33;                         /* BENYTTELSESKODER  */
         INDEX1(1) = 1;                                                 
         INDEX1(2) = 2;                                                 
         INDEX1(3) = 3;                                                 
         INDEX1(4) = 4;                                                 
         INDEX1(5) = 5;                                                 
         INDEX1(6) = 6;                                                 
         INDEX1(7) = 7;                                                 
         INDEX1(8) = 8;                                                 
         INDEX1(9) = 9;                                                 
         INDEX1(13) = 10;                                               
         INDEX1(17) = 11;                                               
         INDEX1(21) = 12;                                               
         INDEX1(22) = 13;                                               
         INDEX1(23) = 14;                                               
         INDEX1(24) = 15;                                               
         INDEX1(25) = 16;                                               
         INDEX1(26) = 17;                                               
         INDEX1(27) = 18;                                               
         INDEX1(28) = 19;                                               
         INDEX1(29) = 20;                                               
         INDEX1(31) = 21;                                               
         INDEX1(33) = 22;                                               
         INDEX1(34) = 23;                                               
         INDEX1(41) = 24;                                               
         INDEX1(42) = 25;                                               
         INDEX1(43) = 26;                                               
         INDEX1(44) = 27;                                               
         INDEX1(45) = 28;                                               
         INDEX1(48) = 29;                                               
         INDEX1(49) = 30;                                               
         INDEX1(70) = 31;                                               
         INDEX1(71) = 32;                                               
 /********************************************************************* 
 *                                                                    * 
 *                  PROCES                                            * 
 *                                                                    * 
 *********************************************************************/ 
         CALL NULSTIL;                                                  
         CALL SKAF_BH611;                                               
         GEMKOM = BH611.SORT_EÆKNR;                                     
         DO WHILE (^EOF_BH611 & BH611.SORT_KOMNR < 999 );               
            IF GEMKOM ^= BH611.SORT_EÆKNR                               
            THEN                                                        
               DO;                                                      
                  CALL UDSKRIV_STATISTIK;                               
                  GEMKOM = BH611.SORT_EÆKNR;                            
               END;                                                     
            CALL OPTÆL;                                                 
            CALL SKAF_BH611;                                            
         END;                                                           
         CALL UDSKRIV_STATISTIK;     /* SIDSTE KOMMUNE */               
         CALL UDSKRIV_RCTOTAL;                                          
         CALL MASK_AFSTEMNING;                                          
 /********************************************************************* 
 *                                                                    * 
 *    BEREGNINGSBÅND INDLÆSES                                         * 
 *                                                                    * 
 *********************************************************************/ 
 SKAF_BH611:                                                            
         PROC;                                                          
 DCL     NY_NØGLE        CHAR      (08);                                
 DCL     1 HJNY_NØGLE    BASED (ADDR(NY_NØGLE)),                        
           2 SORT_EÆKNR  FIXED    (3),                                  
           2 SORT_CPR    FIXED    (10);                                 
 DCL     OVERLÆS         BIT      (01);                                 
         OVERLÆS = '1'B;                                                
         DO UNTIL (OVERLÆS = '0'B ! EOF_BH611 );                        
            READ FILE (BH611I) INTO (BH611_AR);                         
            IF ^EOF_BH611 &                                             
               (BH611.SORT_CPR > 0 & BH611.SORT_KOMNR < 999)            
            THEN                                                        
               ANT_LÆS = ANT_LÆS + 1;                                   
            IF ^EOF_BH611 & BH611.SORT_CPR = 0                          
            THEN                                                        
               ANT_KOM = ANT_KOM + 1;                                   
            HJNY_NØGLE.SORT_EÆKNR = BH611.SORT_EÆKNR;                   
            HJNY_NØGLE.SORT_CPR = BH611.SORT_CPR;                       
            IF NY_NØGLE < GL_NØGLE                                      
            THEN                                                        
               CALL ZS30101                                             
                        (5,'BH62000 ** 250 SEKVENSFEJL PÅ B.H61101D',2);
            GL_NØGLE = NY_NØGLE;                                        
                                                                        
            IF BH611.SORT_CPR = 0   !        /* KOMMUNEINDIVID */       
               BH611.CINVPNR = '2'  !        /* SE-NUMMER */            
               BH611.CINVPNR = '4'  !        /* LØBENR. OG EJ 10/41 */  
             ((BH611.CEJFORH = '50' !        /* ELLER     */            
               BH611.CEJFORH = '60' !        /* OFFENTLIGT*/            
               BH611.CEJFORH = '70' !        /* EJEDE     */            
               BH611.CEJFORH = '80') &       /* EJENDOMME */            
               BH611.CINVPNR ^= '0')         /* UDEN CPRNR*/            
            THEN                                                        
               OVERLÆS = '1'B;                                          
            ELSE                                                        
               IF (BH611.SORT_CPR > 0 &                                 
                   BH611.SORT_CPR < 9999999999) &                       
                  (BH611.CITYP = 1 ! (BH611.CHEJD = '0' &               
                                      BH611.CITYP = 3))                 
               THEN                                                     
                  OVERLÆS = '0'B;                                       
               ELSE                                                     
                  OVERLÆS = '1'B;                                       
         END;                                                           
 END SKAF_BH611;                                                        
 /********************************************************************* 
 *                                                                    * 
 *     OPTÆLLING TIL STATISTIKKER                                     * 
 *                                                                    * 
 *********************************************************************/ 
 OPTÆL:                                                                 
         PROC;                                                          
         HJEJDVÆR = BH611.BEJDVÆR;                                      
         HJSTUE = 0;                                                    
         IF BH611.EJEBOL(1).EJBOLTYP = '4'                              
         THEN                                                           
            HJSTUE = HJSTUE + BH611.EJEBOL(1).BEJEBOL;                  
         IF BH611.EJEBOL(2).EJBOLTYP = '4'                              
         THEN                                                           
            HJSTUE = HJSTUE + BH611.EJEBOL(2).BEJEBOL;                  
         HJEJEBOL = 0;                                                  
         IF BH611.EJEBOL(1).EJBOLTYP > '4'                              
         THEN                                                           
            HJEJEBOL = HJEJEBOL + BH611.EJEBOL(1).BEJEBOL;              
         IF BH611.EJEBOL(2).EJBOLTYP > '4'                              
         THEN                                                           
            HJEJEBOL = HJEJEBOL + BH611.EJEBOL(2).BEJEBOL;              
         CALL OPTÆL_STAT01;                                             
         CALL OPTÆL_STAT02;                                             
 END OPTÆL;                                                             
 /********************************************************************* 
 *                                                                    * 
 *     OPTÆLLING TIL STATISTIK BH62501Y                               * 
 *                                                                    * 
 *********************************************************************/ 
 OPTÆL_STAT01:                                                          
         PROC;                                                          
                                                                        
            /* EJENDOMSVÆRDI - SIDE 1 */                                
                                                                        
         NR = 70;   /* INITIERING */                                    
                                                                        
         IF (BH611.CBENYT = '01'                 &                      
             (BH611.FLEJL = 0 ! BH611.FLEJL = 1) &                      
             HJSTUE = 0                          &                      
             HJEJEBOL = 0)        !                                     
             BH611.CBENYT  = '21' !                                     
             BH611.CBENYT  = '26' !                                     
             BH611.CBENYT  = '27' !                                     
             (BH611.CBENYT  = '41' &                                    
              BH611.FLEJL   < 2    &                                    
              HJEJEBOL      = 0    &                                    
              HJSTUE        = 0)                                        
         THEN                                                           
            DO;                                                         
               IF BH611.BLEJE1 > 0 !                                    
                  BH611.BLEJE2 > 0                                      
               THEN                                                     
                  DO;                                                   
                     IF CREDIG3 > '0' & CREDIG3 < '6'  /* ALM BEREGN. */
                     THEN                                               
                        NR = 1;                                         
                     ELSE                                               
                        NR = 2;       /* 67-ÅRIGE  */                   
                  END;                                                  
               ELSE                                                     
                  NR = 3;             /* EJ BEREGNET */                 
            END;                                                        
                                                                        
         IF  BH611.CBENYT  = '08' !                                     
             BH611.CBENYT  = '28' !                                     
             BH611.CBENYT  = '48'                                       
         THEN                                                           
            DO;                                                         
               IF BH611.BLEJE1 > 0 !                                    
                  BH611.BLEJE2 > 0                                      
               THEN                                                     
                  DO;                                                   
                     IF CREDIG3 > '0' & CREDIG3 < '6'  /* ALM BEREGN. */
                     THEN                                               
                        DO;                                             
                           IF (BH611.C_2PCT = '1' !                     
                               BH611.C_2PCT = '2' !                     
                               BH611.C_2PCT = '3')                      
                           THEN                                         
                              NR = 2; /* HELÅRSSOMMERHUSE 2% */         
                           ELSE                                         
                              NR = 1; /* ØVRIGE SOMMERHUSE 2,5%*/       
                        END;                                            
                     ELSE                                               
                        NR = 3;       /* 67-ÅRIGE  */                   
                  END;                                                  
               ELSE                                                     
                  NR = 4;                     /* EJ BEREGNET       */   
            END;                                                        
                                                                        
         IF NR ^= 70                                                    
         THEN                                                           
            DO;                                                         
               SELECT (BH611.CBENYT);                                   
                  WHEN ('08')                                           
                     NR = NR + 3;                                       
                  WHEN ('21')                                           
                     NR = NR + 7;                                       
                  WHEN ('26')                                           
                     NR = NR + 10;                                      
                  WHEN ('27')                                           
                     NR = NR + 13;                                      
                  WHEN ('28')                                           
                     NR = NR + 16;                                      
                  WHEN ('41')                                           
                     NR = NR + 20;                                      
                  WHEN ('48')                                           
                     NR = NR + 23;                                      
                  OTHERWISE;                                            
               END;                                                     
            END;                                                        
                                                                        
                                                                        
         /* STUEHUSVÆRDI - SIDE 2 */                                    
                                                                        
         IF (BH611.CBENYT  = '01' & NR = 70                             
                                  & (BH611.FLEJL = 0 ! BH611.FLEJL = 1) 
                                  & (HJSTUE > 0 ! HJEJEBOL = 0)) !      
             BH611.CBENYT = '05' !                                      
            (BH611.CBENYT = '06' & (HJSTUE > 0 ! HJEJEBOL = 0))  !      
             BH611.CBENYT = '07' !                                      
            (BH611.CBENYT = '13' & (HJSTUE > 0 ! HJEJEBOL = 0))         
         THEN                                                           
            DO;                                                         
               IF BH611.BLEJE1 > 0 ! BH611.BLEJE2 > 0                   
               THEN                                                     
                  DO;                                                   
                     IF CREDIG3 > '0' & CREDIG3 < '6'  /* ALM BEREGN. */
                     THEN                                               
                        NR = 28;                                        
                     ELSE                                               
                        NR = 29;                  /* 67-ÅRIGE  */       
                  END;                                                  
               ELSE                                                     
                  NR = 30;                    /* EJ BEREGNET       */   
               SELECT (BH611.CBENYT);                                   
                  WHEN ('05')                                           
                     NR = NR + 3;                                       
                  WHEN ('06')                                           
                    NR = NR + 6;                                        
                  WHEN ('07')                                           
                     NR = NR + 9;                                       
                  WHEN ('13')                                           
                     NR = NR + 12;                                      
                  OTHERWISE;                                            
               END;                                                     
            END;                                                        
            /* EJERBOLIGVÆRDI - SIDE 3 */                               
         IF (BH611.CBENYT = '01' &                                      
                (BH611.FLEJL = 0 !BH611.FLEJL = 1) &                    
                 HJEJEBOL > 0 & HJSTUE = 0) !                           
            (BH611.CBENYT = '01' & BH611.FLEJL = 2)           !         
             BH611.CBENYT = '02'                              !         
            (BH611.CBENYT = '06' & HJEJEBOL > 0 & HJSTUE = 0) !         
            (BH611.CBENYT = '13' & HJEJEBOL > 0 & HJSTUE = 0) !         
             BH611.CBENYT = '22'                              !         
             BH611.CBENYT = '29'                              !         
             BH611.CBENYT = '42'                              !         
             BH611.CBENYT = '45'                                        
         THEN                                                           
            DO;                                                         
               IF BH611.BLEJE1 > 0 ! BH611.BLEJE2 > 0                   
               THEN                                                     
                  DO;                                                   
                     IF CREDIG3 > '0' & CREDIG3 < '6'  /* ALM BEREGN. */
                     THEN                                               
                        NR = 43;                                        
                     ELSE                                               
                        NR = 44;                  /* 67-ÅRIGE  */       
                  END;                                                  
               ELSE                                                     
                  NR = 45;                    /* EJ BEREGNET       */   
               SELECT (BH611.CBENYT);                                   
                  WHEN ('01')                                           
                     DO;                                                
                        IF BH611.FLEJL = 2                              
                        THEN                                            
                           NR = NR + 3;                                 
                     END;                                               
                  WHEN ('02')                                           
                     NR = NR + 6;                                       
                  WHEN ('06')                                           
                     NR = NR + 9;                                       
                  WHEN ('13')                                           
                     NR = NR + 12;                                      
                  WHEN ('22')                                           
                     NR = NR + 15;                                      
                  WHEN ('29')                                           
                     NR = NR + 18;                                      
                  WHEN ('42')                                           
                     NR = NR + 21;                                      
                  WHEN ('45')                                           
                     NR = NR + 24;                                      
                  OTHERWISE;                                            
               END;                                                     
            END;                                                        
 /*********************************************************************/
 /*                                                                   */
 /*        UDREGN SØJLE-INDEX TIL LISTE BH62501Y.                     */
 /*                                                                   */
 /*********************************************************************/
         SELECT;                                                        
            WHEN (NR >=  1 & NR <= 27)                                  
               HJVÆRDI = HJEJDVÆR;                                      
            WHEN (NR >= 28 & NR <= 42)                                  
               HJVÆRDI = HJSTUE;                                        
            WHEN (NR >= 43 & NR <= 69)                                  
               HJVÆRDI = HJEJEBOL;                                      
            OTHERWISE                                                   
               HJVÆRDI = 0;                                             
         END;                                                           
         N = 1;                              /*    INITIERING         */
         IF HJVÆRDI  <=  ÅR_PCT_GRÆNSE_1                                
         THEN                                                           
            N = 1;                                                      
         ELSE                                                           
            IF HJVÆRDI  <=  ÅR_PCT_GRÆNSE_2                             
            THEN                                                        
               N = 2;                                                   
            ELSE                                                        
               N = 3;                                                   
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*             HER FORETAGES OPTÆLLING TIL BH62501Y.                 */
 /*                                                                   */
 /*********************************************************************/
         TVPTR2 = ADDR(VÆRTAB(NR,N));   /* POINTER PEGER PÅ DEN       */
         TREC = TREC + 1;               /* AKTUELLE LINIE OG SØJLE    */
         TVÆR = TVÆR + HJVÆRDI;                                         
         TVPTR2 = ADDR(VÆRTAB(NR,4));   /* POINTER PEGER PÅ OPTÆLLING */
         TREC = TREC + 1;               /* AF TVÆRGÅENDE TOTALER      */
         TVÆR = TVÆR + HJVÆRDI;                                         
 END OPTÆL_STAT01;                                                      
 /********************************************************************* 
 *                                                                    * 
 *     OPTÆLLING TIL STATISTIK BH62502Y                               * 
 *                                                                    * 
 *********************************************************************/ 
 OPTÆL_STAT02:                                                          
         PROC;                                                          
 DCL     (HJBSTDF,HJBFSKAT,HJBLEJE) FIXED(11);                          
         HJBFSKAT = BH611.BFSKAT;                                       
         HJBSTDF  = BH611.BSTDF;                                        
         IF BH611.BLEJE2 > 0                                            
         THEN                                                           
            HJBLEJE  = BH611.BLEJE2;                                    
         ELSE                                                           
            HJBLEJE  = BH611.BLEJE1;                                    
         IF BH611.CPERIOD = 1      /* OMREGN BELØB TIL HELÅRS, HVIS  */ 
         THEN                      /* EJENDOMMEN IKKE ER EJET HELE   */ 
            DO;                    /* INDKOMSTÅRET. FDAGE=ANTAL EJET */ 
               IF BH611.FDAGE > 0  /* NB. SKAL VÆRE > 0 ELLERS ER DER*/ 
               THEN                /*     FEJL I BH61110             */ 
                  DO;                                                   
                     HJBFSKAT = ((BH611.BFSKAT * 360) /                 
                                  BH611.FDAGE) + 0.5;                   
                     HJBSTDF  = ((BH611.BSTDF  * 360) /                 
                                  BH611.FDAGE) + 0.5;                   
                     IF BH611.BLEJE2 > 0                                
                     THEN                                               
                        HJBLEJE =((BH611.BLEJE2 * 360) /                
                                   BH611.FDAGE) + 0.5;                  
                     ELSE                                               
                        HJBLEJE =((BH611.BLEJE1 * 360) /                
                                   BH611.FDAGE) + 0.5;                  
                  END;                                                  
            END;                                                        
         TVPTR1 = ADDR(ANTTAB(INDEX1(HJ_CBENYT)));                      
         TIDV = TIDV + 1;                    /* SUMMERING AF INDIVID.*/ 
         TEJDVÆR = TEJDVÆR + HJEJDVÆR;                                  
         TSTUVÆR = TSTUVÆR + HJSTUE;                                    
         TEJEBOL = TEJEBOL + HJEJEBOL;                                  
         TLEJEVÆR = TLEJEVÆR + HJBLEJE;                                 
         TSTDFRA = TSTDFRA + HJBSTDF;                                   
         TEJDSKA = TEJDSKA + HJBFSKAT;                                  
         IF BH611.SORT_KOMNR ^= BH611.SORT_EÆKNR                        
         THEN                                                           
            TFSKKNR = TFSKKNR + 1;                                      
         IF BH611.CINVPNR = '0'                                         
         THEN;                            /* VALIDT CPR-NUMMER     */   
         ELSE                                                           
            DO;                                                         
               /* HVIS EJ VALIDT CPR-NUMMER */                          
               /* ELLER HVIS SE-NUMMER      */                          
               /* OPTÆLLES EJ               */                          
               TCPR_0 = TCPR_0 + 1;                                     
            END;                                                        
 END OPTÆL_STAT02;                                                      
 /********************************************************************* 
 *                                                                    * 
 *    UDSKRIV STATISTIKKER                                            * 
 *                                                                    * 
 *********************************************************************/ 
 UDSKRIV_STATISTIK:                                                     
         PROC;                                                          
         CALL KOMMUNENAVN;                                              
         CALL UDSKRIV_STAT01;                                           
         CALL UDSKRIV_STAT02;                                           
         CALL NULSTIL;                                                  
 END UDSKRIV_STATISTIK;                                                 
 NULSTIL:                                                               
         PROC;                                                          
         DO NR = 1 TO 34;                                               
            TVPTR1 = ADDR(ANTTAB(NR));                                  
            TIDV,TEJDVÆR,TSTUVÆR,TEJEBOL,TLEJEVÆR,                      
            TSTDFRA,TEJDSKA,TCPR_0,TFSKKNR = 0;                         
         END;                                                           
         DO NR = 1 TO 70;                                               
            DO N = 1 TO 4;                                              
               TVPTR2 = ADDR(VÆRTAB(NR,N));                             
               TREC,TVÆR = 0;                                           
            END;                                                        
         END;                                                           
         KOMSUM  = 0;                                                   
 END NULSTIL;                                                           
 /*********************************************************************/
 /*                                                                   */
 /*      UDLEDNING AF KOMMUNENAVN                                     */
 /*                                                                   */
 /*********************************************************************/
 KOMMUNENAVN :                                                          
         PROC;                                                          
 DCL     KOMPTR          PTR;               /* ENTRY POINT ZS32601    */
 DCL     1 KOM           BASED     (KOMPTR),                            
           2 NR          CHAR      (03),                                
           2 NAVN        CHAR      (30);            /* KOMMUNENAVN    */
 DCL     ZS326_KOM       CHAR      (04);                                
         ZS326_KOM = '0'!! GEMKOM;                                      
         CALL ZS32601 (ZS326_KOM,KOMPTR);                               
         KOMNAVN = KOM.NAVN;                                            
 END KOMMUNENAVN;                                                       
 /********************************************************************* 
 *                                                                    * 
 *    UDSKRIV STATISTIK  BH62501  SPECIFIKATION AF EJENDOMSVÆRDIER    * 
 *                                                                    * 
 *********************************************************************/ 
 UDSKRIV_STAT01:                                                        
         PROC;                                                          
                                                                        
         SP_KNR = '0' !! GEMKOM;                                        
         CALL ZZ20390('*SUB','BH62501Y',SP_KNR);                        
         NR = 0;                                                        
         DO J = 1 TO 54;                                                
            SELECT (TEKST(J));                                          
               WHEN ('SIDE 1')                                          
                  DO;                                                   
                     LIN1 = ZZIK1;                                      
                     CALL ZZ20300(LIN1,'01');                           
                     S_KNR = GEMKOM;                                    
                     S_KNA = KOMNAVN;                                   
                     S_SIDE = 1;                                        
                     CALL ZZ20300 (O_SEV1,'01');                        
                     CALL ZZ20300 (O_INDGÅR,'01');                      
                     CALL ZZ20300 (O_SEV2,'01');                        
                     CALL ZZ20300 (O_SEV3,'01');                        
                  END;                                                  
               WHEN ('SIDE 2')                                          
                  DO;                                                   
                     LIN1 = ZZIK1;                                      
                     CALL ZZ20300(LIN1,'01');                           
                     S_SIDE = 2;                                        
                     CALL ZZ20300 (O_SEV1,'01');                        
                     CALL ZZ20300 (O_INDGÅR,'01');                      
                     CALL ZZ20300 (O_SEV2,'01');                        
                     CALL ZZ20300 (O_SEV4,'01');                        
                  END;                                                  
               WHEN ('SIDE 3')                                          
                  DO;                                                   
                     LIN1 = ZZIK1;                                      
                     CALL ZZ20300(LIN1,'01');                           
                     S_SIDE = 3;                                        
                     CALL ZZ20300 (O_SEV1,'01');                        
                     CALL ZZ20300 (O_INDGÅR,'01');                      
                     CALL ZZ20300 (O_SEV2,'01');                        
                     CALL ZZ20300 (O_SEV5,'01');                        
                  END;                                                  
               WHEN (' ')                                               
                  GOTO SKRIV;                                           
               OTHERWISE                                                
                  DO;                                                   
                     LIN1 = ZZWS1 !! TEKST(J);                          
                     CALL ZZ20300 (LIN1,'01');                          
                  END;                                                  
            END;                                                        
            IF TEKST(J) ^= ' '                                          
            THEN                                                        
               GOTO LOOP_END;                                           
 SKRIV:                                                                 
            IF J =  6 !                                                 
               J = 14 !                                                 
               J = 19                                                   
            THEN                                                        
               DO;                                                      
                  /* LINIER VEDR. BK 08, 28 ELLER 48 */                 
                  DO I = 1 TO 4;                                        
                     NR = NR + 1;                                       
                     IF I = 4                                           
                     THEN                                               
                        LIN1 = ZZWS2 !! TXT_SOM(I);                     
                     ELSE                                               
                        LIN1 = ZZWS1 !! TXT_SOM(I);                     
                        DO N = 1 TO 4;                                  
                           TVPTR2 = ADDR(VÆRTAB(NR,N));                 
                           ANTAL(N) = TREC;                             
                           EJDVDI(N) = TVÆR;                            
                        END;                                            
                     CALL ZZ20300(LIN1,'01');                           
                  END;                                                  
               END;                                                     
            ELSE                                                        
               DO;                                                      
                  /* LINIER VEDR. ØVRIGE BK */                          
                  DO I = 1 TO 3;                                        
                     NR = NR + 1;                                       
                     IF I = 3                                           
                     THEN                                               
                        LIN1 = ZZWS2 !! TXT(I);                         
                     ELSE                                               
                        LIN1 = ZZWS1 !! TXT (I);                        
                        DO N = 1 TO 4;                                  
                           TVPTR2 = ADDR(VÆRTAB(NR,N));                 
                           ANTAL(N) = TREC;                             
                           EJDVDI(N) = TVÆR;                            
                        END;                                            
                     CALL ZZ20300(LIN1,'01');                           
                  END;                                                  
               END;                                                     
 LOOP_END:                                                              
         END;                                                           
 /*********************************************************************/
 /*                                                                   */
 /*           OPTÆLLING TIL RC-TOTALER BH62501Y                       */
 /*           (VÆRTAB(70,*) INDEHOLDER EJ BENYTTEDE KODER)            */
 /*********************************************************************/
                                                                        
         DO NR = 1 TO 69;                                               
            DO N = 1 TO 4;                                              
               TVPTR2 = ADDR(VÆRTAB(NR,N));                             
               RCIND(NR,N) = RCIND(NR,N) + TREC;                        
               RCVÆR(NR,N) = RCVÆR(NR,N) + TVÆR;                        
            END;                                                        
         END;                                                           
 END UDSKRIV_STAT01;                                                    
 /********************************************************************* 
 *                                                                    * 
 *    UDSKRIV STATISTIK  BH62502  OVERSIGT FORDELT PÅ BENYTTELSESKODER* 
 *                                                                    * 
 *********************************************************************/ 
 UDSKRIV_STAT02:                                                        
         PROC;                                                          
                                                                        
         SP_KNR = '0' !! GEMKOM;                                        
         CALL ZZ20390('*SUB','BH62502Y',SP_KNR);                        
         LIN1 = ZZIK1;                                                  
         CALL ZZ20300(LIN1,'02');                                       
         E_KNR = GEMKOM;                                                
         E_KNA = KOMNAVN;                                               
         E_SIDE = 1;                                                    
         CALL ZZ20300 (O_EVÆ1,'02');                                    
         CALL ZZ20300 (O_INDGÅR,'02');                                  
         CALL ZZ20300 (O_EVÆ2,'02');                                    
         CALL ZZ20300 (O_EVÆ3,'02');                                    
         DO NR = 1 TO 32;        /* DETAIL  BH62502Y              */    
             LIN1    = ' ';                                             
             BENYT   = BENKODE(NR);                                     
             TVPTR1  = ADDR(ANTTAB(NR));                                
             LÆSIDV  = TIDV;                                            
             EJDVÆR  = TEJDVÆR;                                         
             STHUS   = TSTUVÆR;                                         
             EJEBOLV = TEJEBOL;                                         
             LEJEVÆR = TLEJEVÆR;                                        
             STDFRAD = TSTDFRA;                                         
             EJDSKAT = TEJDSKA;                                         
             CPR_0   = TCPR_0;                                          
             FORSKOM = TFSKKNR;                                         
             IF NR = 26                                                 
             THEN                                                       
                L4.CCD = ZZWS0;                                         
             ELSE                                                       
                L4.CCD = ZZWS2;                                         
             CALL ZZ20300(LIN1,'02');                                   
             IF NR = 26                                                 
             THEN                                                       
                DO;                                                     
                   LIN1 = ZZIK1;            /* BH62502Y   SIDE 2 */     
                   CALL ZZ20300(LIN1,'02');                             
                   E_SIDE = 2;                                          
                   CALL ZZ20300 (O_EVÆ1,'02');                          
                   CALL ZZ20300 (O_INDGÅR,'02');                        
                   CALL ZZ20300 (O_EVÆ2,'02');                          
                   CALL ZZ20300 (O_EVÆ3,'02');                          
                   LIN1 = ZZWS2;                                        
                END;                                                    
                                         /** OPTÆL RC-TOTALER      **/  
             RCTOT4(NR,1) = RCTOT4(NR,1) + TIDV;                        
             RCTOT4(NR,2) = RCTOT4(NR,2) + TEJDVÆR;                     
             RCTOT4(NR,3) = RCTOT4(NR,3) + TSTUVÆR;                     
             RCTOT4(NR,4) = RCTOT4(NR,4) + TEJEBOL;                     
             RCTOT4(NR,5) = RCTOT4(NR,5) + TLEJEVÆR;                    
             RCTOT4(NR,6) = RCTOT4(NR,6) + TSTDFRA;                     
             RCTOT4(NR,7) = RCTOT4(NR,7) + TEJDSKA;                     
             RCTOT4(NR,8) = RCTOT4(NR,8) + TCPR_0;                      
             RCTOT4(NR,9) = RCTOT4(NR,9) + TFSKKNR;                     
                                     /** OPSUMMER SØJLE  TOTALER **/    
             KOMSUM(1) = KOMSUM(1) + TIDV;                              
             KOMSUM(2) = KOMSUM(2) + TEJDVÆR;                           
             KOMSUM(3) = KOMSUM(3) + TSTUVÆR;                           
             KOMSUM(4) = KOMSUM(4) + TEJEBOL;                           
             KOMSUM(5) = KOMSUM(5) + TLEJEVÆR;                          
             KOMSUM(6) = KOMSUM(6) + TSTDFRA;                           
             KOMSUM(7) = KOMSUM(7) + TEJDSKA;                           
             KOMSUM(8) = KOMSUM(8) + TCPR_0;                            
             KOMSUM(9) = KOMSUM(9) + TFSKKNR;                           
          END;                                                          
         /************************************************************  
         *    SKRIV DE OPSUMMEREDE SØJLER PÅ BH62502Y                *  
         ************************************************************/  
         LIN1 = ZZWK1!!'TOTAL';                                         
         LÆSIDV   = KOMSUM(1);                                          
         EJDVÆR   = KOMSUM(2);                                          
         STHUS    = KOMSUM(3);                                          
         EJEBOLV  = KOMSUM(4);                                          
         LEJEVÆR  = KOMSUM(5);                                          
         STDFRAD  = KOMSUM(6);                                          
         EJDSKAT  = KOMSUM(7);                                          
         CPR_0    = KOMSUM(8);                                          
         FORSKOM  = KOMSUM(9);                                          
         CALL ZZ20300(LIN1,'02');                                       
 END UDSKRIV_STAT02;                                                    
 /********************************************************************* 
 *                                                                    * 
 *    RC-TOTAL TIL STATISTIKKERNE UDSKRIVES                           * 
 *                                                                    * 
 *********************************************************************/ 
 UDSKRIV_RCTOTAL:                                                       
         PROC;                                                          
 /*********************************************************************/
 /*           RC-TOTALER  -  BH62503Y - SPEC EJD.VÆRDI - SIDE 1-3     */
 /*********************************************************************/
         SP_KNR = '0' !! '999';                                         
         CALL ZZ20390('*SUB','BH62503Y',SP_KNR);                        
         NR = 0;                                                        
         DO J = 1 TO 54;                                                
            SELECT (TEKST(J));                                          
               WHEN ('SIDE 1')                                          
                  DO;                                                   
                     LIN1 = ZZIK1;                                      
                     CALL ZZ20300(LIN1,'03');                           
                     RC_LIN1.CCA = ZZWS2;                               
                     RC_LIN1.HTEKST2 = S_TXT1;                          
                     RC_LIN1.ESIDE = 1;                                 
                     RC_LIN1.DATO = UDDATO;                             
                     CALL ZZ20300 (RC_LIN1,'03');                       
                     RC_LIN2.CCA = ZZWS2;                               
                     RC_LIN2.ERC = '6';                                 
                     CALL ZZ20300 (RC_LIN2,'03');                       
                     CALL ZZ20300 (O_SEV2,'03');                        
                     CALL ZZ20300 (O_SEV3,'03');                        
                  END;                                                  
               WHEN ('SIDE 2')                                          
                  DO;                                                   
                     LIN1 = ZZIK1;                                      
                     CALL ZZ20300(LIN1,'03');                           
                     RC_LIN1.CCA = ZZWS2;                               
                     RC_LIN1.HTEKST2 = S_TXT1;                          
                     RC_LIN1.ESIDE = 2;                                 
                     RC_LIN1.DATO = UDDATO;                             
                     CALL ZZ20300 (RC_LIN1,'03');                       
                     RC_LIN2.CCA = ZZWS2;                               
                     RC_LIN2.ERC = '6';                                 
                     CALL ZZ20300 (RC_LIN2,'03');                       
                     CALL ZZ20300 (O_SEV2,'03');                        
                     CALL ZZ20300 (O_SEV4,'03');                        
                  END;                                                  
               WHEN ('SIDE 3')                                          
                  DO;                                                   
                     LIN1 = ZZIK1;                                      
                     CALL ZZ20300(LIN1,'03');                           
                     RC_LIN1.CCA = ZZWS2;                               
                     RC_LIN1.HTEKST2 = S_TXT1;                          
                     RC_LIN1.ESIDE = 3;                                 
                     RC_LIN1.DATO = UDDATO;                             
                     CALL ZZ20300 (RC_LIN1,'03');                       
                     RC_LIN2.CCA = ZZWS2;                               
                     RC_LIN2.ERC = '6';                                 
                     CALL ZZ20300 (RC_LIN2,'03');                       
                     CALL ZZ20300 (O_SEV2,'03');                        
                     CALL ZZ20300 (O_SEV5,'03');                        
                  END;                                                  
               WHEN (' ')                                               
                  GOTO PRINT;                                           
               OTHERWISE                                                
                  DO;                                                   
                     LIN1 = ZZWS1 !! TEKST(J);                          
                     CALL ZZ20300 (LIN1,'03');                          
                  END;                                                  
            END;                                                        
            IF TEKST(J) ^= ' '                                          
            THEN                                                        
               GOTO LOOP1_END;                                          
 PRINT:                                                                 
            IF J =  6 !                                                 
               J = 14 !                                                 
               J = 19                                                   
            THEN                                                        
               DO;                                                      
                  /* LINIER VEDR. BK 08, 28 ELLER 48 */                 
                  DO I = 1 TO 4;                                        
                     NR = NR + 1;                                       
                     IF I = 4                                           
                     THEN                                               
                        LIN1 = ZZWS2 !! TXT_SOM(I);                     
                     ELSE                                               
                        LIN1 = ZZWS1 !! TXT_SOM(I);                     
                        DO N = 1 TO 4;                                  
                           TVPTR2 = ADDR(VÆRTAB(NR,N));                 
                           ANTAL(N) = RCIND(NR,N);                      
                           EJDVDI(N) = RCVÆR(NR,N);                     
                        END;                                            
                     CALL ZZ20300(LIN1,'03');                           
                  END;                                                  
               END;                                                     
            ELSE                                                        
               DO;                                                      
                  /* LINIER VEDR. ØVRIGE BK */                          
                  DO I = 1 TO 3;                                        
                     NR = NR + 1;                                       
                     IF I = 3                                           
                     THEN                                               
                        LIN1 = ZZWS2 !! TXT(I);                         
                     ELSE                                               
                        LIN1 = ZZWS1 !! TXT (I);                        
                        DO N = 1 TO 4;                                  
                           TVPTR2 = ADDR(VÆRTAB(NR,N));                 
                           ANTAL(N) = RCIND(NR,N);                      
                           EJDVDI(N) = RCVÆR(NR,N);                     
                        END;                                            
                     CALL ZZ20300(LIN1,'03');                           
                  END;                                                  
               END;                                                     
 LOOP1_END:                                                             
         END;                                                           
 /*********************************************************************/
 /*           RC-TOTALER - BH62503Y  -  OVERSIGT EJD.VÆRDI            */
 /*********************************************************************/
                                                                        
         LIN1 = ZZIK1;                                                  
         CALL ZZ20300(LIN1,'03');                                       
         OVERLIN1.CCA = ZZWS1 ;                /* SKRIVER OVERSKRIFT  */
         OVERLIN1.HTEKST2 = E_TXT1;            /* PÅ BH62502Y         */
         OVERLIN1.DATO = UDDATO;                                        
         OVERLIN1.ESIDE = 1;                                            
         CALL ZZ20300(OVERLIN1,'03');                                   
         CALL ZZ20300(O_INDGÅR,'03');                                   
         OVERLIN2.CCA = ZZWS2;                                          
         OVERLIN2.CRC = BH611.CRCKO;                                    
         OVERLIN2.HTEKST = 'RC-TOTAL';                                  
         CALL ZZ20300(OVERLIN2,'03');                                   
         CALL ZZ20300 (O_EVÆ2,'03');                                    
         CALL ZZ20300 (O_EVÆ3,'03');                                    
         DO NR = 1 TO 9;                       /* SUMMERING AF SØJLER */
            RCTOT4(33,NR) = SUM(RCTOT4(*,NR));                          
         END;                                                           
         DO NR = 1 TO 33;                      /* SKRIV TÆLLEVÆRKER   */
            LIN1  = ' ';                                                
            BENYT = BENKODE(NR);                                        
            IF NR=33                                                    
            THEN                                                        
               BENYT = 'TOTAL';                                         
            LÆSIDV   = RCTOT4(NR,1);                                    
            EJDVÆR   = RCTOT4(NR,2);                                    
            STHUS    = RCTOT4(NR,3);                                    
            EJEBOLV  = RCTOT4(NR,4);                                    
            LEJEVÆR  = RCTOT4(NR,5);                                    
            STDFRAD  = RCTOT4(NR,6);                                    
            EJDSKAT  = RCTOT4(NR,7);                                    
            CPR_0    = RCTOT4(NR,8);                                    
            FORSKOM  = RCTOT4(NR,9);                                    
            IF NR = 25                                                  
            THEN                                                        
               L4.CCD = ZZWS0;                                          
            ELSE                                                        
               L4.CCD = ZZWS2;                                          
            CALL ZZ20300(LIN1,'03');                                    
            IF NR = 25                                                  
            THEN                                                        
               DO;                                                      
                  LIN1 = ZZIK1;               /* SIDE 2 */              
                  CALL ZZ20300(LIN1,'03');                              
                  OVERLIN1.ESIDE = 2;                                   
                  CALL ZZ20300(OVERLIN1,'03');                          
                  CALL ZZ20300(O_INDGÅR,'03');                          
                  CALL ZZ20300(OVERLIN2,'03');                          
                  CALL ZZ20300 (O_EVÆ2,'03');                           
                  CALL ZZ20300 (O_EVÆ3,'03');                           
               END;                                                     
         END;                                                           
 END UDSKRIV_RCTOTAL;                                                   
 /********************************************************************* 
 *                                                                    * 
 *            MASKINEL AFSTEMNING                                     * 
 *                                                                    * 
 *********************************************************************/ 
 MASK_AFSTEMNING:                                                       
         PROC;                                                          
                                                                        
         IF BH611.SORT_KOMNR ^= 999 /* OPTÆLLINGSINDIVID MANGLER */     
         THEN                                                           
            DO;                                                         
               CALL AFSTEM_FEJL('1');                                   
               CALL ZS30101(5,'BH62500 ** 251 ' !!                      
                        'KONSTATERET AFSTEMNINGSFEJL              ',2); 
            END;                                                        
         IF BH61199.ANT_INDV ^= ANT_LÆS                                 
         THEN                                                           
            DO;                                                         
               CALL AFSTEM_FEJL('2');                                   
               CALL ZS30101(5,'BH62500 ** 251 ' !!                      
                        'KONSTATERET AFSTEMNINGSFEJL              ',2); 
            END;                                                        
 END MASK_AFSTEMNING;                                                   
 /*********************************************************************/
 /*                                                                   */
 /*      UDSKRIV FEJLLISTE HVIS DER ER KONSTATERET FEJL VED           */
 /*      MASKINEL AFSTEMNING                                          */
 /*********************************************************************/
 AFSTEM_FEJL:                                                           
         PROC(FEJL);                                                    
 DCL     FEJL            CHAR      (01);                                
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH62500L'),                                        
           2 F1          CHAR      (34)      INIT      (' '),           
           2 TEKST2      CHAR      (44)      INIT      (                
           'UDSKRIVNING AF STATISTIK'),                                 
           2 F2          CHAR      (13)      INIT      (' '),           
           2 TEKST3      CHAR      (14)      INIT      (                
           'UDSKREVET DEN '),                                           
           2 DATO        CHAR      (10);                                
 DCL     1 FLIN1,                                                       
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 F2          CHAR      (86)      INIT      (                
           'FEJLLISTE VEDR. MASKINEL AFSTEMNING');                      
 DCL     1 FLIN2,                                                       
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (55),                                
           2 ANTAL       PIC       'Z.ZZZ.ZZ9',                         
           2 F2          CHAR      (68)      INIT      (' ');           
         CALL ZZ20390 ('*OPEN','BH62504Y');                             
         SIDELIN.CCA = ZZIK1;                                           
         CALL ZZ20300 (SIDELIN,'04');                                   
         OVERLIN1.CCA = ZZWS1;                                          
         OVERLIN1.DATO = UDDATO;                                        
         CALL ZZ20300 (OVERLIN1,'04');                                  
         FLIN1.CCA = ZZWS2;                                             
         CALL ZZ20300 (FLIN1,'04');                                     
         SELECT (FEJL);                                                 
            WHEN('1')                   /* OPTÆLLINGSINDIVID MANGER */  
            DO;                                                         
               SIDELIN.CCA = ZZWS2;                                     
               SIDELIN.FILLER= 'OPTÆLLINGSINDIVID MANGLER PÅ B.H61101D';
               CALL ZZ20300 (SIDELIN,'04');                             
            END;                                                        
            WHEN('2')                   /* ANTAL LÆSTE STEMMER IKKE */  
            DO;                                                         
               FLIN2.CCA   = ZZWS2;                                     
               FLIN2.TEKST = 'ANTAL LÆSTE EJDINDV PÅ B.H61101D';        
               FLIN2.ANTAL = ANT_LÆS;                                   
               CALL ZZ20300 (FLIN2,'04');                               
               FLIN2.CCA   = ZZWS2;                                     
               FLIN2.TEKST = 'ANTAL EJDINDV PÅ B.H61101D IFØLGE OPTÆLLIN
 GSINDIVID';                                                            
               FLIN2.ANTAL = BH61199.ANT_INDV;                          
               CALL ZZ20300 (FLIN2,'04');                               
            END;                                                        
            OTHERWISE;                                                  
         END;    /* SELECT */                                           
 END AFSTEM_FEJL;                                                       
         CLOSE FILE (BH611I);                                           
         CALL ZZ20300 ((133)' ','99');                                  
 END  BH62500;                                                          
