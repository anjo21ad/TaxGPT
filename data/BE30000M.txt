 /**********************************************************************
 * PROJEKT:     EVS FORSKUD/SLUT                                       *
 * PROGRAMNAVN: BE30000M.                                              *
 * PROGRAMTYPE: MAKRO.                                                 *
 * FUNKTION:    SQL UDTRÆK ALLE AKTIVE OG VALIDE EJENDOMME FRA         *
 *              EVS SLUT 2011 PR. PERSON.                              *
 * PROGRAMMØR:  THOMAS FLINDT       THF,  PUS/T&S BRØNDBY  11.07.2001. *
 * ÆNDRINGSLOG: ESBEN BRODERSEN     ESB,  LSU/T&S BRØNDBY  30.07.2002. *
 *              ÅRSRULLET TIL FORSKUD 2003                             *
 *              ESBEN BRODERSEN     ESB,  LSU/T&S BALLERUP 17.07.2003. *
 *              ÅRSRULLET TIL FORSKUD 2004, NYE EVS TABELLER           *
 *              BO SCHMIDT          BOB,  LSU/T&S BALLERUP 07.06.2004. *
 *              ÅRSRULLET TIL FORSKUD 2005 / SLUT 2004                 *
 *  FORSKUD06   SUSANNE KROGH VILLUMSEN  SKV  T&S BALLERUP 07.06.2005. *
 *              ÅRSRULLET TIL FORSKUD 2006 / SLUT 2005                 *
 *  FORSKUD07   BO SCHMIDT          BOB,  LSU/T&S BALLERUP 11.05.2006. *
 *              ÅRSRULLET TIL FORSKUD 2007 / SLUT 2006                 *
 *  FORSKUD08   BO SCHMIDT          BOB,  LSU/T&S BALLERUP 22.05.2007. *
 *              ÅRSRULLET TIL FORSKUD 2008 / SLUT 2007                 *
 *  FORSKUD09   BO SCHMIDT          BOB,  LSU/T&S BALLERUP 24.04.2008. *
 *              ÅRSRULLET TIL FORSKUD 2009 / SLUT 2008                 *
 *  FORSKUD10   GERD HOLM-PEDERSEN  GEH,  PKF/PKA BALLERUP 07.04.2009. *
 *              ÅRSRULLET TIL FORSKUD 2010 / SLUT 2009                 *
 *  FORSKUD11   GERD HOLM-PEDERSEN  GEH,  PKF/PKA BALLERUP 28.05.2010. *
 *              ÅRSRULLET TIL FORSKUD 2011 / SLUT 2010                 *
 *  FORSKUD12   GERD HOLM-PEDERSEN  GEH,  PKF/PKA BALLERUP 12.05.2011. *
 *              ÅRSRULLET TIL FORSKUD 2012 / SLUT 2011                 *
 *  FORSKUD13   ESBEN BRODERSEN     ESB,  PR      BALLERUP 15.05.2012. *
 *              ÅRSRULLET TIL FORSKUD 2013 / SLUT 2012                 *
 *  FORSKUD14   ESBEN BRODERSEN     ESB,  PR      BALLERUP 21.05.2013. *
 *              ÅRSRULLET TIL FORSKUD 2014 / SLUT 2013                 *
 *  FORSKUD15   JØRGEN SAUGMANN     QQS,  PR      BALLERUP 27.06.2014. *
 *              ÅRSRULLET TIL FORSKUD 2015                             *
 *  FORSKUD16   Z6JNK.  ÅRSRULLET TIL FORSKUD 2016         08.06.2015. *
 *              Søg efter "RUL".                                       *
 *  SLUT 2015   Z8QEB                                      08.03.2016  *
 *              ÅRSTAL TAGES FRA MACRO BE65300M #01                    *
 *  FORSKUD17   Z8QEB ÅRSRULLET TIL FORSKUD 2017           12.06.2016  *
 *              BE14->BE15 FILNAVN                                     *
 *              BEGRÆNSNING PÅ EKOMNR TIL BRUGTEST                     *
 *  FORSKUD18   Z8QEB ÅRSRULLET TIL FORSKUD 2018           12.06.2017  *
 *              BE15->BE16 FILNAVN                                     *
 *  FORSKUD19   Z8QEB ÅRSRULLET TIL FORSKUD 2019           30.05.2018  *
 *              BE16->BE17 FILNAVN                                     *
 *              DEFECT #101 UDTRÆK FEJLNUMMER                          *
 *  SLUT18      Z6EBD 2FAMILIE BOLIGER                     14.09.2018  *
 *              Udtræk udviddet med EENHEDLBNR                         *
 *  FORSKUD20   Z6EBD ÅRSRULLET TIL FORSKUD 2020           21.03.2019  *
 *              BE17->BE18 FILNAVN                                     *
 *  FORSKUD21   Z6PBR ÅRSRULLET TIL FORSKUD 2021           23.03.2020  *
 *              BE18->BE19 FILNAVN                                     *
 *  FORSKUD2021 z6pbr D14                                  juni 2020   *
 *              Aktive periodeløbenumre skal videreføres selv om der   *
 *              er slettet højere periodeløbenumre på samme ejendom    *
 * FORSKUD22 Edward Laryea                        07/10-2020           *
 *            TILRETTET FOR FORSKUD2024/SLUT2021                       *
 *            Mellemperioden - 2020                                    *
 *  Slut 2021   Z6SEP                                      Marts 2021  *
 *              BE65300M rettet til BE55300M                           *
 *  FORSKUD25   Z6TIC ÅRSRULLET TIL FORSKUD 2025           20.10.2023  *
 *              BE22->BE23 FILNAVN                                     *
 *  FORSKUD25   Z6JJJ BE55600M erstatter BE55300M          19.06.2024  *
 * Forskud 2026 XJY #1867500 ÆA70 Fjern CELØNCOR/BGLSUM1   12.09.2024  *
 **********************************************************************/
 /*********************************************************************/
 /* DECLARE CURSOR TIL LÆS AF EJERSKABSTABEL BE30000T                 */
 /*********************************************************************/
 DECLARE_CURSOR: PROC;                                                  
                                                                        
         EXEC SQL DECLARE PERSON_CURSOR CURSOR FOR                      
                                                                        
              SELECT Distinct                                           
                     T1.DINDKAAR,                                       
                     T1.DCPRN,                                          
                     T1.EKOMNR,                                         
                     T1.EEJDNR,                                         
                     T1.EENHEDLBNR                                      
                                                                        
         FROM BE30000T T1                                               
         WHERE  T1.DINDKAAR = :BE55600M.GLSLUTÅR /*#01*/                
         AND    T1.DTILGLD  = '9999-12-31-23.59.59.999999'              
         AND   (:PARMKOMNR1 = 0  OR                                     
               (:PARMKOMNR1 <> 0 AND                                    
                T1.EKOMNR IN (:PARMKOMNR1, 999)) OR                     
               (:PARMKOMNR1 <> 0 AND :PARMKOMNR2 <> 0 AND               
                T1.EKOMNR IN (:PARMKOMNR1,:PARMKOMNR2, 999)) OR         
               (:PARMKOMNR1 <> 0 AND :PARMKOMNR2 <> 0                   
                 AND :PARMKOMNR3 <> 0 AND                               
                 T1.EKOMNR IN (:PARMKOMNR1,:PARMKOMNR2,                 
                               :PARMKOMNR3, 999)))                      
                                                                        
         ORDER BY T1.DINDKAAR,                                          
                  T1.DCPRN,                                             
                  T1.EKOMNR,                                            
                  T1.EEJDNR,                                            
                  T1.EENHEDLBNR                                         
                                                                        
         FOR READ ONLY;                                                 
                                                                        
      /***************************/                                     
                                                                        
         EXEC SQL DECLARE PERSON_EJD_CURSOR CURSOR FOR                  
                                                                        
         SELECT t1.elbnr, t1.cslet                                      
          FROM BE30000T T1                                              
         WHERE  T1.DINDKAAR   = :EVS_ESK.DINDKAAR                       
          AND   T1.EKOMNR     = :EVS_ESK.EKOMNR                         
          AND   T1.EEJDNR     = :EVS_ESK.EEJDNR                         
          AND   T1.DCPRN      = :EVS_ESK.DCPRN                          
          AND   T1.EENHEDLBNR = :EVS_ESK.EENHEDLBNR                     
          AND   T1.DTILGLD    = '9999-12-31-23.59.59.999999'            
         order by T1.elbnr desc                                         
         FOR READ ONLY;                                                 
                                                                        
      /***************************/                                     
         EXEC SQL DECLARE RESULTAT_CURSOR CURSOR FOR                    
                                                                        
         SELECT T8.BEJERAN  /* DER HENTES KUN BEJERAN */                
          FROM BE40000T T8                                              
         WHERE T8.DINDKAAR    = :BE55600M.GLSLUTÅR /*#01*/              
           AND T8.DCPRN       = :DCPRN_NGL                              
           AND T8.EKOMNR      = :KOM_NGL                                
           AND T8.EEJDNR      = :EJD_NGL                                
           AND T8.EENHEDLBNR  = :EENHEDLBNR_NGL   /* ?? */              
           AND T8.ELBNR       = :SIDSTE.ELBNR                           
           AND T8.DFRAGLD     = :SIDSTE.DFRAGLD                         
           AND T8.EGENNR   = (SELECT MAX(M.EGENNR)                      
                                FROM BE40000T M                         
                               WHERE M.DINDKAAR    = T8.DINDKAAR        
                                 AND M.DCPRN       = T8.DCPRN           
                                 AND M.EKOMNR      = T8.EKOMNR          
                                 AND M.EEJDNR      = T8.EEJDNR          
                                 AND M.EENHEDLBNR  = T8.EENHEDLBNR      
                                 AND M.ELBNR       = T8.ELBNR           
                                 AND M.DFRAGLD     = T8.DFRAGLD         
                                 AND M.CKOERSEL    = T8.CKOERSEL)       
           AND T8.CKOERSEL = 'B';                                       
                                                                        
      /***************************/                                     
         EXEC SQL DECLARE RESULTAT_DCUR CURSOR FOR                      
                                                                        
         SELECT T8.BEJERAN  /* DER HENTES KUN BEJERAN */                
           FROM BE40000T T8                                             
          WHERE T8.DINDKAAR      =:BE55600M.GLSLUTÅR /*#01*/            
            AND T8.DCPRN         =:DCPRN_NGL                            
            AND T8.EKOMNR        =:KOM_NGL                              
            AND T8.EEJDNR        =:EJD_NGL                              
            AND T8.EENHEDLBNR    = :EENHEDLBNR_NGL   /* ?? */           
            AND T8.ELBNR         =:SIDSTE.ELBNR                         
            AND DATE(T8.DFRAGLD) = :HJ_DFRAGLD_DTO                      
            AND T8.EGENNR   = (SELECT MAX(M.EGENNR)                     
                                 FROM BE40000T M                        
                                WHERE M.DINDKAAR      = T8.DINDKAAR     
                                  AND M.DCPRN         = T8.DCPRN        
                                  AND M.EKOMNR        = T8.EKOMNR       
                                  AND M.EEJDNR        = T8.EEJDNR       
                                  AND M.EENHEDLBNR    = T8.EENHEDLBNR   
                                  AND M.ELBNR         = T8.ELBNR        
                                  AND DATE(M.DFRAGLD) = DATE(T8.DFRAGLD)
                                  AND M.CKOERSEL      = T8.CKOERSEL)    
           AND T8.CKOERSEL = 'B';                                       
                                                                        
                                                                        
 END DECLARE_CURSOR;                                                    
 /*********************************************************************/
 /* FETCH CURSOR TIL LÆS AF EJERSKABSTABEL BE30000T                   */
 /*********************************************************************/
 FETCH_PERSONEJENDOMSOPL: PROC;                                         
                                                                        
         EXEC SQL FETCH PERSON_CURSOR                                   
                                                                        
         INTO :EVS_ESK.DINDKAAR,                                        
              :EVS_ESK.DCPRN,                                           
              :EVS_ESK.EKOMNR,                                          
              :EVS_ESK.EEJDNR,                                          
              :EVS_ESK.EENHEDLBNR,                                      
              :EVS_ESK.ELBNR;                                           
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0) DO;                                                 
               ANTLÆS_PERSON = ANTLÆS_PERSON + 1;                       
           END;                                                         
           WHEN (100);                                                  
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  =  'BE30000 ** 262  FETCH PERSON_CURSOR';     
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
         FETCH_SQLKODE = SQLCA.SQLCODE;  /* GEMMES TIL SENERE BRUG */   
                                                                        
 END FETCH_PERSONEJENDOMSOPL;                                           
 /*********************************************************************/
 /* Skaf ELBNR - PBR Juni 2020                                        */
 /*********************************************************************/
 SKAF_ELBNR: PROC;                                                      
                                                                        
             GEM_ELBNR      = 0;                                        
             GEM_ELBNR_SLET = 0;                                        
                                                                        
             EXEC SQL OPEN PERSON_EJD_CURSOR;                           
             CALL KONTROL('264',' OPEN PERSON_EJD_CURSOR');             
                                                                        
             DO WHILE (SQLCA.SQLCODE = 0);                              
                                                                        
               EXEC SQL FETCH PERSON_EJD_CURSOR                         
               INTO :HJ_ELBNR,                                          
                    :HJ_CSLET;                                          
                                                                        
               IF SQLCA.SQLCODE = 0                                     
               THEN                                                     
                 DO;                                                    
                   IF HJ_CSLET = '1' &                                  
                      GEM_ELBNR = 0  &                                  
                      GEM_ELBNR_SLET = 0                                
                   then do;                                             
                      GEM_ELBNR_SLET = HJ_ELBNR;                        
                      end;                                              
                   IF HJ_CSLET = ' ' &                                  
                      GEM_ELBNR = 0                                     
                   then do;                                             
                      GEM_ELBNR = HJ_ELBNR;                             
                      end;                                              
                 END;                                                   
                                                                        
               IF (SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100)           
               THEN                                                     
                 DO;                                                    
                   FEJLTEKST = 'PERSON_EJD_CURSOR';                     
                   CALL SQL_FEJL;                                       
                 END;                                                   
                                                                        
             END;                                                       
                                                                        
             IF GEM_ELBNR > 0                                           
             then                                                       
                EVS_ESK.ELBNR = GEM_ELBNR;                              
             Else                                                       
                EVS_ESK.ELBNR = GEM_ELBNR_SLET;                         
                                                                        
             EXEC SQL CLOSE PERSON_EJD_CURSOR;                          
             CALL KONTROL('269',' CLOSE PERSON_EJD_CURSOR');            
                                                                        
                                                                        
 END SKAF_ELBNR;                                                        
 /*********************************************************************/
 /* SELECT FØRSTE GENERATION AF PERSON-EJENDOMSOPLYSN.                */
 /*********************************************************************/
 FØRSTE_PERSONEJENDOMSOPL: PROC;                                        
                                                                        
         EXEC SQL                                                       
               SELECT T2.DINDKAAR                                       
                    , T2.DCPRN                                          
                    , T2.EKOMNR                                         
                    , T2.EEJDNR                                         
                    , T2.EENHEDLBNR                                     
                    , T2.ELBNR                                          
                    , T2.EGENNR                                         
                    , T2.CDATAFRA                                       
                    , T2.DFRAGLD                                        
                    , T2.DTILGLD                                        
                    , T2.CSCREGISTMP                                    
                    , T2.PERSKOD                                        
                    , T2.MYNDNR                                         
                    , T2.COMPLA                                         
                    , T2.DOMPLACPR                                      
                    , T2.CAJOUR                                         
                    , T2.CSUPPL                                         
                    , T2.FEJLNR                                         
                    , T2.CEJBEVS                                        
                    , T2.DBRGN_MODT                                     
                    , T2.BEJBOL1                                        
                    , T2.BEJBOL2                                        
                    , T2.BEJBOLANV                                      
                    , T2.BERHVAN                                        
                    , T2.BEVSMAN                                        
                    , T2.BFORSKAT                                       
                    , T2.BFSKAT                                         
                    , T2.BGRPROM1                                       
                    , T2.BGRPROM2                                       
                    , T2.BMANNEDSL                                      
                    , T2.BNEDSL1                                        
                    , T2.BNEDSL2                                        
                    , T2.BNETTO                                         
                    , T2.BOBEHAKOD                                      
                    , T2.BPENSNED                                       
                    , T2.BPENSNÆ                                        
                    , T2.BPRIVAN                                        
                    , T2.BPROM1                                         
                    , T2.BPROM2                                         
                    , T2.BSUM1                                          
                    , T2.BSUM2                                          
                    , T2.BUDLSKC                                        
                    , T2.CANVEBOL                                       
                    , T2.CBERGRGLOP                                     
                    , T2.CBERGROP                                       
                    , T2.CEKSEMP                                        
                    , T2.CENKE                                          
                    , T2.CENKEBOH                                       
                    , T2.CERHV                                          
                    , T2.CFORSKAT                                       
                    , T2.CFRÅR                                          
                    , T2.CINDFLYT                                       
                    , T2.CIVILSTAND                                     
                    , T2.CKØBSALG                                       
                    , T2.CNEDSL1                                        
                    , T2.CNEDSL2                                        
                    , T2.CNULSTIL                                       
                    , T2.CPTYPSLUT                                      
                    , T2.CSKPLOMF                                       
                    , T2.CSKPLOMFGL                                     
                    , T2.CSLET                                          
                    , T2.CUDLDEL                                        
                    , T2.CUDLHEL                                        
                    , T2.CUDLMAN                                        
                    , T2.CÆGTOPR                                        
                    , T2.DAFSTAA                                        
                    , T2.DAFSTAAFOR                                     
                    , T2.DATO0107                                       
                    , T2.DFRAFLYT                                       
                    , T2.DHENVN                                         
                    , T2.DINDFLYT                                       
                    , T2.DOVTG                                          
                    , T2.DOVTGFOR                                       
                    , T2.FDAGERHV                                       
                    , T2.FDAGUDLE                                       
                    , T2.FERHVFLER                                      
                    , T2.FUBEBOELIG                                     
                    , T2.FUDL100                                        
                    , T2.GLPNR                                          
                    , T2.GPCTEJER                                       
                    , T2.GPCTEJERFOR                                    
                    , T2.GPCTERHV                                       
                    , T2.GPCTUDLE                                       
                    , T2.CTILKØB                                        
                    , T2.DRGNÅRFRA                                      
                    , T2.DRGNÅRTIL                                      
                    , T2.BBER2FAM_AKT                                   
                    , T2.BBERGRL_AKT                                    
                    , T2.BEJBOL1_AKT                                    
                    , T2.BEJBOL2_AKT                                    
                    , T2.BEJBOLANV_AKT                                  
                    , T2.BPENSNÆGL                                      
                    , T2.BSUM3                                          
                    , T2.CAFSTAA                                        
                    , T2.CANVEBOL_AKT                                   
                    , T2.CBOBHAKOD                                      
                    , T2.CDBER2FAM_AKT                                  
                    , T2.CDBERGRL_AKT                                   
                    , T2.CDEJBEVS                                       
                    , T2.CDEJDTYPE                                      
                    , T2.CDEKSEMP                                       
                    , T2.CDENKE                                         
                    , T2.CDINDFLYT                                      
                    , T2.CDPTYPGL                                       
                    , T2.CDPTYPSLUT                                     
                    , T2.CDÆGTOPR                                       
                    , T2.CEJDTYPE_AKT                                   
                    , T2.CERHVFLER                                      
                    , T2.CEVSGL                                         
                    , T2.CEVSMAN                                        
                    , T2.CFELT759                                       
                    , T2.CFELT760                                       
                    , T2.CFRAFLYTDTO                                    
                    , T2.CFRÅR_FOR                                      
                    , T2.CINDFLYTDTO                                    
                    , T2.COVTG                                          
                    , T2.CPCTEJER                                       
                    , T2.CPCTERHV                                       
                    , T2.CPCTUDLE                                       
                    , T2.CPENSNEDGL                                     
                    , T2.CUBEBOELIG                                     
                    , T2.CUDLSKC                                        
                    , T2.DERHVPER_FRA1                                  
                    , T2.DERHVPER_TIL1                                  
                    , T2.DERHVPER_FRA2                                  
                    , T2.DERHVPER_TIL2                                  
                    , T2.DERHVPER_FRA3                                  
                    , T2.DERHVPER_TIL3                                  
                    , T2.DERHVPER_FRA4                                  
                    , T2.DERHVPER_TIL4                                  
                    , T2.DERHVPER_FRA5                                  
                    , T2.DERHVPER_TIL5                                  
                    , T2.FERHVPER_ANT                                   
                    , T2.CNEDTAG158                                     
                    , T2.BEJDVPUSKTP                                    
                    , T2.BEJDVÆPUSKP                                    
                    , T2.CFELT762                                       
                    , T2.CFELT769                                       
                    , T2.DVURDÅR                                        
                    , T2.CRTEKORNS                                      
                    , T2.COPR_CRTEKORNS                                 
                    , T2.VURMARK_AKT                                    
                    , T2.VURMARK                                        
                    , T2.JUR_KATEGO_AKT                                 
                    , T2.JUR_KATEGO                                     
                    , T2.JUR_UKATEGO_AKT                                
                    , T2.JUR_UKATEGO                                    
                    , T2.VURDATO_AKT                                    
                    , T2.VURDATO                                        
                    , T2.FORSIGT_EVS_AKT                                
                    , T2.FORSIGT_EVS                                    
                    , T2.BESKAT_EVS_AKT                                 
                    , T2.BESKAT_EVS                                     
                    , T2.EJET20240101                                   
                    , T2.BEVSMANFSI                                     
                    , T2.COPR_BEVSMANFSI                                
                    , T2.BTAKS                                          
                    , T2.BTAKSRABAT                                     
                    , T2.BTAKSEFTERRABAT                                
                    , T2.BBER2FAM                                       
                    , T2.BBERGRL                                        
                                                                        
               INTO  :EVS_ESK.DINDKAAR                                  
                   , :EVS_ESK.DCPRN                                     
                   , :EVS_ESK.EKOMNR                                    
                   , :EVS_ESK.EEJDNR                                    
                   , :EVS_ESK.EENHEDLBNR                                
                   , :EVS_ESK.ELBNR                                     
                   , :EVS_ESK.EGENNR                                    
                   , :EVS_ESK.CDATAFRA                                  
                   , :EVS_ESK.DFRAGLD                                   
                   , :EVS_ESK.DTILGLD                                   
                   , :EVS_ESK.CSCREGISTMP                               
                   , :EVS_ESK.PERSKOD                                   
                   , :EVS_ESK.MYNDNR                                    
                   , :EVS_ESK.COMPLA                                    
                   , :EVS_ESK.DOMPLACPR                                 
                   , :EVS_ESK.CAJOUR                                    
                   , :EVS_ESK.CSUPPL                                    
                   , :EVS_ESK.FEJLNR                                    
                   , :EVS_ESK.CEJBEVS                                   
                   , :EVS_ESK.DBRGN_MODT                                
                   , :EVS_ESK.BEJBOL1        :INDK_PERS.BEJBOL1_I       
                   , :EVS_ESK.BEJBOL2        :INDK_PERS.BEJBOL2_I       
                   , :EVS_ESK.BEJBOLANV      :INDK_PERS.BEJBOLANV_I     
                   , :EVS_ESK.BERHVAN                                   
                   , :EVS_ESK.BEVSMAN        :INDK_PERS.BEVSMAN_I       
                   , :EVS_ESK.BFORSKAT       :INDK_PERS.BFORSKAT_I      
                   , :EVS_ESK.BFSKAT                                    
                   , :EVS_ESK.BGRPROM1       :INDK_PERS.BGRPROM1_I      
                   , :EVS_ESK.BGRPROM2       :INDK_PERS.BGRPROM2_I      
                   , :EVS_ESK.BMANNEDSL      :INDK_PERS.BMANNEDSL_I     
                   , :EVS_ESK.BNEDSL1        :INDK_PERS.BNEDSL1_I       
                   , :EVS_ESK.BNEDSL2        :INDK_PERS.BNEDSL2_I       
                   , :EVS_ESK.BNETTO         :INDK_PERS.BNETTO_I        
                   , :EVS_ESK.BOBEHAKOD                                 
                   , :EVS_ESK.BPENSNED       :INDK_PERS.BPENSNED_I      
                   , :EVS_ESK.BPENSNÆ        :INDK_PERS.BPENSNÆ_I       
                   , :EVS_ESK.BPRIVAN                                   
                   , :EVS_ESK.BPROM1         :INDK_PERS.BPROM1_I        
                   , :EVS_ESK.BPROM2         :INDK_PERS.BPROM2_I        
                   , :EVS_ESK.BSUM1          :INDK_PERS.BSUM1_I         
                   , :EVS_ESK.BSUM2          :INDK_PERS.BSUM2_I         
                   , :EVS_ESK.BUDLSKC        :INDK_PERS.BUDLSKC_I       
                   , :EVS_ESK.CANVEBOL                                  
                   , :EVS_ESK.CBERGRGLOP                                
                   , :EVS_ESK.CBERGROP                                  
                   , :EVS_ESK.CEKSEMP                                   
                   , :EVS_ESK.CENKE                                     
                   , :EVS_ESK.CENKEBOH                                  
                   , :EVS_ESK.CERHV                                     
                   , :EVS_ESK.CFORSKAT                                  
                   , :EVS_ESK.CFRÅR                                     
                   , :EVS_ESK.CINDFLYT                                  
                   , :EVS_ESK.CIVILSTAND                                
                   , :EVS_ESK.CKØBSALG                                  
                   , :EVS_ESK.CNEDSL1                                   
                   , :EVS_ESK.CNEDSL2                                   
                   , :EVS_ESK.CNULSTIL                                  
                   , :EVS_ESK.CPTYPSLUT                                 
                   , :EVS_ESK.CSKPLOMF                                  
                   , :EVS_ESK.CSKPLOMFGL                                
                   , :EVS_ESK.CSLET                                     
                   , :EVS_ESK.CUDLDEL                                   
                   , :EVS_ESK.CUDLHEL                                   
                   , :EVS_ESK.CUDLMAN                                   
                   , :EVS_ESK.CÆGTOPR                                   
                   , :EVS_ESK.DAFSTAA                                   
                   , :EVS_ESK.DAFSTAAFOR                                
                   , :EVS_ESK.DATO0107                                  
                   , :EVS_ESK.DFRAFLYT                                  
                   , :EVS_ESK.DHENVN                                    
                   , :EVS_ESK.DINDFLYT                                  
                   , :EVS_ESK.DOVTG                                     
                   , :EVS_ESK.DOVTGFOR                                  
                   , :EVS_ESK.FDAGERHV                                  
                   , :EVS_ESK.FDAGUDLE                                  
                   , :EVS_ESK.FERHVFLER                                 
                   , :EVS_ESK.FUBEBOELIG                                
                   , :EVS_ESK.FUDL100                                   
                   , :EVS_ESK.GLPNR                                     
                   , :EVS_ESK.GPCTEJER       :INDK_PERS.GPCTEJER_I      
                   , :EVS_ESK.GPCTEJERFOR                               
                   , :EVS_ESK.GPCTERHV                                  
                   , :EVS_ESK.GPCTUDLE                                  
                   , :EVS_ESK.CTILKØB                                   
                   , :EVS_ESK.DRGNÅRFRA                                 
                   , :EVS_ESK.DRGNÅRTIL                                 
                   , :EVS_ESK.BBER2FAM_AKT   :INDK_PERS.BBER2FAM_AKT_I  
                   , :EVS_ESK.BBERGRL_AKT    :INDK_PERS.BBERGRL_AKT_I   
                   , :EVS_ESK.BEJBOL1_AKT    :INDK_PERS.BEJBOL1_AKT_I   
                   , :EVS_ESK.BEJBOL2_AKT    :INDK_PERS.BEJBOL2_AKT_I   
                   , :EVS_ESK.BEJBOLANV_AKT  :INDK_PERS.BEJBOLANV_AKT_I 
                   , :EVS_ESK.BPENSNÆGL      :INDK_PERS.BPENSNÆGL_I     
                   , :EVS_ESK.BSUM3          :INDK_PERS.BSUM3_I         
                   , :EVS_ESK.CAFSTAA                                   
                   , :EVS_ESK.CANVEBOL_AKT                              
                   , :EVS_ESK.CBOBHAKOD                                 
                   , :EVS_ESK.CDBER2FAM_AKT                             
                   , :EVS_ESK.CDBERGRL_AKT                              
                   , :EVS_ESK.CDEJBEVS                                  
                   , :EVS_ESK.CDEJDTYPE                                 
                   , :EVS_ESK.CDEKSEMP                                  
                   , :EVS_ESK.CDENKE                                    
                   , :EVS_ESK.CDINDFLYT                                 
                   , :EVS_ESK.CDPTYPGL                                  
                   , :EVS_ESK.CDPTYPSLUT                                
                   , :EVS_ESK.CDÆGTOPR                                  
                   , :EVS_ESK.CEJDTYPE_AKT                              
                   , :EVS_ESK.CERHVFLER                                 
                   , :EVS_ESK.CEVSGL                                    
                   , :EVS_ESK.CEVSMAN                                   
                   , :EVS_ESK.CFELT759                                  
                   , :EVS_ESK.CFELT760                                  
                   , :EVS_ESK.CFRAFLYTDTO                               
                   , :EVS_ESK.CFRÅR_FOR                                 
                   , :EVS_ESK.CINDFLYTDTO                               
                   , :EVS_ESK.COVTG                                     
                   , :EVS_ESK.CPCTEJER                                  
                   , :EVS_ESK.CPCTERHV                                  
                   , :EVS_ESK.CPCTUDLE                                  
                   , :EVS_ESK.CPENSNEDGL                                
                   , :EVS_ESK.CUBEBOELIG                                
                   , :EVS_ESK.CUDLSKC                                   
                   , :EVS_ESK.DERHVPER_FRA1                             
                   , :EVS_ESK.DERHVPER_TIL1                             
                   , :EVS_ESK.DERHVPER_FRA2                             
                   , :EVS_ESK.DERHVPER_TIL2                             
                   , :EVS_ESK.DERHVPER_FRA3                             
                   , :EVS_ESK.DERHVPER_TIL3                             
                   , :EVS_ESK.DERHVPER_FRA4                             
                   , :EVS_ESK.DERHVPER_TIL4                             
                   , :EVS_ESK.DERHVPER_FRA5                             
                   , :EVS_ESK.DERHVPER_TIL5                             
                   , :EVS_ESK.FERHVPER_ANT                              
                   , :EVS_ESK.CNEDTAG158                                
                   , :EVS_ESK.BEJDVPUSKTP    :INDK_PERS.BEJDVPUSKTP_I   
                   , :EVS_ESK.BEJDVÆPUSKP    :INDK_PERS.BEJDVÆPUSKP_I   
                   , :EVS_ESK.CFELT762                                  
                   , :EVS_ESK.CFELT769                                  
                   , :EVS_ESK.DVURDÅR                                   
                   , :EVS_ESK.CRTEKORNS                                 
                   , :EVS_ESK.COPR_CRTEKORNS                            
                   , :EVS_ESK.VURMARK_AKT                               
                   , :EVS_ESK.VURMARK                                   
                   , :EVS_ESK.JUR_KATEGO_AKT                            
                   , :EVS_ESK.JUR_KATEGO                                
                   , :EVS_ESK.JUR_UKATEGO_AKT                           
                   , :EVS_ESK.JUR_UKATEGO                               
                   , :EVS_ESK.VURDATO_AKT                               
                   , :EVS_ESK.VURDATO                                   
                   , :EVS_ESK.FORSIGT_EVS_AKT                           
                   , :EVS_ESK.FORSIGT_EVS                               
                   , :EVS_ESK.BESKAT_EVS_AKT                            
                   , :EVS_ESK.BESKAT_EVS                                
                   , :EVS_ESK.EJET20240101                              
                   , :EVS_ESK.BEVSMANFSI     :INDK_PERS.BEVSMANFSI_I    
                   , :EVS_ESK.COPR_BEVSMANFSI                           
                   , :EVS_ESK.BTAKS                                     
                   , :EVS_ESK.BTAKSRABAT                                
                   , :EVS_ESK.BTAKSEFTERRABAT                           
                   , :EVS_ESK.BBER2FAM       :INDK_PERS.BBER2FAM_I      
                   , :EVS_ESK.BBERGRL        :INDK_PERS.BBERGRL_I       
                                                                        
              FROM BE30000T T2                                          
                                                                        
              WHERE  T2.DINDKAAR   = :EVS_ESK.DINDKAAR                  
               AND   T2.EKOMNR     = :EVS_ESK.EKOMNR                    
               AND   T2.EEJDNR     = :EVS_ESK.EEJDNR                    
               AND   T2.EEJDNR     = :EVS_ESK.EEJDNR                    
               AND   T2.DCPRN      = :EVS_ESK.DCPRN                     
               AND   T2.EENHEDLBNR = :EVS_ESK.EENHEDLBNR                
               AND   T2.ELBNR      = :EVS_ESK.ELBNR                     
               AND   T2.EGENNR   = 1;                                   
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               CALL FLYT_ESK_FEL;                                       
             END;                                                       
           WHEN (100);                                                  
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  =  'BE30000 ** 263  FØRSTE PERSONEJENDOM';    
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
                                                                        
                                                                        
         CALL SKAF_EJENDOM;                                             
                                                                        
         IF (SQLCA.SQLCODE ^= 0 & SQLCA.SQLCODE ^= 100)                 
         THEN                                                           
           DO;                                                          
             FEJLTEKST = 'FØRSTE_PERSONEJENDOMSOPL';                    
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
                                                                        
         HJ_DATOEN = ZM_OMSÆT_DATO_FRA_DB2 (PERSON.DOVTG);              
                                                                        
         IF HJ_DATOEN = ' '                                             
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            PERSON.DOVTG = HJ_DATO.AAR!!'-01-01';                       
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            PERSON.DOVTG = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-01';         
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            PERSON.DOVTG = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-31';         
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            PERSON.DOVTG = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-30';         
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            PERSON.DOVTG = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-29';         
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            PERSON.DOVTG = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-28';         
                                                                        
                                                                        
         HJ_DATOEN = ZM_OMSÆT_DATO_FRA_DB2 (PERSON.DAFSTAA);            
                                                                        
         IF HJ_DATOEN = ' '                                             
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            PERSON.DAFSTAA = HJ_DATO.AAR!!'-12-31';                     
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            PERSON.DAFSTAA = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-01';       
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            PERSON.DAFSTAA = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-31';       
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            PERSON.DAFSTAA = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-30';       
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            PERSON.DAFSTAA = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-29';       
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            PERSON.DAFSTAA = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-28';       
                                                                        
                                                                        
         HJ_DATOEN = ZM_OMSÆT_DATO_FRA_DB2 (PERSON.DATO0107);           
                                                                        
         IF HJ_DATOEN = ' '                                             
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            PERSON.DATO0107 = HJ_DATO.AAR!!'-01-01';                    
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            PERSON.DATO0107 = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-01';      
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            PERSON.DATO0107 = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-31';      
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            PERSON.DATO0107 = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-30';      
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            PERSON.DATO0107 = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-29';      
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            PERSON.DATO0107 = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-28';      
                                                                        
                                                                        
         HJ_DATOEN = ZM_OMSÆT_DATO_FRA_DB2 (PERSON.DFRAFLYT);           
                                                                        
         IF HJ_DATOEN = ' '                                             
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            PERSON.DFRAFLYT = HJ_DATO.AAR!!'-12-31';                    
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            PERSON.DFRAFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-01';      
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            PERSON.DFRAFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-31';      
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            PERSON.DFRAFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-30';      
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            PERSON.DFRAFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-29';      
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            PERSON.DFRAFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-28';      
                                                                        
                                                                        
         HJ_DATOEN = ZM_OMSÆT_DATO_FRA_DB2 (PERSON.DINDFLYT);           
                                                                        
         IF HJ_DATOEN = ' '                                             
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            PERSON.DINDFLYT = HJ_DATO.AAR!!'-01-01';                    
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            PERSON.DINDFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-01';      
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            PERSON.DINDFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-31';      
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            PERSON.DINDFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-30';      
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            PERSON.DINDFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-29';      
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            PERSON.DINDFLYT = HJ_DATO.AAR!!'-'!!HJ_DATO.MD!!'-28';      
                                                                        
 END FØRSTE_PERSONEJENDOMSOPL;                                          
 /*********************************************************************/
 /* SELECT SIDSTE GENERATION AF PERSON-EJENDOMSOPLYSN.                */
 /*********************************************************************/
 SIDSTE_PERSONEJENDOMSOPL: PROC;                                        
                                                                        
         EXEC SQL                                                       
               SELECT T2.DINDKAAR                                       
                    , T2.DCPRN                                          
                    , T2.EKOMNR                                         
                    , T2.EEJDNR                                         
                    , T2.EENHEDLBNR                                     
                    , T2.ELBNR                                          
                    , T2.EGENNR                                         
                    , T2.CDATAFRA                                       
                    , T2.DFRAGLD                                        
                    , T2.DTILGLD                                        
                    , T2.CSCREGISTMP                                    
                    , T2.PERSKOD                                        
                    , T2.MYNDNR                                         
                    , T2.COMPLA                                         
                    , T2.DOMPLACPR                                      
                    , T2.CAJOUR                                         
                    , T2.CSUPPL                                         
                    , T2.FEJLNR                                         
                    , T2.CEJBEVS                                        
                    , T2.DBRGN_MODT                                     
                    , T2.BEJBOL1                                        
                    , T2.BEJBOL2                                        
                    , T2.BEJBOLANV                                      
                    , T2.BERHVAN                                        
                    , T2.BEVSMAN                                        
                    , T2.BFORSKAT                                       
                    , T2.BFSKAT                                         
                    , T2.BGRPROM1                                       
                    , T2.BGRPROM2                                       
                    , T2.BMANNEDSL                                      
                    , T2.BNEDSL1                                        
                    , T2.BNEDSL2                                        
                    , T2.BNETTO                                         
                    , T2.BOBEHAKOD                                      
                    , T2.BPENSNED                                       
                    , T2.BPENSNÆ                                        
                    , T2.BPRIVAN                                        
                    , T2.BPROM1                                         
                    , T2.BPROM2                                         
                    , T2.BSUM1                                          
                    , T2.BSUM2                                          
                    , T2.BUDLSKC                                        
                    , T2.CANVEBOL                                       
                    , T2.CBERGRGLOP                                     
                    , T2.CBERGROP                                       
                    , T2.CEKSEMP                                        
                    , T2.CENKE                                          
                    , T2.CENKEBOH                                       
                    , T2.CERHV                                          
                    , T2.CFORSKAT                                       
                    , T2.CFRÅR                                          
                    , T2.CINDFLYT                                       
                    , T2.CIVILSTAND                                     
                    , T2.CKØBSALG                                       
                    , T2.CNEDSL1                                        
                    , T2.CNEDSL2                                        
                    , T2.CNULSTIL                                       
                    , T2.CPTYPSLUT                                      
                    , T2.CSKPLOMF                                       
                    , T2.CSKPLOMFGL                                     
                    , T2.CSLET                                          
                    , T2.CUDLDEL                                        
                    , T2.CUDLHEL                                        
                    , T2.CUDLMAN                                        
                    , T2.CÆGTOPR                                        
                    , T2.DAFSTAA                                        
                    , T2.DAFSTAAFOR                                     
                    , T2.DATO0107                                       
                    , T2.DFRAFLYT                                       
                    , T2.DHENVN                                         
                    , T2.DINDFLYT                                       
                    , T2.DOVTG                                          
                    , T2.DOVTGFOR                                       
                    , T2.FDAGERHV                                       
                    , T2.FDAGUDLE                                       
                    , T2.FERHVFLER                                      
                    , T2.FUBEBOELIG                                     
                    , T2.FUDL100                                        
                    , T2.GLPNR                                          
                    , T2.GPCTEJER                                       
                    , T2.GPCTEJERFOR                                    
                    , T2.GPCTERHV                                       
                    , T2.GPCTUDLE                                       
                    , T2.CTILKØB                                        
                    , T2.DRGNÅRFRA                                      
                    , T2.DRGNÅRTIL                                      
                    , T2.BBER2FAM_AKT                                   
                    , T2.BBERGRL_AKT                                    
                    , T2.BEJBOL1_AKT                                    
                    , T2.BEJBOL2_AKT                                    
                    , T2.BEJBOLANV_AKT                                  
                    , T2.BPENSNÆGL                                      
                    , T2.BSUM3                                          
                    , T2.CAFSTAA                                        
                    , T2.CANVEBOL_AKT                                   
                    , T2.CBOBHAKOD                                      
                    , T2.CDBER2FAM_AKT                                  
                    , T2.CDBERGRL_AKT                                   
                    , T2.CDEJBEVS                                       
                    , T2.CDEJDTYPE                                      
                    , T2.CDEKSEMP                                       
                    , T2.CDENKE                                         
                    , T2.CDINDFLYT                                      
                    , T2.CDPTYPGL                                       
                    , T2.CDPTYPSLUT                                     
                    , T2.CDÆGTOPR                                       
                    , T2.CEJDTYPE_AKT                                   
                    , T2.CERHVFLER                                      
                    , T2.CEVSGL                                         
                    , T2.CEVSMAN                                        
                    , T2.CFELT759                                       
                    , T2.CFELT760                                       
                    , T2.CFRAFLYTDTO                                    
                    , T2.CFRÅR_FOR                                      
                    , T2.CINDFLYTDTO                                    
                    , T2.COVTG                                          
                    , T2.CPCTEJER                                       
                    , T2.CPCTERHV                                       
                    , T2.CPCTUDLE                                       
                    , T2.CPENSNEDGL                                     
                    , T2.CUBEBOELIG                                     
                    , T2.CUDLSKC                                        
                    , T2.DERHVPER_FRA1                                  
                    , T2.DERHVPER_TIL1                                  
                    , T2.DERHVPER_FRA2                                  
                    , T2.DERHVPER_TIL2                                  
                    , T2.DERHVPER_FRA3                                  
                    , T2.DERHVPER_TIL3                                  
                    , T2.DERHVPER_FRA4                                  
                    , T2.DERHVPER_TIL4                                  
                    , T2.DERHVPER_FRA5                                  
                    , T2.DERHVPER_TIL5                                  
                    , T2.FERHVPER_ANT                                   
                    , T2.CNEDTAG158                                     
                    , T2.BEJDVPUSKTP                                    
                    , T2.BEJDVÆPUSKP                                    
                    , T2.CFELT762                                       
                    , T2.CFELT769                                       
                    , T2.DVURDÅR                                        
                    , T2.CRTEKORNS                                      
                    , T2.COPR_CRTEKORNS                                 
                    , T2.VURMARK_AKT                                    
                    , T2.VURMARK                                        
                    , T2.JUR_KATEGO_AKT                                 
                    , T2.JUR_KATEGO                                     
                    , T2.JUR_UKATEGO_AKT                                
                    , T2.JUR_UKATEGO                                    
                    , T2.VURDATO_AKT                                    
                    , T2.VURDATO                                        
                    , T2.FORSIGT_EVS_AKT                                
                    , T2.FORSIGT_EVS                                    
                    , T2.BESKAT_EVS_AKT                                 
                    , T2.BESKAT_EVS                                     
                    , T2.EJET20240101                                   
                    , T2.BEVSMANFSI                                     
                    , T2.COPR_BEVSMANFSI                                
                    , T2.BTAKS                                          
                    , T2.BTAKSRABAT                                     
                    , T2.BTAKSEFTERRABAT                                
                    , T2.BBER2FAM                                       
                    , T2.BBERGRL                                        
                                                                        
               INTO  :EVS_ESK.DINDKAAR                                  
                   , :EVS_ESK.DCPRN                                     
                   , :EVS_ESK.EKOMNR                                    
                   , :EVS_ESK.EEJDNR                                    
                   , :EVS_ESK.EENHEDLBNR                                
                   , :EVS_ESK.ELBNR                                     
                   , :EVS_ESK.EGENNR                                    
                   , :EVS_ESK.CDATAFRA                                  
                   , :EVS_ESK.DFRAGLD                                   
                   , :EVS_ESK.DTILGLD                                   
                   , :EVS_ESK.CSCREGISTMP                               
                   , :EVS_ESK.PERSKOD                                   
                   , :EVS_ESK.MYNDNR                                    
                   , :EVS_ESK.COMPLA                                    
                   , :EVS_ESK.DOMPLACPR                                 
                   , :EVS_ESK.CAJOUR                                    
                   , :EVS_ESK.CSUPPL                                    
                   , :EVS_ESK.FEJLNR                                    
                   , :EVS_ESK.CEJBEVS                                   
                   , :EVS_ESK.DBRGN_MODT                                
                   , :EVS_ESK.BEJBOL1        :INDK_PERS.BEJBOL1_I       
                   , :EVS_ESK.BEJBOL2        :INDK_PERS.BEJBOL2_I       
                   , :EVS_ESK.BEJBOLANV      :INDK_PERS.BEJBOLANV_I     
                   , :EVS_ESK.BERHVAN                                   
                   , :EVS_ESK.BEVSMAN        :INDK_PERS.BEVSMAN_I       
                   , :EVS_ESK.BFORSKAT       :INDK_PERS.BFORSKAT_I      
                   , :EVS_ESK.BFSKAT                                    
                   , :EVS_ESK.BGRPROM1       :INDK_PERS.BGRPROM1_I      
                   , :EVS_ESK.BGRPROM2       :INDK_PERS.BGRPROM2_I      
                   , :EVS_ESK.BMANNEDSL      :INDK_PERS.BMANNEDSL_I     
                   , :EVS_ESK.BNEDSL1        :INDK_PERS.BNEDSL1_I       
                   , :EVS_ESK.BNEDSL2        :INDK_PERS.BNEDSL2_I       
                   , :EVS_ESK.BNETTO         :INDK_PERS.BNETTO_I        
                   , :EVS_ESK.BOBEHAKOD                                 
                   , :EVS_ESK.BPENSNED       :INDK_PERS.BPENSNED_I      
                   , :EVS_ESK.BPENSNÆ        :INDK_PERS.BPENSNÆ_I       
                   , :EVS_ESK.BPRIVAN                                   
                   , :EVS_ESK.BPROM1         :INDK_PERS.BPROM1_I        
                   , :EVS_ESK.BPROM2         :INDK_PERS.BPROM2_I        
                   , :EVS_ESK.BSUM1          :INDK_PERS.BSUM1_I         
                   , :EVS_ESK.BSUM2          :INDK_PERS.BSUM2_I         
                   , :EVS_ESK.BUDLSKC        :INDK_PERS.BUDLSKC_I       
                   , :EVS_ESK.CANVEBOL                                  
                   , :EVS_ESK.CBERGRGLOP                                
                   , :EVS_ESK.CBERGROP                                  
                   , :EVS_ESK.CEKSEMP                                   
                   , :EVS_ESK.CENKE                                     
                   , :EVS_ESK.CENKEBOH                                  
                   , :EVS_ESK.CERHV                                     
                   , :EVS_ESK.CFORSKAT                                  
                   , :EVS_ESK.CFRÅR                                     
                   , :EVS_ESK.CINDFLYT                                  
                   , :EVS_ESK.CIVILSTAND                                
                   , :EVS_ESK.CKØBSALG                                  
                   , :EVS_ESK.CNEDSL1                                   
                   , :EVS_ESK.CNEDSL2                                   
                   , :EVS_ESK.CNULSTIL                                  
                   , :EVS_ESK.CPTYPSLUT                                 
                   , :EVS_ESK.CSKPLOMF                                  
                   , :EVS_ESK.CSKPLOMFGL                                
                   , :EVS_ESK.CSLET                                     
                   , :EVS_ESK.CUDLDEL                                   
                   , :EVS_ESK.CUDLHEL                                   
                   , :EVS_ESK.CUDLMAN                                   
                   , :EVS_ESK.CÆGTOPR                                   
                   , :EVS_ESK.DAFSTAA                                   
                   , :EVS_ESK.DAFSTAAFOR                                
                   , :EVS_ESK.DATO0107                                  
                   , :EVS_ESK.DFRAFLYT                                  
                   , :EVS_ESK.DHENVN                                    
                   , :EVS_ESK.DINDFLYT                                  
                   , :EVS_ESK.DOVTG                                     
                   , :EVS_ESK.DOVTGFOR                                  
                   , :EVS_ESK.FDAGERHV                                  
                   , :EVS_ESK.FDAGUDLE                                  
                   , :EVS_ESK.FERHVFLER                                 
                   , :EVS_ESK.FUBEBOELIG                                
                   , :EVS_ESK.FUDL100                                   
                   , :EVS_ESK.GLPNR                                     
                   , :EVS_ESK.GPCTEJER       :INDK_PERS.GPCTEJER_I      
                   , :EVS_ESK.GPCTEJERFOR                               
                   , :EVS_ESK.GPCTERHV                                  
                   , :EVS_ESK.GPCTUDLE                                  
                   , :EVS_ESK.CTILKØB                                   
                   , :EVS_ESK.DRGNÅRFRA                                 
                   , :EVS_ESK.DRGNÅRTIL                                 
                   , :EVS_ESK.BBER2FAM_AKT   :INDK_PERS.BBER2FAM_AKT_I  
                   , :EVS_ESK.BBERGRL_AKT    :INDK_PERS.BBERGRL_AKT_I   
                   , :EVS_ESK.BEJBOL1_AKT    :INDK_PERS.BEJBOL1_AKT_I   
                   , :EVS_ESK.BEJBOL2_AKT    :INDK_PERS.BEJBOL2_AKT_I   
                   , :EVS_ESK.BEJBOLANV_AKT  :INDK_PERS.BEJBOLANV_AKT_I 
                   , :EVS_ESK.BPENSNÆGL      :INDK_PERS.BPENSNÆGL_I     
                   , :EVS_ESK.BSUM3          :INDK_PERS.BSUM3_I         
                   , :EVS_ESK.CAFSTAA                                   
                   , :EVS_ESK.CANVEBOL_AKT                              
                   , :EVS_ESK.CBOBHAKOD                                 
                   , :EVS_ESK.CDBER2FAM_AKT                             
                   , :EVS_ESK.CDBERGRL_AKT                              
                   , :EVS_ESK.CDEJBEVS                                  
                   , :EVS_ESK.CDEJDTYPE                                 
                   , :EVS_ESK.CDEKSEMP                                  
                   , :EVS_ESK.CDENKE                                    
                   , :EVS_ESK.CDINDFLYT                                 
                   , :EVS_ESK.CDPTYPGL                                  
                   , :EVS_ESK.CDPTYPSLUT                                
                   , :EVS_ESK.CDÆGTOPR                                  
                   , :EVS_ESK.CEJDTYPE_AKT                              
                   , :EVS_ESK.CERHVFLER                                 
                   , :EVS_ESK.CEVSGL                                    
                   , :EVS_ESK.CEVSMAN                                   
                   , :EVS_ESK.CFELT759                                  
                   , :EVS_ESK.CFELT760                                  
                   , :EVS_ESK.CFRAFLYTDTO                               
                   , :EVS_ESK.CFRÅR_FOR                                 
                   , :EVS_ESK.CINDFLYTDTO                               
                   , :EVS_ESK.COVTG                                     
                   , :EVS_ESK.CPCTEJER                                  
                   , :EVS_ESK.CPCTERHV                                  
                   , :EVS_ESK.CPCTUDLE                                  
                   , :EVS_ESK.CPENSNEDGL                                
                   , :EVS_ESK.CUBEBOELIG                                
                   , :EVS_ESK.CUDLSKC                                   
                   , :EVS_ESK.DERHVPER_FRA1                             
                   , :EVS_ESK.DERHVPER_TIL1                             
                   , :EVS_ESK.DERHVPER_FRA2                             
                   , :EVS_ESK.DERHVPER_TIL2                             
                   , :EVS_ESK.DERHVPER_FRA3                             
                   , :EVS_ESK.DERHVPER_TIL3                             
                   , :EVS_ESK.DERHVPER_FRA4                             
                   , :EVS_ESK.DERHVPER_TIL4                             
                   , :EVS_ESK.DERHVPER_FRA5                             
                   , :EVS_ESK.DERHVPER_TIL5                             
                   , :EVS_ESK.FERHVPER_ANT                              
                   , :EVS_ESK.CNEDTAG158                                
                   , :EVS_ESK.BEJDVPUSKTP    :INDK_PERS.BEJDVPUSKTP_I   
                   , :EVS_ESK.BEJDVÆPUSKP    :INDK_PERS.BEJDVÆPUSKP_I   
                   , :EVS_ESK.CFELT762                                  
                   , :EVS_ESK.CFELT769                                  
                   , :EVS_ESK.DVURDÅR                                   
                   , :EVS_ESK.CRTEKORNS                                 
                   , :EVS_ESK.COPR_CRTEKORNS                            
                   , :EVS_ESK.VURMARK_AKT                               
                   , :EVS_ESK.VURMARK                                   
                   , :EVS_ESK.JUR_KATEGO_AKT                            
                   , :EVS_ESK.JUR_KATEGO                                
                   , :EVS_ESK.JUR_UKATEGO_AKT                           
                   , :EVS_ESK.JUR_UKATEGO                               
                   , :EVS_ESK.VURDATO_AKT                               
                   , :EVS_ESK.VURDATO                                   
                   , :EVS_ESK.FORSIGT_EVS_AKT                           
                   , :EVS_ESK.FORSIGT_EVS                               
                   , :EVS_ESK.BESKAT_EVS_AKT                            
                   , :EVS_ESK.BESKAT_EVS                                
                   , :EVS_ESK.EJET20240101                              
                   , :EVS_ESK.BEVSMANFSI     :INDK_PERS.BEVSMANFSI_I    
                   , :EVS_ESK.COPR_BEVSMANFSI                           
                   , :EVS_ESK.BTAKS                                     
                   , :EVS_ESK.BTAKSRABAT                                
                   , :EVS_ESK.BTAKSEFTERRABAT                           
                   , :EVS_ESK.BBER2FAM       :INDK_PERS.BBER2FAM_I      
                   , :EVS_ESK.BBERGRL        :INDK_PERS.BBERGRL_I       
                                                                        
              FROM BE30000T T2                                          
                                                                        
              WHERE  T2.DINDKAAR   = :EVS_ESK.DINDKAAR                  
               AND   T2.EKOMNR     = :EVS_ESK.EKOMNR                    
               AND   T2.EEJDNR     = :EVS_ESK.EEJDNR                    
               AND   T2.EENHEDLBNR = :EVS_ESK.EENHEDLBNR                
               AND   T2.DCPRN      = :EVS_ESK.DCPRN                     
               AND   T2.ELBNR      = :EVS_ESK.ELBNR                     
               AND   T2.EGENNR   = (SELECT MAX(TA.EGENNR)               
                                      FROM BE30000T TA                  
                                      WHERE  TA.DINDKAAR = T2.DINDKAAR  
                                        AND  TA.EKOMNR   = T2.EKOMNR    
                                        AND  TA.EEJDNR   = T2.EEJDNR    
                                        AND  TA.EENHEDLBNR =            
                                                       T2.EENHEDLBNR    
                                        AND  TA.DCPRN    = T2.DCPRN     
                                        AND  TA.ELBNR    = T2.ELBNR     
                                        AND  TA.DTILGLD  =              
                                        '9999-12-31-23.59.59.999999')   
         ;                                                              
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               CALL FLYT_ESK_FEL;                                       
             END;                                                       
           WHEN (100);                                                  
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'SELECT PERSONEJDOPL';                      
               PUT SKIP LIST('SQLKODE',SQLCODE);                        
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
                                                                        
 END SIDSTE_PERSONEJENDOMSOPL;                                          
 /*********************************************************************/
 /* OPEN CURSOR TIL LÆS AF TABEL BE30000T                             */
 /*********************************************************************/
 OPEN_PERSONEJENDOMSOPL: PROC;                                          
                                                                        
         EXEC SQL OPEN PERSON_CURSOR;                                   
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'OPEN PERSON_CURSOR';                         
              FEJLTEKST  = 'BE30000 ** 253 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END OPEN_PERSONEJENDOMSOPL;                                            
 /*********************************************************************/
 SKAF_BEJERAN: PROC;                                                    
                                                                        
         CALL OPEN_RESULTAT;                                            
         EXEC SQL FETCH RESULTAT_CURSOR                                 
                                                                        
         INTO :RESULTAT.BEJERAN;                                        
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
           WHEN(0)                                                      
              DO;                                                       
                INDK_RES.BEJERAN_SW = 0;                                
              END;                                                      
           WHEN(100)                                                    
              DO;                                                       
                HJ_DFRAGLD_DTO = SUBSTR(SIDSTE.DFRAGLD,1,10);           
                CALL SKAF_BEJERAN_D;                                    
              END;                                                      
           OTHERWISE                                                    
              DO;                                                       
                FEJLTEKST = 'FETCH RESULTAT';                           
                FEJLTEKST  = 'BE30000 ** 254 ' !! FEJLTEKST;            
                CALL SQL_FEJL;                                          
              END;                                                      
         END; /* SELECT */                                              
                                                                        
         CALL CLOSE_RESULTAT;                                           
                                                                        
 END SKAF_BEJERAN;                                                      
 /*********************************************************************/
 SKAF_BEJERAN_D: PROC;                                                  
                                                                        
         CALL OPEN_RESULTAT_D;                                          
         EXEC SQL FETCH RESULTAT_DCUR                                   
                                                                        
         INTO :RESULTAT.BEJERAN;                                        
                                                                        
         SELECT(SQLCA.SQLCODE);                                         
           WHEN(0)                                                      
              DO;                                                       
                INDK_RES.BEJERAN_SW = 0;                                
              END;                                                      
           WHEN(100)                                                    
              DO;                                                       
                RESULTAT.BEJERAN    =  0;                               
                INDK_RES.BEJERAN_SW = -1;                               
              END;                                                      
           OTHERWISE                                                    
              DO;                                                       
                FEJLTEKST = 'FETCH RESULTAT_D';                         
                FEJLTEKST  = 'BE30000 ** 254 ' !! FEJLTEKST;            
                CALL SQL_FEJL;                                          
              END;                                                      
         END; /* SELECT */                                              
                                                                        
         CALL CLOSE_RESULTAT_D;                                         
                                                                        
 END SKAF_BEJERAN_D;                                                    
 /*********************************************************************/
 SKAF_EJENDOM: PROC;                                                    
                                                                        
         EJD_NØGLE.DINDKAAR   = EVS_ESK.DINDKAAR;                       
         EJD_NØGLE.EKOMNR     = EVS_ESK.EKOMNR;                         
         EJD_NØGLE.EEJDNR     = EVS_ESK.EEJDNR;                         
         EJD_NØGLE.EENHEDLBNR = EVS_ESK.EENHEDLBNR;                     
                                                                        
              /* RUL HERUNDER */                                        
         READ FILE (BE245I) INTO (EJENDOM) KEY (EJD_NØGLEN);            
                                                                        
 END SKAF_EJENDOM;                                                      
 /*********************************************************************/
 /* OPEN CURSOR TIL LÆS AF TABEL BE40000T                             */
 /*********************************************************************/
 OPEN_RESULTAT: PROC;                                                   
                                                                        
         EXEC SQL OPEN RESULTAT_CURSOR;                                 
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'OPEN RESULTAT_CURSOR';                       
              FEJLTEKST  = 'BE30000 ** 255 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END OPEN_RESULTAT;                                                     
 /*********************************************************************/
 /* OPEN CURSOR TIL LÆS AF TABEL BE40000T/BE41000T                    */
 /*********************************************************************/
 OPEN_RESULTAT_D: PROC;                                                 
                                                                        
         EXEC SQL OPEN RESULTAT_DCUR;                                   
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'OPEN RESULTAT_DUR';                          
              FEJLTEKST  = 'BE30000 ** 255 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END OPEN_RESULTAT_D;                                                   
 /*********************************************************************/
 /* CLOSE CURSOR TIL LÆS AF TABEL BE30000T                            */
 /*********************************************************************/
 CLOSE_PERSONEJENDOMSOPL: PROC;                                         
                                                                        
         EXEC SQL CLOSE PERSON_CURSOR;                                  
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'CLOSE PERSON_CURSOR';                        
              FEJLTEKST  = 'BE30000 ** 256 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END CLOSE_PERSONEJENDOMSOPL;                                           
 /*********************************************************************/
 /* CLOSE CURSOR TIL LÆS AF TABEL BE01200T/BE01100T                   */
 /*********************************************************************/
 CLOSE_RESULTAT: PROC;                                                  
                                                                        
         EXEC SQL CLOSE RESULTAT_CURSOR;                                
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'CLOSE RESULTAT_CURSOR';                      
              FEJLTEKST  = 'BE30000 ** 257 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END CLOSE_RESULTAT;                                                    
 /*********************************************************************/
 /* CLOSE CURSOR TIL LÆS AF TABEL BE01200T/BE01100T                   */
 /*********************************************************************/
 CLOSE_RESULTAT_D: PROC;                                                
                                                                        
         EXEC SQL CLOSE RESULTAT_DCUR;                                  
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'CLOSE RESULTAT_DCUR';                        
              FEJLTEKST  = 'BE30000 ** 257 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END CLOSE_RESULTAT_D;                                                  
 /***********************************************************/          
 KONTROL:PROC(TAL,TEKST);                                               
 DCL TAL   CHAR (3);                                                    
 DCL TEKST CHAR (80) VARYING;                                           
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0);                                                    
           OTHER                                                        
             DO;                                                        
               FEJLTEKST  = 'BE30000 ** '!!TAL!! TEKST;                 
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
 END KONTROL;                                                           
