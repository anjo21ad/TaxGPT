 /********************************************************************* 
 *       BH60160M BEREGN EVENTUEL REDUKTION AF LEJEVÆRDI              * 
 *                FÆLLES MACRO FOR :                                  * 
 *                BH60110 ORDINÆR ESKEMA OG BOY                       * 
 *                BH80110 BOY                                         * 
 *                BH90110 FORSKUD                                     * 
 * OBS.: INDEN UDFØRSEL TESTES FOR EVT. UNDTAGELSER FOR REDUKTION     * 
 *********************************************************************/ 
 REDUKTION:                                                             
 PROC (GL_LEJEVÆRDI,NY_LEJEVÆRDI,RED_LEJEVÆRDI,CREDUKT,CREDUKTTYP);     
 DCL     GL_LEJEVÆRDI    FIXED     (11);                                
 DCL     NY_LEJEVÆRDI    FIXED     (11);                                
 DCL     RED_LEJEVÆRDI   FIXED     (11);                                
 DCL     CREDUKT         PIC       '9';                                 
 DCL     CREDUKTTYP      PIC       '9';                                 
 DCL     DIFBLEJE        FIXED     (15,2);                              
 DCL     GLBLEJE20       FIXED     (15,2);                              
         CREDUKTTYP = 0;                                                
         IF BEREGN = NEJ !             /* HVIS UNDTAGET FOR REDUKTION */
            GL_LEJEVÆRDI = 0           /* ELLER HVIS INGEN GL. LEJE-  */
         THEN                          /* VÆRDI                       */
            RETURN;                                                     
         DIFBLEJE   = NY_LEJEVÆRDI - GL_LEJEVÆRDI;                      
         GLBLEJE20  = GL_LEJEVÆRDI *  0.20;                             
         IF CREDUKT = 2            /* PENSIONISTER ELLER FØRTIDSPENS. */
         THEN                                                           
            DO;                                                         
               IF DIFBLEJE > 1000                                       
               THEN                                                     
                  DO;                                                   
                     IF DIFBLEJE > ( GLBLEJE20 - 2500)                  
                     THEN                                               
                        DO;                                             
                           IF (GLBLEJE20 - 2500) > 1000                 
                           THEN                                         
                              DO;                                       
                                 RED_LEJEVÆRDI =                        
                                      GL_LEJEVÆRDI + (GLBLEJE20 - 2500);
                                 CREDUKTTYP = 4;                        
                              END;                                      
                           ELSE                                         
                              DO;                                       
                                 RED_LEJEVÆRDI = GL_LEJEVÆRDI + 1000;   
                                 CREDUKTTYP = 1;                        
                              END;                                      
                        END;                                            
                  END;                                                  
            END;                                                        
         ELSE                                                           
            DO;                                                         
               IF DIFBLEJE > 3500             /* IKKE PENSIONISTER  */  
               THEN                                                     
                  DO;                                                   
                     IF DIFBLEJE > GLBLEJE20                            
                     THEN                                               
                        DO;                                             
                           IF GLBLEJE20 > 3500                          
                           THEN                                         
                              DO;                                       
                                 RED_LEJEVÆRDI =                        
                                              GL_LEJEVÆRDI + GLBLEJE20; 
                                 CREDUKTTYP = 2;                        
                              END;                                      
                           ELSE                                         
                              DO;                                       
                                 RED_LEJEVÆRDI = GL_LEJEVÆRDI + 3500;   
                                 CREDUKTTYP = 3;                        
                              END;                                      
                        END;                                            
                  END;                                                  
            END;                                                        
 END REDUKTION;                                                         
