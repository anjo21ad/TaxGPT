 BH70000: PROC OPTIONS (MAIN) REORDER;                                  
 /********************************************************************  
 *                                                                   *  
 *    GENERERER 3 MAKROER TIL AT FLYTTE DATA FRA TABEL TIL STRUKTUR  *  
 *                                                                   *  
 *    PROGRAMØR : HANS ERIK KJELDSEN T&S LSU             2005        *  
 *                                                                   *  
 *    HUSK AT RETTE WHERE  T1.TIL_ÅR  > 2008 (GAMMELT SLUT ÅR)       *  
 *                                                                   *  
 * *SLUT007*    INGRID FISCHER        IFI,    PKF ÅRHUS    14.11.2007. *
 *              PROGRAMMET ER TILRETTET TIL SLUT 2007                  *
 *                                                                     *
 * *#SLUT09*    GERD HOLM-PEDERSEN    GEH/PKF              14.10.2009*  
 *              PROGRAMMET ER TILRETTET TIL SLUT 2009                *  
 * *#SLUT15*    ESBEN BRODERSEN                                      *  
 *              PROGRAMMET ER TILRETTET TIL SLUT 2015      15.03.2016*  
 *              KØRT SOM TEST AF MACROER                             *  
 * *#SLUT18*    ESBEN BRODERSEN                                      *  
 *              PROGRAMMET ER TILRETTET TIL SLUT 2018      24.09.2018*  
 *              KØRT MED NYE FELTER TIL 2FAMILIE (MANGLER)           *  
 *********************************************************************/ 
 /*********************************************************************/
 /*   DECLARE AF FILER                                                */
 /*********************************************************************/
 DCL     UDFIL1          FILE RECORD OUTPUT;                            
 DCL     UDFIL2          FILE RECORD OUTPUT;                            
 DCL     UDFIL3          FILE RECORD OUTPUT;                            
 DCL     UDFIL4          FILE RECORD OUTPUT;                            
 DCL     UDFIL5          FILE RECORD OUTPUT;                            
 DCL     UDFIL6          FILE RECORD OUTPUT;                            
 DCL     UDFIL7          FILE RECORD OUTPUT;                            
 DCL     UDFIL8          FILE RECORD OUTPUT;                            
 DCL     UDFIL9          FILE RECORD OUTPUT;                            
 DCL     UDFIL10         FILE RECORD OUTPUT;                            
 DCL     UDFIL11         FILE RECORD OUTPUT;                            
 DCL     UDFIL12         FILE RECORD OUTPUT;                            
 /*********************************************************************/
 /*   DECLARE AF FELTER                                               */
 /*********************************************************************/
 DCL     (ADDR, INDEX, LOW, SUBSTR, CEIL, MIN, VERIFY, HIGH ) BUILTIN;  
 DCL     (NULL) BUILTIN;                                                
 DCL     UD              CHAR      (80) INIT (' ');                     
 DCL     I1              BIN FIXED(15)INIT (0);                         
 DCL     I2              BIN FIXED(15)INIT (0);                         
 DCL     I3              BIN FIXED(15)INIT (0);                         
 DCL     I4              BIN FIXED(15)INIT (0);                         
 DCL     I5              BIN FIXED(15)INIT (0);                         
 DCL     I6              BIN FIXED(15)INIT (0);                         
 DCL     I7              BIN FIXED(15)INIT (0);                         
 DCL     I8              BIN FIXED(15)INIT (0);                         
 DCL     I9              BIN FIXED(15)INIT (0);                         
 DCL     I10             BIN FIXED(15)INIT (0);                         
 DCL     I11             BIN FIXED(15)INIT (0);                         
 DCL     I12             BIN FIXED(15)INIT (0);                         
 DCL     J               BIN FIXED(15)INIT (0);                         
 DCL     JJ              BIN FIXED(15)INIT (0);                         
 DCL     K               BIN FIXED(15)INIT (0);                         
 DCL     DAP             CHAR   (01) INIT ('''');                       
 DCL     FEJLTEKST      CHAR (20)        INIT(' ');                     
 DCL     FELTNAVN       CHAR (20)        INIT(' ');                     
 DCL     LÆNGDE_PIC    PIC '999999999999';                              
 DCL     LÆNGDE_CHAR   CHAR (12) DEF LÆNGDE_PIC;                        
 DCL     LÆNGDE_C2     CHAR (2);                                        
 DCL     DECIMAL_PIC   PIC '999999999999';                              
 DCL     DECIMAL_CHAR  CHAR (12) DEF DECIMAL_PIC;                       
 DCL     DECIMAL_C1    CHAR (1);                                        
 DCL     FELTKODE_PIC   PIC 'ZZZZZZZZZZZ9';                             
 DCL     FELTKODE_CHAR  CHAR (12) DEF FELTKODE_PIC;                     
 DCL     FELTKODE_C4    CHAR (4);                                       
 DCL     ABENDMEDD      CHAR (56)        INIT(' ');                     
 DCL     OPSAML1(2000)     CHAR      (80);                              
 DCL     OPSAML2(2000)     CHAR      (80);                              
 DCL     OPSAML3(2000)     CHAR      (80);                              
 DCL     OPSAML4(2000)     CHAR      (80);                              
 DCL     OPSAML5(2000)     CHAR      (80);                              
 DCL     OPSAML6(2000)     CHAR      (80);                              
 DCL     OPSAML7(2000)     CHAR      (80);                              
 DCL     OPSAML8(2000)     CHAR      (80);                              
 DCL     OPSAML9(2000)     CHAR      (80);                              
 DCL     OPSAML10(2000)     CHAR      (80);                             
 DCL     OPSAML11(2000)     CHAR      (80);                             
 DCL     OPSAML12(2000)     CHAR      (80);                             
 DCL     DIGIT          CHAR (10) INIT('0123456789');                   
 DCL     SQLKODE         PIC '9999';                                    
         OPSAML1(*) = ' ';                                              
         OPSAML2(*) = ' ';                                              
         OPSAML3(*) = ' ';                                              
         OPSAML4(*) = ' ';                                              
         OPSAML5(*) = ' ';                                              
         OPSAML6(*) = ' ';                                              
         OPSAML7(*) = ' ';                                              
         OPSAML8(*) = ' ';                                              
         OPSAML9(*) = ' ';                                              
         OPSAML10(*) = ' ';                                             
         OPSAML11(*) = ' ';                                             
         OPSAML12(*) = ' ';                                             
 DCL     ZS67000  ENTRY;                                                
                                                                        
 DCL     1 EVS_FELTKODE,            /* STRUKTUR TIL EVS FELTKODETABEL */
         %INCLUDE BQ50000N;                                             
 /**********************************************************************
 * DECLARE AF DB2 TABELLER                                             *
 **********************************************************************/
                                                                        
         EXEC SQL INCLUDE SQLCA;        /* SQL KOMMUNIKATIONSAREAL    */
         EXEC SQL INCLUDE BQ50000T;     /* EVS FELTKODETABEL          */
 /*********************************************************************/
 /*                                                                   */
 /*   INITIERINGER                                                    */
 /*                                                                   */
 /*********************************************************************/
         CALL DAN_TOP1;                                                 
         CALL DAN_TOP2;                                                 
         CALL DAN_TOP3;                                                 
         CALL DAN_TOP4;                                                 
         CALL DAN_TOP5;                                                 
         CALL DAN_TOP6;                                                 
         CALL DAN_TOP7;                                                 
         CALL DAN_TOP8;                                                 
         CALL DAN_TOP9;                                                 
         CALL DAN_TOP10;                                                
         CALL DAN_TOP11;                                                
         CALL DAN_TOP12;                                                
 /*********************************************************************/
 /*                                                                   */
 /*   PROGRAM                                                         */
 /*                                                                   */
 /*********************************************************************/
         CALL DECLARE_FELTKODE_CUR;                                     
                                                                        
         EXEC SQL OPEN FELTKODE_CUR;                                    
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'SQLFEJL: OPEN FELTKODE_CUR';                 
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
         CALL FETCH_FELTKODE_CUR;                                       
                                                                        
                                                                        
            DO WHILE(SQLCODE = 0);                                      
               IF EVS_FELTKODE.FELTKODETYPE = 2                         
               THEN                                                     
                  DO;                                                   
                     CALL DANLINIE1;                                    
                     IF EVS_FELTKODE.INDK = 1                           
                     THEN                                               
                        CALL DANLINIE4;                                 
                     CALL DANLINIE7;                                    
                  END;                                                  
               IF EVS_FELTKODE.FELTKODETYPE = 3                         
               THEN                                                     
                  DO;                                                   
                     CALL DANLINIE2;                                    
                     IF EVS_FELTKODE.INDK = 1                           
                     THEN                                               
                        CALL DANLINIE5;                                 
                     CALL DANLINIE8;                                    
                  END;                                                  
               IF EVS_FELTKODE.FELTKODETYPE = 4                         
               THEN                                                     
                  DO;                                                   
                     CALL DANLINIE3;                                    
                     IF EVS_FELTKODE.INDK = 1                           
                     THEN                                               
                        CALL DANLINIE6;                                 
                     CALL DANLINIE9;                                    
                  END;                                                  
               CALL FETCH_FELTKODE_CUR;                                 
            END;                                                        
         CALL DAN_BUND1;                                                
         CALL DAN_BUND2;                                                
         CALL DAN_BUND3;                                                
         CALL SKRIV_FIL1;                                               
         CALL SKRIV_FIL2;                                               
         CALL SKRIV_FIL3;                                               
         CALL SKRIV_FIL4;                                               
         CALL SKRIV_FIL5;                                               
         CALL SKRIV_FIL6;                                               
         CALL SKRIV_FIL7;                                               
         CALL SKRIV_FIL8;                                               
         CALL SKRIV_FIL9;                                               
         CALL SKRIV_FIL10;                                              
         CALL SKRIV_FIL11;                                              
         CALL SKRIV_FIL12;                                              
 /*********************************************************************/
 /*                                                                   */
 /*   PROCEDURER                                                      */
 /*                                                                   */
 /*********************************************************************/
 DAN_TOP1: PROC;                                                        
         OPSAML1(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML1(2) = ' /* PROCEDURE DANNET AF BH70000       '          
                   !! '                                */';             
         OPSAML1(3) = ' /* FLYTNING AF DATA FRA EJENDOMSTABEL'          
                   !! ' TIL STRUKTUR                   */';             
         OPSAML1(4) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML1(5) = ' FLYT_EJD_FEL: PROC;                  '          
                   !! '                                  ';             
         OPSAML1(6) = '                                      '          
                   !! '                                  ';             
         OPSAML1(7) = '      SELECT (EVS_EJD_FELT.FELTKODE'             
                   !! ');                                ';             
         I1 = 7;                                                        
 END DAN_TOP1;                                                          
 DAN_TOP2: PROC;                                                        
         OPSAML2(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML2(2) = ' /* PROCEDURE DANNET AF BH70000       '          
                   !! '                                */';             
         OPSAML2(3) = ' /* FLYTNING AF DATA FRA EJERSKABSTABE'          
                   !! 'L TIL STRUKTUR                  */';             
         OPSAML2(4) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML2(5) = ' FLYT_ESK_FEL: PROC;                  '          
                   !! '                                  ';             
         OPSAML2(6) = '                                      '          
                   !! '                                  ';             
         OPSAML2(7) = '      SELECT (EVS_ESK_FELT.FELTKODE'             
                   !! ');                                ';             
         I2 = 7;                                                        
 END DAN_TOP2;                                                          
 DAN_TOP3: PROC;                                                        
         OPSAML3(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML3(2) = ' /* PROCEDURE DANNET AF BH70000       '          
                   !! '                                */';             
         OPSAML3(3) = ' /* FLYTNING AF DATA FRA RESULTATTABEL'          
                   !! ' TIL STRUKTUR                   */';             
         OPSAML3(4) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML3(5) = ' FLYT_RES_FEL: PROC;                  '          
                   !! '                                  ';             
         OPSAML3(6) = '                                      '          
                   !! '                                  ';             
         OPSAML3(7) = '      SELECT (EVS_RES_FELT.FELTKODE'             
                   !! ');                                ';             
         I3 = 7;                                                        
 END DAN_TOP3;                                                          
 DAN_TOP4: PROC;                                                        
         OPSAML4(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML4(2) = ' /* STRUKTUR DANNET AF BH70000        '          
                   !! '                                */';             
         OPSAML4(3) = ' /* INDIKATOR TIL EJENDOMSTABELEN     '          
                   !! '                                */';             
         OPSAML4(4) = ' /************************************'          
                   !! '*********************************/';             
         I4 = 4;                                                        
 END DAN_TOP4;                                                          
 DAN_TOP5: PROC;                                                        
         OPSAML5(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML5(2) = ' /* STRUKTUR DANNET AF BH70000        '          
                   !! '                                */';             
         OPSAML5(3) = ' /* INDIKATOR TIL EJERSKABSTABELEN    '          
                   !! '                                */';             
         OPSAML5(4) = ' /************************************'          
                   !! '*********************************/';             
         I5 = 4;                                                        
 END DAN_TOP5;                                                          
 DAN_TOP6: PROC;                                                        
         OPSAML6(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML6(2) = ' /* STRUKTUR DANNET AF BH70000        '          
                   !! '                                */';             
         OPSAML6(3) = ' /* INDIKATOR TIL RESULTATTABEL       '          
                   !! '                                */';             
         OPSAML6(4) = ' /************************************'          
                   !! '*********************************/';             
         I6 = 4;                                                        
 END DAN_TOP6;                                                          
 DAN_TOP7: PROC;                                                        
         OPSAML7(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML7(2) = ' /* STRUKTUR DANNET AF BH70000        '          
                   !! '                                */';             
         OPSAML7(3) = ' /* STRUKTUR TIL DATA PÅ EJENDOMSTABEL'          
                   !! 'LERNE BQ20000T OG BQ210000T     */';             
         OPSAML7(4) = ' /************************************'          
                   !! '*********************************/';             
         I7 = 4;                                                        
 END DAN_TOP7;                                                          
 DAN_TOP8: PROC;                                                        
         OPSAML8(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML8(2) = ' /* STRUKTUR DANNET AF BH70000        '          
                   !! '                                */';             
         OPSAML8(3) = ' /* FLYTNING AF DATA FRA RESULTATTABEL'          
                   !! ' TIL STRUKTUR                   */';             
         OPSAML8(4) = ' /************************************'          
                   !! '*********************************/';             
         I8 = 4;                                                        
 END DAN_TOP8;                                                          
 DAN_TOP9: PROC;                                                        
         OPSAML9(1) = ' /************************************'          
                   !! '*********************************/';             
         OPSAML9(2) = ' /* STRUKTUR DANNET AF BH70000        '          
                   !! '                                */';             
         OPSAML9(3) = ' /* FLYTNING AF DATA FRA RESULTATTABEL'          
                   !! ' TIL STRUKTUR                   */';             
         OPSAML9(4) = ' /************************************'          
                   !! '*********************************/';             
         I9 = 4;                                                        
 END DAN_TOP9;                                                          
 DAN_TOP10: PROC;                                                       
         OPSAML10(1) = ' /************************************'         
                   !! '*********************************/';             
         OPSAML10(2) = ' /* INITIERING AF INDIKATOR TIL EJENDO'         
                   !! 'MSTABEL DANNET AF BH70000       */';             
         OPSAML10(3) = ' /************************************'         
                   !! '*********************************/';             
         I10 = 3;                                                       
 END DAN_TOP10;                                                         
 DAN_TOP11: PROC;                                                       
         OPSAML11(1) = ' /************************************'         
                   !! '*********************************/';             
         OPSAML11(2) = ' /* INITIERING AF INDIKATOR TIL EJERSK'         
                   !! 'ABSTABEL DANNET AF BH70000      */';             
         OPSAML11(3) = ' /************************************'         
                   !! '*********************************/';             
         I11 = 3;                                                       
 END DAN_TOP11;                                                         
 DAN_TOP12: PROC;                                                       
         OPSAML12(1) = ' /************************************'         
                   !! '*********************************/';             
         OPSAML12(2) = ' /* INITIERING AF INDIKATOR TIL RESULT'         
                   !! 'ATTABEL DANNET AF BH70000       */';             
         OPSAML12(3) = ' /************************************'         
                   !! '*********************************/';             
         I12 = 3;                                                       
 END DAN_TOP12;                                                         
 DANLINIE1: PROC;                                                       
         I1 = I1 + 1;                                                   
         FELTKODE_PIC = EVS_FELTKODE.FELTKODE;                          
         FELTKODE_C4 = SUBSTR(FELTKODE_CHAR,9,4);                       
         OPSAML1(I1) = '         WHEN (' !!                             
                     FELTKODE_C4 !! ')';                                
         I1 = I1 + 1;                                                   
         OPSAML1(I1) = '            DO;';                               
         I1 = I1 + 1;                                                   
         FELTNAVN = EVS_FELTKODE.DATANAVN;                              
         IF EVS_FELTKODE.FORMAT = 'CHAR'                                
         THEN                                                           
            OPSAML1(I1) = '               EJENDOMTAB.'                  
                     !! FELTNAVN                                        
                     !! ' = EVS_EJD_FELT.INDHOLD_C;';                   
         ELSE                                                           
            OPSAML1(I1) = '               EJENDOMTAB.'                  
                     !! FELTNAVN                                        
                     !! ' = EVS_EJD_FELT.INDHOLD_D;';                   
         IF EVS_FELTKODE.INDK = 1                                       
         THEN                                                           
            DO;                                                         
               K = INDEX(EVS_FELTKODE.DATANAVN,' ');                    
               FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';   
               I1 = I1 + 1;                                             
               OPSAML1(I1) = '               INDK_EJEND.'               
                          !! FELTNAVN                                   
                          !! ' = 0;';                                   
            END;                                                        
         I1 = I1 + 1;                                                   
         OPSAML1(I1) = '            END;';                              
 END DANLINIE1;                                                         
 DANLINIE2: PROC;                                                       
         I2 = I2 + 1;                                                   
         FELTKODE_PIC = EVS_FELTKODE.FELTKODE;                          
         FELTKODE_C4 = SUBSTR(FELTKODE_CHAR,9,4);                       
         OPSAML2(I2) = '         WHEN (' !!                             
                     FELTKODE_C4 !! ')';                                
         I2 = I2 + 1;                                                   
         OPSAML2(I2) = '            DO;';                               
         I2 = I2 + 1;                                                   
         FELTNAVN = EVS_FELTKODE.DATANAVN;                              
         IF EVS_FELTKODE.FORMAT = 'CHAR'                                
         THEN                                                           
            OPSAML2(I2) = '               PERSONTAB.'                   
                     !! FELTNAVN                                        
                     !! ' = EVS_ESK_FELT.INDHOLD_C;';                   
         ELSE                                                           
            OPSAML2(I2) = '               PERSONTAB.'                   
                     !! FELTNAVN                                        
                     !! ' = EVS_ESK_FELT.INDHOLD_D;';                   
         IF EVS_FELTKODE.INDK = 1                                       
         THEN                                                           
            DO;                                                         
               K = INDEX(EVS_FELTKODE.DATANAVN,' ');                    
               FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';   
               I2 = I2 + 1;                                             
               OPSAML2(I2) = '               INDK_EJERSK.'              
                          !! FELTNAVN                                   
                          !! ' = 0;';                                   
            END;                                                        
         I2 = I2 + 1;                                                   
         OPSAML2(I2) = '            END;';                              
 END DANLINIE2;                                                         
 DANLINIE3: PROC;                                                       
 DCL     FELTNAVN       CHAR (18);                                      
         I3 = I3 + 1;                                                   
         FELTKODE_PIC = EVS_FELTKODE.FELTKODE;                          
         FELTKODE_C4 = SUBSTR(FELTKODE_CHAR,9,4);                       
         OPSAML3(I3) = '         WHEN (' !!                             
                     FELTKODE_C4 !! ')';                                
         I3 = I3 + 1;                                                   
         OPSAML3(I3) = '            DO;';                               
         I3 = I3 + 1;                                                   
         FELTNAVN = EVS_FELTKODE.DATANAVN;                              
         IF EVS_FELTKODE.FORMAT = 'CHAR'                                
         THEN                                                           
            OPSAML3(I3) = '               RESULTATTAB.'                 
                     !! FELTNAVN                                        
                     !! ' = EVS_RES_FELT.INDHOLD_C;';                   
         ELSE                                                           
            OPSAML3(I3) = '               RESULTATTAB.'                 
                     !! FELTNAVN                                        
                     !! ' = EVS_RES_FELT.INDHOLD_D;';                   
         IF EVS_FELTKODE.INDK = 1                                       
         THEN                                                           
            DO;                                                         
               K = INDEX(EVS_FELTKODE.DATANAVN,' ');                    
               FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';   
               I3 = I3 + 1;                                             
               OPSAML3(I3) = '               INDK_EVS_RES.'             
                          !! FELTNAVN                                   
                          !! ' = 0;';                                   
            END;                                                        
         I3 = I3 + 1;                                                   
         OPSAML3(I3) = '            END;';                              
 END DANLINIE3;                                                         
 DANLINIE4: PROC;                                                       
         I4 = I4 + 1;                                                   
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';         
         OPSAML4(I4) = '     5 '                                        
                    !! FELTNAVN                                         
                    !! 'BIN FIXED (15),';                               
         I10 = I10 + 1;                                                 
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';         
         OPSAML10(I10) = '     INDK_EJEND.'                             
                    !! FELTNAVN                                         
                    !! ' = -1;';                                        
 END DANLINIE4;                                                         
 DANLINIE5: PROC;                                                       
         I5 = I5 + 1;                                                   
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';         
         OPSAML5(I5) = '     5 '                                        
                    !! FELTNAVN                                         
                    !! 'BIN FIXED (15),';                               
                                                                        
         I11 = I11 + 1;                                                 
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';         
         OPSAML11(I11) = '    INDK_EJERSK.'                             
                    !! FELTNAVN                                         
                    !! ' = -1;';                                        
 END DANLINIE5;                                                         
 DANLINIE6: PROC;                                                       
         I6 = I6 + 1;                                                   
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';         
         OPSAML6(I6) = '     5 '                                        
                    !! FELTNAVN                                         
                    !! 'BIN FIXED (15),';                               
                                                                        
         I12 = I12 + 1;                                                 
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = SUBSTR(EVS_FELTKODE.DATANAVN,1,K-1) !!'_I';         
         OPSAML12(I12) = '    INDK_EVS_RES.'                            
                    !! FELTNAVN                                         
                    !! ' = -1;';                                        
 END DANLINIE6;                                                         
 DANLINIE7: PROC;                                                       
         I7 = I7 + 1;                                                   
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = EVS_FELTKODE.DATANAVN;                              
         LÆNGDE_PIC = EVS_FELTKODE.LÆNGDE;                              
         LÆNGDE_C2 = SUBSTR(LÆNGDE_CHAR,11,2);                          
         DECIMAL_PIC = EVS_FELTKODE.DECIMAL;                            
         DECIMAL_C1 = SUBSTR(DECIMAL_CHAR,12,1);                        
         IF EVS_FELTKODE.FORMAT = 'DECIMAL'                             
         THEN                                                           
            OPSAML7(I7) = '       5 '                                   
                         !! FELTNAVN                                    
                         !! 'DEC FIXED(' !! LÆNGDE_C2                   
                         !! ',' !! DECIMAL_C1 !! '),';                  
         ELSE                                                           
            OPSAML7(I7) = '       5 '                                   
                         !! FELTNAVN                                    
                         !! 'CHAR(' !! LÆNGDE_C2 !! '),';               
 END DANLINIE7;                                                         
 DANLINIE8: PROC;                                                       
         I8 = I8 + 1;                                                   
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = EVS_FELTKODE.DATANAVN;                              
         LÆNGDE_PIC = EVS_FELTKODE.LÆNGDE;                              
         LÆNGDE_C2 = SUBSTR(LÆNGDE_CHAR,11,2);                          
         DECIMAL_PIC = EVS_FELTKODE.DECIMAL;                            
         DECIMAL_C1 = SUBSTR(DECIMAL_CHAR,12,1);                        
         IF EVS_FELTKODE.FORMAT = 'DECIMAL'                             
         THEN                                                           
            OPSAML8(I8) = '       5 '                                   
                         !! FELTNAVN                                    
                         !! 'DEC FIXED(' !! LÆNGDE_C2                   
                         !! ',' !! DECIMAL_C1 !! '),';                  
         ELSE                                                           
            OPSAML8(I8) = '       5 '                                   
                         !! FELTNAVN                                    
                         !! 'CHAR(' !! LÆNGDE_C2 !! '),';               
 END DANLINIE8;                                                         
 DANLINIE9: PROC;                                                       
         I9 = I9 + 1;                                                   
         K = INDEX(EVS_FELTKODE.DATANAVN,' ');                          
         FELTNAVN = EVS_FELTKODE.DATANAVN;                              
         LÆNGDE_PIC = EVS_FELTKODE.LÆNGDE;                              
         LÆNGDE_C2 = SUBSTR(LÆNGDE_CHAR,11,2);                          
         DECIMAL_PIC = EVS_FELTKODE.DECIMAL;                            
         DECIMAL_C1 = SUBSTR(DECIMAL_CHAR,12,1);                        
         IF EVS_FELTKODE.FORMAT = 'DECIMAL'                             
         THEN                                                           
            OPSAML9(I9) = '       5 '                                   
                         !! FELTNAVN                                    
                         !! 'DEC FIXED(' !! LÆNGDE_C2                   
                         !! ',' !! DECIMAL_C1 !! '),';                  
         ELSE                                                           
            OPSAML9(I9) = '       5 '                                   
                         !! FELTNAVN                                    
                         !! 'CHAR(' !! LÆNGDE_C2 !! '),';               
 END DANLINIE9;                                                         
 DAN_BUND1: PROC;                                                       
         I1 = I1 + 1;                                                   
         OPSAML1(I1) = '            OTHERWISE;                '         
                    !! '                                  ';            
         I1 = I1 + 1;                                                   
         OPSAML1(I1) = '         END; /*SELECT */             '         
                    !! '                                  ';            
         I1 = I1 + 1;                                                   
         OPSAML1(I1) = '                                      '         
                    !! '                                  ';            
         I1 = I1 + 1;                                                   
         OPSAML1(I1) = ' END FLYT_EJD_FEL;                  '           
                    !! '                                  ';            
 END DAN_BUND1;                                                         
 DAN_BUND2: PROC;                                                       
         I2 = I2 + 1;                                                   
         OPSAML2(I2) = '            OTHERWISE;                '         
                    !! '                                  ';            
         I2 = I2 + 1;                                                   
         OPSAML2(I2) = '         END; /*SELECT */             '         
                    !! '                                  ';            
         I2 = I2 + 1;                                                   
         OPSAML2(I2) = '                                      '         
                    !! '                                  ';            
         I2 = I2 + 1;                                                   
         OPSAML2(I2) = ' END FLYT_ESK_FEL;                  '           
                    !! '                                  ';            
 END DAN_BUND2;                                                         
 DAN_BUND3: PROC;                                                       
         I3 = I3 + 1;                                                   
         OPSAML3(I3) = '            OTHERWISE;                '         
                    !! '                                  ';            
         I3 = I3 + 1;                                                   
         OPSAML3(I3) = '         END; /*SELECT */             '         
                    !! '                                  ';            
         I3 = I3 + 1;                                                   
         OPSAML3(I3) = '                                      '         
                    !! '                                  ';            
         I3 = I3 + 1;                                                   
         OPSAML3(I3) = ' END FLYT_RES_FEL;                  '           
                    !! '                                  ';            
 END DAN_BUND3;                                                         
 SKRIV_FIL1: PROC;                                                      
         OPEN FILE  (UDFIL1)  TITLE ('BH70001O');                       
         DO J = 1 TO I1;                                                
            UD = OPSAML1(J);                                            
            WRITE FILE(UDFIL1) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL1);                                           
 END SKRIV_FIL1;                                                        
 SKRIV_FIL2: PROC;                                                      
         OPEN FILE  (UDFIL2)  TITLE ('BH70002O');                       
         DO J = 1 TO I2;                                                
            UD = OPSAML2(J);                                            
            WRITE FILE(UDFIL2) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL2);                                           
 END SKRIV_FIL2;                                                        
 SKRIV_FIL3: PROC;                                                      
         OPEN FILE  (UDFIL3)  TITLE ('BH70003O');                       
         DO J = 1 TO I3;                                                
            UD = OPSAML3(J);                                            
            WRITE FILE(UDFIL3) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL3);                                           
 END SKRIV_FIL3;                                                        
 SKRIV_FIL4: PROC;                                                      
         OPEN FILE  (UDFIL4)  TITLE ('BH70004O');                       
         DO J = 1 TO I4;                                                
            UD = OPSAML4(J);                                            
            IF J = I4                                                   
            THEN                                                        
               DO;                                                      
                  JJ = INDEX(UD,',');                                   
                  UD = SUBSTR(UD,1,JJ-1);                               
               END;                                                     
            WRITE FILE(UDFIL4) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL4);                                           
 END SKRIV_FIL4;                                                        
 SKRIV_FIL5: PROC;                                                      
         OPEN FILE  (UDFIL5)  TITLE ('BH70005O');                       
         DO J = 1 TO I5;                                                
            UD = OPSAML5(J);                                            
            IF J = I5                                                   
            THEN                                                        
               DO;                                                      
                  JJ = INDEX(UD,',');                                   
                  UD = SUBSTR(UD,1,JJ-1);                               
               END;                                                     
            WRITE FILE(UDFIL5) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL5);                                           
 END SKRIV_FIL5;                                                        
 SKRIV_FIL6: PROC;                                                      
         OPEN FILE  (UDFIL6)  TITLE ('BH70006O');                       
         DO J = 1 TO I6;                                                
            UD = OPSAML6(J);                                            
            IF J = I6                                                   
            THEN                                                        
               DO;                                                      
                  JJ = INDEX(UD,',');                                   
                  UD = SUBSTR(UD,1,JJ-1);                               
               END;                                                     
            WRITE FILE(UDFIL6) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL6);                                           
 END SKRIV_FIL6;                                                        
 SKRIV_FIL7: PROC;                                                      
         OPEN FILE  (UDFIL7)  TITLE ('BH70007O');                       
         DO J = 1 TO I7;                                                
            UD = OPSAML7(J);                                            
            IF J = I7                                                   
            THEN                                                        
               DO;                                                      
                  JJ = INDEX(UD,',');                                   
                  UD = SUBSTR(UD,1,JJ-1);                               
               END;                                                     
            WRITE FILE(UDFIL7) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL7);                                           
 END SKRIV_FIL7;                                                        
 SKRIV_FIL8: PROC;                                                      
         OPEN FILE  (UDFIL8)  TITLE ('BH70008O');                       
         DO J = 1 TO I8;                                                
            UD = OPSAML8(J);                                            
            IF J = I8                                                   
            THEN                                                        
               DO;                                                      
                  JJ = INDEX(UD,',');                                   
                  UD = SUBSTR(UD,1,JJ-1);                               
               END;                                                     
            WRITE FILE(UDFIL8) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL8);                                           
 END SKRIV_FIL8;                                                        
 SKRIV_FIL9: PROC;                                                      
         OPEN FILE  (UDFIL9)  TITLE ('BH70009O');                       
         DO J = 1 TO I9;                                                
            UD = OPSAML9(J);                                            
            IF J = I9                                                   
            THEN                                                        
               DO;                                                      
                  JJ = INDEX(UD,',');                                   
                  UD = SUBSTR(UD,1,JJ-1);                               
               END;                                                     
            WRITE FILE(UDFIL9) FROM (UD);                               
         END;                                                           
         CLOSE FILE (UDFIL9);                                           
 END SKRIV_FIL9;                                                        
 SKRIV_FIL10: PROC;                                                     
         OPEN FILE  (UDFIL10)  TITLE ('BH70010O');                      
         DO J = 1 TO I10;                                               
            UD = OPSAML10(J);                                           
            WRITE FILE(UDFIL10) FROM (UD);                              
         END;                                                           
         CLOSE FILE (UDFIL10);                                          
 END SKRIV_FIL10;                                                       
 SKRIV_FIL11: PROC;                                                     
         OPEN FILE  (UDFIL11)  TITLE ('BH70011O');                      
         DO J = 1 TO I11;                                               
            UD = OPSAML11(J);                                           
            WRITE FILE(UDFIL11) FROM (UD);                              
         END;                                                           
         CLOSE FILE (UDFIL11);                                          
 END SKRIV_FIL11;                                                       
 SKRIV_FIL12: PROC;                                                     
         OPEN FILE  (UDFIL12)  TITLE ('BH70012O');                      
         DO J = 1 TO I12;                                               
            UD = OPSAML12(J);                                           
            WRITE FILE(UDFIL12) FROM (UD);                              
         END;                                                           
         CLOSE FILE (UDFIL12);                                          
 END SKRIV_FIL12;                                                       
 /*********************************************************************/
 /* DECLARE CURSOR TIL EVS OVERSIGT FOR EN PERSON                     */
 /* FUNKTION 8                                                        */
 /*********************************************************************/
 DECLARE_FELTKODE_CUR: PROC;                                            
                                                                        
         EXEC SQL                                                       
                                                                        
              DECLARE FELTKODE_CUR CURSOR FOR                           
                                                                        
              SELECT T1.FELTKODE,                                       
                     T1.FELTKODETYPE,                                   
                     T1.DATANAVN,                                       
                     T1.FORMAT,                                         
                     T1.INDK,                                           
                     T1.LÆNGDE,                                         
                     T1.DECIMAL,                                        
                     T1.FRA_ÅR,                                         
                     T1.TIL_ÅR,                                         
                     T1.CSCNAVN,                                        
                     T1.SLUTNR                                          
                                                                        
              FROM   BQ50000T T1                                        
                                                                        
              WHERE  T1.TIL_ÅR  > 2017             /*#SLUT18 EBD*/      
                                                                        
              ORDER BY T1.FELTKODE                                      
              FOR FETCH ONLY                                            
         ;                                                              
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'SQLFEJL: DECLARE FELTKODE_CUR';              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END DECLARE_FELTKODE_CUR;                                              
 /*********************************************************************/
 /* FETCH CURSOR TIL EVS OVERSIGT FOR EN PERSON                       */
 /* FUNKTION 8                                                        */
 /*********************************************************************/
 FETCH_FELTKODE_CUR: PROC;                                              
                                                                        
         EVS_FELTKODE = '';                                             
                                                                        
         EXEC SQL                                                       
                                                                        
              FETCH FELTKODE_CUR                                        
                                                                        
              INTO  :EVS_FELTKODE.FELTKODE     ,                        
                    :EVS_FELTKODE.FELTKODETYPE ,                        
                    :EVS_FELTKODE.DATANAVN     ,                        
                    :EVS_FELTKODE.FORMAT       ,                        
                    :EVS_FELTKODE.INDK         ,                        
                    :EVS_FELTKODE.LÆNGDE       ,                        
                    :EVS_FELTKODE.DECIMAL      ,                        
                    :EVS_FELTKODE.FRA_ÅR       ,                        
                    :EVS_FELTKODE.TIL_ÅR       ,                        
                    :EVS_FELTKODE.CSCNAVN      ,                        
                    :EVS_FELTKODE.SLUTNR       ;                        
                                                                        
         SQLKODE = SQLCA.SQLCODE;                                       
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0);                                                    
                                                                        
           WHEN (100);                                                  
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST = 'SQLFEJL: FETCH FELTKODE_CUR';               
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* END-SELECT */                                          
                                                                        
 END FETCH_FELTKODE_CUR;                                                
 /*********************************************************************/
 /* CLOSE CURSOR TIL LÆS AF PERSONTABEL BN00600T               RUTINE */
 /*********************************************************************/
 CLOSE_FELTKODE_CUR: PROC;                                              
                                                                        
         EXEC SQL CLOSE FELTKODE_CUR;                                   
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'CLOSE FELTKODE_CUR';                         
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END CLOSE_FELTKODE_CUR;                                                
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
         SQLKODE = SQLCA.SQLCODE;                                       
         CALL ZS67000(SQLCA);                                           
                                                                        
         ABENDMEDD = 'BH70000 ** 250 ' !! FEJLTEKST !! SQLKODE;         
                                                                        
         PUT SKIP LIST(5, ABENDMEDD, 2);                                
                                                                        
 END SQL_FEJL;                                                          
 END BH70000;                                                           
