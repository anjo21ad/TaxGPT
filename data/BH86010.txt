 PROCESS OPT(TIME);                                                     
 BH86010: /* OPSÆT TIL BEREGN AF EVS 2016 TIL SLUT */           /*RUL*/ 
 PROCEDURE (PTR1_INPUT, PTR2_INPUT, PTR3_INPUT, PTR4_INPUT,             
            PTR5_INPUT) REORDER;                                        
 /*********************************************************************/
 DCL COPYRIGHT CHAR (30) STATIC INIT ('COPYRIGHT KOMMUNEDATA I/S 2008');
 /********************************************************************/ 
 /*      PROGRAMMERET AF AAGE RASMUSSEN, PUS T&S DEC. 2000            */
 /*      ÅRSTILRETTET AF AAGE RASMUSSEN, LSU T&S DEC. 2001            */
 /*      ÅRSTILRETTET AF AAGE RASMUSSEN, LSU T&S NOV. 2002            */
 /*      ÅRSRULLET    AF AAGE RASMUSSEN, LSU T&S NOV. 2003            */
 /*      ÅRSRULLET    AF BO SCHMIDT    , LSU T&S NOV. 2004            */
 /* SLUT05    SUSANNE KROGH VILLUMSEN                  09-11-2005     */
 /*           TILRETTET SLUT 2005                                     */
 /* SLUT06    BO SCHMIDT                               04-10-2006     */
 /*           TILRETTET SLUT 2006                                     */
 /* SLUT07    INGRID FISCHER IFI                       14-11-2007     */
 /*           TILRETTET SLUT 2007                                     */
 /* SLUT08    BO SCHMIDT                               14-11-2008     */
 /*           TILRETTET SLUT 2008                                     */
 /* SLUT09    GERD HOLM-PEDERSEN                       08-10-2009     */
 /*           TILRETTET SLUT 2009                                     */
 /* SLUT10    GERD HOLM-PEDERSEN                       10-10-2010     */
 /*           TILRETTET SLUT 2010                                     */
 /* SLUT11    GERD HOLM-PEDERSEN                       20-10-2011     */
 /*           TILRETTET SLUT 2011                                     */
 /* SLUT12    LARS KAAE HARRITSHØJ                     SEP 2012       */
 /*           TILRETTET SLUT 2012                                     */
 /* SLUT13    JØRGEN SAUGMANN                          OKT 2013       */
 /*           TILRETTET SLUT 2013                                     */
 /* SLUT14    JØRGEN SAUGMANN                          OKT 2014       */
 /*           TILRETTET SLUT 2014                                     */
 /* SLUT15    Z6JNK                                    OKT 2015       */
 /*           Årsrul til EVS SLUT-15. (Søg efter 'RUL')               */
 /* SLUT16    Z8QEB                                    JUN 2016       */
 /*           Årsrul til EVS SLUT-16. (Søg efter 'RUL')               */
 /*           CSTOPÅR Udviddet med år 2014 og 2015                    */
 /*           Efter aftale med JAM                                    */
 /*           Regl 5 fra Workshop taget ud. Det var vist en gl.       */
 /*           nød rettelse                                            */
 /* SLUT16    Lene Maj Jensen QLE                      JUN 2016       */
 /*           Hårdkodet årstal fjernet.  Istedet benyttes INDKÅR1     */
 /*           eller glslutår fra BH65300M                             */
 /* DB2OMLÆG  Tilrettet så det kører med pointere til db2-strukturer  */
 /*           for de fire beregningsbånd db2-tabeller.                */
 /*                                                                   */
 /* SLUT17    Z8QEB                                    OKT 2017       */
 /*           Årsrul til EVS SLUT-17. (Søg efter 'RUL')               */
 /*                                                                   */
 /* SLUT18    Z6EBD                                    SEP 2018       */
 /*           Årsrul til EVS SLUT-18. (Søg efter 'RUL')               */
 /*           KS02-23 2familiehuse                                    */
 /* SLUT19    Z6EBD                                    JUN 2019       */
 /*           Årsrul til EVS SLUT-19. (Søg efter 'RUL')               */
 /*           2familie ændringer fra Forskud 2020                     */
 /* Forskud21 Z6PBR                                    Maj 2020       */
 /*           defect 96 (F2021). Nulstillinger                        */
 /* Slut2020    Per Brunk PBR KS2-45                     Nov 2020     */
 /*             skift fra BH65300M.INDKÅR1 til BH65300M.GLSLUTÅR1     */
 /* Slut2020    Ole Nielsen ONE KS2-34                   Nov 2020     */
 /*             Tilføjet fejlnr 5200 ej nulstilles                    */
 /* Slut2021  Z6SEP                                    MAJ 2021       */
 /*           Nyt felt DATA_ID oprettet efter AFVIKLINGS_ID           */
 /*           Definitionen af BH65300M er fjernet, BH55300M kommer nu */
 /*           fra input til program.                                  */
 /*           Z6EBD variabel vurderingsår              MAJ 2021       */
 /*           Rettelserne er markeret med ##                          */
 /* SLUT2021  Z6PBR                                    Maj 2021       */
 /*           Nye felter i BQ78000T, D881                             */
 /*             Per Brunk PBR D1007                     Oktober 2021  */
 /*             Altid fejlnummer = 5001 ved cbenyt = 09               */
 /*           BQ20 -> BQ21                              Oktober 2021  */
 /* SLUT2022  Z6PBR                                                   */
 /*           BQ21 -> BQ22                              Oktober 2021  */
 /* SLUT2022  Z6JJJ                                                   */
 /*           Defect 90                                 Oktober 2022  */
 /* SLUT2022  Z6PBR                                                   */
 /*           (Defect 90) HENT_ADRESSE gav sqlcode -811 Januar 2023   */
 /*                                                                   */
 /* SLUT2023  D92 fejlkode 5193 må ikke ændres Z6ONE    oktober 2023  */
 /* SLUT2023  Z6JJJ                                     Nov. 2023     */
 /*           Beregningskoder 7,8,9,C køres igennem validering        */
 /*           BQ22 -> BQ23  PBR                         November 2023 */
 /*           Z6MBS                                     Okt. 2023     */
 /*           Deaktivering af kontrol på koderne 5155, 5164, 5185 og  */
 /*           5200                                                    */
 /* SLUT2024  Z6JJJ                                                   */
 /*           BH55600M erstatter BH55300M                 Juni 2024   */
 /*********************************************************************/
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /*********************************************************************/
 /*      DECLARE AF INPUT                                             */
 /*********************************************************************/
                                                                        
 DCL     PTR1_INPUT                 PTR;                                
 DCL     1 BQ75_AREA        BASED     (PTR1_INPUT),                     
           %INCLUDE BQ7500TN;;                                          
                                                                        
 DCL     PTR2_INPUT                 PTR;                                
 DCL     1 BQ76_AREA        BASED     (PTR2_INPUT),                     
           %INCLUDE BQ7600TN;;                                          
                                                                        
 DCL     PTR3_INPUT                 PTR;                                
 DCL     1 BQ77_AREA        BASED     (PTR3_INPUT),                     
           %INCLUDE BQ7700TN;;                                          
                                                                        
 DCL     PTR4_INPUT                 PTR;                                
 DCL     1 BQ78_AREA        BASED     (PTR4_INPUT),                     
           %INCLUDE BQ7800TN;;                                          
                                                                        
 DCL     PTR5_INPUT                 PTR;                                
 DCL     1 BH55600M         BASED     (PTR5_INPUT),                     
           %INCLUDE BH55600N;;                                          
                                                                        
  /* Nye til Forskud 2020 kode skal eventuelt flyttes til BH86000 */    
 DCL     ZS67000         ENTRY;                                         
 DCL     ZS30101         ENTRY;                                         
 EXEC SQL INCLUDE SQLCA;                                                
 EXEC SQL INCLUDE BQ70000T;                                             
 EXEC SQL INCLUDE BQ78000T;                                             
 /*********************************************************************/
 /*      DECLARE AF DIVERSE PARAMETRE TIL BEREGNING AF EVS            */
 /*********************************************************************/
                                                                        
 DCL     1 EVS_BER,                                                     
           %INCLUDE BQ24907N;; /* BQ24907N    */                 /*RUL*/
                                                                        
 /*********************************************************************/
 /*      DECLARE AF DIVERSE                                           */
 /*********************************************************************/
                                                                        
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     ADRESSE_FUNDET  BIT       (1)     INIT ('0'B);                 
 DCL     I               BIN FIXED (15);                                
 DCL     HJVÆRDI         FIXED     (11);                                
 DCL     HJVÆRDI1        FIXED     (15,3);                              
 DCL     HJVÆRDI2        FIXED     (11);                                
 DCL     HJ_CSTOP_DATO_CH  CHAR    (8) BASED(ADDR(HJ_CSTOP_DATO_NUM));  
 DCL     HJ_CSTOP_DATO_NUM PIC    '(8)9';                               
 DCL     HJ_VEJKOD_CH    CHAR    (4) BASED(ADDR(HJ_VEJKOD_NUM));        
 DCL     HJ_VEJKOD_NUM   PIC    '(4)9';                                 
                                                                        
 DCL     HJ_ANVÆND_DATO  FIXED     (9);                                 
 DCL     GEM_CEJBEVS     CHAR      (1);                                 
 DCL     HJBEGRÆNSET_TP  CHAR      (1);                                 
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF ABEND STRUKTUR m.v.                               */
 /*                                                                   */
 /*********************************************************************/
 DCL     ABENDKODE     FIXED       (2) INIT(5);                         
 DCL     1 ABENDMEDD,                                                   
          2 ABENDMODUL CHAR      (7) INIT ('BH86010'),                  
          2 ABENDFILL1 CHAR      (1) INIT (' '),                        
          2 ABENDMEDNR CHAR      (2) INIT ('**'),                       
          2 ABENDFILL2 CHAR      (1) INIT (' '),                        
          2 ABENDTXT   CHAR      (45);                                  
                                                                        
 DCL     ABENDRTKODE   FIXED     (1) INIT (2);                          
                                                                        
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 DCL     MULTIPLY        BUILTIN;                                       
 /*********************************************************************/
 /*      P R O C E S S                                                */
 /*********************************************************************/
                                                                        
                                                                        
         IF BQ78_AREA.EKOMNR < 999 &                                    
            BQ78_AREA.TILEVS_CINVPNR = '0'                              
         THEN                                                           
            DO;                                                         
               /* hvis cstopår ligger før indkomstår    */              
               /* benyttes cstopår                      */              
               IF BQ78_AREA.EJENDOM_CSTOPÅR > '2001' &                  
                  BQ78_AREA.EJENDOM_CSTOPÅR < BH55600M.INDKÅR1          
               THEN                                                     
                 DO;                                                    
                   HJ_CSTOP_DATO_CH = BQ78_AREA.EJENDOM_CSTOPÅR !!      
                                            '1001';                     
                   HJ_ANVÆND_DATO = HJ_CSTOP_DATO_NUM;                  
                 END;                                                   
               ELSE                                                     
                 DO;  /* ellers benyttes gammelt slutår */              
                   HJ_CSTOP_DATO_CH = BH55600M.GLSLUTÅR1 !! '1001';     
                   HJ_ANVÆND_DATO = HJ_CSTOP_DATO_NUM;                  
                 END;                                                   
                                                                        
               SELECT;                                                  
                 WHEN ((BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_01OM_CBENYT ^= '  ') &           
                       (BQ77_AREA.EVSSEJ_DCPRN > 0 &                    
                        BQ77_AREA.EVSSEJ_SID_CSLET < '1' &              
                        BQ77_AREA.EVSSEJ_SID_CEJBEVS ^= '9' &           
                   /*   BQ77_AREA.EVSSEJ_SID_CEJBEVS < '9' & */         
                        BQ77_AREA.EVSSEJ_SID_CBERGRGLOP = 'N'))         
                    DO;                                                 
                       CALL OPSÆT_015ANV_NY;  /* NYE EJERE */           
                    END;                                                
                                                                        
                 WHEN ((BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_01OM_CBENYT ^= '  ') &           
                       (BQ77_AREA.EVSSEJ_DCPRN > 0 &                    
                        BQ77_AREA.EVSSEJ_SID_CSLET < '1' &              
                   /*   BQ77_AREA.EVSSEJ_SID_CEJBEVS < '9' & */         
                        BQ77_AREA.EVSSEJ_SID_CEJBEVS ^= '9' &           
                        BQ77_AREA.EVSSEJ_SID_CBERGRGLOP = 'G'))         
                    DO;                                                 
                       CALL OPSÆT_015ANV_ØVR;  /* ØVRIGE EJERE */       
                    END;                                                
                                                                        
                 WHEN (BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &           
                       BQ78_AREA.VURD_01OM_CBENYT ^= '  ' &             
                       BQ78_AREA.TILEVS_DATO0107 > HJ_ANVÆND_DATO)      
                    DO;                                                 
                       CALL OPSÆT_015ANV_NY;  /* NYE EJERE */           
                    END;                                                
                                                                        
                 WHEN ((BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_01OM_CBENYT ^= '  ') &           
                        BQ78_AREA.TILEVS_DATO0107 > 0  &                
                        BQ78_AREA.TILEVS_DATO0107 <= HJ_ANVÆND_DATO)    
                    DO;                                                 
                       CALL OPSÆT_015ANV_ØVR;  /* ØVRIGE EJERE */       
                    END;                                                
                                                                        
                 WHEN (BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &           
                       BQ78_AREA.VURD_01OM_CBENYT ^= '  ' &             
                       BQ78_AREA.TILEVS_BFASTSTIGBGR_SW = 0)            
                    DO;                                                 
                       CALL OPSÆT_015ANV_ØVR;  /* ØVRIGE EJERE */       
                    END;                                                
                                                                        
                 WHEN ( BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_01OM_CBENYT ^= '  ' &            
                        BQ78_AREA.TILEVS_A_EJ_DOVTG_GL > HJ_ANVÆND_DATO)
                    DO;                                                 
                       CALL OPSÆT_015ANV_NY;  /* NYE EJERE */           
                    END;                                                
                                                                        
                 OTHERWISE                                              
                    DO;                                                 
                       CALL OPSÆT_015ANV_ØVR;  /* ØVRIGE EJERE */       
                    END;                                                
               END; /* SELECT */                                        
                                                                        
                                                                        
               SELECT;                                                  
                 WHEN ((BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_02OM_CBENYT ^= '  ') &           
                       (BQ77_AREA.EVSSEJ_DCPRN > 0 &                    
                        BQ77_AREA.EVSSEJ_SID_CSLET < '1' &              
                        BQ77_AREA.EVSSEJ_SID_CEJBEVS ^= '9' &           
                    /*  BQ77_AREA.EVSSEJ_SID_CEJBEVS < '9' & */         
                        BQ77_AREA.EVSSEJ_SID_CBERGRGLOP = 'N'))         
                    DO;                                                 
                       CALL OPSÆT_02ANV_NY;  /* NYE EJERE */            
                    END;                                                
                                                                        
                 WHEN ((BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_02OM_CBENYT ^= '  ') &           
                       (BQ77_AREA.EVSSEJ_DCPRN > 0 &                    
                        BQ77_AREA.EVSSEJ_SID_CSLET < '1' &              
                        BQ77_AREA.EVSSEJ_SID_CEJBEVS ^= '9' &           
                    /*  BQ77_AREA.EVSSEJ_SID_CEJBEVS < '9' & */         
                        BQ77_AREA.EVSSEJ_SID_CBERGRGLOP = 'G'))         
                    DO;                                                 
                       CALL OPSÆT_02ANV_ØVR;  /* ØVRIGE EJERE */        
                    END;                                                
                                                                        
                 WHEN ((BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_02OM_CBENYT ^= '  ') &           
                        BQ78_AREA.TILEVS_DATO0107 > HJ_ANVÆND_DATO)     
                    DO;                                                 
                       CALL OPSÆT_02ANV_NY;  /* NYE EJERE */            
                    END;                                                
                                                                        
                 WHEN ((BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_02OM_CBENYT ^= '  ') &           
                        BQ78_AREA.TILEVS_DATO0107 > 0  &                
                        BQ78_AREA.TILEVS_DATO0107 <= HJ_ANVÆND_DATO)    
                    DO;                                                 
                       CALL OPSÆT_02ANV_ØVR;  /* ØVRIGE EJERE */        
                    END;                                                
                                                                        
                 WHEN (BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &           
                       BQ78_AREA.VURD_02OM_CBENYT ^= '  ' &             
                       BQ78_AREA.TILEVS_BFASTSTIGBGR_SW = 0)            
                    DO;                                                 
                       CALL OPSÆT_02ANV_ØVR;  /* ØVRIGE EJERE */        
                    END;                                                
                                                                        
                 WHEN ( BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &          
                        BQ78_AREA.VURD_02OM_CBENYT ^= '  ' &            
                        BQ78_AREA.TILEVS_A_EJ_DOVTG_GL > HJ_ANVÆND_DATO)
                    DO;                                                 
                       CALL OPSÆT_02ANV_NY;  /* NYE EJERE */            
                    END;                                                
                                                                        
                 OTHERWISE                                              
                    DO;                                                 
                       CALL OPSÆT_02ANV_ØVR;  /* ØVRIGE EJERE */        
                    END;                                                
               END; /* SELECT */                                        
            END;                                                        
                                                                        
         IF BQ78_AREA.EKOMNR < 999 &                                    
            BQ78_AREA.VURD_A_CBENYT_AKT ^= '  '                         
         THEN                                                           
            DO;                                                         
               BQ78_AREA.EJENDOM_BEJDVÆR =                              
               BQ78_AREA.VURD_A_BEJDVÆR_AKT;                            
               BQ78_AREA.EJENDOM_BEJDVÆR_SW =                           
               BQ78_AREA.VURD_A_BEJDVÆR_A_SW;                           
               BQ78_AREA.EJENDOM_BEJBOL1 =                              
               BQ78_AREA.VURD_A_BEJBOL1_AKT;                            
               BQ78_AREA.EJENDOM_BEJBOL1_SW =                           
               BQ78_AREA.VURD_A_BEJBOL1_A_SW;                           
               BQ78_AREA.EJENDOM_CEJBOLTYP1 =                           
               BQ78_AREA.VURD_A_CEJBOLTYP1_AKT;                         
               BQ78_AREA.EJENDOM_BEJBOL2 =                              
               BQ78_AREA.VURD_A_BEJBOL2_AKT;                            
               BQ78_AREA.EJENDOM_BEJBOL2_SW =                           
               BQ78_AREA.VURD_A_BEJBOL2_A_SW;                           
               BQ78_AREA.EJENDOM_CEJBOLTYP2 =                           
               BQ78_AREA.VURD_A_CEJBOLTYP2_AKT;                         
            END;                                                        
                                                                        
 /*********************************************************************/
 /*      OPSÆTNING AF BEREGNINGSGRUNDLAG FOR AKTUEL EJER              */
 /*********************************************************************/
                                                                        
         SELECT;                                                        
           WHEN (BQ78_AREA.VURD_A_BBERGRL_A_SW = 0 &                    
                 BQ78_AREA.VURD_02ANV_BBERGRL_SW = 0 &                  
                 BQ78_AREA.VURD_015ANV_BBERGRL_SW = 0)                  
             DO;                                                        
                SELECT;                                                 
                  WHEN ((BQ78_AREA.VURD_A_BBERGRL_AKT <=                
                         BQ78_AREA.VURD_02ANV_BBERGRL) &                
                        (BQ78_AREA.VURD_A_BBERGRL_AKT <=                
                         BQ78_AREA.VURD_015ANV_BBERGRL))                
                    DO;                                                 
                       BQ78_AREA.EJERSKAB_BBERGRL =                     
                       BQ78_AREA.VURD_A_BBERGRL_AKT;                    
                       BQ78_AREA.EJERSKAB_BBERGRL_SW = 0;               
                       BQ78_AREA.EJERSKAB_BBER2FAM =                    
                       BQ78_AREA.VURD_A_BBER2FAM_AKT;                   
                       BQ78_AREA.EJERSKAB_BBER2FAM_SW =                 
                       BQ78_AREA.VURD_A_BBER2FAM_A_SW;                  
                       BQ78_AREA.EJERSKAB_BEJBOLANV =                   
                       BQ78_AREA.VURD_A_BEJBOLANV_AKT;                  
                       BQ78_AREA.EJERSKAB_BEJBOLANV_SW =                
                       BQ78_AREA.VURD_A_BEJBOLANV_A_SW;                 
                       BQ78_AREA.EJERSKAB_CANVEBOL =                    
                       BQ78_AREA.VURD_A_CANVEBOL_AKT;                   
                       BQ78_AREA.EJERSKAB_CBERGROP = 'I';               
                       BQ78_AREA.EJERSKAB_VURMARK =                     
                       BQ78_AREA.VURD_A_VURMARK_AKT;                    
                       BQ78_AREA.EJERSKAB_JUR_KATEGO  =                 
                       BQ78_AREA.VURD_A_JUR_KATEGO ;                    
                       BQ78_AREA.EJERSKAB_JUR_UKATEGO =                 
                       BQ78_AREA.VURD_A_JUR_UKATEGO;                    
                       BQ78_AREA.EJERSKAB_JUR_VURDATO =                 
                       BQ78_AREA.VURD_A_VURDATO    ;                    
                       BQ78_AREA.EJERSKAB_FORSIGT_EVS =                 
                       BQ78_AREA.VURD_A_FORSIGT_EVS;                    
                       BQ78_AREA.EJERSKAB_BESKAT      =                 
                       BQ78_AREA.VURD_A_BESKAT_EVS ;                    
                    END;                                                
                                                                        
                  WHEN ((BQ78_AREA.VURD_02ANV_BBERGRL <                 
                         BQ78_AREA.VURD_A_BBERGRL_AKT) &                
                        (BQ78_AREA.VURD_02ANV_BBERGRL <=                
                         BQ78_AREA.VURD_015ANV_BBERGRL))                
                    DO;                                                 
                       BQ78_AREA.EJERSKAB_BBERGRL =                     
                       BQ78_AREA.VURD_02ANV_BBERGRL;                    
                       BQ78_AREA.EJERSKAB_BBERGRL_SW = 0;               
                       BQ78_AREA.EJERSKAB_BBER2FAM =                    
                       BQ78_AREA.VURD_02ANV_BBER2FAM;                   
                       BQ78_AREA.EJERSKAB_BBER2FAM_SW =                 
                       BQ78_AREA.VURD_02ANV_BBER2FAM_SW;                
                       BQ78_AREA.EJERSKAB_BEJBOLANV =                   
                       BQ78_AREA.VURD_02ANV_BEJBOLANV;                  
                       BQ78_AREA.EJERSKAB_BEJBOLANV_SW =                
                       BQ78_AREA.VURD_02ANV_BEJBOLANV_SW;               
                       BQ78_AREA.EJERSKAB_CANVEBOL =                    
                       BQ78_AREA.VURD_02ANV_CANVEBOL;                   
                       BQ78_AREA.EJERSKAB_CBERGROP = 'N';               
                       BQ78_AREA.EJERSKAB_VURMARK =                     
                       BQ78_AREA.VURD_02ANV_VURMARK;                    
                       BQ78_AREA.EJERSKAB_JUR_KATEGO  =                 
                       BQ78_AREA.VURD_02ANY_JUR_KATEGO ;                
                       BQ78_AREA.EJERSKAB_JUR_UKATEGO =                 
                       BQ78_AREA.VURD_02ANY_JUR_UKATEGO;                
                       BQ78_AREA.EJERSKAB_JUR_VURDATO =                 
                       BQ78_AREA.VURD_02ANY_VURDATO    ;                
                       BQ78_AREA.EJERSKAB_FORSIGT_EVS =                 
                       BQ78_AREA.VURD_02ANY_FORSIGT_EVS;                
                       BQ78_AREA.EJERSKAB_BESKAT      =                 
                       BQ78_AREA.VURD_02ANY_BESKAT_EVS ;                
                    END;                                                
                                                                        
                  OTHERWISE                                             
                    DO;                                                 
                       BQ78_AREA.EJERSKAB_BBERGRL =                     
                       BQ78_AREA.VURD_015ANV_BBERGRL;                   
                       BQ78_AREA.EJERSKAB_BBERGRL_SW = 0;               
                       BQ78_AREA.EJERSKAB_BBER2FAM =                    
                       BQ78_AREA.VURD_015ANV_BBER2FAM;                  
                       BQ78_AREA.EJERSKAB_BBER2FAM_SW =                 
                       BQ78_AREA.VURD_015ANV_BBER2FAM_SW;               
                       BQ78_AREA.EJERSKAB_BEJBOLANV =                   
                       BQ78_AREA.VURD_015ANV_BEJBOLANV;                 
                       BQ78_AREA.EJERSKAB_BEJBOLANV_SW =                
                       BQ78_AREA.VURD_015ANV_BEJBOLANV_SW;              
                       BQ78_AREA.EJERSKAB_CANVEBOL =                    
                       BQ78_AREA.VURD_015ANV_CANVEBOL;                  
                       BQ78_AREA.EJERSKAB_CBERGROP = 'G';               
                       BQ78_AREA.EJERSKAB_VURMARK =                     
                       BQ78_AREA.VURD_015ANV_VURMARK;                   
                       BQ78_AREA.EJERSKAB_JUR_KATEGO  =                 
                       BQ78_AREA.VURD_015ANY_JUR_KATEGO ;               
                       BQ78_AREA.EJERSKAB_JUR_UKATEGO =                 
                       BQ78_AREA.VURD_015ANY_JUR_UKATEGO;               
                       BQ78_AREA.EJERSKAB_JUR_VURDATO =                 
                       BQ78_AREA.VURD_015ANY_VURDATO    ;               
                       BQ78_AREA.EJERSKAB_FORSIGT_EVS =                 
                       BQ78_AREA.VURD_015ANY_FORSIGT_EVS;               
                       BQ78_AREA.EJERSKAB_BESKAT      =                 
                       BQ78_AREA.VURD_015ANY_BESKAT_EVS ;               
                  END;                                                  
                END; /* SELECT */                                       
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END;  /* SELECT */                                             
                                                                        
         SELECT;                                                        
           WHEN (BQ78_AREA.VURD_015ANV_NY_GL = 'N' &                    
                 BQ78_AREA.VURD_02ANV_NY_GL = 'N')                      
             DO;                                                        
               BQ78_AREA.EJERSKAB_CBERGRGLOP = 'N';                     
             END;                                                       
                                                                        
           WHEN (BQ78_AREA.VURD_015ANV_NY_GL = 'G' &                    
                 BQ78_AREA.VURD_02ANV_NY_GL = 'G')                      
             DO;                                                        
               BQ78_AREA.EJERSKAB_CBERGRGLOP = 'G';                     
             END;                                                       
                                                                        
           WHEN (BQ78_AREA.VURD_015ANV_NY_GL = 'N' &                    
                 BQ78_AREA.VURD_02ANV_NY_GL = ' ')                      
             DO;                                                        
               BQ78_AREA.EJERSKAB_CBERGRGLOP = 'N';                     
             END;                                                       
                                                                        
           WHEN (BQ78_AREA.VURD_015ANV_NY_GL = 'G' &                    
                 BQ78_AREA.VURD_02ANV_NY_GL = ' ')                      
             DO;                                                        
               BQ78_AREA.EJERSKAB_CBERGRGLOP = 'G';                     
             END;                                                       
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               BQ78_AREA.EJERSKAB_CBERGRGLOP = ' ';                     
             END;                                                       
         END; /* SELECT */                                              
                                                                        
         GEM_CEJBEVS = BQ78_AREA.TILEVS_CEJBEVS;                        
                                                                        
                                                                        
         // D92 hvis fejlnr=5193 må det ikke ændres                     
         IF BQ78_AREA.FEJLNR = 5193                                     
         THEN;                                                          
         ELSE DO;                                                       
              /* fejlnummer som opsat i BH84400 til 2 familiehuse */    
              /* de skal ikke ændres                              */    
                                                                        
              /*PUT SKIP LIST('BQ78_AREA.FEJLNR =',BQ78_AREA.FEJLNR);*/ 
                                                                        
              IF(/*BQ78_AREA.FEJLNR = 5185 ! Fjern kontrol på 5185 */   
                 BQ78_AREA.FEJLNR = 5186 !                              
                 BQ78_AREA.FEJLNR = 5187 !                              
                 BQ78_AREA.FEJLNR = 5007) &                             
                 BQ78_AREA.EENHEDLBNR > 0                               
              THEN    /*2familie fejlnr indtil videre samme behandling*/
                DO;                                                     
                  CALL OPSÆT_FEJLNR; /*SAMT CEJBEVS OG CBERGRL*/        
                  BQ78_AREA.EJENDOM_EJD_FEJLNR = BQ78_AREA.FEJLNR;      
                  /*SAMT CEJBEVS OG CBERGRL*/                           
                  CALL OPSÆT_PERSONLIGE_FEJLNR;                         
                END;                                                    
              ELSE    /* normal behandling */                           
                DO;                                                     
                  CALL OPSÆT_FEJLNR; /*SAMT CEJBEVS OG CBERGRL*/        
                  BQ78_AREA.EJENDOM_EJD_FEJLNR = BQ78_AREA.FEJLNR;      
                  /*SAMT CEJBEVS OG CBERGRL*/                           
                  CALL OPSÆT_PERSONLIGE_FEJLNR;                         
                END;                                                    
         END; // D92                                                    
                                                                        
        /* CEJBEVS lig  C og B skal ikke have nulstillet fejlnummer */  
        /* eller sat værdi tilbage fra GEM_CEJBEVS                  */  
                                                                        
     /*    IF GEM_CEJBEVS = '7' !          7,8,9,C rettelse             
            GEM_CEJBEVS = '8' !                                         
            GEM_CEJBEVS = '9'                                           
         THEN                                                           
            DO;                                                         
              BQ78_AREA.TILEVS_CEJBEVS = GEM_CEJBEVS;                   
                                                                        
              IF BQ76_AREA.CCIVS ^= 'D'                                 
              THEN                                                      
                CEJBEVS 7,8 OG 9 SKAL BEVARES  U D E N  FEJLNR.         
               BQ78_AREA.FEJLNR = 0;                                    
            END; */                                                     
                                                                        
         IF BQ78_AREA.TILEVS_C5060 = '5060' &                           
         (((BQ78_AREA.TILEVS_A_V_CBENYT = '03' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '04' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '23' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '24' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '31' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '33' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '43' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '44' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '49') &                       
            BQ78_AREA.FEJLNR = 5001) !                                  
   /*       ((BQ78_AREA.TILEVS_A_V_CBENYT = '09' ! Fjernet D1007     */ 
            ((BQ78_AREA.TILEVS_A_V_CBENYT = '17' !                      
            BQ78_AREA.TILEVS_A_V_CBENYT = '98') &                       
            BQ78_AREA.TILEVS_A_V_CVURDOPR = '1' &                       
            BQ78_AREA.FEJLNR = 5001) !                                  
           (BQ78_AREA.TILEVS_A_V_CBENYT = '45' &                        
            BQ78_AREA.FEJLNR = 5006) !                                  
          ((BQ78_AREA.TILEVS_A_V_CBENYT = '06' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '07' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '13' !                        
            BQ78_AREA.TILEVS_A_V_CBENYT = '34') &                       
            BQ78_AREA.FEJLNR = 5008))                                   
         THEN                                                           
            BQ78_AREA.FEJLNR = 5060; /* KRAVSPEC. 18-01-05 SLUT 2003 */ 
                                                                        
     /*    IF BQ78_AREA.TILEVS_CEJBEVS = '7' !                          
            BQ78_AREA.TILEVS_CEJBEVS = '8' !                            
            BQ78_AREA.TILEVS_CEJBEVS = '9' !                            
            BQ78_AREA.TILEVS_CEJBEVS = 'B' !   KS 02-23                 
            BQ78_AREA.TILEVS_CEJBEVS = 'C'     KS 02-23 */              
                                                                        
         IF BQ78_AREA.TILEVS_CEJBEVS = 'B'   /* 7,8,9,C pilles ud  IF */
         THEN;                                                          
         ELSE                                                           
            IF BQ78_AREA.FEJLNR = 0              /* DENNE EJENDOM KAN */
            THEN                             /* ÅBENBART BEREGNES */    
               BQ78_AREA.TILEVS_CEJBEVS = '0';                          
            ELSE                                                        
              IF BQ78_AREA.EKOMNR < 999 &                               
                 BQ78_AREA.TILEVS_CINVPNR = '0' &                       
                 BQ78_AREA.TILEVS_A_EJ_DCPRCIR > 0 &                    
                 BQ77_AREA.EVSSEJ_DCPRN > 0 &                           
                 BQ77_AREA.EVSSEJ_SID_CSLET < '1' &                     
                 BQ77_AREA.EVSSEJ_SID_DAFSTAA = 0 &                     
                 BQ77_AREA.EVSSEJ_SID_DFRAFLYT = 0 &                    
                (BQ77_AREA.EVSSEJ_SID_CEJBEVS = '0' !                   
                 BQ77_AREA.EVSSEJ_SID_CEJBEVS = '4' !                   
                 BQ77_AREA.EVSSEJ_SID_CEJBEVS = '5' !                   
                 BQ77_AREA.EVSSEJ_SID_CEJBEVS = '6') &                  
                 BQ78_AREA.TILEVS_CÆGTOPR < '1'                         
              THEN                           /* KAN MÅSKE BEREGNES */   
                 DO;                                                    
                   IF BQ78_AREA.FEJLNR = 5001 !                         
                      BQ78_AREA.FEJLNR = 5002 !                         
                      BQ78_AREA.FEJLNR = 5003 !                         
                      BQ78_AREA.FEJLNR = 5004 !                         
                      BQ78_AREA.FEJLNR = 5017 !                         
                      BQ78_AREA.FEJLNR = 5020 !                         
                      BQ78_AREA.FEJLNR = 5024 !                         
                      BQ78_AREA.FEJLNR = 5025 !                         
                      BQ78_AREA.FEJLNR = 5059 !                         
                      BQ78_AREA.FEJLNR = 5060 !                         
                    /*BQ78_AREA.FEJLNR = 5155 ! Fjern check på 5155*/   
                    /*BQ78_AREA.FEJLNR = 5164 ! Fjern check på 5164     
                                                SLUT 20 */              
                      BQ78_AREA.FEJLNR = 5180 !                         
                      BQ78_AREA.FEJLNR = 5181 !                         
                      BQ78_AREA.FEJLNR = 5184 !                         
                    /*BQ78_AREA.FEJLNR = 5185 ! Fjern check på 5185     
                                                KS02-23*/               
                      BQ78_AREA.FEJLNR = 5186 !   /* KS02-23*/          
                                                                        
                      BQ78_AREA.FEJLNR = 5187 !   /* KS02-23*/          
                      BQ78_AREA.FEJLNR = 5189 !   /* KS02-34*/          
                      BQ78_AREA.FEJLNR = 5195 !   /* KS02-34*/          
                      BQ78_AREA.FEJLNR = 5196 !   /* KS02-34*/          
                      BQ78_AREA.FEJLNR = 5197 !   /* KS02-34*/          
                      BQ78_AREA.FEJLNR = 5198 !   /* KS02-34*/          
                    /*BQ78_AREA.FEJLNR = 5200 ! Fjern check på 5200     
                                                SLUT 20 */              
                      BQ78_AREA.FEJLNR = 5204 !   /* SLUT 20 D735 */    
                      BQ78_AREA.FEJLNR = 5206 !   /* SLUT 20 */         
                      BQ78_AREA.EJERSKAB_BBERGRL_SW = -1 !              
                    ((BQ78_AREA.EJENDOM_CEJDTYPE = '4' !                
                      BQ78_AREA.EJENDOM_CEJDTYPE = '5') &               
                      BQ78_AREA.EJERSKAB_BBER2FAM_SW = -1)              
                   THEN;                                                
                   ELSE                                                 
                      DO;                                               
                         IF BQ78_AREA.SORT_CITYP = 0                    
                         THEN                                           
                           BQ78_AREA.TILEVS_CDATAFRA = ' ';             
                         ELSE                                           
                           DO;                                          
                             IF BQ77_AREA.EVSSEJ_SID_CDATAFRA = '1'     
                             THEN                                       
                               BQ78_AREA.TILEVS_CDATAFRA = '5';         
                             ELSE                                       
                               BQ78_AREA.TILEVS_CDATAFRA = '1';         
                           END;                                         
                         BQ78_AREA.TILEVS_CEJBEVS = '0';                
                         BQ78_AREA.FEJLNR = 0;                          
                      END;                                              
                 END;                                                   
                                                                        
         IF BQ78_AREA.TILEVS_C5060 = '5060' &                           
            BQ76_AREA.CCIVS  ^= 'D' &                                   
            BQ78_AREA.TILEVS_A_EJ_DCPRCIR > 0 &                         
            BQ77_AREA.EVSSEJ_DCPRN > 0 &                                
            BQ77_AREA.EVSSÆG_DCPRN = 0 &                                
            BQ75_AREA.EJER_DCPRCIR = 0 &                                
            BQ75_AREA.ÆGTE_DCPRCIR > 0 &                                
            BQ75_AREA.ÆGTE_FEJER = 1 &                                  
            BQ75_AREA.ÆGTE_DOVTG >= BQ76_AREA.DRGNÅRFRA &               
            BQ77_AREA.EVSSEJ_SID_GPCTEJER = 100 &                       
            BQ75_AREA.ÆGTE_GANE = 10000                                 
         THEN                                                           
            DO;                                                         
               BQ78_AREA.FEJLNR = 5060;                                 
               BQ78_AREA.TILEVS_CEJBEVS = '1';                          
            END;                                                        
                                                                        
         IF BQ78_AREA.EKOMNR < 999 &                                    
            BQ78_AREA.TILEVS_CEJBEVS = '0' &                            
            BQ78_AREA.TILEVS_A_EJ_DCPRCIR > 0  &                        
            BQ78_AREA.TILEVS_CINVPNR = '0'                              
         THEN                                                           
            DO;                                                         
               CALL UDFØR_KONTROLLER(BQ78_AREA.TILEVS_FEJLTAB1,         
                                     BQ78_AREA.TILEVS_FEJLTAB2,         
                                     BQ78_AREA.TILEVS_FEJLTAB3,         
                                     BQ78_AREA.TILEVS_FEJLTAB4,         
                                     BQ78_AREA.TILEVS_FEJLTAB5,         
                                     BQ78_AREA.TILEVS_FEJLTAB6,         
                                     BQ78_AREA.TILEVS_FEJLTAB7,         
                                     BQ78_AREA.TILEVS_FEJLTAB8,         
                                     BQ78_AREA.TILEVS_FEJLTAB9,         
                                     BQ78_AREA.TILEVS_FEJLTAB10,        
                                     BQ78_AREA.TILEVS_FEJLTAB11,        
                                     BQ78_AREA.TILEVS_FEJLTAB12);       
                                                                        
               BQ78_AREA.FEJLNR = BQ78_AREA.TILEVS_FEJLTAB1;            
                                                                        
               IF BQ78_AREA.FEJLNR > 0                                  
               THEN                                                     
                  BQ78_AREA.TILEVS_CEJBEVS = '3';                       
               ELSE                                                     
                  DO;                                                   
                     CALL FLYT_TILEVS_TIL_EVSBERTIL;                    
                     CALL FLYT_EJERSKAB_TIL_EVSBERTIL;                  
                     CALL BEREGN_EVS_KMD_DEL(EVS_BER);                  
                     CALL FLYT_EVSBERFRA_TIL_TILEVS;                    
                     CALL FLYT_EVSBERFRA_TIL_FRAEVS;                    
                  END;                                                  
            END;                                                        
                                                                        
      /* Sæt TILEVS_CEJBEVS tilbage til 7,8,9,C fra gemt_cermbevs.      
         Udskrivning af optællingerne sker i BH86024, sæt BNETTO = 0 */ 
      SELECT (GEM_CEJBEVS);                                             
        WHEN ('7','8','9','C')                                          
         DO;                                                            
           BH55600M.ANTAL789C = 1;                                      
                                                                        
           SELECT (GEM_CEJBEVS);                                        
             WHEN ('7')                                                 
              do;                                                       
                IF BQ78_AREA.FEJLNR = 0 THEN                            
                  BH55600M.CEJBEVS7 = 1;                                
                ELSE                                                    
                  BH55600M.CEJBEVS7_FEJL = 1;                           
              end;                                                      
             WHEN ('8')                                                 
              do;                                                       
                IF BQ78_AREA.FEJLNR = 0 THEN                            
                  BH55600M.CEJBEVS8 = 1;                                
                ELSE                                                    
                  BH55600M.CEJBEVS8_FEJL = 1;                           
              end;                                                      
             WHEN ('9')                                                 
              do;                                                       
                IF BQ78_AREA.FEJLNR = 0 THEN                            
                  BH55600M.CEJBEVS9 = 1;                                
                ELSE                                                    
                  BH55600M.CEJBEVS9_FEJL = 1;                           
              end;                                                      
             WHEN ('C')                                                 
              do;                                                       
                IF BQ78_AREA.FEJLNR = 0 THEN                            
                  BH55600M.CEJBEVSC = 1;                                
                ELSE                                                    
                  BH55600M.CEJBEVSC_FEJL = 1;                           
              end;                                                      
             OTHERWISE ;                                                
           END;                                                         
                                                                        
           BQ78_AREA.TILEVS_CEJBEVS = GEM_CEJBEVS;                      
           BQ78_AREA.FRA_EVS_SLUT_BER_BNETTO = 0;                       
           BQ78_AREA.FRA_EVS_SLUT_BER_BNETTO_SW = -1;                   
         END;                                                           
        OTHERWISE ;                                                     
      END;                                                              
 /*********************************************************************/
 /* FLYT FELTER FRA EVS_BER.FRA  til  BQ78.TIL_EVS                    */
 /*********************************************************************/
 FLYT_EVSBERFRA_TIL_TILEVS: PROC;                                       
                                                                        
      BQ78_AREA.TILEVS_BGLSUM1 = EVS_BER.FRA.BGLSUM1;                   
      BQ78_AREA.TILEVS_BGLSUM1_SW = EVS_BER.FRA.BGLSUM1_SW;             
      BQ78_AREA.TILEVS_BPENSNEDGL = EVS_BER.FRA.BPENSNEDGL;             
      BQ78_AREA.TILEVS_BPENSNEDGL_SW = EVS_BER.FRA.BPENSNEDGL_SW;       
      BQ78_AREA.TILEVS_BSTIBGR = EVS_BER.FRA.BSTIBEGR;                  
      BQ78_AREA.TILEVS_CBGLSUM1 = EVS_BER.FRA.CBGLSUM1;                 
      BQ78_AREA.TILEVS_CNEDSL2 = '';                                    
      BQ78_AREA.TILEVS_CSTIBLB = '';                                    
      BQ78_AREA.TILEVS_BSTIBGR = '';                                    
                                                                        
 END FLYT_EVSBERFRA_TIL_TILEVS;                                         
 /*********************************************************************/
 /* FLYT FELTER FRA EVS_BER.FRA  til  BQ78.FRA_EVS                    */
 /*********************************************************************/
 FLYT_EVSBERFRA_TIL_FRAEVS: PROC;                                       
                                                                        
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM1 = EVS_BER.FRA.BGRPROM1;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM1_SW = EVS_BER.FRA.BGRPROM1_SW; 
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM2 = EVS_BER.FRA.BGRPROM2;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM2_SW = EVS_BER.FRA.BGRPROM2_SW; 
      BQ78_AREA.FRA_EVS_SLUT_BER_BNEDSL1 = EVS_BER.FRA.BNEDSL1;         
      BQ78_AREA.FRA_EVS_SLUT_BER_BNEDSL1_SW = EVS_BER.FRA.BNEDSL1_SW;   
      BQ78_AREA.FRA_EVS_SLUT_BER_BNEDSL2 = EVS_BER.FRA.BNEDSL2;         
      BQ78_AREA.FRA_EVS_SLUT_BER_BNEDSL2_SW = EVS_BER.FRA.BNEDSL2_SW;   
      BQ78_AREA.FRA_EVS_SLUT_BER_BNETTO = EVS_BER.FRA.BNETTO;           
      BQ78_AREA.FRA_EVS_SLUT_BER_BNETTO_SW = EVS_BER.FRA.BNETTO_SW;     
      BQ78_AREA.FRA_EVS_SLUT_BER_BPENSNED = EVS_BER.FRA.BPENSNED;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BPENSNED_SW = EVS_BER.FRA.BPENSNED_SW; 
      BQ78_AREA.FRA_EVS_SLUT_BER_BPENSNÆ = EVS_BER.FRA.BPENSNÆ;         
      BQ78_AREA.FRA_EVS_SLUT_BER_BPENSNÆ_SW = EVS_BER.FRA.BPENSNÆ_SW;   
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM1 = EVS_BER.FRA.BGRPROM1;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM1_SW = EVS_BER.FRA.BGRPROM1_SW; 
      BQ78_AREA.FRA_EVS_SLUT_BER_BPROM1 = EVS_BER.FRA.BPROM1;           
      BQ78_AREA.FRA_EVS_SLUT_BER_BPROM1_SW = EVS_BER.FRA.BPROM1_SW;     
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM2    = EVS_BER.FRA.BGRPROM2;    
      BQ78_AREA.FRA_EVS_SLUT_BER_BGRPROM2_SW = EVS_BER.FRA.BGRPROM2_SW; 
      BQ78_AREA.FRA_EVS_SLUT_BER_BPROM2      = EVS_BER.FRA.BPROM2;      
      BQ78_AREA.FRA_EVS_SLUT_BER_BPROM2_SW   = EVS_BER.FRA.BPROM2_SW;   
                                                                        
      BQ78_AREA.FRA_EVS_SLUT_BER_BSTIBEGR = EVS_BER.FRA.BSTIBEGR;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BSTIBEGR_SW = EVS_BER.FRA.BSTIBEGR_SW; 
      BQ78_AREA.FRA_EVS_SLUT_BER_BSTITIL = EVS_BER.FRA.BSTITIL;         
      BQ78_AREA.FRA_EVS_SLUT_BER_BSTITIL_SW = EVS_BER.FRA.BSTITIL_SW;   
      BQ78_AREA.FRA_EVS_SLUT_BER_BSUM1 = EVS_BER.FRA.BSUM1;             
      BQ78_AREA.FRA_EVS_SLUT_BER_BSUM1_SW = EVS_BER.FRA.BSUM1_SW;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BSUM2 = EVS_BER.FRA.BSUM2;             
      BQ78_AREA.FRA_EVS_SLUT_BER_BSUM2_SW = EVS_BER.FRA.BSUM2_SW;       
      BQ78_AREA.FRA_EVS_SLUT_BER_BSUM3 = EVS_BER.FRA.BSUM3;             
      BQ78_AREA.FRA_EVS_SLUT_BER_BSUM3_SW = EVS_BER.FRA.BSUM3_SW;       
      BQ78_AREA.FRA_EVS_SLUT_BER_CNEDSL2 = EVS_BER.FRA.CNEDSL2;         
      BQ78_AREA.FRA_EVS_SLUT_BER_CSTIBLB = EVS_BER.FRA.CSTIBLB;         
                                                                        
 END FLYT_EVSBERFRA_TIL_FRAEVS;                                         
 /*********************************************************************/
 /* Slå sammen til 1 proc                                             */
 /* FLYT FELTER FRA BQ78.TIL_EVS  til  EVS_BER.TIL                    */
 /*********************************************************************/
 FLYT_TILEVS_TIL_EVSBERTIL: PROC;                                       
                                                                        
      EVS_BER = '';                                                     
                                                                        
      EVS_BER.TIL.BBER2FAM = BQ78_AREA.TILEVS_BBER2FAM;                 
      EVS_BER.TIL.BBER2FAM_SW = BQ78_AREA.TILEVS_BBER2FAM_SW;           
      EVS_BER.TIL.BBERGRL = BQ78_AREA.TILEVS_BBERGRL;                   
      EVS_BER.TIL.BBERGRL_SW = BQ78_AREA.TILEVS_BBERGRL_SW;             
      EVS_BER.TIL.BEVSGL = BQ78_AREA.TILEVS_BEVSGL;                     
      EVS_BER.TIL.BEVSGL_SW = BQ78_AREA.TILEVS_BEVSGL_SW;               
      EVS_BER.TIL.BFASTSTIGBGR = BQ78_AREA.TILEVS_BFASTSTIGBGR;         
      EVS_BER.TIL.BFASTSTIGBGR_SW = BQ78_AREA.TILEVS_BFASTSTIGBGR_SW;   
      EVS_BER.TIL.BPENSNÆGL = BQ78_AREA.TILEVS_BPENSNÆGL;               
      EVS_BER.TIL.BPENSNÆGL_SW = BQ78_AREA.TILEVS_BPENSNÆGL_SW;         
      EVS_BER.TIL.CNEDSL1 = BQ78_AREA.TILEVS_CNEDSL1;                   
      EVS_BER.TIL.CPTYPGL = BQ78_AREA.TILEVS_CPTYPGL;                   
      EVS_BER.TIL.CPTYPSLUT = BQ78_AREA.TILEVS_CPTYPSLUT;               
      EVS_BER.TIL.FELT759 = BQ78_AREA.TILEVS_FELT759;                   
      EVS_BER.TIL.FELT760 = BQ78_AREA.TILEVS_CFRED;                     
      EVS_BER.TIL.CEJDTYPE_AKT = BQ78_AREA.EJERSKAB_CEJDTYPE_AKT;       
      EVS_BER.TIL.CEJBEVS      =  BQ78_AREA.TILEVS_CEJBEVS;             
      EVS_BER.TIL.CEJBEVS_ANDEN_ENHED = HENT_CEJBEVS_ANDEN_ENHED;       
                                                                        
 END FLYT_TILEVS_TIL_EVSBERTIL;                                         
 /*********************************************************************/
 /* FLYT FELTER FRA BQ78.EJERSKAB  til  EVS_BER.TIL                   */
 /*********************************************************************/
 FLYT_EJERSKAB_TIL_EVSBERTIL: PROC;                                     
                                                                        
      EVS_BER.TIL.BBER2FAM = BQ78_AREA.EJERSKAB_BBER2FAM;               
      EVS_BER.TIL.BBER2FAM_SW = BQ78_AREA.EJERSKAB_BBER2FAM_SW;         
      EVS_BER.TIL.BBERGRL = BQ78_AREA.EJERSKAB_BBERGRL;                 
      EVS_BER.TIL.BBERGRL_SW = BQ78_AREA.EJERSKAB_BBERGRL_SW;           
      EVS_BER.TIL.CEJDTYPE_AKT = BQ78_AREA.EJERSKAB_CEJDTYPE_AKT;       
                                                                        
 END FLYT_EJERSKAB_TIL_EVSBERTIL;                                       
 /********************************************************************/ 
 /* HENT BEREGNINGSKODE PÅ ANDEN ENHED FOR EJER AF 2FAMILIHUS        */ 
 /* FOR PERIODEN (ANGIVET VED SORTDATO)                              */ 
 /********************************************************************/ 
 HENT_CEJBEVS_ANDEN_ENHED:PROC RETURNS(CHAR(1));                        
                                                                        
   DCL HJCEJBEVS_ANDEN_ENHED CHAR(1);                                   
                                                                        
   HJCEJBEVS_ANDEN_ENHED = ' ';                                         
                                                                        
   EXEC SQL                                                             
      SELECT                                                            
          TILEVS_CEJBEVS                                                
        INTO                                                            
          :HJCEJBEVS_ANDEN_ENHED                                        
                                                                        
      FROM BQ78000T                                                     
      WHERE TIL_EVS_AAR     = :BQ78_AREA.TIL_EVS_AAR                    
        AND   DCPRN         = :BQ78_AREA.DCPRN                          
        AND   AFVIKLINGS_ID = :BQ78_AREA.AFVIKLINGS_ID                  
        AND   DATA_ID       = :BQ78_AREA.DATA_ID                        
        AND   EKOMNR        = :BQ78_AREA.EKOMNR                         
        AND   EEJDNR        = :BQ78_AREA.EEJDNR                         
        AND   EENHEDLBNR    <> :BQ78_AREA.EENHEDLBNR                    
        AND   SORT_DATO     = :BQ78_AREA.SORT_DATO;                     
                                                                        
      SELECT(SQLCA.SQLCODE);                                            
         WHEN(0)                                                        
           DO;                                                          
           END;                                                         
         WHEN(100)                                                      
           DO;                                                          
           END;                                                         
         WHEN(-811)                                                     
           DO;                                                          
             PUT SKIP LIST('FOR MANGE RESULTATER');                     
           END;                                                         
         OTHERWISE DO;                                                  
           ABENDTXT = '101 SELECT ANDEN ENHED BQ78000T';                
           CALL SQL_FEJL;                                               
         END;                                                           
      END;                                                              
                                                                        
   RETURN(HJCEJBEVS_ANDEN_ENHED);                                       
                                                                        
 END HENT_CEJBEVS_ANDEN_ENHED;                                          
 /*********************************************************************/
 /*      VÆLG BEREGNINGSGRUNDLAG 2002 FOR 'NYE EJERE'                 */
 /*********************************************************************/
 OPSÆT_02ANV_NY: PROC;                                                  
                                                                        
         SELECT;                                                        
                                                                        
           WHEN (BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ')                  
             DO;                                                        
                CALL FLYT_VURD_02OMNY_TIL_02ANV;                        
                BQ78_AREA.VURD_02ANV_NY_GL = 'N'; /* OMBEREGN NY EJER */
             END;                                                       
                                                                        
           WHEN (BQ78_AREA.VURD_02_CBENYT ^= '  ')                      
             DO;                                                        
                CALL FLYT_VURD_02_TIL_02ANV;                            
                BQ78_AREA.VURD_02ANV_NY_GL = ' '; /* ÅRSVURDERING */    
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
 END OPSÆT_02ANV_NY;                                                    
 /*********************************************************************/
 /*      VÆLG BEREGNINGSGRUNDLAG 2002 FOR 'ØVRIGE EJERE'              */
 /*********************************************************************/
 OPSÆT_02ANV_ØVR: PROC;                                                 
                                                                        
         SELECT;                                                        
           WHEN (BQ78_AREA.VURD_02OM_CBENYT ^= '  ')                    
             DO;                                                        
                CALL FLYT_VURD_02OM_TIL_02ANV;                          
                                                                        
                IF BQ78_AREA.VURD_02OMNY_CBENYT ^= '  ' &               
                   BQ78_AREA.VURD_02OM_CBENYT ^= '  '                   
                THEN                                                    
                   BQ78_AREA.VURD_02ANV_NY_GL = 'G';                    
                                        /*OMBEREGN ØVR EJERE*/          
                ELSE                                                    
                   BQ78_AREA.VURD_02ANV_NY_GL = ' ';                    
             END;                                                       
           WHEN (BQ78_AREA.VURD_02_CBENYT ^= '  ')                      
             DO;                                                        
                CALL FLYT_VURD_02_TIL_02ANV;                            
                BQ78_AREA.VURD_02ANV_NY_GL = ' '; /* ÅRSVURDERING */    
             END;                                                       
           OTHERWISE;                                                   
         END; /* SELECT */                                              
 END OPSÆT_02ANV_ØVR;                                                   
 /*********************************************************************/
 /*      VÆLG BEREGNINGSGRUNDLAG 2001+5% FOR 'NYE EJERE'              */
 /*********************************************************************/
 OPSÆT_015ANV_NY: PROC;                                                 
                                                                        
         SELECT;                                                        
           WHEN (BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ')                  
             DO;                                                        
                CALL FLYT_VURD_01OMNY_TIL_015ANV;                       
                BQ78_AREA.VURD_015ANV_NY_GL = 'N';                      
                                      /* OMBEREGN NY EJER */            
             END;                                                       
                                                                        
           WHEN (BQ78_AREA.VURD_015PCT_CBENYT ^= '  ')                  
             DO;                                                        
                CALL FLYT_VURD_015PCT_TIL_015ANV;                       
                BQ78_AREA.VURD_015ANV_NY_GL = ' '; /* ÅRSVURDERING */   
             END;                                                       
                                                                        
           OTHERWISE;                                                   
         END; /* SELECT */                                              
                                                                        
 END OPSÆT_015ANV_NY;                                                   
 /*********************************************************************/
 /*      VÆLG BEREGNINGSGRUNDLAG 2001+5% FOR 'ØVRIGE EJERE'           */
 /*********************************************************************/
 OPSÆT_015ANV_ØVR: PROC;                                                
                                                                        
         SELECT;                                                        
           WHEN (BQ78_AREA.VURD_01OM_CBENYT ^= '  ')                    
             DO;                                                        
                CALL FLYT_VURD_01OM_TIL_015ANV;                         
                IF BQ78_AREA.VURD_01OMNY_CBENYT ^= '  ' &               
                   BQ78_AREA.VURD_01OM_CBENYT ^= '  '                   
                THEN                                                    
                   BQ78_AREA.VURD_015ANV_NY_GL = 'G';                   
                                     /*OMBEREGN ØVR EJERE*/             
                ELSE                                                    
                   BQ78_AREA.VURD_015ANV_NY_GL = ' ';                   
             END;                                                       
                                                                        
           WHEN (BQ78_AREA.VURD_015PCT_CBENYT ^= '  ')                  
             DO;                                                        
                CALL FLYT_VURD_015PCT_TIL_015ANV;                       
                BQ78_AREA.VURD_015ANV_NY_GL = ' '; /* ÅRSVURDERING */   
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
 END OPSÆT_015ANV_ØVR;                                                  
 /*********************************************************************/
 /* FLYT VALGTE VURDERING TIL ANVENDT VURDERING                       */
 /*********************************************************************/
 FLYT_VURD_02_TIL_02ANV: PROC;                                          
                                                                        
         BQ78_AREA.VURD_02ANV_CBENYT = BQ78_AREA.VURD_02_CBENYT;        
         BQ78_AREA.VURD_02ANV_FLEJL = BQ78_AREA.VURD_02_FLEJL;          
         BQ78_AREA.VURD_02ANV_BEJDVÆR = BQ78_AREA.VURD_02_BEJDVÆR;      
         BQ78_AREA.VURD_02ANV_BEJDVÆR_SW = BQ78_AREA.VURD_02_BEJDVÆR_SW;
         BQ78_AREA.VURD_02ANV_CEJERL = BQ78_AREA.VURD_02_CEJERL;        
         BQ78_AREA.VURD_02ANV_BEJBOL1 = BQ78_AREA.VURD_02_BEJBOL1;      
         BQ78_AREA.VURD_02ANV_BEJBOL1_SW = BQ78_AREA.VURD_02_BEJBOL1_SW;
         BQ78_AREA.VURD_02ANV_CEJBOLTYP1 = BQ78_AREA.VURD_02_CEJBOLTYP1;
         BQ78_AREA.VURD_02ANV_BEJBOL2 = BQ78_AREA.VURD_02_BEJBOL2;      
         BQ78_AREA.VURD_02ANV_BEJBOL2_SW = BQ78_AREA.VURD_02_BEJBOL2_SW;
         BQ78_AREA.VURD_02ANV_CEJBOLTYP2 = BQ78_AREA.VURD_02_CEJBOLTYP2;
         BQ78_AREA.VURD_02ANV_BEJBOLANV = BQ78_AREA.VURD_02_BEJBOLANV;  
         BQ78_AREA.VURD_02ANV_BEJBOLANV_SW =                            
                                        BQ78_AREA.VURD_02_BEJBOLANV_SW; 
         BQ78_AREA.VURD_02ANV_CANVEBOL = BQ78_AREA.VURD_02_CANVEBOL;    
         BQ78_AREA.VURD_02ANV_BOPÆLSKOD = BQ78_AREA.VURD_02_BOPÆLSKOD;  
         BQ78_AREA.VURD_02ANV_CEJDTYPE = BQ78_AREA.VURD_02_CEJDTYPE;    
         BQ78_AREA.VURD_02ANV_CBERGRL = BQ78_AREA.VURD_02_CBERGRL;      
         BQ78_AREA.VURD_02ANV_BBERGRL = BQ78_AREA.VURD_02_BBERGRL;      
         BQ78_AREA.VURD_02ANV_BBERGRL_SW = BQ78_AREA.VURD_02_BBERGRL_SW;
         BQ78_AREA.VURD_02ANV_BBER2FAM = BQ78_AREA.VURD_02_BBER2FAM;    
         BQ78_AREA.VURD_02ANV_BBER2FAM_SW =                             
                                         BQ78_AREA.VURD_02_BBER2FAM_SW; 
                                                                        
         /* nye felter 2021, D881 */                                    
         BQ78_AREA.VURD_02ANV_VURMARK =                                 
                                  BQ75_AREA.OPL_VURD02_VURMARK;         
         BQ78_AREA.VURD_02ANY_JUR_KATEGO =                              
                                  BQ78_AREA.VURD_02_JUR_KATEGO;         
         BQ78_AREA.VURD_02ANY_JUR_UKATEGO =                             
                                  BQ78_AREA.VURD_02_JUR_UKATEGO;        
         BQ78_AREA.VURD_02ANY_VURDATO =                                 
                                  BQ78_AREA.VURD_02_VURDATO;            
         BQ78_AREA.VURD_02ANY_FORSIGT_EVS =                             
                                  BQ78_AREA.VURD_02_FORSIGT_EVS;        
         BQ78_AREA.VURD_02ANY_BESKAT_EVS =                              
                                  BQ78_AREA.VURD_02_BESKAT_EVS;         
                                                                        
         BQ78_AREA.VURD_02ANV_NY_GL = ' ';                              
                                                                        
 END FLYT_VURD_02_TIL_02ANV;                                            
 /*********************************************************************/
 /* FLYT VALGTE VURDERING TIL ANVENDT VURDERING                       */
 /*********************************************************************/
 FLYT_VURD_01OM_TIL_015ANV: PROC;                                       
                                                                        
         BQ78_AREA.VURD_015ANV_CBENYT = BQ78_AREA.VURD_01OM_CBENYT;     
         BQ78_AREA.VURD_015ANV_FLEJL = BQ78_AREA.VURD_01OM_FLEJL;       
         BQ78_AREA.VURD_015ANV_BEJDVÆR = BQ78_AREA.VURD_01OM_BEJDVÆR;   
         BQ78_AREA.VURD_015ANV_BEJDVÆR_SW =                             
                                       BQ78_AREA.VURD_01OM_BEJDVÆR_SW;  
         BQ78_AREA.VURD_015ANV_CEJERL = BQ78_AREA.VURD_01OM_CEJERL;     
         BQ78_AREA.VURD_015ANV_BEJBOL1 = BQ78_AREA.VURD_01OM_BEJBOL1;   
         BQ78_AREA.VURD_015ANV_BEJBOL1_SW =                             
                                       BQ78_AREA.VURD_01OM_BEJBOL1_SW;  
         BQ78_AREA.VURD_015ANV_CEJBOLTYP1 =                             
                                         BQ78_AREA.VURD_01OM_CEJBOLTYP1;
         BQ78_AREA.VURD_015ANV_BEJBOL2 = BQ78_AREA.VURD_01OM_BEJBOL2;   
         BQ78_AREA.VURD_015ANV_BEJBOL2_SW =                             
                                        BQ78_AREA.VURD_01OM_BEJBOL2_SW; 
         BQ78_AREA.VURD_015ANV_CEJBOLTYP2 =                             
                                        BQ78_AREA.VURD_01OM_CEJBOLTYP2; 
         BQ78_AREA.VURD_015ANV_BEJBOLANV =                              
                                        BQ78_AREA.VURD_01OM_BEJBOLANV;  
         BQ78_AREA.VURD_015ANV_BEJBOLANV_SW =                           
                                     BQ78_AREA.VURD_01OM_BEJBOLANV_SW;  
         BQ78_AREA.VURD_015ANV_CANVEBOL = BQ78_AREA.VURD_01OM_CANVEBOL; 
         BQ78_AREA.VURD_015ANV_BOPÆLSKOD =                              
         BQ78_AREA.VURD_01OM_BOPÆLSKOD;                                 
         BQ78_AREA.VURD_015ANV_CEJDTYPE = BQ78_AREA.VURD_01OM_CEJDTYPE; 
         BQ78_AREA.VURD_015ANV_CBERGRL = BQ78_AREA.VURD_01OM_CBERGRL;   
         BQ78_AREA.VURD_015ANV_BBERGRL = BQ78_AREA.VURD_01OM_BBERGRL;   
         BQ78_AREA.VURD_015ANV_BBERGRL_SW =                             
                                        BQ78_AREA.VURD_01OM_BBERGRL_SW; 
         BQ78_AREA.VURD_015ANV_BBER2FAM = BQ78_AREA.VURD_01OM_BBER2FAM; 
         BQ78_AREA.VURD_015ANV_BBER2FAM_SW =                            
                                        BQ78_AREA.VURD_01OM_BBER2FAM_SW;
                                                                        
         /* nye felter 2021, D881 */                                    
         BQ78_AREA.VURD_015ANV_VURMARK =                                
                                  BQ75_AREA.OPL_VURMARK;                
         BQ78_AREA.VURD_015ANY_JUR_KATEGO =                             
                                  BQ78_AREA.VURD_01OM_JUR_KATEGO;       
         BQ78_AREA.VURD_015ANY_JUR_UKATEGO =                            
                                  BQ78_AREA.VURD_01OM_JUR_UKATEGO;      
         BQ78_AREA.VURD_015ANY_VURDATO =                                
                                  BQ78_AREA.VURD_01OM_VURDATO;          
         BQ78_AREA.VURD_015ANY_FORSIGT_EVS =                            
                                  BQ78_AREA.VURD_01OM_FORSIGT_EVS;      
         BQ78_AREA.VURD_015ANY_BESKAT_EVS =                             
                                  BQ78_AREA.VURD_01OM_BESKAT_EVS;       
                                                                        
         BQ78_AREA.VURD_015ANV_NY_GL = ' ';                             
                                                                        
 END FLYT_VURD_01OM_TIL_015ANV;                                         
 /*********************************************************************/
 /* FLYT VALGTE VURDERING TIL ANVENDT VURDERING                       */
 /*********************************************************************/
 FLYT_VURD_01OMNY_TIL_015ANV: PROC;                                     
                                                                        
         BQ78_AREA.VURD_015ANV_CBENYT = BQ78_AREA.VURD_01OMNY_CBENYT;   
         BQ78_AREA.VURD_015ANV_FLEJL = BQ78_AREA.VURD_01OMNY_FLEJL;     
         BQ78_AREA.VURD_015ANV_BEJDVÆR = BQ78_AREA.VURD_01OMNY_BEJDVÆR; 
         BQ78_AREA.VURD_015ANV_BEJDVÆR_SW =                             
                                   BQ78_AREA.VURD_01OMNY_BEJDVÆR_SW;    
         BQ78_AREA.VURD_015ANV_CEJERL = BQ78_AREA.VURD_01OMNY_CEJERL;   
         BQ78_AREA.VURD_015ANV_BEJBOL1 = BQ78_AREA.VURD_01OMNY_BEJBOL1; 
         BQ78_AREA.VURD_015ANV_BEJBOL1_SW =                             
                                   BQ78_AREA.VURD_01OMNY_BEJBOL1_SW;    
         BQ78_AREA.VURD_015ANV_CEJBOLTYP1 =                             
                                   BQ78_AREA.VURD_01OMNY_CEJBOLTYP1;    
         BQ78_AREA.VURD_015ANV_BEJBOL2 = BQ78_AREA.VURD_01OMNY_BEJBOL2; 
         BQ78_AREA.VURD_015ANV_BEJBOL2_SW =                             
                                   BQ78_AREA.VURD_01OMNY_BEJBOL2_SW;    
         BQ78_AREA.VURD_015ANV_CEJBOLTYP2 =                             
                                   BQ78_AREA.VURD_01OMNY_CEJBOLTYP2;    
         BQ78_AREA.VURD_015ANV_BEJBOLANV =                              
                                   BQ78_AREA.VURD_01OMNY_BEJBOLANV;     
         BQ78_AREA.VURD_015ANV_BEJBOLANV_SW =                           
                                   BQ78_AREA.VURD_01OMNY_BEJBOLANV_SW;  
         BQ78_AREA.VURD_015ANV_CANVEBOL =                               
                                   BQ78_AREA.VURD_01OMNY_CANVEBOL;      
         BQ78_AREA.VURD_015ANV_BOPÆLSKOD =                              
                                   BQ78_AREA.VURD_01OMNY_BOPÆLSKOD;     
         BQ78_AREA.VURD_015ANV_CEJDTYPE =                               
                                   BQ78_AREA.VURD_01OMNY_CEJDTYPE;      
         BQ78_AREA.VURD_015ANV_CBERGRL = BQ78_AREA.VURD_01OMNY_CBERGRL; 
         BQ78_AREA.VURD_015ANV_BBERGRL = BQ78_AREA.VURD_01OMNY_BBERGRL; 
         BQ78_AREA.VURD_015ANV_BBERGRL_SW =                             
                                   BQ78_AREA.VURD_01OMNY_BBERGRL_SW;    
         BQ78_AREA.VURD_015ANV_BBER2FAM =                               
                                   BQ78_AREA.VURD_01OMNY_BBER2FAM;      
         BQ78_AREA.VURD_015ANV_BBER2FAM_SW =                            
                                   BQ78_AREA.VURD_01OMNY_BBER2FAM_SW;   
                                                                        
         /* nye felter 2021, D881 */                                    
         BQ78_AREA.VURD_015ANV_VURMARK =                                
                                  BQ75_AREA.OPL_VURMARK;                
         BQ78_AREA.VURD_015ANY_JUR_KATEGO =                             
                                  BQ78_AREA.VURD_01OMNY_JUR_KATEGO;     
         BQ78_AREA.VURD_015ANY_JUR_UKATEGO =                            
                                  BQ78_AREA.VURD_01OMNY_JUR_UKATEGO;    
         BQ78_AREA.VURD_015ANY_VURDATO =                                
                                  BQ78_AREA.VURD_01OMNY_VURDATO;        
         BQ78_AREA.VURD_015ANY_FORSIGT_EVS =                            
                                  BQ78_AREA.VURD_01OMNY_FORSIGT_EVS;    
         BQ78_AREA.VURD_015ANY_BESKAT_EVS =                             
                                  BQ78_AREA.VURD_01OMNY_BESKAT_EVS;     
                                                                        
         BQ78_AREA.VURD_015ANV_NY_GL = ' ';                             
                                                                        
 END FLYT_VURD_01OMNY_TIL_015ANV;                                       
 /*********************************************************************/
 /* FLYT VALGTE VURDERING TIL ANVENDT VURDERING                       */
 /*********************************************************************/
 FLYT_VURD_015PCT_TIL_015ANV: PROC;                                     
                                                                        
         BQ78_AREA.VURD_015ANV_CBENYT = BQ78_AREA.VURD_015PCT_CBENYT;   
         BQ78_AREA.VURD_015ANV_FLEJL = BQ78_AREA.VURD_015PCT_FLEJL;     
         BQ78_AREA.VURD_015ANV_BEJDVÆR = BQ78_AREA.VURD_015PCT_BEJDVÆR; 
         BQ78_AREA.VURD_015ANV_BEJDVÆR_SW =                             
                                  BQ78_AREA.VURD_015PCT_BEJDVÆR_SW;     
         BQ78_AREA.VURD_015ANV_CEJERL = BQ78_AREA.VURD_015PCT_CEJERL;   
         BQ78_AREA.VURD_015ANV_BEJBOL1 = BQ78_AREA.VURD_015PCT_BEJBOL1; 
         BQ78_AREA.VURD_015ANV_BEJBOL1_SW =                             
                                  BQ78_AREA.VURD_015PCT_BEJBOL1_SW;     
         BQ78_AREA.VURD_015ANV_CEJBOLTYP1 =                             
                                  BQ78_AREA.VURD_015PCT_CEJBOLTYP1;     
         BQ78_AREA.VURD_015ANV_BEJBOL2 = BQ78_AREA.VURD_015PCT_BEJBOL2; 
         BQ78_AREA.VURD_015ANV_BEJBOL2_SW =                             
                                  BQ78_AREA.VURD_015PCT_BEJBOL2_SW;     
         BQ78_AREA.VURD_015ANV_CEJBOLTYP2 =                             
                                  BQ78_AREA.VURD_015PCT_CEJBOLTYP2;     
         BQ78_AREA.VURD_015ANV_BEJBOLANV =                              
                                  BQ78_AREA.VURD_015PCT_BEJBOLANV;      
         BQ78_AREA.VURD_015ANV_BEJBOLANV_SW =                           
                                  BQ78_AREA.VURD_015PCT_BEJBOLANV_SW;   
         BQ78_AREA.VURD_015ANV_CANVEBOL =                               
                                  BQ78_AREA.VURD_015PCT_CANVEBOL;       
         BQ78_AREA.VURD_015ANV_BOPÆLSKOD =                              
                                  BQ78_AREA.VURD_015PCT_BOPÆLSKOD;      
         BQ78_AREA.VURD_015ANV_CEJDTYPE =                               
                                  BQ78_AREA.VURD_015PCT_CEJDTYPE;       
         BQ78_AREA.VURD_015ANV_CBERGRL =                                
                                  BQ78_AREA.VURD_015PCT_CBERGRL;        
         BQ78_AREA.VURD_015ANV_BBERGRL = BQ78_AREA.VURD_015PCT_BBERGRL; 
         BQ78_AREA.VURD_015ANV_BBERGRL_SW =                             
                                  BQ78_AREA.VURD_015PCT_BBERGRL_SW;     
         BQ78_AREA.VURD_015ANV_BBER2FAM =                               
                                  BQ78_AREA.VURD_015PCT_BBER2FAM;       
         BQ78_AREA.VURD_015ANV_BBER2FAM_SW =                            
                                  BQ78_AREA.VURD_015PCT_BBER2FAM_SW;    
         /* nye felter 2021, D881 */                                    
         BQ78_AREA.VURD_015ANV_VURMARK =                                
                                  BQ75_AREA.OPL_VURD01_VURMARK;         
         BQ78_AREA.VURD_015ANY_JUR_KATEGO =                             
                                  BQ78_AREA.VURD_015PCT_JUR_KATEGO;     
         BQ78_AREA.VURD_015ANY_JUR_UKATEGO =                            
                                  BQ78_AREA.VURD_015PCT_JUR_UKATEGO;    
         BQ78_AREA.VURD_015ANY_VURDATO =                                
                                  BQ78_AREA.VURD_015PCT_VURDATO;        
         BQ78_AREA.VURD_015ANY_FORSIGT_EVS =                            
                                  BQ78_AREA.VURD_015PCT_FORSIGT_EVS;    
         BQ78_AREA.VURD_015ANY_BESKAT_EVS =                             
                                  BQ78_AREA.VURD_015PCT_BESKAT_EVS;     
                                                                        
         BQ78_AREA.VURD_015ANV_NY_GL = ' ';                             
                                                                        
         /* Defect 256 Forskud 2020*/                                   
         /* Hvis der ikke findes aktuel vurdering i ESR så opsættes  */ 
         /* 2001 grundlag uden +5%. Disse grundlag skal nulstilles   */ 
         /* Det skal ikke ske ved omberegning                        */ 
         /* Kode ændret i forbindelse med variabel vurderingsår ##EBD */
         IF  (BQ78_AREA.TILEVS_A_V_CBENYT = '  ' !                      
             (BQ78_AREA.TILEVS_A_V_DVURDÅR ^= BH55600M.GLSLUTÅR1 &      
              BQ78_AREA.TILEVS_A_V_DVURDÅR ^= BH55600M.INDKÅR1)) &      
             BQ75_AREA.OPL_VUR2001 = 'N'                                
         THEN                                                           
           DO;                                                          
             BQ78_AREA.VURD_015ANV_BEJDVÆR     = 0;                     
             BQ78_AREA.VURD_015ANV_BEJDVÆR_SW  = -1;                    
             BQ78_AREA.VURD_015ANV_BBER2FAM    = 0;                     
             BQ78_AREA.VURD_015ANV_BBER2FAM_SW = -1;                    
             BQ78_AREA.VURD_015ANV_BBERGRL = 0;                         
             BQ78_AREA.VURD_015ANV_BBERGRL_SW = -1;                     
             BQ78_AREA.VURD_015ANV_CBERGRL = '9';                       
             BQ78_AREA.VURD_015ANV_BEJBOLANV = 0;                       
             BQ78_AREA.VURD_015ANV_BEJBOLANV_SW = -1;                   
             BQ78_AREA.VURD_015ANV_CANVEBOL = ' ';                      
           END;                                                         
                                                                        
 END FLYT_VURD_015PCT_TIL_015ANV;                                       
 /*********************************************************************/
 /* FLYT VALGTE VURDERING TIL ANVENDT VURDERING                       */
 /*********************************************************************/
 FLYT_VURD_02OM_TIL_02ANV: PROC;                                        
                                                                        
         BQ78_AREA.VURD_02ANV_CBENYT = BQ78_AREA.VURD_02OM_CBENYT;      
         BQ78_AREA.VURD_02ANV_FLEJL = BQ78_AREA.VURD_02OM_FLEJL;        
         BQ78_AREA.VURD_02ANV_BEJDVÆR = BQ78_AREA.VURD_02OM_BEJDVÆR;    
         BQ78_AREA.VURD_02ANV_BEJDVÆR_SW =                              
                                  BQ78_AREA.VURD_02OM_BEJDVÆR_SW;       
         BQ78_AREA.VURD_02ANV_CEJERL = BQ78_AREA.VURD_02OM_CEJERL;      
         BQ78_AREA.VURD_02ANV_BEJBOL1 = BQ78_AREA.VURD_02OM_BEJBOL1;    
         BQ78_AREA.VURD_02ANV_BEJBOL1_SW =                              
                                  BQ78_AREA.VURD_02OM_BEJBOL1_SW;       
         BQ78_AREA.VURD_02ANV_CEJBOLTYP1 =                              
                                  BQ78_AREA.VURD_02OM_CEJBOLTYP1;       
         BQ78_AREA.VURD_02ANV_BEJBOL2 = BQ78_AREA.VURD_02OM_BEJBOL2;    
         BQ78_AREA.VURD_02ANV_BEJBOL2_SW =                              
                                  BQ78_AREA.VURD_02OM_BEJBOL2_SW;       
         BQ78_AREA.VURD_02ANV_CEJBOLTYP2 =                              
                                  BQ78_AREA.VURD_02OM_CEJBOLTYP2;       
         BQ78_AREA.VURD_02ANV_BEJBOLANV = BQ78_AREA.VURD_02OM_BEJBOLANV;
         BQ78_AREA.VURD_02ANV_BEJBOLANV_SW =                            
                                  BQ78_AREA.VURD_02OM_BEJBOLANV_SW;     
         BQ78_AREA.VURD_02ANV_CANVEBOL = BQ78_AREA.VURD_02OM_CANVEBOL;  
         BQ78_AREA.VURD_02ANV_BOPÆLSKOD = BQ78_AREA.VURD_02OM_BOPÆLSKOD;
         BQ78_AREA.VURD_02ANV_CEJDTYPE = BQ78_AREA.VURD_02OM_CEJDTYPE;  
         BQ78_AREA.VURD_02ANV_CBERGRL = BQ78_AREA.VURD_02OM_CBERGRL;    
         BQ78_AREA.VURD_02ANV_BBERGRL = BQ78_AREA.VURD_02OM_BBERGRL;    
         BQ78_AREA.VURD_02ANV_BBERGRL_SW =                              
                                  BQ78_AREA.VURD_02OM_BBERGRL_SW;       
         BQ78_AREA.VURD_02ANV_BBER2FAM = BQ78_AREA.VURD_02OM_BBER2FAM;  
         BQ78_AREA.VURD_02ANV_BBER2FAM_SW =                             
                                  BQ78_AREA.VURD_02OM_BBER2FAM_SW;      
                                                                        
         /* nye felter 2021, D881 */                                    
         BQ78_AREA.VURD_02ANV_VURMARK =                                 
                                  BQ75_AREA.OPL_VURMARK;                
         BQ78_AREA.VURD_02ANY_JUR_KATEGO =                              
                                  BQ78_AREA.VURD_02OM_JUR_KATEGO;       
         BQ78_AREA.VURD_02ANY_JUR_UKATEGO =                             
                                  BQ78_AREA.VURD_02OM_JUR_UKATEGO;      
         BQ78_AREA.VURD_02ANY_VURDATO =                                 
                                  BQ78_AREA.VURD_02OM_VURDATO;          
         BQ78_AREA.VURD_02ANY_FORSIGT_EVS =                             
                                  BQ78_AREA.VURD_02OM_FORSIGT_EVS;      
         BQ78_AREA.VURD_02ANY_BESKAT_EVS =                              
                                  BQ78_AREA.VURD_02OM_BESKAT_EVS;       
                                                                        
                                                                        
         BQ78_AREA.VURD_02ANV_NY_GL = ' ';                              
                                                                        
 END FLYT_VURD_02OM_TIL_02ANV;                                          
 /*********************************************************************/
 /* FLYT VALGTE VURDERING TIL ANVENDT VURDERING                       */
 /*********************************************************************/
 FLYT_VURD_02OMNY_TIL_02ANV: PROC;                                      
                                                                        
         BQ78_AREA.VURD_02ANV_CBENYT = BQ78_AREA.VURD_02OMNY_CBENYT;    
         BQ78_AREA.VURD_02ANV_FLEJL = BQ78_AREA.VURD_02OMNY_FLEJL;      
         BQ78_AREA.VURD_02ANV_BEJDVÆR = BQ78_AREA.VURD_02OMNY_BEJDVÆR;  
         BQ78_AREA.VURD_02ANV_BEJDVÆR_SW =                              
                                  BQ78_AREA.VURD_02OMNY_BEJDVÆR_SW;     
         BQ78_AREA.VURD_02ANV_CEJERL = BQ78_AREA.VURD_02OMNY_CEJERL;    
         BQ78_AREA.VURD_02ANV_BEJBOL1 = BQ78_AREA.VURD_02OMNY_BEJBOL1;  
         BQ78_AREA.VURD_02ANV_BEJBOL1_SW =                              
                                  BQ78_AREA.VURD_02OMNY_BEJBOL1_SW;     
         BQ78_AREA.VURD_02ANV_CEJBOLTYP1 =                              
                                  BQ78_AREA.VURD_02OMNY_CEJBOLTYP1;     
         BQ78_AREA.VURD_02ANV_BEJBOL2 = BQ78_AREA.VURD_02OMNY_BEJBOL2;  
         BQ78_AREA.VURD_02ANV_BEJBOL2_SW =                              
                                  BQ78_AREA.VURD_02OMNY_BEJBOL2_SW;     
         BQ78_AREA.VURD_02ANV_CEJBOLTYP2 =                              
                                  BQ78_AREA.VURD_02OMNY_CEJBOLTYP2;     
         BQ78_AREA.VURD_02ANV_BEJBOLANV =                               
                                  BQ78_AREA.VURD_02OMNY_BEJBOLANV;      
         BQ78_AREA.VURD_02ANV_BEJBOLANV_SW =                            
                                  BQ78_AREA.VURD_02OMNY_BEJBOLANV_SW;   
         BQ78_AREA.VURD_02ANV_CANVEBOL = BQ78_AREA.VURD_02OMNY_CANVEBOL;
         BQ78_AREA.VURD_02ANV_BOPÆLSKOD =                               
                                  BQ78_AREA.VURD_02OMNY_BOPÆLSKOD;      
         BQ78_AREA.VURD_02ANV_CEJDTYPE = BQ78_AREA.VURD_02OMNY_CEJDTYPE;
         BQ78_AREA.VURD_02ANV_CBERGRL = BQ78_AREA.VURD_02OMNY_CBERGRL;  
         BQ78_AREA.VURD_02ANV_BBERGRL = BQ78_AREA.VURD_02OMNY_BBERGRL;  
         BQ78_AREA.VURD_02ANV_BBERGRL_SW =                              
                                  BQ78_AREA.VURD_02OMNY_BBERGRL_SW;     
         BQ78_AREA.VURD_02ANV_BBER2FAM = BQ78_AREA.VURD_02OMNY_BBER2FAM;
         BQ78_AREA.VURD_02ANV_BBER2FAM_SW =                             
                                  BQ78_AREA.VURD_02OMNY_BBER2FAM_SW;    
                                                                        
         /* nye felter 2021, D881 */                                    
         BQ78_AREA.VURD_02ANV_VURMARK =                                 
                                  BQ75_AREA.OPL_VURMARK;                
         BQ78_AREA.VURD_02ANY_JUR_KATEGO =                              
                                  BQ78_AREA.VURD_02OMNY_JUR_KATEGO;     
         BQ78_AREA.VURD_02ANY_JUR_UKATEGO =                             
                                  BQ78_AREA.VURD_02OMNY_JUR_UKATEGO;    
         BQ78_AREA.VURD_02ANY_VURDATO =                                 
                                  BQ78_AREA.VURD_02OMNY_VURDATO;        
         BQ78_AREA.VURD_02ANY_FORSIGT_EVS =                             
                                  BQ78_AREA.VURD_02OMNY_FORSIGT_EVS;    
         BQ78_AREA.VURD_02ANY_BESKAT_EVS =                              
                                  BQ78_AREA.VURD_02OMNY_BESKAT_EVS;     
                                                                        
                                                                        
         BQ78_AREA.VURD_02ANV_NY_GL = ' ';                              
                                                                        
 END FLYT_VURD_02OMNY_TIL_02ANV;                                        
 /*********************************************************************/
 /* HENT ADRESSE TIL KONTROL AF FRAFLYTNING                    RUTINE */
 /*********************************************************************/
 HENT_ADRESSE: PROC;                                                    
                                                                        
  DCLBQ70000T = '';                                                     
                                                                        
  EXEC SQL                                                              
     SELECT C.VEJKOD,                                                   
            C.HUSNR,                                                    
            C.HUSBOGSTAADR,                                             
            C.ETAGENR,                                                  
            C.SIDEDOERNR                                                
       INTO :DCLBQ70000T.VEJKOD,                                        
            :DCLBQ70000T.HUSNR,                                         
            :DCLBQ70000T.HUSBOGSTAADR,                                  
            :DCLBQ70000T.ETAGENR,                                       
            :DCLBQ70000T.SIDEDOERNR                                     
       FROM BQ78000T A,                                                 
            BQ70000T C                                                  
      WHERE A.DCPRN = C.PNR                                             
        AND A.TIL_EVS_AAR = C.TIL_EVS_AAR                               
        AND A.AFVIKLINGS_ID = C.AFVIKLINGS_ID                           
        AND A.DCPRN > 99999999                                          
        AND A.TILEVS_CDATAFRA > '0'                                     
        AND EXISTS (SELECT 'A' FROM BQ78000T B                          
                     WHERE B.AFVIKLINGS_ID = A.AFVIKLINGS_ID            
                       AND B.DATA_ID = A.DATA_ID                        
                       AND B.TILEVS_A_EJ_CEJFORH IN ('40', '41')        
                       AND B.TILEVS_CINVPNR > '0'                       
                       AND B.EKOMNR = A.EKOMNR                          
                       AND B.TIL_EVS_AAR = A.TIL_EVS_AAR                
                       AND B.EEJDNR = A.EEJDNR                          
                       AND B.DCPRN <= 99999999)                         
        AND A.DCPRN         = :BQ78_AREA.DCPRN                          
        AND A.EKOMNR        = :BQ78_AREA.EKOMNR                         
        AND A.EEJDNR        = :BQ78_AREA.EEJDNR                         
        AND A.AFVIKLINGS_ID = :BQ78_AREA.AFVIKLINGS_ID                  
        AND A.DATA_ID       = :BQ78_AREA.DATA_ID                        
        AND A.TIL_EVS_AAR   = :BQ78_AREA.TIL_EVS_AAR  /*EBD 15/1-2023*/ 
        AND A.EENHEDLBNR    = :BQ78_AREA.EENHEDLBNR   /*PBR 16/1-2023*/ 
        FETCH FIRST 1 ROW ONLY;                       /*PBR 16/1-2023*/ 
                                                                        
    SELECT(SQLCA.SQLCODE);                                              
       WHEN(0) DO;                                                      
          ADRESSE_FUNDET = JA;                                          
       END;                                                             
       WHEN(100) DO;                                                    
          ADRESSE_FUNDET = NEJ;                                         
       END;                                                             
       WHEN(-811) DO;     /* EBD ekstra hack pga nedbrud */             
          ADRESSE_FUNDET = NEJ;                                         
          PUT SKIP LIST ('BQ78_AREA.DCPRN',BQ78_AREA.DCPRN);            
          PUT SKIP LIST ('BH86010 HACK SQLCODE: ' !! SQLCA.SQLCODE);    
       END;                                                             
       OTHERWISE DO;                                                    
          ABENDTXT = '101 SELECT BQ70000T';                             
          CALL SQL_FEJL;                                                
       END;                                                             
    END;                                                                
                                                                        
 END HENT_ADRESSE;                                                      
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED SQLCODE: ' !! SQLCA.SQLCODE);  
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
                                                                        
         CALL ZS67000(SQLCA);                                           
                                                                        
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* HER UDSKRIVES ØVRIGE FEJL                                  RUTINE */
 /*********************************************************************/
 PROGRAM_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED PROGRAMFEJL');                 
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END PROGRAM_FEJL;                                                      
 /*********************************************************************/
                                                                        
         %INCLUDE BH86071M; /* OPSÆT GENERELLE FEJLNR M.V. */           
         %INCLUDE BH86072M; /* OPSÆT PERSONLIGE FEJLNR M.V. */          
         %INCLUDE BH86005M; /* UDFØR DIVERSE KONTROLLER */              
         %INCLUDE BQ24907M; /* BEREGN EVS SLUT KMDS DEL */      /*RUL*/ 
                                                                        
 END BH86010;                                                           
