 BE30000: PROCEDURE OPTIONS (MAIN);                                     
 /**********************************************************************
 * PROJEKT:     EVS FORSKUD/EVS SLUT                                  **
 * PROGRAMNAVN: BE30000.                                               *
 * PROGRAMTYPE: BATCH.                                                 *
 * FUNKTION:    PROGRAMMET UDTRÆKKER ALLE AKTIVE OG VALIDE EJENDOMME   *
 *              FRA SENEST EVS SLUT ÅR                                 *
 * PGMFORLØB:   1. ÅBEN EVS UDTRÆKSFIL.                                *
 *              2. DECLARE PERSONEJENDOMSOPL.                          *
 *              3. OPEN PERSONEJENDOMSOPL.                             *
 *              4. LÆS/FETCH RÆKKE PÅ PERSONTABEL.                     *
 *              5. BEHANDL DATA TIL FØRSTE DEL AF RECORDSTRUKTUR.      *
 *              6. LÆS/FETCH RÆKKE PÅ PERSONTABEL.                     *
 *              7. BEHANDL DATA TIL SIDSTE DEL AF RECORDSTRUKTUR.      *
 *              8. CHECK/SKRIV RÆKKE PÅ EVS FIL.                       *
 *              9. GENTAG PUNKT 4 TIL 8 INTIL IKKE FLERE RÆKKER        *
 *             10. LUK PERSONEJENDOMSOPL.                              *
 *             11. LUK EVS UDTRÆKSFIL.                                 *
 *             12. SKRIV KONTROLLISTE.                                 *
 * INDDATA:     VB.Q17500D        - EVS EJENDOMSREGISTER SLUT 2017     *
 *              BE30000T/BE31000T - EVS PERSONTABEL.                   *
 *              BE40000T/BE41000T - EVS RESULTATTABEL.                 *
 * UDDATA:      BE30000O - UDTRÆK FRA EVS SLUT EXCL. KOMMUNE           *
 *                         999 (UDENLANDSKE EJENDOMME).                *
 *              BE30010O - UDTRÆK FRA EVS SLUT KUN KOMMUNE             *
 *                         999 (UDENLANDSKE EJENDOMME).                *
 *              BE30001Y - KONTROLLISTE.                               *
 * KONSTRUKTØR: THOMAS FLINDT         THF, PUS/T&S BRØNDBY 16.07.2001. *
 * ÆNDRINGSLOG: PROGRAMMET ER TILRETTET TIL EVS 2001                   *
 *              ESBEN BRODERSEN       ESB,    T&S BRØNDBY  16.11.2001. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2002               *
 *              ESBEN BRODERSEN       ESB,    T&S BRØNDBY  26.07.2002. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2003               *
 *              ESBEN BRODERSEN       ESB,    T&S BALLERUP 17.07.2003. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2004               *
 *              BO SCHMIDT            BOB,    T&S BALLERUP 07.06.2004. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2005               *
 * *FORSKUD06*  SUSANNE KROGH VILLUMSEN SKV,  T&S BALLERUP 23.05.2005. *
 *             -PROGRAMMET ER TILRETTET TIL FORSKUD 2006               *
 *             -ANTAL LÆSTE VAR IKKE LIG MED ANTAL SKREVNE - ANTAL     *
 *              AFVISTE.                                               *
 *             -BSUM1 OG BSUM2 BLEV IKKE OVERFØRT TIL OUTPUT-FILEN     *
 * *SLUT05*     SUSANNE KROGH VILLUMSEN SKV,  T&S BALLERUP 07.11.2005. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2005                  *
 *              KONVERTERING AF ÆRØ KOMMUNE.  KMNR 443 OG 492  TIL 443 *
 * *FORSKUD07*  BO SCHMIDT            BOB,    PKF BALLERUP 11.05.2006. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2007               *
 * *SLUT06*     BO SCHMIDT            BOB,    PKF BALLERUP 03.11.2006. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2006                  *
 *              KONVERTERING AF DE ØVRIGE KOMMUNER I KOMMUNALREFORMEN. *
 * *FORSKUD08*  BO SCHMIDT            BOB,    PKF BALLERUP 22.05.2007. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2008               *
 * *SLUT07*     BO SCHMIDT            BOB,    PKF BALLERUP 03.01.2008. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2007                  *
 * *FORSKUD09*  BO SCHMIDT            BOB,    PKF BALLERUP 25.04.2008. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2009               *
 * *FORSKUD10*  GERD HOLM-PEDERSEN    GEH,    PKF BALLERUP 07.04.2009. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2010               *
 *              BUDLSKC(910) TILFØJET I BN30000N OG I UDTRÆKKET.       *
 * *FORSKUD11*  GERD HOLM-PEDERSEN    GEH,    PKF BALLERUP 28.05.2010. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2011               *
 *              BBERGRLUDL_01 OG BOMBTILBUDL_01                        *
 *              FJERNET I BN30000N OG I UDTRÆKKET.                     *
 * *FORSKUD12*  GERD HOLM-PEDERSEN    GEH,    PKF BALLERUP 16.05.2011. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2012               *
 * *FORSKUD13*  ESBEN BRODERSEN       ESB,    PR  BALLERUP 15.05.2012. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2013               *
 * *FORSKUD14*  ESBEN BRODERSEN       ESB,    PR  BALLERUP 22.05.2013. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2014               *
 * *FORSKUD15*  JØRGEN SAUGMANN       QQS,    PR  BALLERUP 27.06.2014. *
 *              PROGRAMMET ER TILRETTET TIL FORSKUD 2015               *
 * *FORSKUD16*  JENS HOLGER KJÆR      JNK,        BALLERUP 08.06.2015. *
 *             PROGRAMMET ER ÅRSRULLET TIL FORSKUD 2016               * 
 * SLUT 2015   ESBEN BRODERSEN Z8QEB              BALLERUP 08.03.2016  *
 *             INDLAGT KONSTANT MACRO BE65300M #01                     *
 * *FORSKUD17* ESBEN BRODERSEN Z8QEB              BALLERUP 08.06.2016  *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2017                *
 *             KS30-01 SLETTEDE EJERSKABER SKAL IKKE SKRIVES #01       *
 *             UDVIDDET MED PARMKORT DA KUN KOMMUNE 170 SKAL MED       *
 *             I BRUGTEST                                              *
 * *FORSKUD18* ESBEN BRODERSEN Z8QEB              BALLERUP 05.06.2017  *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2018                *
 * *FORSKUD19* ESBEN BRODERSEN Z8QEB              BALLERUP 30.05.2018  *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2019                *
 *             BE16 -> BE17                                            *
 * *SLUT18*    ESBEN BRODERSEN Z6EBD              BALLERUP 14.09.2018  *
 *             2-FAMILIE BOLIGER 02-23                                 *
 *             felt EENHEDLBNR er indført der mangler tilretning af    *
 *             BQ strukturer og macroer                                *
 * *FORSKUD20* ESBEN BRODERSEN Z6EBD             BALLERUP 22.03.2019   *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2020                *
 *             BE17 -> BE18                                            *
 *             UDENLANDSKE EJERFORHOLD SOM ER SLETTET SKRIVES          *
 *             DEFECT 248                                              *
 * SLUT 2019   ESBEN BRODERSEN Z6EBD             BALLERUP 22.03.2019   *
 *             SLETTEDE DANSKE EJERSKABER CSLET = 1 SKAL SKRIVES SÅ    *
 *             DE KAN BRUGES TIL FJERNE EVS FORSKUDS OPLYSNINGER       *
 *             I BE317000L KS02-34A                                    *
 * *FORSKUD21* PER BRUNK Z6PBR                   BALLERUP 23.03.2020   *
 *             PROGRAMMET ER TILRETTET TIL FORSKUD 2021                *
 *             BE18 -> BE19                                            *
 * FORSKUD2021 z6pbr D14                                  juni 2020    *
 *             Aktive periodeløbenumre skal videreføres selv om der    *
 *             er slettet højere periodeløbenumre på samme ejendom     *
 * FORSKUD2024 Edward Laryea                        21/10-2020         *
 *            TILRETTET FOR FORSKUD2024/SLUT2021                       *
 *            BE19 -> BE20                                             *
 *            Mellemperioden - 2024                                    *
 *             Per Brunk                            29/01-2021         *
 *            Ny struktur BE30000N mellemperiode                       *
 * SLUT 2021   Z6SEP                                Marts 2021         *
 *             Rettet BE65300M til BE55300M                            *
 * FORSKUD2025 Tina Carstens, TIC                    BF17 27.10.2023   *
 *             BE22 -> BE23                                            *
 * FORSKUD2025 Jens Thomassen, JXT                   BF17 27.10.2023   *
 *             Fjern ægtefællefordeling i SLUT (ny lov) US 1564164     *
 * Forskud 2025 PBR,  Defekt 2416                          22.05.2024. *
 *              Hvis landekode = FR ændres landekode til F1 eller F2   *
 * Forskud 2025 JJJ,                                       19.06.2024. *
 *              BE55600M erstatter BE55300M                            *
 * Forskud 2026 XJY #1867500 ÆA70 Fjern CELØNCOR/BGLSUM1   12.09.2024  *
 **********************************************************************/
                                                                        
 DEFAULT RANGE (*) STATIC; /* LAGERTYPE AHT. KALD AF EKSTERNE MODULER */
                                                                        
 DCL     COPYRIGHT      CHAR (30) INIT ('(C) KMD A/S 2018');            
                                                                        
 /*********************************************************************/
 /* DECLARE AF DB2                                                    */
 /*********************************************************************/
                                                                        
         EXEC SQL INCLUDE SQLCA;        /* SQL KOMMUNIKATIONSAREAL    */
         EXEC SQL INCLUDE BE30000T;     /* EVS SLUT EJERSKABSTABEL    */
         EXEC SQL INCLUDE BE40000T;     /* EVS SLUT RESULTATTABEL     */
                                                                        
 /**********************************************************************
 * DECLARE AF ABEND RUTINE                                             *
 **********************************************************************/
                                                                        
 DCL     ZS30101        ENTRY;                                          
 DCL     ZS67000        ENTRY;                                          
 DCL     ZS61900        ENTRY;                        /* KST/SSI INFO */
                                                                        
 /*********************************************************************/
 /* DECLARE AF DIVERSE                                                */
 /*********************************************************************/
                                                                        
 DCL     HJ_DCPRN       CHAR (10);                                      
 DCL     HJ_DCPRN_PIC   PIC  '(10)9' BASED(ADDR(HJ_DCPRN));             
 DCL     HJ_EKOMNR      CHAR (03);                                      
 DCL     HJ_EEJDNR      CHAR (06);                                      
 DCL     HJ_DFRAGLD_DTO CHAR (10);                                      
 DCL     EKOMEEJD_NR    CHAR (09);                                      
 DCL     OK             CHAR (01)        INIT('J');                     
 DCL     FEJLTEKST      CHAR (20)        INIT(' ');                     
 DCL     ABENDMEDD      CHAR (56)        INIT(' ');                     
 DCL     FLAG_EN_RÆKKE  BIT(1)           INIT('0'B);                    
 DCL     DCPRN_NGL      DEC FIXED (11,0);                               
 DCL     KOM_NGL        BIN FIXED (15) UNAL;                            
 DCL     EJD_NGL        BIN FIXED (31) UNAL;                            
 DCL     EENHEDLBNR_NGL BIN FIXED (15) UNAL; /* ??? */                  
 DCL     FETCH_SQLKODE  FIXED BIN(15)    INIT(0);                       
                                                                        
 DCL     PARMKOMNR1     BIN FIXED (15);                                 
 DCL     PARMKOMNR2     BIN FIXED (15);                                 
 DCL     PARMKOMNR3     BIN FIXED (15);                                 
                                                                        
 DCL     DT             CHAR (6);                                       
 DCL     1 DAT          BASED(ADDR(DT)),                                
           2 ÅR         PIC   '99',                                     
           2 MD         PIC   '99',                                     
           2 DAG        PIC   '99';                                     
                                                                        
 DCL     HJ_DATOEN       CHAR (8);                                      
 DCL     1 HJ_DATO       BASED(ADDR(HJ_DATOEN)),                        
           2 AAR         PIC  '9999',                                   
           2 MD          PIC  '99',                                     
           2 DG          PIC  '99';                                     
                                                                        
 DCL     EJD_NØGLEN     CHAR      (10);                                 
 DCL     1 EJD_NØGLE    BASED(ADDR(EJD_NØGLEN)),                        
           2 DINDKAAR   BIN FIXED(15),                                  
           2 EKOMNR     BIN FIXED(15),                                  
           2 EEJDNR     BIN FIXED(31),                                  
           2 EENHEDLBNR BIN FIXED(15);                                  
                                                                        
 DCL     TFLAG          BIT(1)         INIT('0'B);                      
                                                                        
 DCL     1 BE55600M,                                                    
           %INCLUDE BE55600M;                    /* DATO OG ÅR MACRO */ 
                                                                        
 /*********************************************************************/
 /* PARM KORT                                                         */
 /*********************************************************************/
  DCL     EOF_PARM         BIT (1) INIT ('0'B);                         
  DCL     PARMKORT         FILE RECORD INPUT;                           
  DCL     PARM_AR          CHAR  (80)  INIT (' ');                      
  DCL     PARM_MEDTAGET    BIT (1)       INIT ('0'B);                   
  DCL     PARM_FEJL        BIT (1)       INIT ('0'B);                   
                                                                        
  DCL     1 PARMLINIE  BASED (ADDR (PARM_AR) ),                         
            2 PARMSTART    CHAR      (02),                              
            2 PROGNAVN     CHAR      (07),                              
            2 KOMNR1       CHAR      (03),                              
            2 KOMNR2       CHAR      (03),                              
            2 KOMNR3       CHAR      (03),                              
            2 REST         CHAR      (62);                              
                                                                        
 /*********************************************************************/
 /* DECLARE DATASÆT                                                   */
 /*********************************************************************/
                                                                        
 DCL     SYSPRINT FILE STREAM PRINT;                                    
    /*  RUL HERUNDER  */                                                
 DCL     BE245I  FILE RECORD DIRECT  /* EVS EJENDOMS REGISTER         */
                 INPUT KEYED ENV (VSAM);                                
                                                                        
 DCL     BE3000O FILE OUTPUT RECORD; /* EVS UDTRÆK EXCL. KOMMUNE 999  */
 DCL     BE3001O FILE OUTPUT RECORD; /* EVS UDTRÆK KUN   KOMMUNE 999  */
                                                                        
 /*********************************************************************/
 /* DECLARE STRUKTURER                                                */
 /*********************************************************************/
                                                                        
 DCL     1 UDTRÆK_SLUT,                                                 
           %INCLUDE BE30000N;;          /* Fra BH30000N               */
                                                                        
 DCL     1 EJENDOM,                   /* EVS EJENDOMS REGISTER      */  
           2 FELTER,                                                    
             %INCLUDE BE24100N;,    /*RUL*/                             
           2 INDK,                                                      
             %INCLUDE BE24005N;;    /*RUL*/                             
                                                                        
 DCL     1 PERSON,                    /* EVS EJERSKABSTABELEN       */  
           %INCLUDE BE24200N;;        /*RUL*/                           
                                                                        
 DCL     1 INDK_PERS,                 /* INDIKATOR EJERSKAB OPLYSN. */  
           %INCLUDE BE24006N;;        /*RUL*/                           
                                                                        
 DCL     1 RESULTAT,                                                    
           5 BEJERAN     DEC FIXED(15,2);                               
                                                                        
 DCL     1 INDK_RES,                                                    
           5 BEJERAN_SW  BIN FIXED (15) UNAL;                           
                                                                        
 DCL     1 EVS_ESK,                     /* EVS EJERSKABSTABELEN       */
           %INCLUDE BE30001N;;          /* Fra BE30000N               */
 //DCL     1 EVS_ESK_FELT,              /* EVS EJERSKABSFELTTABELEN   */
 //          %INCLUDE BE31000N;;                                        
 DCL     1 EVS_RES,                     /* EVS RESULTATSTABEL         */
           %INCLUDE BE40000N;;                                          
 //DCL     1 EVS_RES_FELT,              /* EVS RESULTATFELTTABELEN    */
 //          %INCLUDE BE41000N;;                                        
                                                                        
 DCL     HJ_ELBNR        BIN FIXED (15) INIT (0);                       
 DCL     HJ_CSLET        CHAR (1) INIT ('*');                           
 DCL     GEM_ELBNR       BIN FIXED (15) INIT (0);                       
 DCL     GEM_ELBNR_SLET  BIN FIXED (15) INIT (0);                       
 DCL     GEM_CSLET       CHAR (1) INIT ('*');                           
                                                                        
 /*********************************************************************/
 /* DECLARE AF BUILTIN                                                */
 /*********************************************************************/
                                                                        
 DCL     (ADDR,DATE,VERIFY,NULL,MOD,SUBSTR,PLIDUMP,PROCNAME) BUILTIN;   
                                                                        
 /*********************************************************************/
 /* DECLARE AF TÆLLERE                                                */
 /*********************************************************************/
                                                                        
 DCL   ANTLÆS_PERSON     BIN FIXED (31) INIT(0);/* LÆSTE PERSONTABEL  */
 DCL   ANTSKRIV_PERSON   BIN FIXED (31) INIT(0);/* SKREVET UDTRÆKSFIL */
 DCL   ANTSKRIV_ØVR      BIN FIXED (31) INIT(0);/* SKREVET EXCL UDLAND*/
 DCL   ANTSKRIV_ØVR_CÆG  BIN FIXED (31) INIT(0);/* SKREVET EXCL UDLAND*/
                                                /* OG CÆGTOPR ^= ' '  */
 DCL   ANTSKRIV_UDL      BIN FIXED (31) INIT(0);/* SKREVET KUN  UDLAND*/
 DCL   ANTCEJBEVS_9      BIN FIXED (31) INIT(0);/* CEJBEVS=9(SLETTET) */
 DCL   ANTOMPLACERET     BIN FIXED (31) INIT(0);/* COMPLA = 1         */
 DCL   ANTCSLET_1        BIN FIXED (31) INIT(0);/* CSLET=1  (SLETTET) */
 DCL   ANTEJDNR_UDL_EJ   BIN FIXED (31) INIT(0);/* FORKERT EJENDOMSNR */
                                                /* HOS CSC FOR UDLAND */
 DCL   ANTEJDNR_EEJDNR_0 BIN FIXED (31) INIT(0);/* FORKERT EJENDOMSNR */
 /*********************************************************************/
 /* PRINTLINIER TIL SPOOL                                             */
 /*********************************************************************/
                                                                        
 DCL     LINIE           CHAR (133);                                    
 DCL     1 LIN           BASED(ADDR(LINIE)),                            
           2 CC          CHAR (1),                                      
           2 TEKST       CHAR (56),                                     
           2 ANT         PIC  '---------9',                             
           2 FIL1        CHAR (66);                                     
                                                                        
         %INCLUDE ZZ20301M;                                             
                                                                        
 /*********************************************************************/
 /* ON - CONDITIONS                                                   */
 /*********************************************************************/
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
                ON ERROR SYSTEM;                                        
                PUT SKIP LIST ('PROGRAMFEJL');                          
                CALL PLIDUMP  ('SBHO','MODUL BE30000');                 
            END;                                                        
                                                                        
         ON KEY (BE245I)        /*RUL*/                                 
            BEGIN;                                                      
            END;                                                        
                                                                        
 /*********************************************************************/
 /* HOUSEKEEPING                                                      */
 /*********************************************************************/
                                                                        
                                                                        
         UDTRÆK_SLUT       = '';                                        
         PERSON            = '';                                        
         EJENDOM           = '';                                        
         RESULTAT          = '';                                        
                                                                        
         /*BE55600M.GLSLUTÅR1 = '2018'*/ /* skal fjernes efter test */  
                                                                        
         DT = DATE;                                                     
         CALL INIT_INDK;                                                
                                                                        
         CALL OPSTART_INIT;                                             
                                                                        
         OPEN FILE (BE245I)  TITLE ('BE24500I');  /*RUL*/               
         OPEN FILE (BE3000O) TITLE ('BE30000O');                        
         OPEN FILE (BE3001O) TITLE ('BE30010O');                        
                                                                        
         CALL ZZ20390('*OPEN','BE30001Y');       /* ÅBEN KONTROLLISTE */
                                                                        
         LINIE = ZZWS3 !! ' KONTROL- & AFSTEMNINGSTOTAL FOR'            
                       !! ' UDTRÆK FRA EVS SLUT '                       
         /*#01*/       !! BE55600M.GLSLUTÅR1 !! ' DATO: '               
                       !!   DAT.DAG !! '.' !! DAT.MD !! '.' !! DAT.ÅR;  
                                                                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE = ZZWS3 !! ' PROGRAMID: BE30000 ';                       
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE = ZZWS2;                                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         CALL ZS61900;                              /* KST/SSI INFO   */
                                                                        
 /*********************************************************************/
 /* PROCES                                                            */
 /*********************************************************************/
         CALL DECLARE_CURSOR;                                           
         CALL OPEN_PERSONEJENDOMSOPL;                                   
         CALL FETCH_PERSONEJENDOMSOPL;                                  
                                                                        
         SELECT (FETCH_SQLKODE);  /*GEMT SQLCODE FRA FETCH_PERSONEJ. */ 
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               DO WHILE (FETCH_SQLKODE = 0);                            
                  CALL BEHANDL;                                         
                  CALL INIT_INDK;                                       
                  CALL FETCH_PERSONEJENDOMSOPL;                         
               END;                                                     
             END;                                                       
                                                                        
           WHEN (100)                                                   
               PUT SKIP LIST ('INGEN RÆKKER LÆST');                     
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'FETCH PERSON_CURSOR ';                     
               FEJLTEKST  = 'BE30000 ** 251 ' !! FEJLTEKST;             
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT */                                              
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /*********************************************************************/
 /* BEHANDL                                                    RUTINE */
 /*********************************************************************/
 BEHANDL: PROC;                                                         
                                                                        
         CALL INIT_INDK;                                                
         CALL SKAF_ELBNR;  /* D14 */                                    
         CALL FØRSTE_PERSONEJENDOMSOPL;                                 
         IF SQLCA.SQLCODE = 0                                           
         THEN                         /* LÆST LÆSTE RÆKKE OG I FØSTE */ 
            CALL GEM_FØRSTE;          /* DEL AF STRUKTUREN           */ 
                                                                        
         IF EVS_ESK.DTILGLD = '9999-12-31-23.59.59.999999'              
         THEN                                                           
            DO;                           /* FØRSTE = SIDSTE SÅ GEMMES*/
              FLAG_EN_RÆKKE = '1'B;       /* FØRSTE DEL AF STRUKTUREN */
              CALL GEM_SIDSTE_CHECK_SKRIV;/* RÆKKEN I SIDSTE DEL AF   */
                                          /* STURKTUREN               */
            END;                                                        
         ELSE                                                           
            DO;                                                         
              CALL INIT_INDK;                                           
              CALL SIDSTE_PERSONEJENDOMSOPL;                            
              IF SQLCA.SQLCODE = 0                                      
              THEN                                                      
                 DO;                                                    
                   CALL GEM_SIDSTE_CHECK_SKRIV;                         
                 END;                                                   
              ELSE                                                      
                 DO;                                                    
                   FLAG_EN_RÆKKE = '0'B;                                
                 END;                                                   
            END;                                                        
                                                                        
 END BEHANDL;                                                           
 /*********************************************************************/
 /* HER INDSÆTTES DATA I DEN FØRSTE DEL AF STUKTUR BE30000N           */
 /*********************************************************************/
 GEM_FØRSTE:  PROC;                                                     
 /*********************************************************************/
 /*      STAM/NØGLEDATA/FÆLLESDATA                                    */
 /*********************************************************************/
         IF TFLAG THEN PUT SKIP LIST('***** '!!PROCNAME!!' *****');     
         UDTRÆK_SLUT.DCPRN      = EVS_ESK.DCPRN;                        
         DCPRN_NGL              = UDTRÆK_SLUT.DCPRN;                    
         UDTRÆK_SLUT.EKOMNR     = EVS_ESK.EKOMNR;                       
         UDTRÆK_SLUT.EEJDNR     = EVS_ESK.EEJDNR;                       
         /* nye felter i slut 2018*/                                    
         UDTRÆK_SLUT.EENHEDLBNR  = EVS_ESK.EENHEDLBNR;                  
         UDTRÆK_SLUT.EJDBELIG    = EJENDOM.EJDBELIG;                    
         UDTRÆK_SLUT.VEJK_EJD    = EJENDOM.VEJK_EJD;                    
         UDTRÆK_SLUT.HUSNR_EJD   = EJENDOM.HUSNR_EJD;                   
         UDTRÆK_SLUT.ETAGE_EJD   = EJENDOM.ETAGE_EJD;                   
         UDTRÆK_SLUT.SDØR_EJD    = EJENDOM.SDØR_EJD;                    
         UDTRÆK_SLUT.ENHEDBELIG  = EJENDOM.ENHEDBELIG;                  
         UDTRÆK_SLUT.VEJK_ENHED  = EJENDOM.VEJK_ENHED;                  
         UDTRÆK_SLUT.HUSNR_ENHED = EJENDOM.HUSNR_ENHED;                 
         UDTRÆK_SLUT.ETAGE_ENHED = EJENDOM.ETAGE_ENHED;                 
         UDTRÆK_SLUT.SDØR_ENHED  = EJENDOM.SDØR_ENHED;                  
         /* nye felter i slut 2018 afsluttet*/                          
                                                                        
         UDTRÆK_SLUT.CLANDEKODE = EJENDOM.CLANDEKODE;                   
                                                                        
         KOM_NGL         = EVS_ESK.EKOMNR;                              
         EJD_NGL         = EVS_ESK.EEJDNR;                              
         EENHEDLBNR_NGL  = EVS_ESK.EENHEDLBNR; /*??*/                   
                                                                        
         UDTRÆK_SLUT.CFRATYPE   = '2';                                  
                                                                        
         IF PERSON.DAFSTAA ^= (10)' '                                   
         THEN                                                           
            UDTRÆK_SLUT.DSORTDAT1 = DB2_DATO_TIL_FIX09(PERSON.DAFSTAA); 
         ELSE                                                           
            UDTRÆK_SLUT.DSORTDAT1 = 99991231;                           
                                                                        
         IF PERSON.DOVTG ^= (10)' '                                     
         THEN                                                           
            UDTRÆK_SLUT.DSORTDAT2 = DB2_DATO_TIL_FIX09(PERSON.DOVTG);   
         ELSE                                                           
            UDTRÆK_SLUT.DSORTDAT2 = 0;                                  
                                                                        
         UDTRÆK_SLUT.CBENYT       = EJENDOM.CBENYT;                     
         UDTRÆK_SLUT.CEJBOLTYP1   = EJENDOM.CEJBOLTYP1;                 
         UDTRÆK_SLUT.CEJBOLTYP2   = EJENDOM.CEJBOLTYP2;                 
                                                                        
 /*******************************************************************/  
 /*    VARIABLE DATA FOR RÆKKE MED EGENNR = 1 OG HØJSTE ELBNR       */  
 /*******************************************************************/  
                                                                        
         UDTRÆK_SLUT.FØRSTE.ELBNR      = EVS_ESK.ELBNR;                 
         UDTRÆK_SLUT.FØRSTE.EGENNR     = EVS_ESK.EGENNR;                
         UDTRÆK_SLUT.FØRSTE.DFRAGLD    = EVS_ESK.DFRAGLD;               
         UDTRÆK_SLUT.FØRSTE.DTILGLD    = EVS_ESK.DTILGLD;               
         UDTRÆK_SLUT.FØRSTE.CDATAFRA   = EVS_ESK.CDATAFRA;              
         UDTRÆK_SLUT.FØRSTE.CAJOUR     = EVS_ESK.CAJOUR;                
         UDTRÆK_SLUT.FØRSTE.CSUPPL     = EVS_ESK.CSUPPL;                
         UDTRÆK_SLUT.FØRSTE.DHENVN     = PERSON.DHENVN;                 
         UDTRÆK_SLUT.FØRSTE.FEJLNR     = EVS_ESK.FEJLNR;    /*#101*/    
         UDTRÆK_SLUT.FØRSTE.CÆGTOPR    = PERSON.CÆGTOPR;                
         UDTRÆK_SLUT.FØRSTE.CSKPLOMF   = PERSON.CSKPLOMF;               
                                                                        
         IF PERSON.CEJBEVS ^= '6'             /* #SLUT2006 */           
          & PERSON.CEJBEVS ^= '7'                                       
          & PERSON.CEJBEVS ^= '8'                                       
          & PERSON.CEJBEVS ^= '9'                                       
          //& (PERSON.CÆGTOPR = '1' !         JXT 27.10.2023 BF17       
          //   PERSON.CÆGTOPR = '3' !                                   
          //   PERSON.CÆGTOPR = '4')                                    
          & PERSON.GPCTEJER = 0                                         
          & INDK_PERS.GPCTEJER_I = 0                                    
          & PERSON.CPCTEJER = '8'                                       
         THEN                                                           
            PERSON.CEJBEVS = '9';                                       
                                                                        
         UDTRÆK_SLUT.FØRSTE.CEJBEVS    = PERSON.CEJBEVS;                
         UDTRÆK_SLUT.FØRSTE.BPENSNED   = PERSON.BPENSNED;               
         UDTRÆK_SLUT.FØRSTE.BPENSNÆ    = PERSON.BPENSNÆ ;               
         UDTRÆK_SLUT.FØRSTE.CEJDTYPE   = EJENDOM.CEJDTYPE;              
         IF PERSON.CEJDTYPE_AKT > '0'                                   
         THEN                                                           
           UDTRÆK_SLUT.FØRSTE.CEJDTYPE   = PERSON.CEJDTYPE_AKT;         
         UDTRÆK_SLUT.FØRSTE.FELT760    = PERSON.CFELT760;               
         UDTRÆK_SLUT.FØRSTE.CNEDSL1    = PERSON.CNEDSL1;                
                                                                        
         IF PERSON.DATO0107 ^= (10)' '                                  
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DATO0107 =                               
            DB2_DATO_TIL_FIX09(PERSON.DATO0107);                        
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DATO0107 = 0;                            
                                                                        
         IF PERSON.DOVTG ^= (10)' '                                     
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DOVTG =                                  
            DB2_DATO_TIL_FIX09(PERSON.DOVTG);                           
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DOVTG = 0;                               
                                                                        
         IF PERSON.DAFSTAA ^= (10)' '                                   
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DAFSTAA =                                
            DB2_DATO_TIL_FIX09(PERSON.DAFSTAA);                         
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DAFSTAA = 0;                             
                                                                        
         IF PERSON.DINDFLYT ^= (10)' '                                  
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DINDFLYT =                               
            DB2_DATO_TIL_FIX09(PERSON.DINDFLYT);                        
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DINDFLYT = 0;                            
                                                                        
         IF PERSON.DFRAFLYT ^= (10)' '                                  
         THEN                                                           
            UDTRÆK_SLUT.FØRSTE.DFRAFLYT =                               
            DB2_DATO_TIL_FIX09(PERSON.DFRAFLYT);                        
         ELSE                                                           
            UDTRÆK_SLUT.FØRSTE.DFRAFLYT = 0;                            
                                                                        
         UDTRÆK_SLUT.FØRSTE.CINDFLYT = PERSON.CINDFLYT;                 
                                                                        
         IF INDK_PERS.GPCTEJER_I = 0                                    
         THEN                                                           
            DO;                                                         
               /* JXT 27.10.2023 BF17 */                                
               IF PERSON.CÆGTOPR >= '1'                                 
               THEN DO;                                                 
                 UDTRÆK_SLUT.FØRSTE.GPCTEJER = 0;                       
                 UDTRÆK_SLUT.FØRSTE.GPCTEJER_SW = -1;                   
               END;               /* JXT 27.10.2023 BF17 */             
               ELSE DO;                                                 
                 UDTRÆK_SLUT.FØRSTE.GPCTEJER = PERSON.GPCTEJER;         
                 UDTRÆK_SLUT.FØRSTE.GPCTEJER_SW = 0;                    
               END;                                                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.GPCTEJER = 0;                         
               UDTRÆK_SLUT.FØRSTE.GPCTEJER_SW = -1;                     
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.FDAGUDLE   = PERSON.FDAGUDLE;               
         UDTRÆK_SLUT.FØRSTE.GPCTUDLE   = PERSON.GPCTUDLE;               
         UDTRÆK_SLUT.FØRSTE.FUDL100    = PERSON.FUDL100;                
         UDTRÆK_SLUT.FØRSTE.FDAGERHV   = PERSON.FDAGERHV;               
         UDTRÆK_SLUT.FØRSTE.GPCTERHV   = PERSON.GPCTERHV;               
         UDTRÆK_SLUT.FØRSTE.FERHVFLER  = PERSON.FERHVFLER;              
         UDTRÆK_SLUT.FØRSTE.CBERGROP   = PERSON.CBERGROP;               
                                                                        
         IF INDK_PERS.BBERGRL_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBERGRL = PERSON.BBERGRL;             
               UDTRÆK_SLUT.FØRSTE.BBERGRL_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBERGRL = 0;                          
               UDTRÆK_SLUT.FØRSTE.BBERGRL_SW = -1;                      
            END;                                                        
                                                                        
         IF INDK_PERS.BBER2FAM_I = 0                                    
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBER2FAM = PERSON.BBER2FAM;           
               UDTRÆK_SLUT.FØRSTE.BBER2FAM_SW = 0;                      
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BBER2FAM = 0;                         
               UDTRÆK_SLUT.FØRSTE.BBER2FAM_SW = -1;                     
            END;                                                        
                                                                        
         IF INDK_PERS.BBERGRL_AKT_I = 0                                 
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT = PERSON.BBERGRL_AKT;      
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT_SW = 0;                    
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT = 0;                       
              UDTRÆK_SLUT.FØRSTE.BBERGRL_AKT_SW = -1;                   
            END;                                                        
                                                                        
         IF INDK_PERS.BBER2FAM_AKT_I = 0                                
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT = PERSON.BBER2FAM_AKT;    
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT_SW = 0;                   
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT   =  0;                   
              UDTRÆK_SLUT.FØRSTE.BBER2FAM_AKT_SW = -1;                  
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.BPROM1     = PERSON.BPROM1;                 
                                                                        
         IF INDK_PERS.BSUM1_I = 0        /*FORSKUD06*/                  
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM1 = PERSON.BSUM1;                 
               UDTRÆK_SLUT.FØRSTE.BSUM1_SW = 0;                         
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM1 = 0;                            
               UDTRÆK_SLUT.FØRSTE.BSUM1_SW = -1;                        
            END;                                                        
                                                                        
         IF INDK_PERS.BSUM3_I = 0        /*FORSKUD06*/                  
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM3 = PERSON.BSUM3;                 
               UDTRÆK_SLUT.FØRSTE.BSUM3_SW = 0;                         
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BSUM3 = 0;                            
               UDTRÆK_SLUT.FØRSTE.BSUM3_SW = -1;                        
            END;                                                        
                                                                        
         IF PERSON.CEJBEVS = '0' ! PERSON.CEJBEVS = '4' !               
            PERSON.CEJBEVS = '5'                                        
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BNETTO    = PERSON.BNETTO;            
               UDTRÆK_SLUT.FØRSTE.BNETTO_SW = 0;                        
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BNETTO    = 0;                        
               UDTRÆK_SLUT.FØRSTE.BNETTO_SW =-1;                        
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.BEJERAN    = 0;                             
         UDTRÆK_SLUT.FØRSTE.BEJERAN_SW =-1;                             
                                                                        
         IF INDK_PERS.BEVSMAN_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEVSMAN = PERSON.BEVSMAN;             
               UDTRÆK_SLUT.FØRSTE.BEVSMAN_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEVSMAN = 0;                          
               UDTRÆK_SLUT.FØRSTE.BEVSMAN_SW = -1;                      
            END;                                                        
                                                                        
   /* US1549422 MBS - fjerne felt 811 i ny lov */                       
   /*      IF INDK_PERS.BMANEVSSTI_I = 0                                
         THEN                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI    = PERSON.BMANEVSSTI;     
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI_SW = 0;                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI    = 0;                     
              UDTRÆK_SLUT.FØRSTE.BMANEVSSTI_SW = -1;                    
            END; */                                                     
                                                                        
         UDTRÆK_SLUT.FØRSTE.BMANNEDSL   = PERSON.BMANNEDSL;             
         UDTRÆK_SLUT.FØRSTE.CENKE       = PERSON.CENKE;                 
         UDTRÆK_SLUT.FØRSTE.CENKEBOH    = PERSON.CENKEBOH;              
         UDTRÆK_SLUT.FØRSTE.BOBEHAKOD   = PERSON.BOBEHAKOD;             
         UDTRÆK_SLUT.FØRSTE.CIVILSTAND  = PERSON.CIVILSTAND;            
         UDTRÆK_SLUT.FØRSTE.CSLET       = PERSON.CSLET;                 
                                                                        
         IF INDK_PERS.BEJBOL1_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL1 = PERSON.BEJBOL1;             
               UDTRÆK_SLUT.FØRSTE.BEJBOL1_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL1 = 0;                          
               UDTRÆK_SLUT.FØRSTE.BEJBOL1_SW = -1;                      
            END;                                                        
                                                                        
         IF INDK_PERS.BEJBOL2_I = 0                                     
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL2 = PERSON.BEJBOL2;             
               UDTRÆK_SLUT.FØRSTE.BEJBOL2_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEJBOL2 = 0;                          
               UDTRÆK_SLUT.FØRSTE.BEJBOL2_SW = -1;                      
            END;                                                        
                                                                        
         IF PERSON.CANVEBOL = ' '                                       
          & INDK_PERS.BPROM1_I = 0                                      
          & EJENDOM.INDK.BEJBOL2_AKT_I = 0                              
          & EJENDOM.BEJBOL1_AKT ^= EJENDOM.BEJBOL2_AKT                  
         THEN                                                           
            DO;                                                         
              IF PERSON.BBERGRL_AKT = PERSON.BEJBOL1_AKT                
              THEN                                                      
                 PERSON.CANVEBOL = '1';                                 
              ELSE                                                      
              IF PERSON.BBERGRL_AKT = PERSON.BEJBOL2_AKT                
              THEN                                                      
                 PERSON.CANVEBOL = '2';                                 
            END;                                                        
                                                                        
         UDTRÆK_SLUT.FØRSTE.CANVEBOL   = PERSON.CANVEBOL;               
         UDTRÆK_SLUT.FØRSTE.CPTYPSLUT  = PERSON.CPTYPSLUT;              
         UDTRÆK_SLUT.FØRSTE.FELT759    = PERSON.CFELT759;               
         UDTRÆK_SLUT.FØRSTE.CEKSEMP    = PERSON.CEKSEMP; /*#SLUT07*/    
         UDTRÆK_SLUT.FØRSTE.CFRÅR      = PERSON.CFRÅR;                  
         UDTRÆK_SLUT.FØRSTE.COMPLA     = EVS_ESK.COMPLA;                
         UDTRÆK_SLUT.FØRSTE.DOMPLACPR  = EVS_ESK.DOMPLACPR;             
                                                                        
         IF INDK_PERS.BUDLSKC_I = 0        /*FORSKUD10*/                
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BUDLSKC    = PERSON.BUDLSKC;          
               UDTRÆK_SLUT.FØRSTE.BUDLSKC_SW = 0;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BUDLSKC    = 0;                       
               UDTRÆK_SLUT.FØRSTE.BUDLSKC_SW = -1;                      
            END;                                                        
                                                                        
         IF INDK_PERS.BEVSMANFSI_I = 0                                  
         THEN                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEVSMANFSI = PERSON.BEVSMANFSI;       
               UDTRÆK_SLUT.FØRSTE.BEVSMANFSI_SW = 0;                    
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_SLUT.FØRSTE.BEVSMANFSI = 0;                       
               UDTRÆK_SLUT.FØRSTE.BEVSMANFSI_SW = -1;                   
            END;                                                        
         UDTRÆK_SLUT.FØRSTE.COPR_BEVSMANFSI = PERSON.COPR_BEVSMANFSI;   
                                                                        
         CALL OPSÆT_GL_INDKOMSTÅR (UDTRÆK_SLUT.FØRSTE.CFRÅR,            
                                   UDTRÆK_SLUT.FØRSTE.DRGNÅRFRA,        
                                   UDTRÆK_SLUT.FØRSTE.DRGNÅRTIL);       
                                                                        
                                                                        
         PERSON            = ''; /* MED DE NYE TABELLER SKAL VI */      
         EJENDOM           = ''; /* NULSTILLE FØR DEN NÆSTE     */      
         RESULTAT          = ''; /* LÆSNING                     */      
         EVS_RES           = '';                                        
                                                                        
 END GEM_FØRSTE;                                                        
 /*********************************************************************/
 /* HER INDSÆTTES DATA I DEN SIDSTE DEL AF STUKTUR BE30000N           */
 /*********************************************************************/
 GEM_SIDSTE_CHECK_SKRIV: PROC;                                          
 /*******************************************************************/  
 /*    VARIABLE DATA FOR RÆKKE MED HØJESTE DTILGLD OG HØJESTE ELBNR */  
 /*******************************************************************/  
         IF TFLAG THEN PUT SKIP LIST('***** '!!PROCNAME!!' *****');     
         IF FLAG_EN_RÆKKE = '1'B                                        
         THEN                                                           
           DO;                                                          
             UDTRÆK_SLUT.SIDSTE = UDTRÆK_SLUT.FØRSTE;                   
             CALL SKAF_BEJERAN;                                         
                                                                        
             IF INDK_RES.BEJERAN_SW = 0   /* CHEK OM FUNDET */          
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = RESULTAT.BEJERAN;    
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = 0;                   
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW =-1;                   
                END;                                                    
           END;                                                         
         ELSE                                                           
           DO;                                                          
             UDTRÆK_SLUT.SIDSTE.ELBNR      = EVS_ESK.ELBNR;             
             UDTRÆK_SLUT.SIDSTE.EGENNR     = EVS_ESK.EGENNR;            
             UDTRÆK_SLUT.SIDSTE.DFRAGLD    = EVS_ESK.DFRAGLD;           
             UDTRÆK_SLUT.SIDSTE.DTILGLD    = EVS_ESK.DTILGLD;           
             UDTRÆK_SLUT.SIDSTE.CDATAFRA   = EVS_ESK.CDATAFRA;          
             UDTRÆK_SLUT.SIDSTE.CAJOUR     = EVS_ESK.CAJOUR;            
             UDTRÆK_SLUT.SIDSTE.CSUPPL     = EVS_ESK.CSUPPL;            
             UDTRÆK_SLUT.SIDSTE.DHENVN     = PERSON.DHENVN;             
             UDTRÆK_SLUT.SIDSTE.FEJLNR     = EVS_ESK.FEJLNR; /*#101*/   
             UDTRÆK_SLUT.SIDSTE.CÆGTOPR    = PERSON.CÆGTOPR;            
             UDTRÆK_SLUT.SIDSTE.CSKPLOMF   = PERSON.CSKPLOMF;           
                                                                        
             IF PERSON.CEJBEVS ^= '6'             /* #SLUT2006 */       
              & PERSON.CEJBEVS ^= '7'                                   
              & PERSON.CEJBEVS ^= '8'                                   
              & PERSON.CEJBEVS ^= '9'                                   
              & INDK_PERS.GPCTEJER_I = 0                                
              & PERSON.GPCTEJER = 0                                     
              & PERSON.CPCTEJER = '8'                                   
             THEN                                                       
                PERSON.CEJBEVS = '9';                                   
                                                                        
             UDTRÆK_SLUT.SIDSTE.CEJBEVS    = PERSON.CEJBEVS;            
             UDTRÆK_SLUT.SIDSTE.BPENSNED   = PERSON.BPENSNED;           
             UDTRÆK_SLUT.SIDSTE.BPENSNÆ    = PERSON.BPENSNÆ ;           
             UDTRÆK_SLUT.SIDSTE.CEJDTYPE   = EJENDOM.CEJDTYPE;          
             IF PERSON.CEJDTYPE_AKT > '0'                               
             THEN                                                       
               UDTRÆK_SLUT.SIDSTE.CEJDTYPE = PERSON.CEJDTYPE_AKT;       
             UDTRÆK_SLUT.SIDSTE.FELT760    = PERSON.CFELT760;           
             UDTRÆK_SLUT.SIDSTE.CNEDSL1    = PERSON.CNEDSL1;            
                                                                        
             IF PERSON.DATO0107 ^= (10)' '                              
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DATO0107 =                           
                DB2_DATO_TIL_FIX09(PERSON.DATO0107);                    
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DATO0107 = 0;                        
                                                                        
             IF PERSON.DOVTG ^= (10)' '                                 
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DOVTG =                              
                DB2_DATO_TIL_FIX09(PERSON.DOVTG);                       
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DOVTG = 0;                           
                                                                        
             IF PERSON.DAFSTAA ^= (10)' '                               
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DAFSTAA =                            
                DB2_DATO_TIL_FIX09(PERSON.DAFSTAA);                     
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DAFSTAA = 0;                         
                                                                        
             IF PERSON.DINDFLYT ^= (10)' '                              
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DINDFLYT =                           
                DB2_DATO_TIL_FIX09(PERSON.DINDFLYT);                    
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DINDFLYT = 0;                        
                                                                        
             IF PERSON.DFRAFLYT ^= (10)' '                              
             THEN                                                       
                UDTRÆK_SLUT.SIDSTE.DFRAFLYT =                           
                DB2_DATO_TIL_FIX09(PERSON.DFRAFLYT);                    
             ELSE                                                       
                UDTRÆK_SLUT.SIDSTE.DFRAFLYT = 0;                        
                                                                        
             UDTRÆK_SLUT.SIDSTE.CINDFLYT = PERSON.CINDFLYT;             
                                                                        
             IF INDK_PERS.GPCTEJER_I = 0                                
             THEN                                                       
               DO;                                                      
                 /* JXT 27.10.2023 BF17 */                              
                 IF PERSON.CÆGTOPR >= '1'                               
                 THEN DO;                                               
                   UDTRÆK_SLUT.SIDSTE.GPCTEJER = 0;                     
                   UDTRÆK_SLUT.SIDSTE.GPCTEJER_SW = -1;                 
                 END;                       /* JXT 27.10.2023 BF17 */   
                 ELSE DO;                                               
                   UDTRÆK_SLUT.SIDSTE.GPCTEJER = PERSON.GPCTEJER;       
                   UDTRÆK_SLUT.SIDSTE.GPCTEJER_SW = 0;                  
                 END;                                                   
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.GPCTEJER = 0;                       
                 UDTRÆK_SLUT.SIDSTE.GPCTEJER_SW = -1;                   
               END;                                                     
                                                                        
                                                                        
             UDTRÆK_SLUT.SIDSTE.FDAGUDLE   = PERSON.FDAGUDLE;           
             UDTRÆK_SLUT.SIDSTE.GPCTUDLE   = PERSON.GPCTUDLE;           
             UDTRÆK_SLUT.SIDSTE.FUDL100    = PERSON.FUDL100;            
             UDTRÆK_SLUT.SIDSTE.FDAGERHV   = PERSON.FDAGERHV;           
             UDTRÆK_SLUT.SIDSTE.GPCTERHV   = PERSON.GPCTERHV;           
             UDTRÆK_SLUT.SIDSTE.FERHVFLER  = PERSON.FERHVFLER;          
             UDTRÆK_SLUT.SIDSTE.CBERGROP   = PERSON.CBERGROP;           
                                                                        
             IF INDK_PERS.BBERGRL_I = 0                                 
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL = PERSON.BBERGRL;           
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_SW = 0;                     
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBERGRL = 0;                        
                 UDTRÆK_SLUT.SIDSTE.BBERGRL_SW = -1;                    
               END;                                                     
                                                                        
             IF INDK_PERS.BBER2FAM_I = 0                                
             THEN                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM = PERSON.BBER2FAM;         
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_SW = 0;                    
               END;                                                     
             ELSE                                                       
               DO;                                                      
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM = 0;                       
                 UDTRÆK_SLUT.SIDSTE.BBER2FAM_SW = -1;                   
               END;                                                     
                                                                        
             IF INDK_PERS.BBERGRL_AKT_I = 0                             
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT = PERSON.BBERGRL_AKT;  
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT_SW = 0;                
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT = 0;                   
                  UDTRÆK_SLUT.SIDSTE.BBERGRL_AKT_SW = -1;               
                END;                                                    
                                                                        
             IF INDK_PERS.BBER2FAM_AKT_I = 0                            
             THEN                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT = PERSON.BBER2FAM_AKT;
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT_SW = 0;               
                END;                                                    
             ELSE                                                       
                DO;                                                     
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT = 0;                  
                  UDTRÆK_SLUT.SIDSTE.BBER2FAM_AKT_SW = -1;              
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.BPROM1     = PERSON.BPROM1;             
                                                                        
             IF INDK_PERS.BSUM1_I = 0    /*SLUT06*/                     
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM1 = PERSON.BSUM1;             
                   UDTRÆK_SLUT.SIDSTE.BSUM1_SW = 0;                     
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM1 = 0;                        
                   UDTRÆK_SLUT.SIDSTE.BSUM1_SW = -1;                    
                END;                                                    
                                                                        
             IF INDK_PERS.BSUM3_I = 0    /*SLUT06*/                     
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM3 = PERSON.BSUM3;             
                   UDTRÆK_SLUT.SIDSTE.BSUM3_SW = 0;                     
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BSUM3 = 0;                        
                   UDTRÆK_SLUT.SIDSTE.BSUM3_SW = -1;                    
                END;                                                    
                                                                        
             IF PERSON.CEJBEVS = '0' ! PERSON.CEJBEVS = '4' !           
                PERSON.CEJBEVS = '5'                                    
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BNETTO    = PERSON.BNETTO;        
                   UDTRÆK_SLUT.SIDSTE.BNETTO_SW = 0;                    
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BNETTO    = 0;                    
                   UDTRÆK_SLUT.SIDSTE.BNETTO_SW =-1;                    
                END;                                                    
                                                                        
             CALL SKAF_BEJERAN;                                         
             IF INDK_RES.BEJERAN_SW = 0   /* CHEK OM FUNDET */          
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = RESULTAT.BEJERAN;    
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJERAN    = 0;                   
                   UDTRÆK_SLUT.SIDSTE.BEJERAN_SW =-1;                   
                END;                                                    
                                                                        
             IF INDK_PERS.BEVSMAN_I = 0                                 
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN = PERSON.BEVSMAN;         
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN = 0;                      
                   UDTRÆK_SLUT.SIDSTE.BEVSMAN_SW = -1;                  
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.BMANNEDSL  = PERSON.BMANNEDSL;          
             UDTRÆK_SLUT.SIDSTE.CENKE      = PERSON.CENKE;              
             UDTRÆK_SLUT.SIDSTE.CENKEBOH   = PERSON.CENKEBOH;           
             UDTRÆK_SLUT.SIDSTE.BOBEHAKOD  = PERSON.BOBEHAKOD;          
             UDTRÆK_SLUT.SIDSTE.CIVILSTAND = PERSON.CIVILSTAND;         
             UDTRÆK_SLUT.SIDSTE.CSLET      = PERSON.CSLET;              
                                                                        
             IF INDK_PERS.BEJBOL1_I = 0                                 
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1 = PERSON.BEJBOL1;         
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1 = 0;                      
                   UDTRÆK_SLUT.SIDSTE.BEJBOL1_SW = -1;                  
                END;                                                    
                                                                        
             IF INDK_PERS.BEJBOL2_I = 0                                 
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2 = PERSON.BEJBOL2;         
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2 = 0;                      
                   UDTRÆK_SLUT.SIDSTE.BEJBOL2_SW = -1;                  
                END;                                                    
                                                                        
             IF PERSON.CANVEBOL = ' '                                   
              & INDK_PERS.BPROM1_I = 0                                  
              & EJENDOM.INDK.BEJBOL2_AKT_I = 0                          
              & EJENDOM.BEJBOL1_AKT ^= EJENDOM.BEJBOL2_AKT              
             THEN                                                       
                DO;                                                     
                  IF PERSON.BBERGRL_AKT = PERSON.BEJBOL1_AKT            
                  THEN                                                  
                     PERSON.CANVEBOL = '1';                             
                  ELSE                                                  
                  IF PERSON.BBERGRL_AKT = PERSON.BEJBOL2_AKT            
                  THEN                                                  
                     PERSON.CANVEBOL = '2';                             
                END;                                                    
                                                                        
             UDTRÆK_SLUT.SIDSTE.CANVEBOL   = PERSON.CANVEBOL;           
             UDTRÆK_SLUT.SIDSTE.CPTYPSLUT  = PERSON.CPTYPSLUT;          
             UDTRÆK_SLUT.SIDSTE.FELT759    = PERSON.CFELT759;           
             UDTRÆK_SLUT.SIDSTE.CEKSEMP    = PERSON.CEKSEMP; /*#SLUT07*/
             UDTRÆK_SLUT.SIDSTE.CFRÅR      = PERSON.CFRÅR;              
             UDTRÆK_SLUT.SIDSTE.COMPLA     = EVS_ESK.COMPLA;            
             UDTRÆK_SLUT.SIDSTE.DOMPLACPR  = EVS_ESK.DOMPLACPR;         
                                                                        
             //Defekt 2416 - start                                      
             IF UDTRÆK_SLUT.EKOMNR      = 999                           
              & UDTRÆK_SLUT.CLANDEKODE  = 'FR'                          
             THEN DO;                                                   
                IF UDTRÆK_SLUT.SIDSTE.CEKSEMP = '1'                     
                THEN                                                    
                   UDTRÆK_SLUT.CLANDEKODE = 'F1';                       
                IF UDTRÆK_SLUT.SIDSTE.CEKSEMP = '2'                     
                THEN                                                    
                   UDTRÆK_SLUT.CLANDEKODE = 'F2';                       
                END;                                                    
              //Defekt 2416 - slut                                      
                                                                        
             IF INDK_PERS.BUDLSKC_I = 0        /*FORSKUD10*/            
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC    = PERSON.BUDLSKC;      
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC_SW = 0;                   
                END;                                                    
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC    = 0;                   
                   UDTRÆK_SLUT.SIDSTE.BUDLSKC_SW = -1;                  
             END;                                                       
                                                                        
             IF INDK_PERS.BEVSMANFSI_I = 0                              
             THEN                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEVSMANFSI = PERSON.BEVSMANFSI;   
                   UDTRÆK_SLUT.SIDSTE.BEVSMANFSI_SW = 0;                
             END;                                                       
             ELSE                                                       
                DO;                                                     
                   UDTRÆK_SLUT.SIDSTE.BEVSMANFSI = 0;                   
                    UDTRÆK_SLUT.SIDSTE.BEVSMANFSI_SW = -1;              
             END;                                                       
             UDTRÆK_SLUT.SIDSTE.COPR_BEVSMANFSI =                       
                PERSON.COPR_BEVSMANFSI;                                 
                                                                        
             CALL OPSÆT_GL_INDKOMSTÅR (UDTRÆK_SLUT.SIDSTE.CFRÅR,        
                                       UDTRÆK_SLUT.SIDSTE.DRGNÅRFRA,    
                                       UDTRÆK_SLUT.SIDSTE.DRGNÅRTIL);   
           END;                                                         
                                                                        
         PERSON            = ''; /* MED DE NYE TABELLER SKAL VI */      
         EJENDOM           = ''; /* NULSTILLE FØR DEN NÆSTE     */      
         RESULTAT          = ''; /* LÆSNING                     */      
         EVS_ESK           = '';                                        
         EVS_RES           = '';                                        
                                                                        
         FLAG_EN_RÆKKE = '0'B;                                          
                                                                        
 /*******************************************************************/  
 /*    CHECK FOR FORKERTE EJENDOMSNUMMER                            */  
 /*******************************************************************/  
                                                                        
         IF (UDTRÆK_SLUT.SIDSTE.COMPLA = '1')                           
         THEN                                                           
            DO;                                                         
               ANTOMPLACERET = ANTOMPLACERET + 1;                       
               RETURN;                                                  
            END;                                                        
                                                                        
         IF (UDTRÆK_SLUT.EEJDNR = 0)                                    
         THEN                                                           
            DO;                                                         
               ANTEJDNR_EEJDNR_0 = ANTEJDNR_EEJDNR_0 + 1;               
               RETURN;                                                  
            END;                                                        
                                                                        
         IF UDTRÆK_SLUT.EKOMNR ^= 999        &     /*FORSKUD09*/        
            UDTRÆK_SLUT.SIDSTE.CEJBEVS = '9' &                          
            UDTRÆK_SLUT.FØRSTE.CÆGTOPR < '1' & /* JXT 27.10.2023 ???*/  
            UDTRÆK_SLUT.SIDSTE.CÆGTOPR < '1' &                          
            UDTRÆK_SLUT.SIDSTE.CINDFLYT < '1'                           
         THEN                                                           
            DO;                                                         
               ANTCEJBEVS_9 = ANTCEJBEVS_9 + 1;                         
               RETURN;                                                  
            END;                                                        
                                                                        
         /* Fra Forskud 2017 skal slettede ejendomme  */                
         /* ikke indgå i oprettelsen KS30-01          */                
         /* Defect 248 udlandske skrives så de senere */                
         /* kan afgører om data fra EVS SLUT/Forskud  */                
         /* skal bruges                               */                
         /* Slut 2019 danske med  CSLET = 1 skrives   */                
                                                                        
         IF UDTRÆK_SLUT.SIDSTE.CSLET = '1'                              
         THEN                                                           
           DO;                                                          
             ANTCSLET_1 = ANTCSLET_1 + 1;                               
           END;                                                         
                                                                        
 /*********************************************************************/
 /* UDSKRIVNING                                                       */
 /*********************************************************************/
         ANTSKRIV_PERSON = ANTSKRIV_PERSON + 1;                         
                                                                        
         IF UDTRÆK_SLUT.EKOMNR ^= 999 THEN                              
           DO;                                                          
             WRITE FILE (BE3000O) FROM (UDTRÆK_SLUT);                   
             ANTSKRIV_ØVR = ANTSKRIV_ØVR + 1;                           
           END;                                                         
         ELSE                                                           
           DO;                                                          
             WRITE FILE (BE3001O) FROM (UDTRÆK_SLUT);                   
             ANTSKRIV_UDL = ANTSKRIV_UDL + 1;                           
           END;                                                         
                                                                        
 END GEM_SIDSTE_CHECK_SKRIV;                                            
 /********************************************************************/ 
 /* FLYTNING AF DATA FRA EJERSKABSTABEL TIL STRUKTUR                 */ 
 /********************************************************************/ 
 FLYT_ESK_FEL: PROC;                                                    
                                                                        
               PERSON.BEJBOL1              = EVS_ESK.BEJBOL1;           
               PERSON.BEJBOL2              = EVS_ESK.BEJBOL2;           
               PERSON.BEJBOLANV            = EVS_ESK.BEJBOLANV;         
               PERSON.BERHVAN              = EVS_ESK.BERHVAN;           
               PERSON.BEVSMAN              = EVS_ESK.BEVSMAN;           
               PERSON.BFORSKAT             = EVS_ESK.BFORSKAT;          
               PERSON.BFSKAT               = EVS_ESK.BFSKAT;            
               PERSON.BGRPROM1             = EVS_ESK.BGRPROM1;          
               PERSON.BGRPROM2             = EVS_ESK.BGRPROM2;          
               PERSON.BMANNEDSL            = EVS_ESK.BMANNEDSL;         
               PERSON.BNEDSL1              = EVS_ESK.BNEDSL1;           
               PERSON.BNEDSL2              = EVS_ESK.BNEDSL2;           
               PERSON.BNETTO               = EVS_ESK.BNETTO;            
               PERSON.BOBEHAKOD            = EVS_ESK.BOBEHAKOD;         
               PERSON.BPENSNED             = EVS_ESK.BPENSNED;          
         //      PERSON.BPENSNEDGL           = EVS_ESK.BPENSNEDGL;      
               PERSON.BPENSNÆ              = EVS_ESK.BPENSNÆ;           
               PERSON.BPRIVAN              = EVS_ESK.BPRIVAN;           
               PERSON.BPROM1               = EVS_ESK.BPROM1;            
               PERSON.BPROM2               = EVS_ESK.BPROM2;            
               PERSON.BSUM1                = EVS_ESK.BSUM1;             
               PERSON.BSUM2                = EVS_ESK.BSUM2;             
               PERSON.BUDLSKC              = EVS_ESK.BUDLSKC;           
               PERSON.CANVEBOL             = EVS_ESK.CANVEBOL;          
               PERSON.CBERGRGLOP           = EVS_ESK.CBERGRGLOP;        
               PERSON.CBERGROP             = EVS_ESK.CBERGROP;          
               PERSON.CEJBEVS              = EVS_ESK.CEJBEVS;           
               PERSON.CEKSEMP              = EVS_ESK.CEKSEMP;           
               PERSON.CENKE                = EVS_ESK.CENKE;             
               PERSON.CENKEBOH             = EVS_ESK.CENKEBOH;          
               PERSON.CERHV                = EVS_ESK.CERHV;             
               PERSON.CFORSKAT             = EVS_ESK.CFORSKAT;          
               PERSON.CFRÅR                = EVS_ESK.CFRÅR;             
               PERSON.CINDFLYT             = EVS_ESK.CINDFLYT;          
               PERSON.CIVILSTAND           = EVS_ESK.CIVILSTAND;        
               PERSON.CKØBSALG             = EVS_ESK.CKØBSALG;          
               PERSON.CNEDSL1              = EVS_ESK.CNEDSL1;           
               PERSON.CNEDSL2              = EVS_ESK.CNEDSL2;           
               PERSON.CNULSTIL             = EVS_ESK.CNULSTIL;          
               PERSON.CPTYPSLUT            = EVS_ESK.CPTYPSLUT;         
               PERSON.CSKPLOMF             = EVS_ESK.CSKPLOMF;          
               PERSON.CSKPLOMFGL           = EVS_ESK.CSKPLOMFGL;        
               PERSON.CSLET                = EVS_ESK.CSLET;             
               PERSON.CUDLDEL              = EVS_ESK.CUDLDEL;           
               PERSON.CUDLHEL              = EVS_ESK.CUDLHEL;           
               PERSON.CUDLMAN              = EVS_ESK.CUDLMAN;           
               PERSON.CÆGTOPR              = EVS_ESK.CÆGTOPR;           
               PERSON.DAFSTAA              = EVS_ESK.DAFSTAA;           
               PERSON.DAFSTAAFOR           = EVS_ESK.DAFSTAAFOR;        
               PERSON.DATO0107             = EVS_ESK.DATO0107;          
               PERSON.DFRAFLYT             = EVS_ESK.DFRAFLYT;          
               PERSON.DHENVN               = EVS_ESK.DHENVN;            
               PERSON.DINDFLYT             = EVS_ESK.DINDFLYT;          
               PERSON.DOVTG                = EVS_ESK.DOVTG;             
               PERSON.DOVTGFOR             = EVS_ESK.DOVTGFOR;          
               PERSON.FDAGERHV             = EVS_ESK.FDAGERHV;          
               PERSON.FDAGUDLE             = EVS_ESK.FDAGUDLE;          
               PERSON.FERHVFLER            = EVS_ESK.FERHVFLER;         
               PERSON.FUBEBOELIG           = EVS_ESK.FUBEBOELIG;        
               PERSON.FUDL100              = EVS_ESK.FUDL100;           
               PERSON.GLPNR                = EVS_ESK.GLPNR;             
               PERSON.GPCTEJER             = EVS_ESK.GPCTEJER;          
               PERSON.GPCTEJERFOR          = EVS_ESK.GPCTEJERFOR;       
               PERSON.GPCTERHV             = EVS_ESK.GPCTERHV;          
               PERSON.GPCTUDLE             = EVS_ESK.GPCTUDLE;          
               PERSON.CTILKØB              = EVS_ESK.CTILKØB;           
               PERSON.DRGNÅRFRA            = EVS_ESK.DRGNÅRFRA;         
               PERSON.DRGNÅRTIL            = EVS_ESK.DRGNÅRTIL;         
               PERSON.BBER2FAM_AKT         = EVS_ESK.BBER2FAM_AKT;      
               PERSON.BBERGRL_AKT          = EVS_ESK.BBERGRL_AKT;       
               PERSON.BEJBOL1_AKT          = EVS_ESK.BEJBOL1_AKT;       
               PERSON.BEJBOL2_AKT          = EVS_ESK.BEJBOL2_AKT;       
               PERSON.BEJBOLANV_AKT        = EVS_ESK.BEJBOLANV_AKT;     
               PERSON.BPENSNÆGL            = EVS_ESK.BPENSNÆGL;         
               PERSON.BSUM3                = EVS_ESK.BSUM3;             
               PERSON.CAFSTAA              = EVS_ESK.CAFSTAA;           
               PERSON.CANVEBOL_AKT         = EVS_ESK.CANVEBOL_AKT;      
               PERSON.CBOBHAKOD            = EVS_ESK.CBOBHAKOD;         
               PERSON.CDBER2FAM_AKT        = EVS_ESK.CDBER2FAM_AKT;     
               PERSON.CDBERGRL_AKT         = EVS_ESK.CDBERGRL_AKT;      
               PERSON.CDEJBEVS             = EVS_ESK.CDEJBEVS;          
               PERSON.CDEJDTYPE            = EVS_ESK.CDEJDTYPE;         
               PERSON.CDEKSEMP             = EVS_ESK.CDEKSEMP;          
               PERSON.CDENKE               = EVS_ESK.CDENKE;            
               PERSON.CDINDFLYT            = EVS_ESK.CDINDFLYT;         
               PERSON.CDPTYPGL             = EVS_ESK.CDPTYPGL;          
               PERSON.CDPTYPSLUT           = EVS_ESK.CDPTYPSLUT;        
               PERSON.CDÆGTOPR             = EVS_ESK.CDÆGTOPR;          
               PERSON.CEJDTYPE_AKT         = EVS_ESK.CEJDTYPE_AKT;      
               PERSON.CERHVFLER            = EVS_ESK.CERHVFLER;         
               PERSON.CEVSGL               = EVS_ESK.CEVSGL;            
               PERSON.CEVSMAN              = EVS_ESK.CEVSMAN;           
               PERSON.CFELT759             = EVS_ESK.CFELT759;          
               PERSON.CFELT760             = EVS_ESK.CFELT760;          
               PERSON.CFRAFLYTDTO          = EVS_ESK.CFRAFLYTDTO;       
               PERSON.CFRÅR_FOR            = EVS_ESK.CFRÅR_FOR;         
               PERSON.CINDFLYTDTO          = EVS_ESK.CINDFLYTDTO;       
               PERSON.COVTG                = EVS_ESK.COVTG;             
               PERSON.CPCTEJER             = EVS_ESK.CPCTEJER;          
               PERSON.CPCTERHV             = EVS_ESK.CPCTERHV;          
               PERSON.CPCTUDLE             = EVS_ESK.CPCTUDLE;          
               PERSON.CPENSNEDGL           = EVS_ESK.CPENSNEDGL;        
               PERSON.CUBEBOELIG           = EVS_ESK.CUBEBOELIG;        
               PERSON.CUDLSKC              = EVS_ESK.CUDLSKC;           
               PERSON.DERHVPER_FRA1        = EVS_ESK.DERHVPER_FRA1;     
               PERSON.DERHVPER_TIL1        = EVS_ESK.DERHVPER_TIL1;     
               PERSON.DERHVPER_FRA2        = EVS_ESK.DERHVPER_FRA2;     
               PERSON.DERHVPER_TIL2        = EVS_ESK.DERHVPER_TIL2;     
               PERSON.DERHVPER_FRA3        = EVS_ESK.DERHVPER_FRA3;     
               PERSON.DERHVPER_TIL3        = EVS_ESK.DERHVPER_TIL3;     
               PERSON.DERHVPER_FRA4        = EVS_ESK.DERHVPER_FRA4;     
               PERSON.DERHVPER_TIL4        = EVS_ESK.DERHVPER_TIL4;     
               PERSON.DERHVPER_FRA5        = EVS_ESK.DERHVPER_FRA5;     
               PERSON.DERHVPER_TIL5        = EVS_ESK.DERHVPER_TIL5;     
               PERSON.FERHVPER_ANT         = EVS_ESK.FERHVPER_ANT;      
               PERSON.CNEDTAG158           = EVS_ESK.CNEDTAG158;        
               PERSON.BEJDVPUSKTP          = EVS_ESK.BEJDVPUSKTP;       
               PERSON.BEJDVÆPUSKP          = EVS_ESK.BEJDVÆPUSKP;       
               PERSON.CFELT762             = EVS_ESK.CFELT762;          
               PERSON.CFELT769             = EVS_ESK.CFELT769;          
               PERSON.DVURDÅR              = EVS_ESK.DVURDÅR;           
               PERSON.CRTEKORNS            = EVS_ESK.CRTEKORNS;         
               PERSON.COPR_CRTEKORNS       = EVS_ESK.COPR_CRTEKORNS;    
               PERSON.VURMARK_AKT          = EVS_ESK.VURMARK_AKT;       
               PERSON.VURMARK              = EVS_ESK.VURMARK;           
               PERSON.JUR_KATEGO_AKT       = EVS_ESK.JUR_KATEGO_AKT;    
               PERSON.JUR_KATEGO           = EVS_ESK.JUR_KATEGO;        
               PERSON.JUR_UKATEGO_AKT      = EVS_ESK.JUR_UKATEGO_AKT;   
               PERSON.JUR_UKATEGO          = EVS_ESK.JUR_UKATEGO;       
               PERSON.VURDATO_AKT          = EVS_ESK.VURDATO_AKT;       
               PERSON.VURDATO              = EVS_ESK.VURDATO;           
               PERSON.FORSIGT_EVS_AKT      = EVS_ESK.FORSIGT_EVS_AKT;   
               PERSON.FORSIGT_EVS          = EVS_ESK.FORSIGT_EVS;       
               PERSON.BESKAT_EVS_AKT       = EVS_ESK.BESKAT_EVS_AKT;    
               PERSON.BESKAT_EVS           = EVS_ESK.BESKAT_EVS;        
               PERSON.EJET20240101         = EVS_ESK.EJET20240101;      
               PERSON.BEVSMANFSI           = EVS_ESK.BEVSMANFSI;        
               PERSON.COPR_BEVSMANFSI      = EVS_ESK.COPR_BEVSMANFSI;   
               PERSON.BTAKS                = EVS_ESK.BTAKS;             
               PERSON.BTAKSRABAT           = EVS_ESK.BTAKSRABAT;        
               PERSON.BTAKSEFTERRABAT      = EVS_ESK.BTAKSEFTERRABAT;   
               PERSON.BBER2FAM             = EVS_ESK.BBER2FAM;          
               PERSON.BBERGRL              = EVS_ESK.BBERGRL;           
                                                                        
                                                                        
 END FLYT_ESK_FEL;                                                      
 /*********************************************************************/
 /* OPSÆT BRUGTE INDIKATORE TIL -1 SOM STARTS VÆRDI            RUTINE */
 /*********************************************************************/
 INIT_INDK: PROC;                                                       
                                                                        
   IF TFLAG THEN PUT SKIP LIST('***** '!!PROCNAME!!' *****');           
                                                                        
   INDK_PERS.BBER2FAM_I         = -1;                                   
   INDK_PERS.BBERGRL_I          = -1;                                   
   INDK_PERS.BEJBOL1_I          = -1;                                   
   INDK_PERS.BEJBOL2_I          = -1;                                   
   INDK_PERS.BEJBOLANV_I        = -1;                                   
   INDK_PERS.BEVSMAN_I          = -1;                                   
   INDK_PERS.BFORSKAT_I         = -1;                                   
   INDK_PERS.BGRPROM1_I         = -1;                                   
   INDK_PERS.BGRPROM2_I         = -1;                                   
   INDK_PERS.BMANNEDSL_I        = -1;                                   
   INDK_PERS.BNEDSL1_I          = -1;                                   
   INDK_PERS.BNEDSL2_I          = -1;                                   
   INDK_PERS.BNETTO_I           = -1;                                   
   INDK_PERS.BPENSNED_I         = -1;                                   
   INDK_PERS.BPENSNÆ_I          = -1;                                   
   INDK_PERS.BPROM1_I           = -1;                                   
   INDK_PERS.BPROM2_I           = -1;                                   
   INDK_PERS.BSUM1_I            = -1;                                   
   INDK_PERS.BSUM2_I            = -1;                                   
   INDK_PERS.BUDLSKC_I          = -1;                                   
   INDK_PERS.GPCTEJER_I         = -1;                                   
   INDK_PERS.BBER2FAM_AKT_I     = -1;                                   
   INDK_PERS.BBERGRL_AKT_I      = -1;                                   
   INDK_PERS.BEJBOL1_AKT_I      = -1;                                   
   INDK_PERS.BEJBOL2_AKT_I      = -1;                                   
   INDK_PERS.BEJBOLANV_AKT_I    = -1;                                   
   INDK_PERS.BPENSNÆGL_I        = -1;                                   
   INDK_PERS.BSUM3_I            = -1;                                   
   INDK_PERS.BEJDVPUSKTP_I      = -1;                                   
   INDK_PERS.BEJDVÆPUSKP_I      = -1;                                   
   INDK_PERS.BEVSMANFSI_I       = -1;                                   
                                                                        
 END INIT_INDK;                                                         
 /*********************************************************************/
 OPSTART_INIT: PROC;                                                    
                                                                        
   DCL     HJ_KOMNR     PIC '(03)9';                                    
                                                                        
   /* PARMKORT ER EVT. MEDTAGET I KØRSLEN */                            
   ON  ENDFILE (PARMKORT)                                               
   BEGIN;                                                               
      EOF_PARM  = '1'B;                                                 
      GO TO INIT_SLUT;                                                  
   END;                                                                 
                                                                        
   PARMLINIE = '';                                                      
                                                                        
   READ FILE (PARMKORT) INTO  (PARM_AR);                                
                                                                        
   IF PARMLINIE.PROGNAVN ^= 'BE30000'                                   
    THEN                                                                
       PARM_FEJL = '1'B;                                                
                                                                        
    IF VERIFY (PARMLINIE.KOMNR1,'0123456789')  >  0                     
    THEN                                                                
      DO;                                                               
        PARM_FEJL = '1'B;                                               
      END;                                                              
                                                                        
    /*Første kommunenummer skal være udfyldt når der er parmkort*/      
    IF PARMLINIE.KOMNR1  <  '100' !                                     
       PARMLINIE.KOMNR1  >  '999'                                       
    THEN                                                                
      DO;                                                               
        PARM_FEJL = '1'B;                                               
      END;                                                              
                                                                        
    IF PARM_FEJL                                                        
    THEN                                                                
       DO;                                                              
         PUT SKIP LIST ('FEJL I PARMKORT: ',PARM_AR);                   
         ABENDMEDD = '101 FEJL I PARMKORT';                             
         CALL ZS30101(5,ABENDMEDD,2);                                   
       END;                                                             
    ELSE                                                                
       DO;                                                              
         PARM_MEDTAGET  = '1'B;                                         
         PUT SKIP LIST('PARMKORT MEDTAGET: ' !!                         
                PARMLINIE.PROGNAVN  !! PARMLINIE.KOMNR1 !!              
                PARMLINIE.KOMNR2 !! PARMLINIE.KOMNR3);                  
       END;                                                             
                                                                        
   INIT_SLUT:                                                           
                                                                        
   IF PARMLINIE.KOMNR1 = ''                                             
   THEN                                                                 
     DO;                                                                
       PARMKOMNR1 = 0;                                                  
       PARMKOMNR2 = 0;                                                  
       PARMKOMNR3 = 0;                                                  
     END;                                                               
   ELSE                                                                 
     DO;                                                                
       HJ_KOMNR  = PARMLINIE.KOMNR1;                                    
       PARMKOMNR1 = HJ_KOMNR;                                           
       IF PARMLINIE.KOMNR2 > '000'                                      
       THEN                                                             
         DO;                                                            
           HJ_KOMNR  = PARMLINIE.KOMNR2;                                
           PARMKOMNR2 = HJ_KOMNR;                                       
         END;                                                           
                                                                        
       IF PARMLINIE.KOMNR3 > '000'                                      
       THEN                                                             
         DO;                                                            
           HJ_KOMNR  = PARMLINIE.KOMNR3;                                
           PARMKOMNR3 = HJ_KOMNR;                                       
         END;                                                           
                                                                        
       PUT SKIP LIST('PARMLINIE.KOMNR1 =',PARMKOMNR1);                  
       PUT SKIP LIST('PARMLINIE.KOMNR2 =',PARMKOMNR2);                  
       PUT SKIP LIST('PARMLINIE.KOMNR3 =',PARMKOMNR3);                  
     END;                                                               
                                                                        
                                                                        
  END OPSTART_INIT;                                                     
                                                                        
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST('SQL_FEJL.....');                                
         PUT SKIP LIST('SQLCA',SQLCA);                                  
         CLOSE FILE(BE245I);            /*RUL*/                         
         CLOSE FILE(BE3000O);                                           
         CLOSE FILE(BE3001O);                                           
         CALL ZS67000(SQLCA);                                           
                                                                        
         ABENDMEDD =  FEJLTEKST;                                        
                                                                        
         CALL ZS30101 (5, ABENDMEDD, 2);                                
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* LUK FILER, CURSOR OG UDSKRIV AFSTEMNINGS- OG KONTROLLISTE  RUTINE */
 /*********************************************************************/
 AFSLUT: PROC;                                                          
                                                                        
         CLOSE FILE(BE245I);             /*RUL*/                        
         CLOSE FILE(BE3000O);                                           
         CLOSE FILE(BE3001O);                                           
         CALL CLOSE_PERSONEJENDOMSOPL;                                  
                                                                        
         LINIE = ZZWS2;                                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL LÆSTE FRA PERSONTABELLEN ................'; 
         LIN.ANT   = ANTLÆS_PERSON;                                     
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKRIV MED CEJBEVS = 9 OG CÆGTOPR < 1..'; 
         LIN.ANT   = ANTCEJBEVS_9;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET OMPLACERET ...................'; 
         LIN.ANT   = ANTOMPLACERET;                                     
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET MED EJDNR = 0 ................'; 
         LIN.ANT   = ANTEJDNR_EEJDNR_0;                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET MED CSLET LIG 1 ..............'; 
         LIN.ANT   = ANTCSLET_1;                                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL SKREVNE IALT ............................'; 
         LIN.ANT   = ANTSKRIV_PERSON;                                   
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '      HERAF DANSKE EJENDOMME ..................'; 
         LIN.ANT   = ANTSKRIV_ØVR;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '      HERAF UDENLANDSKE EJENDOMME .............'; 
         LIN.ANT   = ANTSKRIV_UDL;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         CALL ZZ20300(' ','99');                      /* LUK KMDSPOOL */
                                                                        
 END AFSLUT;                                                            
 /*********************************************************************/
 /* HER STARTER APPLIKATIONENS EGNE INCLUDES                          */
 /*********************************************************************/
 %INCLUDE BE30000M;             /* DECLARE OG FETCH SQL STATEMENTS.   */
 %INCLUDE ZM90013M;             /* OMSÆT DATO TIL/FRA DB2-DATOFORMAT  */
 %INCLUDE ZM90051M;             /* KONV BIN15 TIL CHAR                */
 %INCLUDE BS34307M;             /* KONV BF31 TIL CHAR6                */
 %INCLUDE BE30001M;             /* KONV DATO FRA CHAR TIL DEC FIXED   */
 %INCLUDE BE30002M;             /* KONV CHAR(10) TIL DEC FIXED(11)    */
 %INCLUDE BE30003M;             /* OPSÆT GL. REGNSKABS- OG INDKOMSTÅR */
                                                                        
 END BE30000;                                                           
