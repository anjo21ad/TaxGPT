  PROCESS OPT(TIME);                                                    
 BH90100: /* DAN 1. UDGAVE AF BEREGNINGSBÅND TIL EVS FORSKUD */         
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
         INIT ('COPYRIGHT KMD A/S 2003');                               
 /********************************************************************* 
 *                                                                    * 
 * FORMÅL: SAMSORTEREDE UDTRÆK FRA ESR, SLUT OG FORSKUD EVS-TABELLER  * 
 *         BRUGES TIL DANNELSE AF 1. UDGAVE AF BEREGNINGSBÅNDET TIL   * 
 *         EVS FORSKUD.                                               * 
 *                                                                    * 
 * INPUT:  B.H61200D  UDTRÆK FRA ESR, EVS SLUT OG EVS FORSKUD         * 
 *                                                                    * 
 * OUTPUT: B.H90100D  BEREGNINGSBÅND                                  * 
 *         B.H90110D  BEREGNINGSBÅND - FRASORTEREDE DUBLETTER         * 
 *         BH90101Y   KONTROLLISTE                                    * 
 *                                                                    * 
 * PROGRAMMØR:   AAGE RASMUSSEN PUS T&S DEC 2000                      * 
 *                                                                    * 
 * ÅRSTILRETTET: AAGE RASMUSSEN T&S NOV 2001                          * 
 * ÅRSTILRETTET: BENTE BJERG    T&S AUG 2002                          * 
 * ÅRSTILRETTET: BO SCHMIDT     T&S JUL 2003                          * 
 * ÅRSTILRETTET: BO SCHMIDT     T&S JUL 2004                          * 
 * FORSKUD06     SUSANNE KROGH VILLUMSEN               31/05-2005     * 
 *               ÅRSTILRETTET                                         * 
 *               BH901.ESR.STAMOPL.VURDOPL0 ÆNDRES TIL                * 
 *               BH901.ESR.STAMOPL.VURDOPLNY                          * 
 *               BBERGRL_02_SW ÆNDRES TIL BBERGRL_02ANV_SW            * 
 *               BBER2FAM_02_SW ÆNDRES TIL BBER2FAM_02ANV_SW          * 
 * FORSKUD07     BO SCHMIDT                            14/05-2006     * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD08     BO SCHMIDT                            23/05-2007     * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD09     BO SCHMIDT                            23/06-2008     * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD10     GERD HOLM-PEDERSEN                    16/04-2009     * 
 *               ÅRSTILRETTET                                         * 
 *               BUDLSKC_SW  TILFØJET                                 * 
 *               LANDEKODE FR SKAL SÆTTES OP SOM F1 ELLER F2 FRA SLUT * 
 *               OG ALTID SOM F2 FRA FORSKUD, SOM KUN BRUGES HVIS     * 
 *               EJENDOMMEN IKKE FINDES I SLUT                        * 
 * FORSKUD11     GERD HOLM-PEDERSEN                    08/06-2010     * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD12     GERD HOLM-PEDERSEN                    08/06-2011     * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD13     LARS KAAE HARRITSHØJ                  07/06-2012     * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD14     LARS KAAE HARRITSHØJ                   Maj 2013      * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD15     JØRGEN SAUGMANN                       JUN 2014       * 
 *               ÅRSTILRETTET                                         * 
 * FORSKUD16     JØRGEN SAUGMANN                       JUN 2015       * 
 *               ÅRSTILRETTET                                         * 
 * SLUT15        ESBEN BRODERSEN                       MAR 2016       * 
 *               UDVIDET BRUG AF BH55300M DATO INCLUDE #01            * 
 * FORSKUD17     ESBEN BRODERSEN                       JUN 2016       * 
 *               ÅRSTILRETTET                                         * 
 * SLUT16        LENE MAJ JENSEN Z6QLE                25/07-2016      * 
 *               TILRETNING AF CHECK PÅ OM INDENLANDSK EJENDOM        * 
 *               SKAL VIDEREFØRES PÅ GRUNDLAG AF SLUT                 * 
 * FORSKUD18     ESBEN BRODERSEN                       JUN 2017       * 
 *               KUN KOMPILERET                                       * 
 * FORSKUD19     ESBEN BRODERSEN                       MAJ 2018       * 
 *               KUN KOMPILERET                                       * 
 * FORSKUD20 #02:Edward Laryea, EDL                    22-03-2019     * 
 *               Nyt felt STRAKS_EVS i BH32202N                       * 
 * FORSKUD20 #03 Esben Brodersen                       08-04-2019     * 
 *               UDVIDDET NØGLE MED EENHEDLBNR TIL 2 FAMILIE BOLIG    * 
 *               UDVIDDET REGLER FOR VIDERFØRSEL FRA EVS SLUT         * 
 *               MED CEJBEVS = B OG C SAMT CDATAFRA = 7               * 
 * Forskud2021 Per Brunk                               Marts 2020     * 
 *               Nye felter i BH32202N VURMARK og VUR2001             * 
 * Slut 2020:    Elena Flygenring EFL                  marts 2021     * 
 *             - struktur BH65300M erstattes med BH55300M             * 
 *             - struktur BH90100N erstattes med BH90121N             * 
 *             - kompileringsfejl rettet: dcl af BH612_AR ændret      * 
 *               fra char(3000) var til char (4000) var               * 
 * Forskud2022 Per Brunk                               Juni 2021      * 
 *             Udfyldelse af BFENR og VUREJENDOMID for ejendom (D897) * 
 * Forskud2022 Per Brunk                               August 2021    * 
 *             KS46 - ny struktur BH30100N                            * 
 *             BH90122N -> BH90121N                    2021-10-27     * 
 * Forskud2023 Per Brunk  Årsrul                       08.06.2022     * 
 * SLUT 2022   Per Brunk compileret                    oktober 2022   * 
 *********************************************************************/ 
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH612I FILE RECORD INPUT;     /* ESR OG EVS UDTRÆK         */  
 DCL     BH901O FILE RECORD OUTPUT;    /* BEREGNINGSBÅND            */  
 DCL     BH9011O FILE RECORD OUTPUT;   /* BEREGNINGSBÅND - DUBLETTER*/  
 DCL     SYSPRINT FILE EXTERNAL PRINT;                                  
 /********************************************************************* 
 *       DECLARE AF UDTRÆK FRA ESR                                    * 
 *********************************************************************/ 
 DCL     BH612_AR        CHAR      (4000) VAR;                          
 DCL     1 BH6121        BASED     (ADDR(BH612_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH32400N;;                                          
                                                                        
 DCL     1 BH6122        BASED     (ADDR(BH612_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH31700N;;                                          
                                                                        
 DCL     1 BH612_ID1,                                                   
           2 DCPRCIR     PIC       '(10)9',                             
           2 EKOMNR      PIC       '(3)9',                              
           2 EEJDNR      PIC       '(7)9',                              
           2 EENHEDLBNR  BIN FIXED (15);      /*#03*/                   
                                                                        
 /*0DCL     1 BH612_ID2     BASED(ADDR(BH612_ID1)),                     
           2 FØSDAG      PIC       '(6)9',                              
           2 LØBENR      PIC       '999',                               
           2 CHKCIF      PIC       '9'; */                              
 DCL       BH612_ID        CHAR(22)   BASED(ADDR(BH612_ID1)); /*#03*/   
                                                                        
 DCL     1 GEM,                                                         
           2 EVS_UDTRÆK,                                                
             %INCLUDE BH31700N;;                                        
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (BEREGNINGSBÅND)                           * 
 *********************************************************************/ 
 DCL     1 BH901,                                                       
           %INCLUDE BH90123N;;              /* RUL */                   
 DCL     1 BH90099,                                                     
           %INCLUDE BH90099N;               /* OPTÆLLINGSINDIVID      */
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_BH612        FIXED DEC (7),                            
           2 LÆS_EVS          FIXED DEC (7),                            
           2 LÆS_EVS_F        FIXED DEC (7),                            
           2 LÆS_EVS_S        FIXED DEC (7),                            
           2 FESR_MATCH       FIXED DEC (7),                            
           2 FOVF_SALG        FIXED DEC (7),                            
           2 LÆS_ESR          FIXED DEC (7),                            
           2 OFF_CPR          FIXED DEC (7),                            
           2 OFF_EJ_CPR       FIXED DEC (7),                            
           2 OVERSPR_CPR      FIXED DEC (7),                            
           2 OVERSPR_SE       FIXED DEC (7),                            
           2 OVERSPR_EVSHDL   FIXED DEC (7),                            
           2 SLETSLUT_EJERHDL FIXED DEC (7),                            
           2 SLETSLUT_ÆGTFHDL FIXED DEC (7),                            
           2 SLET_FORSKUD_HDL FIXED DEC (7),                            
           2 TO_EJER          FIXED DEC (7),                            
           2 EJ_SKR           FIXED DEC (7),                            
           2 TO_EJER_NUL      FIXED DEC (7),                            
           2 FL_EJER_NUL      FIXED DEC (7),                            
           2 GANE_JUSTER      FIXED DEC (7),                            
           2 SAMME_EJER       FIXED DEC (7),                            
           2 KUN_ÆGTF         FIXED DEC (7),                            
           2 EJER_OPRET       FIXED DEC (7),                            
           2 ÆGTF_OPRET       FIXED DEC (7),                            
           2 EJER_SLETTET     FIXED DEC (7),                            
           2 ÆGTF_SLETTET     FIXED DEC (7),                            
           2 EJER_OMBYT       FIXED DEC (7),                            
           2 ÆGTFOPR_FEJL     FIXED DEC (7),                            
           2 FRASORTERET      FIXED DEC (7),                            
           2 EJER_FRA_SLUT    FIXED DEC (7),                            
           2 SOLGT_I_SLUT     FIXED DEC (7),                            
           2 EJET_I_SLUT      FIXED DEC (7),                            
           2 RET_EFTERLEV     FIXED DEC (7),                            
           2 OPR_EFTERLEV     FIXED DEC (7),                            
           2 OPR_SLUT_EJER    FIXED DEC (7),                            
           2 SKREVET          FIXED DEC (7),                            
           2 FEVS             FIXED DEC (7),                            
           2 FØVREVS          FIXED DEC (7),                            
           2 FUDLANDSK        FIXED DEC (7),                            
           2 FEVSOPRET        FIXED DEC (7),                            
           2 FL_EJER          FIXED DEC (7),                            
           2 FORSKEL1         FIXED DEC (7),                            
           2 FORSKEL2         FIXED DEC (7),                            
           2 FORSKEL3         FIXED DEC (7),                            
           2 PGF4A            FIXED DEC (7),                            
           2 PGF4B            FIXED DEC (7);                            
                                                                        
 /********************************************************************* 
 *       DECLARE AF DIV. FÆLLESMACROER (ESKEMA/BOY/FORSKUD)           * 
 *********************************************************************/ 
 DCL     1 BH55300M,                                                    
           %INCLUDE BH55300M;                                           
 DCL     1 BH60101M      ALIGNED,                                       
           %INCLUDE BH60101M;                                           
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     STG             BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     VERIFY          BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH90100L'),                                        
           2 F1          CHAR      (28)      INIT      (' '),           
           2 TEKST2      CHAR      (49)      INIT      (' '),           
           2 TEKST3      CHAR      (28)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN0,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (41),                                
           2 CPUÅR       PIC       '99',                                
           2 TEKST2      CHAR      (11),                                
           2 START       PIC       '999999',                            
           2 TEKST3      CHAR      (9),                                 
           2 SLUT        PIC       '999999',                            
           2 TEKST4      CHAR      (57);                                
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (33),                                
           2 RCKOD       CHAR      (01)      INIT      (' '),           
           2 F1          CHAR      (19)      INIT      (' '),           
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (68)      INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     (I,J,K,N)       BIN FIXED (15)    INIT (0);                    
 DCL     EOF_BH612       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     HJ_CPR          PIC       '(10)9';                             
 DCL     CRETUR          CHAR      (1);                                 
 DCL     MATCH_CPRNR     FIXED     (11) INIT (0);                       
 DCL     MATCH_KOMNR     FIXED     (3)  INIT (0);                       
 DCL     MATCH_EJDNR     FIXED     (7)  INIT (0);                       
 DCL     MATCH_ENHEDLBNR BIN FIXED (15) INIT (0);                       
 DCL     HJKOMNR         PIC       '999';     /* HJÆLPEFELT TIL KOMNR */
 DCL     HJCRCKO         PIC       '9';       /* HJÆLPEFELT TIL RCKODE*/
 DCL     EJENDOM_VIDERE  BIT       (1);                                 
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
         EOF_BH612 = NEJ;                                               
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (BH612I)  TITLE ('BH61200I');                        
         OPEN FILE (BH901O)  TITLE ('BH90100O');                        
         OPEN FILE (BH9011O) TITLE ('BH90110O');                        
                                                                        
         ON ENDFILE (BH612I)                                            
            EOF_BH612 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH90101Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         OVERLIN1.TEKST2 = '1. UDGAVE AF BEREGNINGSBÅND TIL EVS ' !!    
                           'FORSKUD ' !! INDKÅR2;                       
                                                                        
         TV = 0;                                                        
                                                                        
         GEM = '';                                                      
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_BH612;                                                
                                                                        
         DO WHILE ( EOF_BH612 = NEJ );                                  
                                                                        
            CALL BEHANDL; /* BEHANDL ESR+EVS-UDTRÆK */                  
            CALL LÆS_BH612;                                             
                                                                        
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR OG EVS - SAMSORTERET (B.H61200D)          * 
 *********************************************************************/ 
 LÆS_BH612:                                                             
         PROC;                                                          
                                                                        
         READ FILE (BH612I) INTO (BH612_AR);                            
                                                                        
         IF EOF_BH612 = NEJ                                             
         THEN                                                           
            DO;                                                         
               BH612_ID1.DCPRCIR    = BH6121.SORTCPR;                   
               BH612_ID1.EKOMNR     = BH6121.EKOMNR;                    
               BH612_ID1.EEJDNR     = BH6121.EEJDNR;                    
               BH612_ID1.EENHEDLBNR = BH6121.EENHEDLBNR;                
                                                                        
               TV.LÆS_BH612 = TV.LÆS_BH612 + 1;                         
               IF BH6121.SORTCITYP > 0                                  
               THEN                                                     
                  TV.LÆS_ESR = TV.LÆS_ESR + 1;                          
               ELSE                                                     
                  DO;                                                   
                     TV.LÆS_EVS = TV.LÆS_EVS + 1;                       
                     SELECT;                                            
                       WHEN (BH6122.EVS_FORSK_EJER.DCPRN > 0 &          
                             BH6122.EVS_SLUT_EJER.DCPRN = 0 &           
                             BH6122.EVS_SLUT_ÆGTF.DCPRN = 0)            
                          TV.LÆS_EVS_F = TV.LÆS_EVS_F + 1;              
                       WHEN (BH6122.EVS_FORSK_EJER.DCPRN = 0)           
                          TV.LÆS_EVS_S = TV.LÆS_EVS_S + 1;              
                       OTHERWISE;                                       
                     END;                                               
                  END;                                                  
            END;                                                        
 END LÆS_BH612;                                                         
 /*********************************************************************/
 /*       PERSONER SOM EVT. SKAL BEHANDLES/BEREGNES              /*#03*/
 /*********************************************************************/
 BEHANDL: PROC;                                                         
                                                                        
                                                                        
         IF GEM.EVS_UDTRÆK.DCPRNUM > 0 &                                
           (BH6121.SORTCPR > GEM.EVS_UDTRÆK.DCPRNUM  !                  
            (BH6121.SORTCPR = GEM.EVS_UDTRÆK.DCPRNUM  &                 
             BH6121.EKOMNR  > GEM.EVS_UDTRÆK.EKOMNUM) !                 
            (BH6121.SORTCPR = GEM.EVS_UDTRÆK.DCPRNUM  &                 
             BH6121.EKOMNR  = GEM.EVS_UDTRÆK.EKOMNUM  &                 
             BH6121.EEJDNR  > GEM.EVS_UDTRÆK.EEJDNUM) !                 
            (BH6121.SORTCPR = GEM.EVS_UDTRÆK.DCPRNUM  &                 
             BH6121.EKOMNR  = GEM.EVS_UDTRÆK.EKOMNUM  &                 
             BH6121.EEJDNR  = GEM.EVS_UDTRÆK.EEJDNUM  &                 
             BH6121.EENHEDLBNR > GEM.EVS_UDTRÆK.EENHEDLBNUM))           
         THEN                                                           
            DO;                                                         
               IF MATCH_CPRNR     = GEM.EVS_UDTRÆK.DCPRNUM &            
                  MATCH_KOMNR     = GEM.EVS_UDTRÆK.EKOMNUM &            
                  MATCH_EJDNR     = GEM.EVS_UDTRÆK.EEJDNUM &            
                  MATCH_ENHEDLBNR = GEM.EVS_UDTRÆK.EENHEDLBNUM          
               THEN;                                                    
               ELSE                                                     
                  IF  GEM.EVS_UDTRÆK.DCPRNUM > MATCH_CPRNR  !           
                     (GEM.EVS_UDTRÆK.DCPRNUM = MATCH_CPRNR  &           
                      GEM.EVS_UDTRÆK.EKOMNUM > MATCH_KOMNR) !           
                     (GEM.EVS_UDTRÆK.DCPRNUM = MATCH_CPRNR  &           
                      GEM.EVS_UDTRÆK.EKOMNUM = MATCH_KOMNR  &           
                      GEM.EVS_UDTRÆK.EEJDNUM > MATCH_EJDNR) !           
                     (GEM.EVS_UDTRÆK.DCPRNUM = MATCH_CPRNR  &           
                      GEM.EVS_UDTRÆK.EKOMNUM = MATCH_KOMNR  &           
                      GEM.EVS_UDTRÆK.EEJDNUM = MATCH_EJDNR  &           
                      GEM.EVS_UDTRÆK.EENHEDLBNUM > MATCH_ENHEDLBNR)     
                  THEN                                                  
                     DO;                                                
                        CALL BEHANDL_EVS_TILGANG;                       
                        GEM = '';                                       
                     END;                                               
            END;                                                        
                                                                        
         IF BH6121.SORTCITYP = 0          /* INDIVID MED DATA FRA EVS */
         THEN                                                           
            DO;                                                         
               CALL BEHANDL_EVS_UDTRÆK;                                 
               RETURN;                                                  
            END;                                                        
                                                                        
         BH60101M = '';                                                 
         BH901 = '';                                                    
         BH901.ESR = BH6121, BY NAME;                                   
                                                                        
         IF GEM.EVS_UDTRÆK.DCPRNUM = BH901.ESR.SORTCPR &                
            GEM.EVS_UDTRÆK.EKOMNUM = BH901.ESR.EKOMNR &                 
            GEM.EVS_UDTRÆK.EEJDNUM = BH901.ESR.EEJDNR &                 
            GEM.EVS_UDTRÆK.EENHEDLBNUM = BH901.ESR.EENHEDLBNR           
         THEN                                                           
            DO;                                                         
               TV.FESR_MATCH = TV.FESR_MATCH + 1;                       
               MATCH_CPRNR = GEM.EVS_UDTRÆK.DCPRNUM;                    
               MATCH_KOMNR = GEM.EVS_UDTRÆK.EKOMNUM;                    
               MATCH_EJDNR = GEM.EVS_UDTRÆK.EEJDNUM;                    
               MATCH_ENHEDLBNR = GEM.EVS_UDTRÆK.EENHEDLBNUM;            
               BH901.EVS_UDTRÆK = GEM.EVS_UDTRÆK, BY NAME;              
            END;                                                        
         ELSE                                                           
            DO;                                                         
               /* INITIER DIVERSE INDIKATOR-FELTER */                   
               /* HVIS INTET EVS-UDTRÆK FOR EJER OG/ELLER ÆGTEFÆLLE */  
               IF BH901.EVS_SLUT_EJER.DCPRN = 0                         
               THEN                                                     
                  DO;                                                   
                     BH901.EVS_SLUT_EJER.FØRSTE.GPCTEJER_SW = -1;       
                     BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = -1;       
                     BH901.EVS_SLUT_EJER.FØRSTE.BBERGRL_SW = -1;        
                     BH901.EVS_SLUT_EJER.SIDSTE.BBERGRL_SW = -1;        
                     BH901.EVS_SLUT_EJER.FØRSTE.BBER2FAM_SW = -1;       
                     BH901.EVS_SLUT_EJER.SIDSTE.BBER2FAM_SW = -1;       
   /*FORSKUD11       BH901.EVS_SLUT_EJER.FØRSTE.BBERGRLUDL_01_SW = -1;  
                     BH901.EVS_SLUT_EJER.SIDSTE.BBERGRLUDL_01_SW = -1;  
                     BH901.EVS_SLUT_EJER.FØRSTE.BOMBTILBUDL_01_SW = -1; 
                     BH901.EVS_SLUT_EJER.SIDSTE.BOMBTILBUDL_01_SW = -1*/
                     BH901.EVS_SLUT_EJER.FØRSTE.BBERGRL_015ANV_SW = -1; 
                     BH901.EVS_SLUT_EJER.SIDSTE.BBERGRL_015ANV_SW = -1; 
                     BH901.EVS_SLUT_EJER.FØRSTE.BBER2FAM_015ANV_SW = -1;
                     BH901.EVS_SLUT_EJER.SIDSTE.BBER2FAM_015ANV_SW = -1;
   /*FORSKUD06*/     BH901.EVS_SLUT_EJER.FØRSTE.BBERGRL_02ANV_SW = -1;  
   /*FORSKUD06*/     BH901.EVS_SLUT_EJER.SIDSTE.BBERGRL_02ANV_SW = -1;  
   /*FORSKUD06*/     BH901.EVS_SLUT_EJER.FØRSTE.BBER2FAM_02ANV_SW = -1; 
   /*FORSKUD06*/     BH901.EVS_SLUT_EJER.SIDSTE.BBER2FAM_02ANV_SW = -1; 
                     BH901.EVS_SLUT_EJER.FØRSTE.BBERGRL_AKT_SW = -1;    
                     BH901.EVS_SLUT_EJER.SIDSTE.BBERGRL_AKT_SW = -1;    
                     BH901.EVS_SLUT_EJER.FØRSTE.BBER2FAM_AKT_SW = -1;   
                     BH901.EVS_SLUT_EJER.SIDSTE.BBER2FAM_AKT_SW = -1;   
                     BH901.EVS_SLUT_EJER.FØRSTE.BFASTSTIGBGR_SW = -1;   
                     BH901.EVS_SLUT_EJER.SIDSTE.BFASTSTIGBGR_SW = -1;   
                     BH901.EVS_SLUT_EJER.FØRSTE.BNETTO_SW = -1;         
                     BH901.EVS_SLUT_EJER.SIDSTE.BNETTO_SW = -1;         
                     BH901.EVS_SLUT_EJER.FØRSTE.BEJERAN_SW = -1;        
                     BH901.EVS_SLUT_EJER.SIDSTE.BEJERAN_SW = -1;        
                     BH901.EVS_SLUT_EJER.FØRSTE.BEVSMAN_SW = -1;        
                     BH901.EVS_SLUT_EJER.SIDSTE.BEVSMAN_SW = -1;        
                     BH901.EVS_SLUT_EJER.FØRSTE.BMANEVSSTI_SW = -1;     
                     BH901.EVS_SLUT_EJER.SIDSTE.BMANEVSSTI_SW = -1;     
                     BH901.EVS_SLUT_EJER.FØRSTE.MANNEDSLSTI_SW = -1;    
                     BH901.EVS_SLUT_EJER.SIDSTE.MANNEDSLSTI_SW = -1;    
                     BH901.EVS_SLUT_EJER.FØRSTE.BEJBOL1_SW = -1;        
                     BH901.EVS_SLUT_EJER.SIDSTE.BEJBOL1_SW = -1;        
                     BH901.EVS_SLUT_EJER.FØRSTE.BEJBOL2_SW = -1;        
                     BH901.EVS_SLUT_EJER.SIDSTE.BEJBOL2_SW = -1;        
   /*FORSKUD10*/     BH901.EVS_SLUT_EJER.FØRSTE.BUDLSKC_SW = -1;        
   /*FORSKUD10*/     BH901.EVS_SLUT_EJER.SIDSTE.BUDLSKC_SW = -1;        
                     /*QEB TILFØJET 28-04-2017 ENS MED BH90000*/        
                     BH901.EVS_SLUT_EJER.FØRSTE.BSUM1_SW = -1;          
                     BH901.EVS_SLUT_EJER.SIDSTE.BSUM1_SW = -1;          
                     BH901.EVS_SLUT_EJER.FØRSTE.BSUM3_SW = -1;          
                     BH901.EVS_SLUT_EJER.SIDSTE.BSUM3_SW = -1;          
                     BH901.EVS_SLUT_EJER.FØRSTE.MANPENSSTI_SW  = -1;    
                     BH901.EVS_SLUT_EJER.SIDSTE.MANPENSSTI_SW  = -1;    
                  END;                                                  
                                                                        
               IF BH901.EVS_SLUT_ÆGTF.DCPRN = 0                         
               THEN                                                     
                  DO;                                                   
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.GPCTEJER_SW = -1;       
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER_SW = -1;       
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_SW = -1;       
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_SW = -1;       
   /*FORSKUD11       BH901.EVS_SLUT_ÆGTF.FØRSTE.BBERGRLUDL_01_SW = -1;  
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBERGRLUDL_01_SW = -1;  
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BOMBTILBUDL_01_SW = -1; 
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BOMBTILBUDL_01_SW = -1*/
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_015ANV_SW = -1; 
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_015ANV_SW = -1; 
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_015ANV_SW = -1;
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_015ANV_SW = -1;
   /*FORSKUD06*/     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_02ANV_SW = -1;  
   /*FORSKUD06*/     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_02ANV_SW = -1;  
   /*FORSKUD06*/     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_02ANV_SW = -1; 
   /*FORSKUD06*/     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_02ANV_SW = -1; 
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_AKT_SW = -1;    
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_AKT_SW = -1;    
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_AKT_SW = -1;   
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_AKT_SW = -1;   
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BFASTSTIGBGR_SW = -1;   
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BFASTSTIGBGR_SW = -1;   
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BNETTO_SW = -1;         
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BNETTO_SW = -1;         
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BEJERAN_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BEJERAN_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BEVSMAN_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BEVSMAN_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BMANEVSSTI_SW = -1;     
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BMANEVSSTI_SW = -1;     
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.MANNEDSLSTI_SW = -1;    
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.MANNEDSLSTI_SW = -1;    
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL1_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL1_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL2_SW = -1;        
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL2_SW = -1;        
   /*FORSKUD10*/     BH901.EVS_SLUT_ÆGTF.FØRSTE.BUDLSKC_SW = -1;        
   /*FORSKUD10*/     BH901.EVS_SLUT_ÆGTF.SIDSTE.BUDLSKC_SW = -1;        
                     /*QEB TILFØJET 28-04-2017 ENS MED BH90000*/        
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BSUM1_SW = -1;          
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BSUM1_SW = -1;          
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.BSUM3_SW = -1;          
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.BSUM3_SW = -1;          
                     BH901.EVS_SLUT_ÆGTF.FØRSTE.MANPENSSTI_SW  = -1;    
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.MANPENSSTI_SW  = -1;    
                  END;                                                  
                                                                        
               IF BH901.EVS_FORSK_EJER.DCPRN = 0                        
               THEN                                                     
                  DO;                                                   
                     BH901.EVS_FORSK_EJER.B100_SW = -1;                 
                     BH901.EVS_FORSK_EJER.BBRUTTO_SW = -1;              
                     BH901.EVS_FORSK_EJER.BEJERAN_SW = -1;              
                     BH901.EVS_FORSK_EJER.BNYMAN_SW = -1;               
                     BH901.EVS_FORSK_EJER.BFORSKAT_SW = -1;             
                  END;                                                  
                                                                        
               IF BH901.EVS_FORSK_ÆGTF.DCPRN = 0                        
               THEN                                                     
                  DO;                                                   
                     BH901.EVS_FORSK_ÆGTF.B100_SW = -1;                 
                     BH901.EVS_FORSK_ÆGTF.BBRUTTO_SW = -1;              
                     BH901.EVS_FORSK_ÆGTF.BEJERAN_SW = -1;              
                     BH901.EVS_FORSK_ÆGTF.BNYMAN_SW = -1;               
                     BH901.EVS_FORSK_ÆGTF.BFORSKAT_SW = -1;             
                  END;                                                  
            END;                                                        
                                                                        
         BH901.SORT_CPR = BH901.ESR.SORTCPR;                            
         BH901.SORT_KOMNR = BH901.ESR.EKOMNR;                           
         BH901.SORT_EJDNR = BH901.ESR.EEJDNR;                           
         BH901.SORT_ENHEDLBNR = BH901.ESR.EENHEDLBNR;                   
         BH901.SORT_CITYP = BH901.ESR.SORTCITYP;                        
                                                                        
         IF BH901.ESR.EJER.DCPRCIR > 0 &                                
            BH901.ESR.EJER.GANE = 0 &                                   
            BH901.ESR.EJER.FEJER = 1                                    
         THEN                                                           
            BH901.ESR.EJER.GANE = 10000;                                
                                                                        
         IF BH901.ESR.ÆGTF.DCPRCIR > 0 &                                
            BH901.ESR.ÆGTF.GANE = 0 &                                   
            BH901.ESR.ÆGTF.FEJER = 1                                    
         THEN                                                           
            BH901.ESR.ÆGTF.GANE = 10000;                                
                                                                        
         IF BH901.ESR.EJER.DCPRCIR > 0                                  
         THEN                                                           
            DO;                                                         
               BH901.AKT_EJER = BH901.ESR.EJER, BY NAME;                
               BH901.CPENS_FESR = BH901.ESR.EJER.CPENS;                 
            END;                                                        
                                                                        
         IF BH901.ESR.ÆGTF.DCPRCIR > 0                                  
         THEN                                                           
            BH901.AKT_ÆGTF = BH901.ESR.ÆGTF, BY NAME;                   
                                                                        
         CALL OPSÆT_ÆGTF_FORDEL;                                        
                                                                        
         BH901.EJENDOM.EJDBELIG = SUBSTR(BH901.ESR.ABELMAT,1,31);       
         /* Nye felter til slut 2018 nu i Forskud 2020 */               
         BH901.EJENDOM.VEJK_EJD    = BH901.ESR.VEJK_EJD;                
         BH901.EJENDOM.HUSNR_EJD   = BH901.ESR.HUSNR_EJD;               
         BH901.EJENDOM.ETAGE_EJD   = BH901.ESR.ETAGE_EJD;               
         BH901.EJENDOM.SDØR_EJD    = BH901.ESR.SDØR_EJD;                
         BH901.EJENDOM.ENHEDBELIG  = BH901.ESR.ENHEDBELIG;              
         BH901.EJENDOM.VEJK_ENHED  = BH901.ESR.VEJK_ENHED;              
         BH901.EJENDOM.HUSNR_ENHED = BH901.ESR.HUSNR_ENHED;             
         BH901.EJENDOM.ETAGE_ENHED = BH901.ESR.ETAGE_ENHED;             
         BH901.EJENDOM.SDØR_ENHED  = BH901.ESR.SDØR_ENHED;              
                                                                        
         /* Defect 897, fra SLUT skal også rettes her */                
         BH901.EJENDOM.BFENR        = BH901.ESR.BFENR;                  
         BH901.EJENDOM.VUREJENDOMID = BH901.ESR.VUREJENDOMID;           
                                                                        
         BH901.TIL_EVS.CSKATBER = '1';                                  
                                                                        
         HJKOMNR = BH901.ESR.EKOMNR;                                    
         CALL RCPROC;       /* BEREGN RC-KODE FOR BELIGGENHEDSKOMMUNE */
         BH901.CRCKO = HJCRCKO;                                         
                                                                        
         IF BH901.AKT_EJER.FEJER = 2 &                                  
            BH901.AKT_EJER.GANE = 0                                     
         THEN                                                           
            TV.TO_EJER_NUL = TV.TO_EJER_NUL + 1;                        
                                                                        
         IF BH901.AKT_EJER.FEJER > 2 &                                  
            BH901.AKT_EJER.GANE = 0                                     
         THEN                                                           
            TV.FL_EJER_NUL = TV.FL_EJER_NUL + 1;                        
                                                                        
         /* KONTROLLER STATUS FOR EJERS CPRNR, D.V.S. OM DER ER   */    
         /* TALE OM ET RIGTIGT CPRNR, ET SE-NR, ET INVALIDT CPRNR */    
         /* ELLER ET LØBENR.                                      */    
                                                                        
         HJ_CPR = BH901.SORT_CPR;                                       
                                                                        
         CALL DAN_CPRNR_STATUS(HJ_CPR,BH901.AKT_EJER.CEJFORH,CRETUR);   
                                                                        
         BH901.CINVPNR = CRETUR;                                        
                                                                        
         IF BH901.AKT_EJER.CEJFORH = '50' ! /*HVIS EJEREN ER */         
            BH901.AKT_EJER.CEJFORH = '60' ! /*OFFENTLIG D.V.S.*/        
            BH901.AKT_EJER.CEJFORH = '70' ! /*KOMM./AMT/STAT */         
            BH901.AKT_EJER.CEJFORH = '80'                               
         THEN                                                           
            DO;                                                         
               IF BH901.CINVPNR = '0' /* HVIS PNR. ER VALIDT */         
               THEN                   /* BEHANDLES 'NORMALT' */         
                  TV.OFF_CPR = TV.OFF_CPR + 1;                          
               ELSE                                                     
                  DO;                                                   
                     TV.OFF_EJ_CPR = TV.OFF_EJ_CPR + 1;                 
                     CALL SKRIV_PERSON;                                 
                     RETURN;                                            
                  END;                                                  
            END;                                                        
                                                                        
         IF BH901.CINVPNR = '0'                /* PERSONNR. ER VALIDT */
         THEN                                                           
            DO;                                                         
               BH901.TIL_EVS.CPTYPSLUT = '1';  /*PERSONTYPE=ALM PERSON*/
               BH901.TIL_FORSKUD.COPR_CPTYPSLUT = 'F';                  
               BH901.TIL_EVS.CPTYPFOR = '1';                            
               BH901.TIL_FORSKUD.COPR_CPTYPFOR = 'F';                   
            END;                                                        
         ELSE                                                           
            DO;                                                         
               /* DETTE ER EJERE SOM IKKE ER OMFATTET  */               
               /* AF EVS-REGLERNE, MEN MEDTAGET FOR AT */               
               /* KUNNE OPRETTE SÅ MANGE EJENDOMME SOM */               
               /* MULIGT PÅ EJENDOMSTABELLEN.          */               
               IF BH901.CINVPNR = '2'        /* DETTE ER VALIDT SE-NR */
               THEN                                                     
                  DO;                                                   
                     TV.OVERSPR_SE = TV.OVERSPR_SE + 1;                 
                     BH901.CKUN_SLS = '1';                              
                     BH901.CSKATBER = '0';                              
                  END;                                                  
               ELSE                                                     
                  TV.OVERSPR_CPR = TV.OVERSPR_CPR + 1;                  
               CALL SKRIV_PERSON;                                       
               RETURN;                                                  
            END;                                                        
         /* OPTÆL PGF 4 VURDEREDE EJD */                                
                                       /*FORSKUD06*/                    
         IF BH901.ESR.STAMOPL.VURDOPLNY.BEJDVÆP4A ^= 0                  
         THEN                                                           
            TV.PGF4A = TV.PGF4A + 1;                                    
         IF BH901.ESR.STAMOPL.BEJDVÆP4B ^= 0                            
         THEN                                                           
            TV.PGF4B = TV.PGF4B + 1;                                    
                                                                        
         IF BH901.ESR.STAMOPL.VURDOPLNY.CFORSKEL = '1'   /*FORSKUD06*/  
         THEN                                                           
            TV.FORSKEL1 = TV.FORSKEL1 + 1;                              
         IF BH901.ESR.STAMOPL.VURDOPLNY.CFORSKEL = '2'   /*FORSKUD06*/  
         THEN                                                           
            TV.FORSKEL2 = TV.FORSKEL2 + 1;                              
         IF BH901.ESR.STAMOPL.VURDOPLNY.CFORSKEL = '3'   /*FORSKUD06*/  
         THEN                                                           
            TV.FORSKEL3 = TV.FORSKEL3 + 1;                              
                                                                        
         CALL SKRIV_PERSON;                                             
 END BEHANDL;                                                           
 /*********************************************************************/
 /*      SKAF RC-KODE PÅ GRUNDLAG AF BELIGGENHEDSKOMMUNE              */
 /*********************************************************************/
 RCPROC:                                                                
         PROC;                                                          
         SELECT;                                                        
           WHEN (HJKOMNR = 0)                                           
              HJCRCKO = 6; /* KMB */                                    
           WHEN (HJKOMNR < 129)                                         
              HJCRCKO = 1; /* KMV */                                    
           WHEN (HJKOMNR <= 409)                                        
              HJCRCKO = 6; /* KMB */                                    
           WHEN (HJKOMNR <= 499)                                        
              HJCRCKO = 5; /* KMO */                                    
           WHEN (HJKOMNR = 751)                                         
              HJCRCKO = 4; /* KMÅ */                                    
           OTHERWISE                                                    
              HJCRCKO = 3; /* KMA */                                    
         END;                                                           
 END RCPROC;                                                            
 /********************************************************************* 
 *       BEHANDLING AF INDIVID FRA EVS UDTRÆK                         * 
 *********************************************************************/ 
 BEHANDL_EVS_UDTRÆK:                                                    
         PROC;                                                          
                                                                        
         /* INITIER DIVERSE INDIKATOR-FELTER */                         
         /* HVIS INTET EVS-UDTRÆK FOR EJER OG/ELLER ÆGTEFÆLLE */        
                                                                        
         IF BH6122.EVS_SLUT_EJER.DCPRN = 0                              
         THEN                                                           
            DO;                                                         
               BH6122.EVS_SLUT_EJER.FØRSTE.GPCTEJER_SW = -1;            
               BH6122.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = -1;            
               BH6122.EVS_SLUT_EJER.FØRSTE.BBERGRL_SW = -1;             
               BH6122.EVS_SLUT_EJER.SIDSTE.BBERGRL_SW = -1;             
               BH6122.EVS_SLUT_EJER.FØRSTE.BBER2FAM_SW = -1;            
               BH6122.EVS_SLUT_EJER.SIDSTE.BBER2FAM_SW = -1;            
 /*            BH6122.EVS_SLUT_EJER.FØRSTE.BBERGRLUDL_01_SW = -1;       
               BH6122.EVS_SLUT_EJER.SIDSTE.BBERGRLUDL_01_SW = -1;       
               BH6122.EVS_SLUT_EJER.FØRSTE.BOMBTILBUDL_01_SW = -1;      
               BH6122.EVS_SLUT_EJER.SIDSTE.BOMBTILBUDL_01_SW = -1;   */ 
               BH6122.EVS_SLUT_EJER.FØRSTE.BBERGRL_015ANV_SW = -1;      
               BH6122.EVS_SLUT_EJER.SIDSTE.BBERGRL_015ANV_SW = -1;      
               BH6122.EVS_SLUT_EJER.FØRSTE.BBER2FAM_015ANV_SW = -1;     
               BH6122.EVS_SLUT_EJER.SIDSTE.BBER2FAM_015ANV_SW = -1;     
 /*FORSKUD06*/ BH6122.EVS_SLUT_EJER.FØRSTE.BBERGRL_02ANV_SW = -1;       
 /*FORSKUD06*/ BH6122.EVS_SLUT_EJER.SIDSTE.BBERGRL_02ANV_SW = -1;       
 /*FORSKUD06*/ BH6122.EVS_SLUT_EJER.FØRSTE.BBER2FAM_02ANV_SW = -1;      
 /*FORSKUD06*/ BH6122.EVS_SLUT_EJER.SIDSTE.BBER2FAM_02ANV_SW = -1;      
               BH6122.EVS_SLUT_EJER.FØRSTE.BBERGRL_AKT_SW = -1;         
               BH6122.EVS_SLUT_EJER.SIDSTE.BBERGRL_AKT_SW = -1;         
               BH6122.EVS_SLUT_EJER.FØRSTE.BBER2FAM_AKT_SW = -1;        
               BH6122.EVS_SLUT_EJER.SIDSTE.BBER2FAM_AKT_SW = -1;        
               BH6122.EVS_SLUT_EJER.FØRSTE.BFASTSTIGBGR_SW = -1;        
               BH6122.EVS_SLUT_EJER.SIDSTE.BFASTSTIGBGR_SW = -1;        
               BH6122.EVS_SLUT_EJER.FØRSTE.BNETTO_SW = -1;              
               BH6122.EVS_SLUT_EJER.SIDSTE.BNETTO_SW = -1;              
               BH6122.EVS_SLUT_EJER.FØRSTE.BEJERAN_SW = -1;             
               BH6122.EVS_SLUT_EJER.SIDSTE.BEJERAN_SW = -1;             
               BH6122.EVS_SLUT_EJER.FØRSTE.BEVSMAN_SW = -1;             
               BH6122.EVS_SLUT_EJER.SIDSTE.BEVSMAN_SW = -1;             
               BH6122.EVS_SLUT_EJER.FØRSTE.BMANEVSSTI_SW = -1;          
               BH6122.EVS_SLUT_EJER.SIDSTE.BMANEVSSTI_SW = -1;          
               BH6122.EVS_SLUT_EJER.FØRSTE.MANNEDSLSTI_SW = -1;         
               BH6122.EVS_SLUT_EJER.SIDSTE.MANNEDSLSTI_SW = -1;         
               BH6122.EVS_SLUT_EJER.FØRSTE.BEJBOL1_SW = -1;             
               BH6122.EVS_SLUT_EJER.SIDSTE.BEJBOL1_SW = -1;             
               BH6122.EVS_SLUT_EJER.FØRSTE.BEJBOL2_SW = -1;             
               BH6122.EVS_SLUT_EJER.SIDSTE.BEJBOL2_SW = -1;             
 /*FORSKUD10*/ BH6122.EVS_SLUT_EJER.FØRSTE.BUDLSKC_SW = -1;             
 /*FORSKUD10*/ BH6122.EVS_SLUT_EJER.SIDSTE.BUDLSKC_SW = -1;             
                /*QEB TILFØJET 28-04-2017 ENS MED BH90000*/             
               BH6122.EVS_SLUT_EJER.FØRSTE.BSUM1_SW = -1;               
               BH6122.EVS_SLUT_EJER.SIDSTE.BSUM1_SW = -1;               
               BH6122.EVS_SLUT_EJER.FØRSTE.BSUM3_SW = -1;               
               BH6122.EVS_SLUT_EJER.SIDSTE.BSUM3_SW = -1;               
               BH6122.EVS_SLUT_EJER.FØRSTE.MANPENSSTI_SW  = -1;         
               BH6122.EVS_SLUT_EJER.SIDSTE.MANPENSSTI_SW  = -1;         
            END;                                                        
                                                                        
         IF BH6122.EVS_SLUT_ÆGTF.DCPRN = 0                              
         THEN                                                           
            DO;                                                         
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.GPCTEJER_SW = -1;            
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER_SW = -1;            
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_SW = -1;            
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_SW = -1;            
 /* FORSKUD11  BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBERGRLUDL_01_SW = -1;       
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBERGRLUDL_01_SW = -1;       
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BOMBTILBUDL_01_SW = -1;      
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BOMBTILBUDL_01_SW = -1;   */ 
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_015ANV_SW = -1;      
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_015ANV_SW = -1;      
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_015ANV_SW = -1;     
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_015ANV_SW = -1;     
 /*FORSKUD06*/ BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_02ANV_SW = -1;       
 /*FORSKUD06*/ BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_02ANV_SW = -1;       
 /*FORSKUD06*/ BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_02ANV_SW = -1;      
 /*FORSKUD06*/ BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_02ANV_SW = -1;      
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_AKT_SW = -1;         
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_AKT_SW = -1;         
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_AKT_SW = -1;        
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_AKT_SW = -1;        
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BFASTSTIGBGR_SW = -1;        
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BFASTSTIGBGR_SW = -1;        
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BNETTO_SW = -1;              
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BNETTO_SW = -1;              
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BEJERAN_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BEJERAN_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BEVSMAN_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BEVSMAN_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BMANEVSSTI_SW = -1;          
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BMANEVSSTI_SW = -1;          
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.MANNEDSLSTI_SW = -1;         
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.MANNEDSLSTI_SW = -1;         
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL1_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL1_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL2_SW = -1;             
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL2_SW = -1;             
 /*FORSKUD10*/ BH6122.EVS_SLUT_ÆGTF.FØRSTE.BUDLSKC_SW = -1;             
 /*FORSKUD10*/ BH6122.EVS_SLUT_ÆGTF.SIDSTE.BUDLSKC_SW = -1;             
             /*QEB TILFØJET 28-04-2017 ENS MED BH90000*/                
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BSUM1_SW = -1;               
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BSUM1_SW = -1;               
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.BSUM3_SW = -1;               
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.BSUM3_SW = -1;               
               BH6122.EVS_SLUT_ÆGTF.FØRSTE.MANPENSSTI_SW  = -1;         
               BH6122.EVS_SLUT_ÆGTF.SIDSTE.MANPENSSTI_SW  = -1;         
            END;                                                        
                                                                        
         IF BH6122.EVS_FORSK_EJER.DCPRN = 0                             
         THEN                                                           
            DO;                                                         
               BH6122.EVS_FORSK_EJER.B100_SW = -1;                      
               BH6122.EVS_FORSK_EJER.BBRUTTO_SW = -1;                   
               BH6122.EVS_FORSK_EJER.BEJERAN_SW = -1;                   
               BH6122.EVS_FORSK_EJER.BNYMAN_SW = -1;                    
               BH6122.EVS_FORSK_EJER.BFORSKAT_SW = -1;                  
            END;                                                        
                                                                        
         IF BH6122.EVS_FORSK_ÆGTF.DCPRN = 0                             
         THEN                                                           
            DO;                                                         
               BH6122.EVS_FORSK_ÆGTF.B100_SW = -1;                      
               BH6122.EVS_FORSK_ÆGTF.BBRUTTO_SW = -1;                   
               BH6122.EVS_FORSK_ÆGTF.BEJERAN_SW = -1;                   
               BH6122.EVS_FORSK_ÆGTF.BNYMAN_SW = -1;                    
               BH6122.EVS_FORSK_ÆGTF.BFORSKAT_SW = -1;                  
            END;                                                        
                                                                        
         GEM.EVS_UDTRÆK = BH6122, BY NAME;                              
                                                                        
         IF BH6122.EKOMNUM = 999                                        
         THEN                                                           
            DO;                                                         
               /* UDENLANDSK EJENDOM */                                 
               TV.FUDLANDSK = TV.FUDLANDSK + 1;                         
               CALL OPRET_FRA_EVS;                                      
            END;                                                        
         ELSE                                                           
            /* IKKE UDENLANDSK EJENDOM */                               
            TV.FØVREVS = TV.FØVREVS + 1;                                
                                                                        
 END BEHANDL_EVS_UDTRÆK;                                                
                                                                        
 /********************************************************************* 
 *       BEHANDLING AF INDIVID FRA EVS UDTRÆK D.V.S.                  * 
 *       NYE KØBERE KUN I EVS ELLER UDENLANDSKE EJENDOMME             * 
 *********************************************************************/ 
 OPRET_FRA_EVS:                                                         
         PROC;                                                          
                                                                        
         BH60101M = '';                                                 
         BH901 = '';                                                    
                                                                        
         BH901.EVS_UDTRÆK = GEM.EVS_UDTRÆK, BY NAME;                    
                                                                        
         BH901.SORT_CPR = GEM.EVS_UDTRÆK.DCPRNUM;                       
         BH901.SORT_KOMNR = GEM.EVS_UDTRÆK.EKOMNUM;                     
         BH901.SORT_EJDNR = GEM.EVS_UDTRÆK.EEJDNUM;                     
         BH901.SORT_ENHEDLBNR = GEM.EVS_UDTRÆK.EENHEDLBNUM; /*#03*/     
         BH901.SORT_CITYP = 0;                                          
                                                                        
         BH901.CINVPNR = '0'; /* PERSONNR. ER VALIDT */                 
                                                                        
         BH901.TIL_EVS.CPTYPSLUT = '1'; /* PERSONTYPE = ALM. PERSON */  
         BH901.TIL_FORSKUD.COPR_CPTYPSLUT = 'F';                        
         BH901.TIL_EVS.CPTYPFOR = '1';  /* D.V.S. DEFAULT OPSAT     */  
         BH901.TIL_FORSKUD.COPR_CPTYPFOR = 'F';                         
                                                                        
         SELECT;                                                        
           WHEN (BH901.EVS_SLUT_EJER.DCPRN > 0 &                        
                 BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1')                
             DO;                                                        
                BH901.EJENDOM.EJDBELIG =                                
                BH901.EVS_SLUT_EJER.EJDBELIG;                           
                /* Nye felter til slut 2018 nu i Forskud 2020 */        
                BH901.EJENDOM.VEJK_EJD    =                             
                                       BH901.EVS_SLUT_EJER.VEJK_EJD;    
                BH901.EJENDOM.HUSNR_EJD   =                             
                                       BH901.EVS_SLUT_EJER.HUSNR_EJD;   
                BH901.EJENDOM.ETAGE_EJD   =                             
                                       BH901.EVS_SLUT_EJER.ETAGE_EJD;   
                BH901.EJENDOM.SDØR_EJD    =                             
                                       BH901.EVS_SLUT_EJER.SDØR_EJD;    
                BH901.EJENDOM.ENHEDBELIG  =                             
                                       BH901.EVS_SLUT_EJER.ENHEDBELIG;  
                BH901.EJENDOM.VEJK_ENHED  =                             
                                       BH901.EVS_SLUT_EJER.VEJK_ENHED;  
                BH901.EJENDOM.HUSNR_ENHED =                             
                                       BH901.EVS_SLUT_EJER.HUSNR_ENHED; 
                BH901.EJENDOM.ETAGE_ENHED =                             
                                       BH901.EVS_SLUT_EJER.ETAGE_ENHED; 
                BH901.EJENDOM.SDØR_ENHED  =                             
                                       BH901.EVS_SLUT_EJER.SDØR_ENHED;  
                BH901.EJENDOM.CEJDTYPE =                                
                BH901.EVS_SLUT_EJER.SIDSTE.CEJDTYPE;                    
                BH901.TIL_FORSKUD.COPR_CEJDTYPE = 'S';                  
                BH901.EJENDOM.CLANDEKODE =                              
                BH901.EVS_SLUT_EJER.CLANDEKODE;        /* FORSKUD09 */  
                IF BH901.EJENDOM.CLANDEKODE = 'FR'     /* FORSKUD10 */  
                THEN                                                    
                   DO;                                                  
                      IF BH901.EVS_SLUT_EJER.SIDSTE.DOVTG > '20071128'  
                      THEN                                              
                         BH901.EJENDOM.CLANDEKODE = 'F2';               
                      ELSE                                              
                         BH901.EJENDOM.CLANDEKODE = 'F1';               
                   END;                                /* FORSKUD10 */  
             END;                                                       
           WHEN (BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                        
                 BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1')                
             DO;                                                        
                BH901.EJENDOM.EJDBELIG =                                
                BH901.EVS_SLUT_ÆGTF.EJDBELIG;                           
                /* Nye felter til slut 2018 nu i Forskud 2020 */        
                BH901.EJENDOM.VEJK_EJD    =                             
                                       BH901.EVS_SLUT_ÆGTF.VEJK_EJD;    
                BH901.EJENDOM.HUSNR_EJD   =                             
                                       BH901.EVS_SLUT_ÆGTF.HUSNR_EJD;   
                BH901.EJENDOM.ETAGE_EJD   =                             
                                       BH901.EVS_SLUT_ÆGTF.ETAGE_EJD;   
                BH901.EJENDOM.SDØR_EJD    =                             
                                       BH901.EVS_SLUT_ÆGTF.SDØR_EJD;    
                BH901.EJENDOM.ENHEDBELIG  =                             
                                       BH901.EVS_SLUT_ÆGTF.ENHEDBELIG;  
                BH901.EJENDOM.VEJK_ENHED  =                             
                                       BH901.EVS_SLUT_ÆGTF.VEJK_ENHED;  
                BH901.EJENDOM.HUSNR_ENHED =                             
                                       BH901.EVS_SLUT_ÆGTF.HUSNR_ENHED; 
                BH901.EJENDOM.ETAGE_ENHED =                             
                                       BH901.EVS_SLUT_ÆGTF.ETAGE_ENHED; 
                BH901.EJENDOM.SDØR_ENHED  =                             
                                       BH901.EVS_SLUT_ÆGTF.SDØR_ENHED;  
                BH901.EJENDOM.CEJDTYPE =                                
                BH901.EVS_SLUT_ÆGTF.SIDSTE.CEJDTYPE;                    
                BH901.TIL_FORSKUD.COPR_CEJDTYPE = 'S';                  
                BH901.EJENDOM.CLANDEKODE =                              
                BH901.EVS_SLUT_ÆGTF.CLANDEKODE;        /* FORSKUD09 */  
                IF BH901.EJENDOM.CLANDEKODE = 'FR'     /* FORSKUD10 */  
                THEN                                                    
                   DO;                                                  
                      IF BH901.EVS_SLUT_ÆGTF.SIDSTE.DOVTG > '20071128'  
                      THEN                                              
                         BH901.EJENDOM.CLANDEKODE = 'F2';               
                      ELSE                                              
                         BH901.EJENDOM.CLANDEKODE = 'F1';               
                   END;                                /* FORSKUD10 */  
             END;                                                       
           WHEN (BH901.EVS_FORSK_EJER.DCPRN > 0)                        
             DO;                                                        
                BH901.EJENDOM.EJDBELIG =                                
                BH901.EVS_FORSK_EJER.EJDBELIG;                          
                /* Nye felter til slut 2018 nu i Forskud 2020 */        
                BH901.EJENDOM.VEJK_EJD    =                             
                                       BH901.EVS_FORSK_EJER.VEJK_EJD;   
                BH901.EJENDOM.HUSNR_EJD   =                             
                                       BH901.EVS_FORSK_EJER.HUSNR_EJD;  
                BH901.EJENDOM.ETAGE_EJD   =                             
                                       BH901.EVS_FORSK_EJER.ETAGE_EJD;  
                BH901.EJENDOM.SDØR_EJD    =                             
                                       BH901.EVS_FORSK_EJER.SDØR_EJD;   
                BH901.EJENDOM.ENHEDBELIG  =                             
                                       BH901.EVS_FORSK_EJER.ENHEDBELIG; 
                BH901.EJENDOM.VEJK_ENHED  =                             
                                       BH901.EVS_FORSK_EJER.VEJK_ENHED; 
                BH901.EJENDOM.HUSNR_ENHED =                             
                                       BH901.EVS_FORSK_EJER.HUSNR_ENHED;
                BH901.EJENDOM.ETAGE_ENHED =                             
                                       BH901.EVS_FORSK_EJER.ETAGE_ENHED;
                BH901.EJENDOM.SDØR_ENHED  =                             
                                       BH901.EVS_FORSK_EJER.SDØR_ENHED; 
                                                                        
                BH901.EJENDOM.CEJDTYPE =                                
                BH901.EVS_FORSK_EJER.CEJDTYPE;                          
                BH901.TIL_FORSKUD.COPR_CEJDTYPE = 'F';                  
                BH901.EJENDOM.CLANDEKODE =                              
                BH901.EVS_FORSK_EJER.CLANDEKODE;       /* FORSKUD09 */  
                IF BH901.EJENDOM.CLANDEKODE = 'FR'     /* FORSKUD10 */  
                THEN                                   /* FORSKUD10 */  
                   BH901.EJENDOM.CLANDEKODE = 'F2';    /* FORSKUD10 */  
             END;                                                       
           OTHERWISE;                                                   
         END;  /* SELECT */                                             
                                                                        
         IF BH901.EVS_FORSK_EJER.DCPRN > 0 &                            
            BH901.EJENDOM.CEJDTYPE < '1'                                
         THEN                                                           
            DO;                                                         
               BH901.EJENDOM.EJDBELIG =                                 
               BH901.EVS_FORSK_EJER.EJDBELIG;                           
               /* Nye felter til slut 2018 nu i Forskud 2020 */         
               BH901.EJENDOM.VEJK_EJD    =                              
                             BH901.EVS_FORSK_EJER.VEJK_EJD;             
               BH901.EJENDOM.HUSNR_EJD   =                              
                             BH901.EVS_FORSK_EJER.HUSNR_EJD;            
               BH901.EJENDOM.ETAGE_EJD   =                              
                             BH901.EVS_FORSK_EJER.ETAGE_EJD;            
               BH901.EJENDOM.SDØR_EJD    =                              
                             BH901.EVS_FORSK_EJER.SDØR_EJD;             
               BH901.EJENDOM.ENHEDBELIG  =                              
                             BH901.EVS_FORSK_EJER.ENHEDBELIG;           
               BH901.EJENDOM.VEJK_ENHED  =                              
                             BH901.EVS_FORSK_EJER.VEJK_ENHED;           
               BH901.EJENDOM.HUSNR_ENHED =                              
                             BH901.EVS_FORSK_EJER.HUSNR_ENHED;          
               BH901.EJENDOM.ETAGE_ENHED =                              
                             BH901.EVS_FORSK_EJER.ETAGE_ENHED;          
               BH901.EJENDOM.SDØR_ENHED  =                              
                             BH901.EVS_FORSK_EJER.SDØR_ENHED;           
               BH901.EJENDOM.CEJDTYPE =                                 
               BH901.EVS_FORSK_EJER.CEJDTYPE;                           
               BH901.TIL_FORSKUD.COPR_CEJDTYPE = 'F';                   
            END;                                                        
                                                                        
                                                                        
      /* HVIS EJENDOMSOPLYSN. ER TAGET FRA SLUT, MEN LANDEKODEN ER */   
      /* FRA FORSKUD, SKAL DET VÆRE F1, UDEN AT SPØRGE PÅ DATO     */   
                                                                        
         IF BH901.EVS_FORSK_EJER.DCPRN > 0 &                            
            BH901.EJENDOM.CLANDEKODE = ' '                              
         THEN                                                           
            DO;                                                         
               BH901.EJENDOM.CLANDEKODE =                               
               BH901.EVS_FORSK_EJER.CLANDEKODE;       /* FORSKUD09 */   
               IF BH901.EJENDOM.CLANDEKODE = 'FR'     /* FORSKUD10 */   
               THEN                                   /* FORSKUD10 */   
                  BH901.EJENDOM.CLANDEKODE = 'F1';    /* FORSKUD10 */   
            END;                                                        
                                                                        
         /* EJENDOMSTYPE MÅ KUN HENTES FRA SLUT ELLER FORSKUD */        
         /* HVIS DER ER TALE OM EN UDENLANDSK EJENDOM         */        
                                                                        
         IF BH901.SORT_KOMNR ^= 999 !                                   
            BH901.EJENDOM.CEJDTYPE < '1'                                
         THEN                                                           
            DO;                                                         
              BH901.TIL_FORSKUD.COPR_CEJDTYPE = ' ';                    
              BH901.EJENDOM.CEJDTYPE = ' ';                             
            END;                                                        
                                                                        
         CALL SKRIV_PERSON;                                             
                                                                        
         GEM = '';                                                      
                                                                        
 END OPRET_FRA_EVS;                                                     
 /********************************************************************* 
 *       BEHANDLING AF INDIVID FRA EVS UDTRÆK                         * 
 *********************************************************************/ 
 BEHANDL_EVS_TILGANG:PROC;                                              
                                                                        
         TV.FEVSOPRET = TV.FEVSOPRET + 1;                               
                                                                        
         CALL OPRET_FRA_EVS;                                            
                                                                        
 END BEHANDL_EVS_TILGANG;                                               
 /*********************************************************************/
 /* ÆGTFÆLLEFORDELING JVF. EVS SLUT.                                  */
 /*                                                                   */
 /* KODEN ER INDSAT IFM. FORSKUD 2005 (BH90105M BENYTTES IKKE MERE)   */
 /* VED KOPIERING FRA BH90000 SOM ER PENDANT TIL BH90100.             */
 /*                                                                   */
 /*           VED HVER ÅRSTILRETNING TIL FORSKUD                      */
 /*           SAMMENLIGNES INDHOLDET AF OPSÆT_ÆGTF_FORDEL             */
 /*           MED SENESTE UDGAVE I BH90000.                           */
 /*                                                                   */
 /*********************************************************************/
 /* OPRET EVT. ÆGTEFÆLLE SOM 'NY' ESR-EJER NÅR DER ER FORETAGET ÆGTE- */
 /* FÆLLEFORDELING I EVS SLUT GL. ÅR, OG/ELLER RET ESR-EJERANDEL FOR  */
 /* ÆGTEFÆLLER JVF. EJERANDEL FRA EVS SLUT GL. ÅR (ANTAL EJERE OG     */
 /* CEJ_100 RETTES EVT. OGSÅ).                                        */
 /*                                                                   */
 /*           FUNKTIONEN UDFØRES KUN HVIS DEN SAMLEDE EJERANDEL JVF.  */
 /*           ESR OG GL. SLUTÅR STEMMER OVERENS SAMT  H V I S         */
 /*           ÆGTEFÆLLERNE ER SAMBESKATTET I BÅDE GL. OG NYT SLUTÅR   */
 /*           SAMT  H V I S  IKKE HANDLET I BÅDE GL. OG NYT SLUTÅR.   */
 /*********************************************************************/
 OPSÆT_ÆGTF_FORDEL:                                                     
 PROC;                                                                  
                                                                        
 DCL ESR_SUM FIXED (5);                                                 
 DCL ESR_ANT FIXED (5);                                                 
 DCL EVS_SUM FIXED (5);                                                 
 DCL EVS_ANT FIXED (5);                                                 
                                                                        
         ESR_SUM = 0;                                                   
         ESR_ANT = 0;                                                   
         EVS_SUM = 0;                                                   
         EVS_ANT = 0;                                                   
                                                                        
         IF BH901.ESR.SORTCPR = 0                                       
         THEN                                                           
            RETURN;   /* INGEN EJERE JVF. ESR */                        
                                                                        
         /* KONTROLLER OM BEGGE DE INVOLVEREDE ÆGTEFÆLLER ER         */ 
         /* INDBERETTET MED KODE FOR ÆGTEFÆLLEFORDELING I GL.SLUTÅR  */ 
         /* DA DE ELLERS IKKE SKAL BEHANDLES HER.                    */ 
                                                                        
         IF BH901.EVS_SLUT_EJER.SIDSTE.CÆGTOPR > '0' &    /* F2005 */   
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CÆGTOPR > '0'                    
         THEN;                                                          
         ELSE                                                           
            RETURN;                                                     
                                                                        
         IF (BH901.ESR.CSBSK = '2' !                                    
             BH901.ESR.CSBSK = '3' !                                    
             BH901.ESR.CSBSK = '5' !                                    
             BH901.ESR.CSBSK = '6') &                                   
            (BH901.EVS_UDTRÆK.CSBSK = '2' !                             
             BH901.EVS_UDTRÆK.CSBSK = '3' !                             
             BH901.EVS_UDTRÆK.CSBSK = '5' !                             
             BH901.EVS_UDTRÆK.CSBSK = '6')                              
         THEN;                                                          
         ELSE                                                           
            RETURN;   /* ÆGTEFÆLLERNE ER IKKE SAMBESKAT- */             
                      /* TET I BÅDE GL. OG NYT SLUTÅR    */             
                                                                        
         IF BH901.ESR.EJER.DCPRCIR > 0 &                                
           (BH901.ESR.EJER.DAFSTÅ > 0 &                                 
            BH901.ESR.EJER.DAFSTÅ <= BH901.ESR.EJER.DRGNÅRTIL)          
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF (BH901.ESR.EJER.DCPRCIR > 0 &                               
             BH901.ESR.ÆGTF.DCPRCIR > 0) &                              
            (BH901.ESR.EJER.DAFSTÅ > 0 &                                
             BH901.ESR.EJER.DAFSTÅ <= BH901.ESR.ÆGTF.DRGNÅRTIL)         
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.ESR.EJER.DCPRCIR > 0 &                                
            BH901.ESR.EJER.DOVTG > BH901.ESR.EJER.DRGNÅRFRA             
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF (BH901.ESR.EJER.DCPRCIR > 0 &                               
             BH901.ESR.ÆGTF.DCPRCIR > 0) &                              
            BH901.ESR.EJER.DOVTG > BH901.ESR.ÆGTF.DRGNÅRFRA             
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF (BH901.ESR.EJER.DCPRCIR > 0 &                               
             BH901.ESR.ÆGTF.DCPRCIR > 0) &                              
            (BH901.ESR.ÆGTF.DAFSTÅ > 0 &                                
             BH901.ESR.ÆGTF.DAFSTÅ <= BH901.ESR.EJER.DRGNÅRTIL)         
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.ESR.ÆGTF.DCPRCIR > 0 &                                
           (BH901.ESR.ÆGTF.DAFSTÅ > 0 &                                 
            BH901.ESR.ÆGTF.DAFSTÅ <= BH901.ESR.ÆGTF.DRGNÅRTIL)          
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF (BH901.ESR.EJER.DCPRCIR > 0 &                               
             BH901.ESR.ÆGTF.DCPRCIR > 0) &                              
            BH901.ESR.ÆGTF.DOVTG > BH901.ESR.EJER.DRGNÅRFRA             
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.ESR.ÆGTF.DCPRCIR > 0 &                                
            BH901.ESR.ÆGTF.DOVTG > BH901.ESR.ÆGTF.DRGNÅRFRA             
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.EVS_SLUT_EJER.DCPRN > 0 &                             
            BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA > 0                      
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                             
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_ÆGTF.SIDSTE.DAFSTAA > 0                      
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.EVS_SLUT_EJER.DCPRN > 0 &              /* F2005 */    
            BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_EJER.SIDSTE.DOVTG >                          
                            BH901.EVS_SLUT_EJER.SIDSTE.DRGNÅRFRA        
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &              /* F2005 */    
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_ÆGTF.SIDSTE.DOVTG >                          
                            BH901.EVS_SLUT_ÆGTF.SIDSTE.DRGNÅRFRA        
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH901.EVS_SLUT_EJER.DCPRN > 0 &                             
            BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS ^= '9' &                 
            BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = 0                  
         THEN                                                           
            DO;                                                         
               EVS_ANT = EVS_ANT + 1;                                   
               EVS_SUM = EVS_SUM +                                      
               BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;               
            END;                                                        
                                                                        
         IF BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                             
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CEJBEVS ^= '9' &                 
            BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER_SW = 0                  
         THEN                                                           
            DO;                                                         
               EVS_ANT = EVS_ANT + 1;                                   
               EVS_SUM = EVS_SUM +                                      
               BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100;               
            END;                                                        
                                                                        
         IF BH901.ESR.EJER.DCPRCIR > 0 &                                
            BH901.ESR.EJER.GANE ^= 0                                    
         THEN                                                           
            DO;                                                         
               ESR_SUM = ESR_SUM + BH901.ESR.EJER.GANE;                 
               ESR_ANT = ESR_ANT + 1;                                   
            END;                                                        
                                                                        
         IF BH901.ESR.ÆGTF.DCPRCIR > 0 &                                
            BH901.ESR.ÆGTF.GANE ^= 0                                    
         THEN                                                           
            DO;                                                         
               ESR_SUM = ESR_SUM + BH901.ESR.ÆGTF.GANE;                 
               ESR_ANT = ESR_ANT + 1;                                   
            END;                                                        
                                                                        
         IF ESR_SUM ^= EVS_SUM                                          
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF EVS_ANT = 0 !                                               
            EVS_SUM = 0                                                 
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF ESR_ANT = EVS_ANT &                                         
            ESR_ANT = 2                                                 
         THEN                                                           
            DO;                                                         
               IF BH901.EVS_SLUT_EJER.DCPRN = BH901.ESR.EJER.DCPRCIR &  
                  BH901.EVS_SLUT_ÆGTF.DCPRN = BH901.ESR.ÆGTF.DCPRCIR    
               THEN;                                                    
               ELSE                                                     
                  RETURN;                                               
               /* BEHANDL PERSONER SOM ER ÆGTEFÆLLER   */               
               /* BÅDE I GL. SLUTÅR SAMT I NYT SLUTÅR. */               
               IF (BH901.ESR.EJER.GANE =                                
                   BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100) &         
                  (BH901.ESR.ÆGTF.GANE =                                
                   BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100)           
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     BH901.AKT_EJER.GANE =                              
                     BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;         
                     BH901.AKT_ÆGTF.GANE =                              
                     BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100;         
                     BH901.TIL_EVS.CÆGTOPR = '4';                       
                     TV.ÆGTF_OPRET = TV.ÆGTF_OPRET + 1;                 
                  END;                                                  
               RETURN;                                                  
            END;                                                        
                                                                        
         /* KONTROLLER OM DE INVOLVEREDE PERSONER ER ÆGTEFÆLLER */      
         /* BÅDE I GL. SLUTÅR SAMT I NYT SLUTÅR.                */      
                                                                        
         IF (BH901.EVS_SLUT_EJER.DCPRN > 0 &                            
             BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                            
             BH901.ESR.EJER.DCPRCIR > 0 &                               
             BH901.EVS_SLUT_EJER.DCPRN = BH901.ESR.EJER.DCPRCIR) !      
            (BH901.EVS_SLUT_EJER.DCPRN > 0 &                            
             BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                            
             BH901.ESR.ÆGTF.DCPRCIR > 0 &                               
             BH901.EVS_SLUT_ÆGTF.DCPRN = BH901.ESR.ÆGTF.DCPRCIR)        
         THEN;                                                          
         ELSE                                                           
            RETURN;                                                     
                                                                        
         /* BEHANDL PERSONER HVOR DER ER FORETAGET */                   
         /* ÆGTEFÆLLEFORDELING I GL. SLUTÅR        */                   
                                                                        
         IF ESR_ANT = EVS_ANT &                                         
            ESR_ANT = 1                                                 
         THEN                                                           
            DO;                                                         
               /* KUN EEN EJER BÅDE I ESR OG GL. SLUTÅR */              
               CALL BEHANDL_KUN_EEN_EJER;                               
               RETURN;                                                  
            END;                                                        
                                                                        
         IF EVS_ANT = 1                                                 
         THEN                                                           
            DO;                                                         
               /* KUN DEN ENE ÆGTEFÆLLE ER EJER JVF. GL. SLUTÅR */      
               /* MEN BEGGE JVF. ESR                            */      
               CALL BEHANDL_EN_EJER;                                    
               RETURN;                                                  
            END;                                                        
                                                                        
 /*********************************************************************/
 /*      BEGGE ÆGTEFÆLLER ER EJERE JVF. GL. SLUTÅR                    */
 /*      MEN KUN DEN ENE JVF. ESR                                     */
 /*********************************************************************/
                                                                        
         SELECT;                                                        
                                                                        
           WHEN (BH901.EVS_SLUT_EJER.DCPRN > 0 &                        
                 BH901.AKT_EJER.DCPRCIR > 0)                            
             DO;                                                        
                BH901.AKT_EJER.GANE =                                   
                BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;              
                IF BH901.AKT_EJER.FEJER > 0                             
                THEN                                                    
                   DO;                                                  
                      BH901.AKT_EJER.CEJ_100 = '1';                     
                      BH901.AKT_EJER.FEJER = BH901.AKT_EJER.FEJER + 1;  
                   END;                                                 
                BH901.AKT_ÆGTF = BH901.AKT_EJER, BY NAME;               
                BH901.AKT_ÆGTF.DCPRCIR =                                
                BH901.EVS_SLUT_ÆGTF.DCPRN;                              
                BH901.AKT_ÆGTF.GANE =                                   
                BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100;              
                BH901.TIL_EVS.CÆGTOPR = '4';                            
                TV.ÆGTF_OPRET = TV.ÆGTF_OPRET + 1;                      
             END;                                                       
                                                                        
           WHEN (BH901.EVS_SLUT_EJER.DCPRN > 0 &                        
                 BH901.AKT_EJER.DCPRCIR = 0)                            
             DO;                                                        
                BH901.AKT_ÆGTF.GANE =                                   
                BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100;              
                IF BH901.AKT_ÆGTF.FEJER > 0                             
                THEN                                                    
                   DO;                                                  
                      BH901.AKT_ÆGTF.CEJ_100 = '1';                     
                      BH901.AKT_ÆGTF.FEJER = BH901.AKT_ÆGTF.FEJER + 1;  
                   END;                                                 
                BH901.AKT_EJER = BH901.AKT_ÆGTF, BY NAME;               
                BH901.AKT_EJER.DCPRCIR =                                
                BH901.EVS_SLUT_EJER.DCPRN;                              
                BH901.AKT_EJER.GANE =                                   
                BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;              
                BH901.TIL_EVS.CÆGTOPR = '3';                            
                TV.EJER_OPRET = TV.EJER_OPRET + 1;                      
             END;                                                       
                                                                        
           OTHERWISE                                                    
             DO;                                                        
                TV.ÆGTFOPR_FEJL = TV.ÆGTFOPR_FEJL + 1;                  
                PUT DATA(BH901.SORT_CPR,                                
                         BH901.SORT_KOMNR,                              
                         BH901.SORT_EJDNR);                             
                /* MÅ IKKE FORKOMME? - OPTÆL ANTAL? */                  
             END;                                                       
                                                                        
         END; /* SELECT */                                              
                                                                        
 /*********************************************************************/
 /* KUN DEN ENE ÆGTEFÆLLE ER EJER JVF. GL. SLUTÅR MEN BEGGE JVF. ESR  */
 /*********************************************************************/
 BEHANDL_EN_EJER:                                                       
 PROC;                                                                  
                                                                        
         SELECT;                                                        
                                                                        
          WHEN (BH901.EVS_SLUT_EJER.DCPRN > 0 &                         
                BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS ^= '9' &             
                BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1')                 
            DO;                                                         
               BH901.AKT_ÆGTF = '';                                     
               BH901.AKT_EJER.GANE =                                    
               BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;               
               IF BH901.AKT_EJER.GANE = 10000                           
               THEN                                                     
                 DO;                                                    
                   BH901.AKT_EJER.CEJ_100 = '1';                        
                   BH901.AKT_EJER.FEJER = 1;                            
                 END;                                                   
               ELSE                                                     
                 IF BH901.AKT_EJER.FEJER > 1                            
                 THEN                                                   
                    BH901.AKT_EJER.FEJER =                              
                    BH901.AKT_EJER.FEJER - 1;                           
               BH901.TIL_EVS.CÆGTOPR = '4';                             
               TV.ÆGTF_OPRET = TV.ÆGTF_OPRET + 1;                       
            END;                                                        
                                                                        
          WHEN (BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                         
                BH901.EVS_SLUT_ÆGTF.SIDSTE.CEJBEVS ^= '9' &             
                BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1')                 
            DO;                                                         
               BH901.AKT_EJER.GANE = 0;                                 
               BH901.TIL_EVS.CEJBEVS = '9';                             
               BH901.AKT_ÆGTF.GANE =                                    
               BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100;               
               IF BH901.AKT_ÆGTF.GANE = 10000                           
               THEN                                                     
                 DO;                                                    
                   BH901.AKT_ÆGTF.CEJ_100 = '1';                        
                   BH901.AKT_ÆGTF.FEJER = 1;                            
                 END;                                                   
               ELSE                                                     
                 IF BH901.AKT_ÆGTF.FEJER > 1                            
                 THEN                                                   
                    BH901.AKT_ÆGTF.FEJER =                              
                    BH901.AKT_ÆGTF.FEJER - 1;                           
               BH901.TIL_EVS.CÆGTOPR = '4';                             
               TV.EJER_SLETTET = TV.EJER_SLETTET + 1;                   
            END;                                                        
                                                                        
          OTHERWISE                                                     
            DO;                                                         
               TV.ÆGTFOPR_FEJL = TV.ÆGTFOPR_FEJL + 1;                   
               PUT DATA(BH901.SORT_CPR,                                 
                        BH901.SORT_KOMNR,                               
                        BH901.SORT_EJDNR,                               
                        BH901.SORT_ENHEDLBNR);                          
               /* MÅ IKKE FORKOMME? - OPTÆL ANTAL? */                   
            END;                                                        
                                                                        
         END; /* SELECT */                                              
                                                                        
 END BEHANDL_EN_EJER;                                                   
                                                                        
 /*********************************************************************/
 /* KUN DEN EEN EJER JVF. BÅDE ESR OG GL. SLUTÅR                      */
 /*********************************************************************/
 BEHANDL_KUN_EEN_EJER:                                                  
 PROC;                                                                  
                                                                        
         SELECT;                                                        
                                                                        
          WHEN ((BH901.EVS_SLUT_EJER.DCPRN > 0 &                        
                 BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS ^= '9' &            
                 BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1') &              
                 BH901.EVS_SLUT_EJER.DCPRN = BH901.ESR.EJER.DCPRCIR)    
            DO;                                                         
               TV.SAMME_EJER = TV.SAMME_EJER + 1;                       
            END;                                                        
                                                                        
          WHEN ((BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                        
                 BH901.EVS_SLUT_ÆGTF.SIDSTE.CEJBEVS ^= '9' &            
                 BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1') &              
                 BH901.EVS_SLUT_ÆGTF.DCPRN = BH901.ESR.ÆGTF.DCPRCIR)    
            DO;                                                         
               TV.KUN_ÆGTF = TV.KUN_ÆGTF + 1;                           
            END;                                                        
                                                                        
          WHEN (BH901.EVS_SLUT_EJER.DCPRN > 0 &                         
                BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS ^= '9' &             
                BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1')                 
            DO;                                                         
               BH901.AKT_EJER = AKT_ÆGTF, BY NAME;                      
               BH901.AKT_ÆGTF = '';                                     
               BH901.AKT_EJER.DCPRCIR =                                 
               BH901.EVS_SLUT_EJER.DCPRN;                               
               BH901.AKT_EJER.GANE =                                    
               BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;               
               IF BH901.AKT_EJER.GANE = 10000                           
               THEN                                                     
                 DO;                                                    
                   BH901.AKT_EJER.CEJ_100 = '1';                        
                   BH901.AKT_EJER.FEJER = 1;                            
                 END;                                                   
               BH901.TIL_EVS.CÆGTOPR = '3';                             
               TV.EJER_OPRET = TV.EJER_OPRET + 1;                       
            END;                                                        
                                                                        
          WHEN (BH901.EVS_SLUT_ÆGTF.DCPRN > 0 &                         
                BH901.EVS_SLUT_ÆGTF.SIDSTE.CEJBEVS ^= '9' &             
                BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1')                 
            DO;                                                         
               BH901.AKT_ÆGTF = AKT_EJER, BY NAME;                      
               BH901.AKT_EJER.GANE = 0;                                 
               BH901.AKT_ÆGTF.DCPRCIR =                                 
               BH901.EVS_SLUT_ÆGTF.DCPRN;                               
               BH901.AKT_ÆGTF.GANE =                                    
               BH901.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER * 100;               
               IF BH901.AKT_ÆGTF.GANE = 10000                           
               THEN                                                     
                 DO;                                                    
                   BH901.AKT_ÆGTF.CEJ_100 = '1';                        
                   BH901.AKT_ÆGTF.FEJER = 1;                            
                 END;                                                   
               BH901.TIL_EVS.CÆGTOPR = '4';                             
               BH901.TIL_EVS.CEJBEVS = '9';                             
               TV.EJER_SLETTET = TV.EJER_SLETTET + 1;                   
            END;                                                        
                                                                        
          OTHERWISE                                                     
            DO;                                                         
               TV.ÆGTFOPR_FEJL = TV.ÆGTFOPR_FEJL + 1;                   
               PUT DATA(BH901.SORT_CPR,                                 
                        BH901.SORT_KOMNR,                               
                        BH901.SORT_EJDNR,                               
                        BH901.SORT_ENHEDLBNR);                          
               /* MÅ IKKE FORKOMME? - OPTÆL ANTAL? */                   
            END;                                                        
                                                                        
         END; /* SELECT */                                              
                                                                        
 END BEHANDL_KUN_EEN_EJER;                                              
                                                                        
 END OPSÆT_ÆGTF_FORDEL;                                                 
                                                                        
 %INCLUDE BH60105M; /* UNDERSØG STATUS FOR EJERENS CPRNR */             
                                                                        
 /********************************************************************* 
 *       ALLE INDIVIDER SKRIVES A.H.T. OPDATERING AF EVS EJD.TABEL    * 
 *********************************************************************/ 
 SKRIV_PERSON:PROC;                                                     
                                                                        
         IF BH901.SORT_KOMNR < 999 &                                    
            BH901.AKT_ÆGTF.DCPRCIR > 0 &                                
            BH901.AKT_ÆGTF.DCPRCIR = BH901.EVS_SLUT_ÆGTF.DCPRN &        
           (BH901.EVS_SLUT_ÆGTF.SIDSTE.BOBEHAKOD = 'B' !                
            BH901.EVS_SLUT_ÆGTF.SIDSTE.BOBEHAKOD = 'D') &               
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CSLET < '1' &                    
            BH901.EVS_SLUT_ÆGTF.SIDSTE.CEJBEVS < '9' &                  
            BH901.AKT_ÆGTF.DAFSTÅ  = 0 &                                
            BH901.AKT_EJER.DAFSTÅ  = 0 &                                
          ((BH901.AKT_EJER.GANE + BH901.AKT_ÆGTF.GANE) <= 10000)        
         THEN                                                           
            DO;                                                         
               SELECT;                                                  
                 WHEN (BH901.AKT_ÆGTF.DCPRCIR > 0 &                     
                       BH901.AKT_EJER.DCPRCIR = 0)                      
                   DO;                                                  
                      /* KUN AFDØDE EJER EJENDOMMEN JVF. ESR */         
                      BH901.AKT_EJER = BH901.AKT_ÆGTF, BY NAME;         
                      BH901.AKT_EJER.DCPRCIR = BH901.SORT_CPR;          
                      BH901.AKT_ÆGTF = '';                              
                      TV.OPR_EFTERLEV = TV.OPR_EFTERLEV + 1;            
                      BH901.TIL_EVS.CDATAFRA = '4';                     
                   END;                                                 
                 OTHERWISE                                              
                   DO;                                                  
                      /* BÅDE AFDØDE OG EFTERLEVENDE ÆGTEFÆLLE */       
                      /* EJER EJENDOMMEN JVF. ESR              */       
                      BH901.AKT_EJER.GANE =                             
                      BH901.AKT_EJER.GANE + BH901.AKT_ÆGTF.GANE;        
                      BH901.AKT_ÆGTF = '';                              
                                                                        
                      IF BH901.AKT_EJER.GANE = 10000                    
                      THEN                                              
                        DO;                                             
                          BH901.AKT_EJER.CEJ_100 = '1';                 
                          BH901.AKT_EJER.FEJER = 1;                     
                        END;                                            
                      ELSE                                              
                        IF BH901.AKT_EJER.FEJER > 1                     
                        THEN                                            
                           BH901.AKT_EJER.FEJER =                       
                           BH901.AKT_EJER.FEJER - 1;                    
                                                                        
                      TV.RET_EFTERLEV = TV.RET_EFTERLEV + 1;            
                      BH901.TIL_EVS.CDATAFRA = '4';                     
                   END;                                                 
               END; /* SELECT */                                        
            END;                                                        
                                                                        
         /* CHECK OM INDENLANDSK EJENDOM SKAL VIDEREFØRES */            
         /* PÅ GRUNDLAG AF SLUT                           */            
         CALL CHECK_OM_EJD_VIDERE;                                      
         IF EJENDOM_VIDERE = JA                                         
         THEN                                                           
            DO;                                                         
               BH901.AKT_EJER.DCPRCIR = BH901.EVS_SLUT_EJER.DCPRN;      
               BH901.AKT_EJER.DOVTG = BH901.EVS_SLUT_EJER.SIDSTE.DOVTG; 
               BH901.AKT_EJER.DOVTG_GL = BH901.AKT_EJER.DOVTG;          
               BH901.AKT_EJER.CEJFORH = '10';                           
               BH901.AKT_EJER.CEJ_100 = '1';                            
                                                                        
               IF BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = 0            
               THEN                                                     
                  BH901.AKT_EJER.GANE =                                 
                  BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER * 100;            
                                                                        
               IF BH901.AKT_EJER.GANE = 10000                           
               THEN                                                     
                  BH901.AKT_EJER.FEJER = 1;                             
                                                                        
               SELECT (BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA);            
                 WHEN ('1','5')                                         
                   BH901.TIL_EVS.CDATAFRA = '5';                        
                 WHEN ('4')                                             
                   BH901.TIL_EVS.CDATAFRA = '4';                        
                 WHEN ('2')                                             
                   BH901.TIL_EVS.CDATAFRA = '2';                        
                 OTHERWISE                                              
                   BH901.TIL_EVS.CDATAFRA = '1';                        
               END;                                                     
                                                                        
               BH901.TIL_EVS.C5060 = '5060';                            
                                                                        
               TV.OPR_SLUT_EJER = TV.OPR_SLUT_EJER + 1;                 
            END;                                                        
                                                                        
                                                                        
         BH901.CPENS_TESR = '-';                                        
                                                                        
         SELECT;                                                        
                                                                        
           WHEN (BH901.AKT_EJER.DCPRCIR > 0)                            
            DO;                                                         
             BH901.TIL_EVS.DOVTG = BH901.AKT_EJER.DOVTG;                
             BH901.TIL_FORSKUD.COPR_DOVTG = 'E';                        
             IF BH901.AKT_EJER.DAFSTÅ > 0                               
             THEN                                                       
                DO;                                                     
                   BH901.TIL_EVS.DAFSTAA = BH901.AKT_EJER.DAFSTÅ;       
                   BH901.TIL_FORSKUD.COPR_DAFSTAA = 'E';                
                END;                                                    
            END;                                                        
                                                                        
           WHEN (BH901.EVS_SLUT_EJER.DCPRN > 0 &                        
                 BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1')                
            DO;                                                         
             BH901.TIL_EVS.DOVTG = BH901.EVS_SLUT_EJER.SIDSTE.DOVTG;    
             BH901.TIL_FORSKUD.COPR_DOVTG = 'S';                        
             IF BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA > 0                  
             THEN                                                       
                DO;                                                     
                   BH901.TIL_EVS.DAFSTAA =                              
                   BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA;                  
                   BH901.TIL_FORSKUD.COPR_DAFSTAA = 'S';                
                END;                                                    
             ELSE                                                       
                IF BH901.EVS_FORSK_EJER.DAFSTAA > 0                     
                THEN                                                    
                   DO;                                                  
                      BH901.TIL_EVS.DAFSTAA =                           
                      BH901.EVS_FORSK_EJER.DAFSTAA;                     
                      BH901.TIL_FORSKUD.COPR_DAFSTAA = 'F';             
                   END;                                                 
             IF BH901.EVS_SLUT_EJER.SIDSTE.DFRAFLYT > 0                 
             THEN                                                       
                DO;                                                     
                   BH901.TIL_EVS.DFRAFLYT =                             
                   BH901.EVS_SLUT_EJER.SIDSTE.DFRAFLYT;                 
                END;                                                    
             ELSE                                                       
                IF BH901.EVS_FORSK_EJER.DFRAFLYT > 0                    
                THEN                                                    
                   DO;                                                  
                      BH901.TIL_EVS.DFRAFLYT =                          
                      BH901.EVS_FORSK_EJER.DFRAFLYT;                    
                   END;                                                 
            END;                                                        
                                                                        
           WHEN (BH901.EVS_FORSK_EJER.DCPRN > 0)                        
            DO;                                                         
             BH901.TIL_EVS.DOVTG = BH901.EVS_FORSK_EJER.DOVTG;          
             BH901.TIL_FORSKUD.COPR_DOVTG = 'F';                        
             IF BH901.EVS_FORSK_EJER.DAFSTAA > 0                        
             THEN                                                       
                DO;                                                     
                   BH901.TIL_EVS.DAFSTAA =                              
                   BH901.EVS_FORSK_EJER.DAFSTAA;                        
                   BH901.TIL_FORSKUD.COPR_DAFSTAA = 'F';                
                END;                                                    
             IF BH901.EVS_FORSK_EJER.DFRAFLYT > 0                       
             THEN                                                       
                DO;                                                     
                   BH901.TIL_EVS.DFRAFLYT =                             
                   BH901.EVS_FORSK_EJER.DFRAFLYT;                       
                END;                                                    
            END;                                                        
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF BH901.TIL_EVS.DFRAFLYT > 0                                  
         THEN                                                           
            BH901.SORT_DATO = BH901.TIL_EVS.DFRAFLYT;                   
         ELSE                                                           
            IF BH901.TIL_EVS.DAFSTAA > 0                                
            THEN                                                        
               BH901.SORT_DATO = BH901.TIL_EVS.DAFSTAA;                 
            ELSE                                                        
               BH901.SORT_DATO = 99991231;                              
                                                                        
         IF (BH901.SORT_KOMNR = 999 &                                   
             BH901.EVS_SLUT_EJER.DCPRN = 0 &            /*FORSKUD07*/   
             BH901.EVS_FORSK_EJER.DCPRN > 0 &                           
             BH901.EVS_FORSK_EJER.DAFSTAA = 0) !                        
            (BH901.SORT_KOMNR = 999 &                                   
             BH901.EVS_SLUT_EJER.DCPRN > 0 &                            
             BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                   
             BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA = 0) !                  
            (BH901.SORT_KOMNR < 999 &                                   
             BH901.AKT_EJER.DCPRCIR = 0 &                               
             BH901.EVS_FORSK_EJER.DCPRN > 0 &                           
             BH901.EVS_FORSK_EJER.DAFSTAA = 0) !                        
            (BH901.SORT_KOMNR < 999 &                                   
             BH901.AKT_EJER.DCPRCIR > 0) !                              
            (BH901.SORT_KOMNR < 999 &                                   
             BH901.AKT_EJER.DCPRCIR = 0 &                               
             BH901.EVS_SLUT_EJER.DCPRN > 0 &                            
             BH901.EVS_SLUT_EJER.FØRSTE.CÆGTOPR  < '1' &                
             BH901.EVS_SLUT_EJER.SIDSTE.CÆGTOPR  < '1' &                
             BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &                   
             BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA = 0 &                   
            (BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '2' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '3' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '6' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '7' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '8' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '9' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = 'B' !                 
             BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = 'C'))                 
         THEN                                                           
            DO;                                                         
               TV.SKREVET = TV.SKREVET + 1;                             
               IF BH901.AKT_EJER.FEJER > 2                              
               THEN                                                     
                  TV.FL_EJER = TV.FL_EJER + 1;                          
               IF BH901.AKT_EJER.DCPRCIR = 0                            
               THEN                                                     
                  TV.FEVS = TV.FEVS + 1;                                
               WRITE FILE (BH901O) FROM (BH901);                        
               RETURN;                                                  
            END;                                                        
                                                                        
         /* ØVRIGE INDIVIDER SKAL IKKE BEHANDLES */                     
         /* I DE EFTERFØLGENDE PROGRAMMER        */                     
                                                                        
         IF BH901.EVS_SLUT_EJER.DCPRN > 0 &                             
            BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1'                      
         THEN                                                           
           DO;                                                          
             TV.EJER_FRA_SLUT = TV.EJER_FRA_SLUT + 1;                   
             IF BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA > 0                  
             THEN                                                       
                TV.SOLGT_I_SLUT = TV.SOLGT_I_SLUT + 1;                  
             ELSE                                                       
                TV.EJET_I_SLUT = TV.EJET_I_SLUT + 1;                    
           END;                                                         
                                                                        
         TV.FRASORTERET = TV.FRASORTERET + 1;                           
         WRITE FILE (BH9011O) FROM (BH901);                             
                                                                        
 END SKRIV_PERSON;                                                      
 /********************************************************************* 
 *         CHECK OM INDENLANDSK EJENDOM SKAL VIDEREFØRES              * 
 *         PÅ GRUNDLAG AF SLUT                                        * 
 *         UDVIDDET MED CEJBEVS = B OG CEJBEVS = C SAMT               * 
 *         CDATAFRA = 7 TIL FORSKUD 2020                              * 
 *********************************************************************/ 
 CHECK_OM_EJD_VIDERE: PROC;                                             
                                                                        
     DCL    INDENLANDSK_EJENDOM                         BIT (1);        
     DCL    PERSON_ER_GYLDIG                            BIT (1);        
     DCL    KODE_2PROM_NEDSLAG_STØRRE_LIG_10            BIT (1);        
                                                                        
     DCL    EJER_ER_DØD                                 BIT (1);        
     DCL    EJERSKAB_ER_SLETTET                         BIT (1);        
     DCL    EJERSKAB_ER_OPRETTET_VED_ÆGTEFÆLLEFORDELING BIT (1);        
     DCL    EJERSKAB_ER_SOLGT                           BIT (1);        
     DCL    EJERSKAB_ER_FRAFLYTTET                      BIT (1);        
     DCL    EJER_HAR_EN_EJERANDEL                       BIT (1);        
                                                                        
     DCL    GENERELLE_KRITERIER_ER_OPFYLDT              BIT (1);        
     DCL    REGEL1_KRITERIER_ER_OPFYLDT                 BIT (1);        
     DCL    REGEL2_KRITERIER_ER_OPFYLDT                 BIT (1);        
     DCL    REGEL3_KRITERIER_ER_OPFYLDT                 BIT (1);        
                                                                        
     /**************************************************/               
     /* G E N E R E L T  check for samtlige regler 1-3 */               
     /**************************************************/               
                                                                        
     /* Er ejendommen indenlandsk ? */                                  
     IF BH901.SORT_KOMNR < 999                                          
     THEN                                                               
       INDENLANDSK_EJENDOM = JA;                                        
     ELSE                                                               
       INDENLANDSK_EJENDOM = NEJ;                                       
                                                                        
     /* Er cprnr ok, og er persontypen sat i slutår ? */                
     IF BH901.AKT_EJER.DCPRCIR = 0 &                                    
        BH901.EVS_SLUT_EJER.DCPRN > 0 &                                 
        BH901.EVS_SLUT_EJER.SIDSTE.CPTYPSLUT > '0'                      
     THEN                                                               
       PERSON_ER_GYLDIG = JA;                                           
     ELSE                                                               
       PERSON_ER_GYLDIG = NEJ;                                          
                                                                        
     /* Er 2 promille nedslag større eller lig 10 ? */                  
     IF BH901.EVS_SLUT_EJER.SIDSTE.CNEDSL1 >= '10'                      
     THEN                                                               
       KODE_2PROM_NEDSLAG_STØRRE_LIG_10 = JA;                           
     ELSE                                                               
       KODE_2PROM_NEDSLAG_STØRRE_LIG_10 = NEJ;                          
                                                                        
     /* Er ejer død ? */                                                
     IF BH901.EVS_SLUT_EJER.SIDSTE.FEJLNR ^= '5004'                     
     THEN                                                               
       EJER_ER_DØD = NEJ;                                               
     ELSE                                                               
       EJER_ER_DØD = JA;                                                
                                                                        
     /* Er ejerskab slettet ? */                                        
     IF BH901.EVS_SLUT_EJER.SIDSTE.CSLET < '1'                          
     THEN                                                               
       EJERSKAB_ER_SLETTET = NEJ;                                       
     ELSE                                                               
       EJERSKAB_ER_SLETTET = JA;                                        
                                                                        
     /* Er ejerskab oprettet ved ægtefællefordeling ? */                
     IF BH901.EVS_SLUT_EJER.SIDSTE.CÆGTOPR < '1' &                      
        BH901.EVS_SLUT_EJER.SIDSTE.FEJLNR ^= '5027'                     
     THEN                                                               
       EJERSKAB_ER_OPRETTET_VED_ÆGTEFÆLLEFORDELING = NEJ;               
     ELSE                                                               
       EJERSKAB_ER_OPRETTET_VED_ÆGTEFÆLLEFORDELING = JA;                
                                                                        
     /* Er ejerskabet solgt ? */                                        
     IF BH901.EVS_SLUT_EJER.SIDSTE.DAFSTAA = 0                          
     THEN                                                               
       EJERSKAB_ER_SOLGT = NEJ;                                         
     ELSE                                                               
       EJERSKAB_ER_SOLGT = JA;                                          
                                                                        
     /* Er ejerskabet fraflyttet ? */                                   
     IF BH901.EVS_SLUT_EJER.SIDSTE.DFRAFLYT = 0                         
     THEN                                                               
       EJERSKAB_ER_FRAFLYTTET = NEJ;                                    
     ELSE                                                               
       EJERSKAB_ER_FRAFLYTTET = JA;                                     
                                                                        
     /* har ejerskabet en ejerandel ? */                                
     IF BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = 0 &                    
        BH901.EVS_SLUT_EJER.SIDSTE.GPCTEJER > 0                         
     THEN                                                               
       EJER_HAR_EN_EJERANDEL = JA;                                      
     ELSE                                                               
       EJER_HAR_EN_EJERANDEL = NEJ;                                     
                                                                        
     IF INDENLANDSK_EJENDOM = JA &                                      
        PERSON_ER_GYLDIG = JA &                                         
        EJER_ER_DØD = NEJ &                                             
        EJERSKAB_ER_SLETTET = NEJ &                                     
        EJERSKAB_ER_OPRETTET_VED_ÆGTEFÆLLEFORDELING = NEJ &             
        EJERSKAB_ER_SOLGT = NEJ &                                       
        EJERSKAB_ER_FRAFLYTTET = NEJ &                                  
        EJER_HAR_EN_EJERANDEL = JA &                                    
        KODE_2PROM_NEDSLAG_STØRRE_LIG_10 = JA                           
     THEN                                                               
       Generelle_kriterier_er_opfyldt = JA;                             
     ELSE                                                               
       Generelle_kriterier_er_opfyldt = NEJ;                            
                                                                        
                                                                        
     /**************************************************/               
     /* I N D I V I D U E L T  check for regel 1-3     */               
     /**************************************************/               
                                                                        
     /* REGEL 1 */                                                      
     IF BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' &                      
        BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA ^= '6'                      
     THEN                                                               
       Regel1_kriterier_er_opfyldt = JA;                                
     ELSE                                                               
       Regel1_kriterier_er_opfyldt = NEJ;                               
                                                                        
     /* REGEL 2 */                                                      
     IF(BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS < '8' !                      
        BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = 'B' !                      
        BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = 'C') &                     
       (BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA = '4' !                     
        BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA = '7')                      
     THEN                                                               
       Regel2_kriterier_er_opfyldt = JA;                                
     ELSE                                                               
       Regel2_kriterier_er_opfyldt = NEJ;                               
                                                                        
                                                                        
     /* REGEL 3 */                                                      
     IF (BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA = '1' !                    
         BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA = '2' !                    
         BH901.EVS_SLUT_EJER.SIDSTE.CDATAFRA = '5') &                   
        (BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '1' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '2' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '3' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '6' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '7' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = 'B' !                     
         BH901.EVS_SLUT_EJER.SIDSTE.CEJBEVS = 'C')                      
     THEN                                                               
       Regel3_kriterier_er_opfyldt = JA;                                
     ELSE                                                               
       Regel3_kriterier_er_opfyldt = NEJ;                               
                                                                        
                                                                        
     /* Hvis de generelle kriterier samt kriterier for mindst EN af */  
     /* reglerne er opfyldt, medtages ejendommen i slut akt_år      */  
                                                                        
     IF generelle_kriterier_er_opfyldt &                                
        (Regel1_kriterier_er_opfyldt !                                  
         Regel2_kriterier_er_opfyldt !                                  
         Regel3_kriterier_er_opfyldt)                                   
     THEN                                                               
       EJENDOM_VIDERE = JA;                                             
     ELSE                                                               
       EJENDOM_VIDERE = NEJ;                                            
                                                                        
                                                                        
 END CHECK_OM_EJD_VIDERE;                                               
                                                                        
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH612;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK FRA ESR+EVS  B.H61200D';
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS;                                    
         DETLIN1.TEKST = '   HERAF INDIVIDER FRA EVS             ';     
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS_F;                                  
 /*#01*/ DETLIN1.TEKST = '         HERAF KUN FRA FORSKUD ' !!           
                         BH55300M.INDKÅR1;                              
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS_S;                                  
 /*#01*/ DETLIN1.TEKST = '         HERAF KUN FRA SLUT ' !!              
                         BH55300M.GLSLUTÅR1;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SLETSLUT_EJERHDL;                           
         DETLIN1.TEKST = '      HERAF EVS-SLUT EJEROPLYSNINGER SLETTET';
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SLETSLUT_ÆGTFHDL;                           
         DETLIN1.TEKST = '      HERAF EVS-SLUT ÆGTFOPLYSNINGER SLETTET';
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SLET_FORSKUD_HDL;                           
         DETLIN1.TEKST = '      HERAF EVS-FORSKUD OPLYSNINGER SLETTET'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OVERSPR_EVSHDL;                             
         DETLIN1.TEKST = '      HERAF OVERSPRUNGNE HANDLER';            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FUDLANDSK;                                  
         DETLIN1.TEKST = '      HERAF UDENLANDSKE EJENDOMME';           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FØVREVS;                                    
         DETLIN1.TEKST = '      HERAF IKKE UDENLANDSKE EJENDOMME';      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FEVSOPRET;                                  
         DETLIN1.TEKST = '         HERAF OPRETTEDE KØBERE';             
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FESR_MATCH;                                 
         DETLIN1.TEKST = '         HERAF EJER+EJD OGSÅ FRA ESR';        
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_ESR;                                    
         DETLIN1.TEKST = '   HERAF INDIVIDER FRA ESR                ';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OFF_EJ_CPR;                                 
         DETLIN1.TEKST = '      HERAF OFFENTLIGT EJET (IKKE P-NR)';     
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OFF_CPR;                                    
         DETLIN1.TEKST = '      HERAF OFFENTLIGT EJET (MED P-NR)';      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OVERSPR_CPR;                                
         DETLIN1.TEKST = '      HERAF EJ MED VALIDT PERSONNR.';         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OVERSPR_SE;                                 
         DETLIN1.TEKST = '      HERAF SE-NUMRE KUN TIL SLS   ';         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.TO_EJER_NUL;                                
         DETLIN1.TEKST = '      HERAF 2-EJERE UDEN EJERANDEL';          
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.FL_EJER_NUL;                                
         DETLIN1.TEKST = '      HERAF MED OVER 2 EJERE UDEN EJERANDEL'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.GANE_JUSTER;                                
         DETLIN1.TEKST = '      HERAF EJERANDEL OVERFØRT FRA EVS SLUT'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJER_OPRET;                                 
         DETLIN1.TEKST = '      HERAF EJER-OPRETTELSE FRA EVS SLUT';    
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.ÆGTF_OPRET;                                 
         DETLIN1.TEKST = '      HERAF ÆGTF-OPRETTELSE FRA EVS SLUT';    
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SAMME_EJER;                                 
         DETLIN1.TEKST = '      HERAF KUN EEN EJER OG SAMME EJER';      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.KUN_ÆGTF;                                   
         DETLIN1.TEKST = '      HERAF KUN EEN EJER=ÆGTEFÆLLE    ';      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJER_SLETTET;                               
         DETLIN1.TEKST = '      HERAF EJER SLETTET VIA ÆGTF-OPRET   ';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.ÆGTF_SLETTET;                               
         DETLIN1.TEKST = '      HERAF ÆGTF SLETTET VIA ÆGTF-OPRET   ';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJER_OMBYT;                                 
         DETLIN1.TEKST = '      HERAF HEL ANDEL FLYTTET MELLEM ÆGTF.';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.ÆGTFOPR_FEJL;                               
         DETLIN1.TEKST = '      HERAF MÅSKE FEJL VEDR. ÆGTF-OPRET   ';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FRASORTERET;                                
         DETLIN1.TEKST = 'ANTAL FRASORTEREDE SITUATIONER    B.H90110D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJER_FRA_SLUT;                              
  /*#01*/DETLIN1.TEKST = '      HERAF EJER FRA SLUT ' !!                
                         BH55300M.GLSLUTÅR1;                            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJET_I_SLUT;                                
         DETLIN1.TEKST = '            HERAF IKKE SOLGT JVF. UDTRÆK   '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SOLGT_I_SLUT;                               
         DETLIN1.TEKST = '            HERAF SOLGT JVF. UDTRÆK        '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER           B.H90100D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FEVS;                                       
         DETLIN1.TEKST = '      HERAF FRA EVS          ';               
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.FL_EJER;                                    
         DETLIN1.TEKST = '      HERAF MED FLERE END 2 EJERE';           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
 /*#01*/ DETLIN1.TEKST = 'ANTAL CFORSKEL=1 (EVT. REDUCERET I ' !!       
                        BH55300M.INDKÅR1 !!  ')  ';                     
         DETLIN1.ANTAL = TV.FORSKEL1;                                   
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = 'ANTAL CFORSKEL=2 (EJ REDUKTION-BYGGERI>100';  
         DETLIN1.ANTAL = TV.FORSKEL2;                                   
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
 /*#01*/ DETLIN1.TEKST = 'ANTAL CFORSKEL=3 (BENYT ' !!                  
                          BH55300M.INDKÅR1 !! '- BYGGERI<101';          
         DETLIN1.ANTAL = TV.FORSKEL3;                                   
         CALL ZZ20300 (DETLIN1,'01');                                   
  END TOTALLISTE;                                                       
 /********************************************************************* 
 *       SKRIVNING AF OPTÆLLINGSINDIVID                               * 
 *********************************************************************/ 
 SKRIV_OPTÆLLING:                                                       
         PROC;                                                          
                                                                        
         BH90099            = '';                                       
         BH90099.SORT_CPR   = 99999999999;                              
         BH90099.SORT_KOMNR = 999;                                      
         BH90099.SORT_EJDNR = 9999999;                                  
         BH90099.ANT_INDV   = TV.SKREVET;                               
         WRITE FILE (BH901O) FROM (BH90099);                            
                                                                        
 END SKRIV_OPTÆLLING;                                                   
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
         CALL TOTALLISTE;                                               
         CALL SKRIV_OPTÆLLING;                                          
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH612I),                                           
               FILE (BH901O),                                           
               FILE (BH9011O);                                          
 END AFSLUT;                                                            
 END  BH90100;                                                          
