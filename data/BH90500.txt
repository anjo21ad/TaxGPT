  PROCESS OPT(TIME);                                                    
 BH90500: /* DAN 1. UDGAVE AF BEREGNINGSBÅND TIL EVS SLUT 2011 SUPPL */ 
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KMD A/S 2011');               
 /********************************************************************* 
 *                                                                    * 
 * FORMÅL: SAMSORTEREDE UDTRÆK FRA ESR, SLUT OG FORSKUD EVS-TABELLER  * 
 *         BRUGES TIL DANNELSE AF 1. UDGAVE AF BEREGNINGSBÅNDET TIL   * 
 *         EVS SLUT 2011 SUPPLEMENTSKØRSEL.                           * 
 *                                                                    * 
 *         DET ER KUN ESR-EJERE MED VALIDT PERSONNR. SOM MÅ SLIPPE    * 
 *         IGENNEM TIL BEREGNINGSBÅNDET (EJERE JVF. EVS-UDTRÆKKET     * 
 *         SOM  I K K E  OGSÅ ER ESR-EJERE OVERLÆSES).                * 
 *                                                                    * 
 *    OBS. UDTRÆKKET FRA ESR ER 'UBEHANDLET' D.V.S. HAR IKKE VÆRET    * 
 *         IGENNEM 'FORBEHANDLINGEN' SOM VED GRUNDLEVERINGEN. DERFOR  * 
 *         BLIVER DEN 'FORBEHANDLING' SOM ELLERS UDFØRES I PROGRAM    * 
 *         BH31800 SÅ VIDT MULIGT FORETAGET I DETTE PROGRAM INDEN     * 
 *         DATA FLYTTES TIL BEREGNINGSBÅNDET.                         * 
 *                                                                    * 
 * INPUT:  B.H61400D  UDTRÆK FRA ESR, EVS SLUT OG EVS FORSKUD         * 
 *                                                                    * 
 * OUTPUT: B.H90500D  BEREGNINGSBÅND                                  * 
 *         BH90501Y   KONTROLLISTE                                    * 
 *                                                                    * 
 * PROGRAMMØR:   AAGE RASMUSSEN LSU T&S FEB 2002                      * 
 * (DANNET P.G.A. BH90000 FRA HOVEDLEVERING EVS SLUT 2001)            * 
 *                                                                    * 
 * ÅRSTILRETTET:  AAGE RASMUSSEN FEBRUAR  2003                        * 
 * ÅRSTILRETTET:  AAGE RASMUSSEN JANUAR   2004                        * 
 * ÅRSTILRETTET:  AAGE RASMUSSEN JANUAR   2005                        * 
 * ÅRSTILRETTET:  BO SCHMIDT     JANUAR   2006                        * 
 * ÅRSTILRETTET:  BO SCHMIDT     NOVEMBER 2006                        * 
 * ÅRSTILRETTET:  INGRID FISCHAR NOVEMBER 2007                        * 
 * ÅRSTILRETTET:  BO SCHMIDT     NOVEMBER 2008                        * 
 * ÅRSTILRETTET:  GEH            NOVEMBER 2009    #SLUT09 + I TEKSTER * 
 * ÅRSTILRETTET:  GEH            NOVEMBER 2010    #SLUT10 + I TEKSTER * 
 * ÅRSTILRETTET:  GEH            DECEMBER 2011    #SLUT11 + I TEKSTER * 
 *                                                                    * 
 *********************************************************************/ 
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /********************************************************************* 
 *       DECLARE AF REGISTRE                                          * 
 *********************************************************************/ 
 DCL     BH614I FILE RECORD INPUT;      /* ESR OG EVS UDTRÆK         */ 
 DCL     BH905O FILE RECORD OUTPUT;     /* BEREGNINGSBÅND            */ 
 DCL     SYSPRINT FILE EXTERNAL PRINT;                                  
 /********************************************************************* 
 *       DECLARE AF UDTRÆK FRA ESR                                    * 
 *********************************************************************/ 
 DCL     BH614_AR        CHAR      (4000) VAR;                          
 DCL     1 BH6141        BASED     (ADDR(BH614_AR)),                    
           4 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH31800N;                                           
 DCL     1 BH6142        BASED     (ADDR(BH614_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH31700N;;                                          
 DCL     1 BH614_ID1,                                                   
           2 DCPRCIR     PIC       '(10)9',                             
           2 EKOMNR      PIC       '(3)9',                              
           2 EEJDNR      PIC       '(7)9';                              
 DCL     1 BH614_ID2     BASED(ADDR(BH614_ID1)),                        
           2 FØSDAG      PIC       '(6)9',                              
           2 LØBENR      PIC       '999',                               
           2 CHKCIF      PIC       '9';                                 
 DCL     BH614_ID        CHAR      (20)   BASED(ADDR(BH614_ID1));       
 DCL     1 GEM,                                                         
           2 EVS_UDTRÆK,                                                
             %INCLUDE BH31700N;;                                        
 /********************************************************************* 
 *       DECLARE AF UDTRÆK (BEREGNINGSBÅND)                           * 
 *********************************************************************/ 
 DCL     1 BH900,                                                       
           %INCLUDE BH90000N;;                                          
 DCL     1 BH90099,                                                     
           %INCLUDE BH90099N;               /* OPTÆLLINGSINDIVID      */
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_BH614        FIXED DEC (7),                            
           2 LÆS_OPTÆL        FIXED DEC (7),                            
           2 LÆS_EVS          FIXED DEC (7),                            
           2 LÆS_EVS_F        FIXED DEC (7),                            
           2 LÆS_EVS_S        FIXED DEC (7),                            
           2 LÆS_EVS_FS       FIXED DEC (7),                            
           2 FESR_MATCH       FIXED DEC (7),                            
           2 FOVF_SALG        FIXED DEC (7),                            
           2 LÆS_ESR          FIXED DEC (7),                            
           2 OFF_CPR          FIXED DEC (7),                            
           2 OFF_EJ_CPR       FIXED DEC (7),                            
           2 OVERSPR_CPR      FIXED DEC (7),                            
           2 CPRNR_NUL        FIXED DEC (7),                            
           2 OVERSPR_BK       FIXED DEC (7),                            
           2 OVERSPR_BK14     FIXED DEC (7),                            
           2 OVERSPR_BK20     FIXED DEC (7),                            
           2 OVERSPR_BK78     FIXED DEC (7),                            
           2 OVERSPR_BK79     FIXED DEC (7),                            
           2 OVERSPR_SLT16    FIXED DEC (7),                            
           2 OVERSPR_SLT      FIXED DEC (7),                            
           2 OVERSPR_SE       FIXED DEC (7),                            
           2 SALG_FØR         FIXED DEC (7),                            
           2 KØB_EFTER        FIXED DEC (7),                            
           2 TO_EJER          FIXED DEC (7),                            
           2 EJ_SKR           FIXED DEC (7),                            
           2 TO_EJER_NUL      FIXED DEC (7),                            
           2 FL_EJER_NUL      FIXED DEC (7),                            
           2 FRASORTERET      FIXED DEC (7),                            
           2 SKREVET          FIXED DEC (7),                            
           2 FEVS             FIXED DEC (7),                            
           2 FØVREVS          FIXED DEC (7),                            
           2 FUDLANDSK        FIXED DEC (7),                            
           2 FL_EJER          FIXED DEC (7),                            
           2 FORSKEL1         FIXED DEC (7),                            
           2 FORSKEL2         FIXED DEC (7),                            
           2 FORSKEL3         FIXED DEC (7),                            
           2 PGF4A            FIXED DEC (7),                            
           2 PGF4B            FIXED DEC (7);                            
 /********************************************************************* 
 *       DECLARE AF DIV. FÆLLESMACROER (ESKEMA/BOY/FORSKUD)           * 
 *********************************************************************/ 
 DCL     1 BH65300M,                                                    
           %INCLUDE BH65300M;                                           
 DCL     1 BH60101M      ALIGNED,                                       
           %INCLUDE BH60101M;                                           
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     MOD             BUILTIN;                                       
 DCL     STG             BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     VERIFY          BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH90500L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (69)      INIT      (                
           '1. UDGAVE AF BEREGNINGSBÅND TIL EVS SLUT 2011 SUPPL'),      
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN0,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (41),                                
           2 CPUÅR       PIC       '99',                                
           2 TEKST2      CHAR      (11),                                
           2 START       PIC       '999999',                            
           2 TEKST3      CHAR      (9),                                 
           2 SLUT        PIC       '999999',                            
           2 TEKST4      CHAR      (57);                                
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (33),                                
           2 RCKOD       CHAR      (01)      INIT      (' '),           
           2 F1          CHAR      (19)      INIT      (' '),           
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (68)      INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     EOF_BH614       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     (I,J,K,N)       BIN FIXED (15)    INIT (0);                    
 DCL     HJ_CPR          PIC       '(10)9';                             
 DCL     CRETUR          CHAR      (1);                                 
 DCL     MATCH_CPRNR     FIXED     (11) INIT (0);                       
 DCL     MATCH_KOMNR     FIXED     (3)  INIT (0);                       
 DCL     MATCH_EJDNR     FIXED     (7)  INIT (0);                       
 DCL     HJKOMNR         PIC       '999';     /* HJÆLPEFELT TIL KOMNR */
 DCL     HJCRCKO         PIC       '9';       /* HJÆLPEFELT TIL RCKODE*/
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     HJ_DATOEN       PIC  '(8)9';                                   
 DCL     1 HJ_DATO       BASED(ADDR(HJ_DATOEN)),                        
           2 AAR         PIC  '9999',                                   
           2 MD          PIC  '99',                                     
           2 DG          PIC  '99';                                     
                                                                        
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *********************************************************************/ 
 DCL     SWFEJL          CHAR      (1)       INIT      (' ');           
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
         EOF_BH614 = NEJ;                                               
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (BH614I)  TITLE ('BH61400I');                        
         OPEN FILE (BH905O)  TITLE ('BH90500O');                        
                                                                        
         ON ENDFILE (BH614I)                                            
            EOF_BH614 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH90501Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         TV = 0;                                                        
                                                                        
         GEM = '';                                                      
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_BH614;                                                
                                                                        
         DO WHILE ( EOF_BH614 = NEJ );                                  
            CALL BEHANDL;                                               
            CALL LÆS_BH614;                                             
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR OG EVS - SAMSORTERET (B.H61400D)          * 
 *********************************************************************/ 
 LÆS_BH614:                                                             
         PROC;                                                          
                                                                        
         READ FILE (BH614I) INTO (BH614_AR);                            
                                                                        
                                                                        
         IF EOF_BH614 = NEJ                                             
         THEN                                                           
          DO;                                                           
           BH614_ID1.DCPRCIR = BH6141.DCPRCIR;                          
           BH614_ID1.EKOMNR  = BH6141.EKOMNR;                           
           BH614_ID1.EEJDNR  = BH6141.EEJDNR;                           
           TV.LÆS_BH614 = TV.LÆS_BH614 + 1;                             
                                                                        
           IF BH6141.DCPRCIR >= 9999999999                              
           THEN                                                         
            TV.LÆS_OPTÆL = TV.LÆS_OPTÆL + 1;                            
           ELSE                                                         
            DO;                                                         
             IF BH6141.CITYP > 0                                        
             THEN                                                       
                TV.LÆS_ESR = TV.LÆS_ESR + 1;                            
             ELSE                                                       
               DO;                                                      
                 TV.LÆS_EVS = TV.LÆS_EVS + 1;                           
                 SELECT;                                                
                   WHEN (BH6142.EVS_FORSK_EJER.DCPRN > 0 &              
                        (BH6142.EVS_SLUT_EJER.DCPRN = 0 !               
                         BH6142.EVS_SLUT_EJER.SIDSTE.CSLET = '1') &     
                        (BH6142.EVS_SLUT_ÆGTF.DCPRN = 0 !               
                         BH6142.EVS_SLUT_ÆGTF.SIDSTE.CSLET = '1'))      
                     TV.LÆS_EVS_F = TV.LÆS_EVS_F + 1;                   
                   WHEN (BH6142.EVS_FORSK_EJER.DCPRN = 0)               
                     TV.LÆS_EVS_S = TV.LÆS_EVS_S + 1;                   
                   OTHERWISE                                            
                     TV.LÆS_EVS_FS = TV.LÆS_EVS_FS + 1;                 
                 END; /* SELECT */                                      
               END;                                                     
            END;                                                        
          END;                                                          
                                                                        
 END LÆS_BH614;                                                         
 /********************************************************************* 
 *       PERSONER SOM EVT. SKAL BEHANDLES/BEREGNES                    * 
 *                                                                    * 
 *  OBS. BEHANDLINGEN AF ESR-UDTRÆKKET ÅRSTILRETTES JVF. DE ÆNDRINGER * 
 *       SOM EVT. ER FORETAGET I PROGRAM BH31800.                     * 
 *********************************************************************/ 
 BEHANDL:                                                               
         PROC;                                                          
                                                                        
         IF BH6141.DCPRCIR >= 9999999999                                
         THEN                                                           
            RETURN; /* ESR-OPTÆLLINGSINDIVID OVERSPRINGES */            
                                                                        
         IF BH6141.CITYP > 0           /* INDIVID MED DATA FRA ESR */   
         THEN                          /* SPRINGES EVT. OVER       */   
            DO;                                                         
               IF BH6141.DCPRCIR = 0         /* HVIS INGEN EJERE */     
               THEN                          /* SPRINGES OVER    */     
                  DO;                                                   
                     TV.CPRNR_NUL = TV.CPRNR_NUL + 1;                   
                     RETURN;                                            
                  END;                                                  
                                                                        
               IF (BH6141.DAFGDAT > 0 &       /* HVIS EJEREN ER   */    
                   BH6141.DAFSTÅ = 0)         /* SLETTET I ESR    */    
               THEN                           /* SPRINGES OVER    */    
                  DO;                                                   
                     /* DISSE SPRINGES OVER AF HENSYN TIL OPRETTELSE */ 
                     /* AF OPLYSNINGER VEDR. DØDE P.G.A. EVS-UDTRÆK  */ 
                     IF BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '16'          
                     THEN                                               
                        TV.OVERSPR_SLT16 = TV.OVERSPR_SLT16 + 1;        
                     ELSE                                               
                        TV.OVERSPR_SLT = TV.OVERSPR_SLT + 1;            
                     RETURN;                                            
                  END;                                                  
                                                                        
               CALL VALIDER_DATO;                                       
                                                                        
               IF BH6141.DAFSTÅ > 0 &      /* AF HENSYN TIL BAGUD  */   
  /*#SLUT11*/     BH6141.DAFSTÅ < 20100301 /* FORSKUDT REGNSKABSÅR */   
               THEN                                                     
                  DO;                                                   
                     TV.SALG_FØR = TV.SALG_FØR + 1;                     
                     RETURN;                                            
                  END;                                                  
                                                                        
  /*#SLUT11*/  IF BH6141.DOVTG > 20120131  /* AF HENSYN TIL FREMAD */   
               THEN                        /* FORSKUDT REGNSKABSÅR */   
                  DO;                                                   
                     TV.KØB_EFTER = TV.KØB_EFTER + 1;                   
                     RETURN;                                            
                  END;                                                  
                                                                        
               IF (BH6141.VURDOPLNY.OMBER01(1).KONSEKVENS = 'J' !       
                   BH6141.VURDOPLNY.OMBER01(1).KONSEKVENS = 'N' !       
                   BH6141.VURDOPLNY.OMBER01(2).KONSEKVENS = 'J' !       
                   BH6141.VURDOPLNY.OMBER01(2).KONSEKVENS = 'N') &      
                   BH6141.VURDOPLNY.ÅRSVURD.CUOP ^= '6'                 
               THEN                                                     
                  DO;                                                   
                     /* DER ER OMBEREGNINGER TIL AKTUEL VURDERING, */   
                     /* D.V.S. AT VURDERINGSOPLYSNINGERNE FRA DEN  */   
                     /* NÆRMESTE FOREGÅENDE VURDERING              */   
                     /* (DENNE GANG FRA ÅRSVURDERINGEN PR. 1/10-04)*/   
                     /* SKAL BENYTTES SOM AKTUEL VURDERING D.V.S.  */   
                     /* TIL OPSÆTNING AF FEJLNR, CEJBEVS SAMT BE-  */   
                     /* REGNINGSGRUNDLAG M.V..                     */   
                     IF BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '00' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '10' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '11' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '12' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '14' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '20' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '55' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '56' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '57' !        
                        BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '79'          
                     THEN                                               
                        DO;                                             
                           /* DETTE ER EJENDOMME SOM IKKE   */          
                           /* ER EVS-RELEVANTE P.G.A AKTUEL */          
                           /* VURDERING                     */          
                           IF BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '14'    
                           THEN                                         
                              TV.OVERSPR_BK14 = TV.OVERSPR_BK14 + 1;    
                           ELSE                                         
                           IF BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '20'    
                           THEN                                         
                              TV.OVERSPR_BK20 = TV.OVERSPR_BK20 + 1;    
                           ELSE                                         
                           IF BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '79'    
                           THEN                                         
                              TV.OVERSPR_BK79 = TV.OVERSPR_BK79 + 1;    
                           ELSE                                         
                              TV.OVERSPR_BK = TV.OVERSPR_BK + 1;        
                           RETURN;                                      
                        END;                                            
                  END;                                                  
               ELSE                                                     
                  DO;                                                   
                     IF BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '00' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '10' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '11' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '12' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '14' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '20' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '55' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '56' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '57' !        
                        BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '79'          
                     THEN                                               
                        DO;                                             
                           /* DETTE ER EJENDOMME SOM IKKE */            
                           /* ER EVS-RELEVANTE P.G.A AKTUEL */          
                           /* VURDERING                     */          
                           IF BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '14'    
                           THEN                                         
                              TV.OVERSPR_BK14 = TV.OVERSPR_BK14 + 1;    
                           ELSE                                         
                           IF BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '20'    
                           THEN                                         
                              TV.OVERSPR_BK20 = TV.OVERSPR_BK20 + 1;    
                           ELSE                                         
                           IF BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '79'    
                           THEN                                         
                              TV.OVERSPR_BK79 = TV.OVERSPR_BK79 + 1;    
                           ELSE                                         
                              TV.OVERSPR_BK = TV.OVERSPR_BK + 1;        
                           RETURN;                                      
                        END;                                            
                  END;                                                  
                                                                        
               IF BH6141.VURDOPLNY.ÅRSVURD.CBENYT = '78' !              
                 (BH6141.VURDOPLNY.ÅRSVURD.CBENYT > '00' &              
                  BH6141.VURDOPLNY.ÅRSVURD.CBENYT ^= '78' &             
                  BH6141.VURDOPLNY.ÅRSVURD.BEJDVÆR = 0 &                
                  BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '78')               
               THEN                                                     
                  DO;                                                   
                     /* DETTE ER EJENDOMME SOM IKKE */                  
                     /* ER EVS-RELEVANTE JVF. T&S   */                  
                     /* KRAVSPEC. EVS 2003 18-04-05 */                  
                     TV.OVERSPR_BK78 = TV.OVERSPR_BK78 + 1;             
                     RETURN;                                            
                  END;                                                  
            END;                                                        
                                                                        
         IF GEM.EVS_UDTRÆK.DCPRNUM > 0 &                                
           (BH6141.DCPRCIR > GEM.EVS_UDTRÆK.DCPRNUM !                   
           (BH6141.DCPRCIR = GEM.EVS_UDTRÆK.DCPRNUM &                   
            BH6141.EKOMNR > GEM.EVS_UDTRÆK.EKOMNUM) !                   
          ((BH6141.DCPRCIR = GEM.EVS_UDTRÆK.DCPRNUM &                   
            BH6141.EKOMNR = GEM.EVS_UDTRÆK.EKOMNUM) &                   
            BH6141.EEJDNR > GEM.EVS_UDTRÆK.EEJDNUM))                    
         THEN                                                           
            DO;                                                         
               IF MATCH_CPRNR = GEM.EVS_UDTRÆK.DCPRNUM &                
                  MATCH_KOMNR = GEM.EVS_UDTRÆK.EKOMNUM &                
                  MATCH_EJDNR = GEM.EVS_UDTRÆK.EEJDNUM                  
               THEN;                                                    
               ELSE                                                     
                  IF (GEM.EVS_UDTRÆK.DCPRNUM > MATCH_CPRNR !            
                     (GEM.EVS_UDTRÆK.DCPRNUM = MATCH_CPRNR &            
                      GEM.EVS_UDTRÆK.EKOMNUM > MATCH_KOMNR) !           
                    ((GEM.EVS_UDTRÆK.DCPRNUM = MATCH_CPRNR &            
                      GEM.EVS_UDTRÆK.EKOMNUM = MATCH_KOMNR) &           
                      GEM.EVS_UDTRÆK.EEJDNUM > MATCH_EJDNR))            
                  THEN                                                  
                     GEM = '';                                          
            END;                                                        
                                                                        
         IF BH6141.CITYP = 0              /* INDIVID MED DATA FRA EVS */
         THEN                                                           
            DO;                                                         
               CALL BEHANDL_EVS_UDTRÆK;                                 
               RETURN;                                                  
            END;                                                        
                                                                        
         IF BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '00' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '10' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '11' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '12' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '14' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '20' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '55' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '56' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '57' !                    
            BH6141.VURDOPLGL.ÅRSVURD.CBENYT = '79'                      
         THEN                                                           
            BH6141.VURDOPLGL = '';                                      
                                                                        
         IF BH6141.VURDOPL02.CBENYT = '00' !                            
            BH6141.VURDOPL02.CBENYT = '10' !                            
            BH6141.VURDOPL02.CBENYT = '11' !                            
            BH6141.VURDOPL02.CBENYT = '12' !                            
            BH6141.VURDOPL02.CBENYT = '14' !                            
            BH6141.VURDOPL02.CBENYT = '20' !                            
            BH6141.VURDOPL02.CBENYT = '55' !                            
            BH6141.VURDOPL02.CBENYT = '56' !                            
            BH6141.VURDOPL02.CBENYT = '57' !                            
            BH6141.VURDOPL02.CBENYT = '79'                              
         THEN                                                           
            BH6141.VURDOPL02 = '';                                      
                                                                        
         IF (BH6141.VURDOPL01.CBENYT = '00' !                           
             BH6141.VURDOPL01.CBENYT = '10' !                           
             BH6141.VURDOPL01.CBENYT = '11' !                           
             BH6141.VURDOPL01.CBENYT = '12' !                           
             BH6141.VURDOPL01.CBENYT = '14' !                           
             BH6141.VURDOPL01.CBENYT = '20' !                           
             BH6141.VURDOPL01.CBENYT = '55' !                           
             BH6141.VURDOPL01.CBENYT = '56' !                           
             BH6141.VURDOPL01.CBENYT = '57' !                           
             BH6141.VURDOPL01.CBENYT = '79')                            
          ! (BH6141.VURDOPL01.BEJDVÆR = 0 &                             
             BH6141.VURDOPL01.CBENYT ^= '78')                           
         THEN                                                           
            BH6141.VURDOPL01 = '';                                      
                                                                        
         IF BH6141.CPENS = '0'                                          
         THEN                                                           
            BH6141.CPENS = ' ';                                         
                                                                        
         IF BH6141.CFRED = '0'                                          
         THEN                                                           
            BH6141.CFRED = ' ';                                         
                                                                        
   /*    IF BH6141.CEJEV = '0'                                          
         THEN                                                           
            BH6141.CEJEV = ' ';                             /*#SLUT10*/ 
                                                                        
         IF BH6141.VURDOPLNY.ÅRSVURD.CFORSKEL = '0'                     
         THEN                                                           
            BH6141.VURDOPLNY.ÅRSVURD.CFORSKEL = ' ';                    
                                                                        
         IF BH6141.VURDOPLNY.ÅRSVURD.CEJERL = '1' !                     
            BH6141.VURDOPLNY.ÅRSVURD.CEJERL = '2'                       
         THEN;                                                          
         ELSE                                                           
            BH6141.VURDOPLNY.ÅRSVURD.CEJERL = ' ';                      
                                                                        
         IF BH6141.VURDOPLNY.ÅRSVURD.CUOP = '0'                         
         THEN                                                           
            BH6141.VURDOPLNY.ÅRSVURD.CUOP = ' ';                        
                                                                        
         IF BH6141.VURDOPLNY.ÅRSVURD.EJEBOL(1).EJBOLTYP < '1' &         
            BH6141.VURDOPLNY.ÅRSVURD.EJEBOL(2).EJBOLTYP > '0'           
         THEN                                                           
            DO;                                                         
               BH6141.VURDOPLNY.ÅRSVURD.EJEBOL(1) =                     
               BH6141.VURDOPLNY.ÅRSVURD.EJEBOL(2), BY NAME;             
               BH6141.VURDOPLNY.ÅRSVURD.EJEBOL(2) = '';                 
            END;                                                        
                                                                        
         IF BH6141.VURDOPLGL.ÅRSVURD.CEJERL = '1' !                     
            BH6141.VURDOPLGL.ÅRSVURD.CEJERL = '2'                       
         THEN;                                                          
         ELSE                                                           
            BH6141.VURDOPLGL.ÅRSVURD.CEJERL = ' ';                      
                                                                        
         IF BH6141.VURDOPLGL.ÅRSVURD.CUOP = '0'                         
         THEN                                                           
            BH6141.VURDOPLGL.ÅRSVURD.CUOP = ' ';                        
                                                                        
         IF BH6141.VURDOPLGL.ÅRSVURD.EJEBOL(1).EJBOLTYP < '1' &         
            BH6141.VURDOPLGL.ÅRSVURD.EJEBOL(2).EJBOLTYP > '0'           
         THEN                                                           
            DO;                                                         
               BH6141.VURDOPLGL.ÅRSVURD.EJEBOL(1) =                     
               BH6141.VURDOPLGL.ÅRSVURD.EJEBOL(2), BY NAME;             
               BH6141.VURDOPLGL.ÅRSVURD.EJEBOL(2) = '';                 
            END;                                                        
                                                                        
         IF BH6141.VURDOPL02.EJEBOL(1).EJBOLTYP < '1' &                 
            BH6141.VURDOPL02.EJEBOL(2).EJBOLTYP > '0'                   
         THEN                                                           
            DO;                                                         
               BH6141.VURDOPL02.EJEBOL(1) =                             
               BH6141.VURDOPL02.EJEBOL(2), BY NAME;                     
               BH6141.VURDOPL02.EJEBOL(2) = '';                         
            END;                                                        
                                                                        
         IF BH6141.VURDOPL01.EJEBOL(1).EJBOLTYP < '1' &                 
            BH6141.VURDOPL01.EJEBOL(2).EJBOLTYP > '0'                   
         THEN                                                           
            DO;                                                         
               BH6141.VURDOPL01.EJEBOL(1) =                             
               BH6141.VURDOPL01.EJEBOL(2), BY NAME;                     
               BH6141.VURDOPL01.EJEBOL(2) = '';                         
            END;                                                        
                                                                        
         IF BH6141.SKATSTOP.OMBER01(1).EJEBOL(1).EJBOLTYP < '1' &       
            BH6141.SKATSTOP.OMBER01(1).EJEBOL(2).EJBOLTYP > '0'         
         THEN                                                           
            DO;                                                         
               BH6141.SKATSTOP.OMBER01(1).EJEBOL(1) =                   
               BH6141.SKATSTOP.OMBER01(1).EJEBOL(2), BY NAME;           
               BH6141.SKATSTOP.OMBER01(1).EJEBOL(2) = '';               
            END;                                                        
                                                                        
         IF BH6141.SKATSTOP.OMBER01(2).EJEBOL(1).EJBOLTYP < '1' &       
            BH6141.SKATSTOP.OMBER01(2).EJEBOL(2).EJBOLTYP > '0'         
         THEN                                                           
            DO;                                                         
               BH6141.SKATSTOP.OMBER01(2).EJEBOL(1) =                   
               BH6141.SKATSTOP.OMBER01(2).EJEBOL(2), BY NAME;           
               BH6141.SKATSTOP.OMBER01(2).EJEBOL(2) = '';               
            END;                                                        
                                                                        
         IF BH6141.SKATSTOP.OMBER02(1).EJEBOL(1).EJBOLTYP < '1' &       
            BH6141.SKATSTOP.OMBER02(1).EJEBOL(2).EJBOLTYP > '0'         
         THEN                                                           
            DO;                                                         
               BH6141.SKATSTOP.OMBER02(1).EJEBOL(1) =                   
               BH6141.SKATSTOP.OMBER02(1).EJEBOL(2), BY NAME;           
               BH6141.SKATSTOP.OMBER02(1).EJEBOL(2) = '';               
            END;                                                        
                                                                        
         IF BH6141.SKATSTOP.OMBER02(2).EJEBOL(1).EJBOLTYP < '1' &       
            BH6141.SKATSTOP.OMBER02(2).EJEBOL(2).EJBOLTYP > '0'         
         THEN                                                           
            DO;                                                         
               BH6141.SKATSTOP.OMBER02(2).EJEBOL(1) =                   
               BH6141.SKATSTOP.OMBER02(2).EJEBOL(2), BY NAME;           
               BH6141.SKATSTOP.OMBER02(2).EJEBOL(2) = '';               
            END;                                                        
                                                                        
         BH60101M = '';                                                 
         BH900 = '';                                                    
                                                                        
         BH900.ESR.EJER = BH6141, BY NAME;                              
         BH900.ESR.EJER.DOVTG_GL = BH6141.DOVTG;                        
         BH900.ESR.STAMOPL = BH6141, BY NAME;                           
         BH900.ESR.STAMOPL.VURDOPLNY = BH6141.VURDOPLNY, BY NAME;       
         BH900.ESR.STAMOPL.VURDOPLGL = BH6141.VURDOPLGL, BY NAME;       
         BH900.ESR.STAMOPL.VURDOPL02 = BH6141.VURDOPL02, BY NAME;       
         BH900.ESR.STAMOPL.VURDOPL01 = BH6141.VURDOPL01, BY NAME;       
                                                                        
         BH900.ESR.SORTCPR = BH6141.DCPRCIR;                            
         BH900.ESR.EKOMNR = BH6141.EKOMNR;                              
         BH900.ESR.EEJDNR = BH6141.EEJDNR;                              
         BH900.ESR.SORTCITYP = BH6141.CITYP;                            
         BH900.ESR.SORTTYPE = '1'; /* ALTID=AKTUEL EJER I SUPPL*/       
                                                                        
         IF BH900.ESR.EJER.DAFSTÅ > 0                                   
         THEN                                                           
            BH900.ESR.SORTDATO = BH900.ESR.EJER.DAFSTÅ;                 
         ELSE                                                           
            BH900.ESR.SORTDATO = 99991231;                              
                                                                        
         BH900.SORT_CPR = BH900.ESR.SORTCPR;                            
         BH900.SORT_KOMNR = BH900.ESR.EKOMNR;                           
         BH900.SORT_EJDNR = BH900.ESR.EEJDNR;                           
         BH900.SORT_CITYP = BH900.ESR.SORTCITYP;                        
         BH900.SORT_DATO  = BH900.ESR.SORTDATO;                         
                                                                        
         BH900.AKT_EJER = BH900.ESR.EJER, BY NAME;                      
         BH900.CPENS_FESR = BH900.ESR.EJER.CPENS;                       
                                                                        
         BH900.AKT_EJER.DRGNÅRFRA = BH65300M.ÅR0101;                    
         BH900.AKT_EJER.DRGNÅRTIL = BH65300M.ÅR1231;                    
                                                                        
         IF BH900.AKT_EJER.GANE = 0 &                                   
            BH900.AKT_EJER.FEJER = 1                                    
         THEN                                                           
            BH900.AKT_EJER.GANE = 10000;                                
                                                                        
         IF GEM.EVS_UDTRÆK.DCPRNUM = BH900.ESR.SORTCPR &                
            GEM.EVS_UDTRÆK.EKOMNUM = BH900.ESR.EKOMNR &                 
            GEM.EVS_UDTRÆK.EEJDNUM = BH900.ESR.EEJDNR                   
         THEN                                                           
            DO;                                                         
               TV.FESR_MATCH = TV.FESR_MATCH + 1;                       
               MATCH_CPRNR = GEM.EVS_UDTRÆK.DCPRNUM;                    
               MATCH_KOMNR = GEM.EVS_UDTRÆK.EKOMNUM;                    
               MATCH_EJDNR = GEM.EVS_UDTRÆK.EEJDNUM;                    
               BH900.EVS_UDTRÆK = GEM.EVS_UDTRÆK, BY NAME;              
            END;                                                        
         ELSE                                                           
            DO;                                                         
               /* INITIER DIVERSE INDIKATOR-FELTER */                   
               /* HVIS INTET EVS-UDTRÆK FOR EJER OG/ELLER ÆGTEFÆLLE */  
               IF BH900.EVS_SLUT_EJER.DCPRN = 0                         
               THEN                                                     
                  DO;                                                   
                     BH900.EVS_SLUT_EJER.FØRSTE.GPCTEJER_SW = -1;       
                     BH900.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = -1;       
                     BH900.EVS_SLUT_EJER.FØRSTE.BBERGRL_SW = -1;        
                     BH900.EVS_SLUT_EJER.SIDSTE.BBERGRL_SW = -1;        
                     BH900.EVS_SLUT_EJER.FØRSTE.BBER2FAM_SW = -1;       
                     BH900.EVS_SLUT_EJER.SIDSTE.BBER2FAM_SW = -1;       
                     BH900.EVS_SLUT_EJER.FØRSTE.BNETTO_SW = -1;         
                     BH900.EVS_SLUT_EJER.SIDSTE.BNETTO_SW = -1;         
                     BH900.EVS_SLUT_EJER.FØRSTE.BEJERAN_SW = -1;        
                     BH900.EVS_SLUT_EJER.SIDSTE.BEJERAN_SW = -1;        
                     BH900.EVS_SLUT_EJER.FØRSTE.BFASTSTIGBGR_SW = -1;   
                     BH900.EVS_SLUT_EJER.SIDSTE.BFASTSTIGBGR_SW = -1;   
                     BH900.EVS_SLUT_EJER.FØRSTE.BEVSMAN_SW = -1;        
                     BH900.EVS_SLUT_EJER.SIDSTE.BEVSMAN_SW = -1;        
                     BH900.EVS_SLUT_EJER.FØRSTE.BMANEVSSTI_SW = -1;     
                     BH900.EVS_SLUT_EJER.SIDSTE.BMANEVSSTI_SW = -1;     
                     BH900.EVS_SLUT_EJER.FØRSTE.BEJBOL1_SW = -1;        
                     BH900.EVS_SLUT_EJER.SIDSTE.BEJBOL1_SW = -1;        
                     BH900.EVS_SLUT_EJER.FØRSTE.BEJBOL2_SW = -1;        
                     BH900.EVS_SLUT_EJER.SIDSTE.BEJBOL2_SW = -1;        
                     BH900.EVS_SLUT_EJER.FØRSTE.BBERGRL_02ANV_SW = -1;  
                     BH900.EVS_SLUT_EJER.SIDSTE.BBERGRL_02ANV_SW = -1;  
                     BH900.EVS_SLUT_EJER.FØRSTE.BBER2FAM_02ANV_SW = -1; 
                     BH900.EVS_SLUT_EJER.SIDSTE.BBER2FAM_02ANV_SW = -1; 
                     BH900.EVS_SLUT_EJER.FØRSTE.BBER2FAM_AKT_SW = -1;   
                     BH900.EVS_SLUT_EJER.SIDSTE.BBER2FAM_AKT_SW = -1;   
                     BH900.EVS_SLUT_EJER.FØRSTE.BSUM1_SW = -1;          
                     BH900.EVS_SLUT_EJER.SIDSTE.BSUM1_SW = -1;          
                     BH900.EVS_SLUT_EJER.FØRSTE.BSUM3_SW = -1;          
                     BH900.EVS_SLUT_EJER.SIDSTE.BSUM3_SW = -1;          
                     BH900.EVS_SLUT_EJER.FØRSTE.BBERGRL_015ANV_SW = -1; 
                     BH900.EVS_SLUT_EJER.SIDSTE.BBERGRL_015ANV_SW = -1; 
                     BH900.EVS_SLUT_EJER.FØRSTE.BBER2FAM_015ANV_SW = -1;
                     BH900.EVS_SLUT_EJER.SIDSTE.BBER2FAM_015ANV_SW = -1;
                     BH900.EVS_SLUT_EJER.FØRSTE.MANNEDSLSTI_SW = -1;    
                     BH900.EVS_SLUT_EJER.SIDSTE.MANNEDSLSTI_SW = -1;    
                     BH900.EVS_SLUT_EJER.FØRSTE.MANPENSSTI_SW = -1;     
                     BH900.EVS_SLUT_EJER.SIDSTE.MANPENSSTI_SW = -1;     
   /*#SLUT10         BH900.EVS_SLUT_EJER.FØRSTE.BOMBTILBUDL_01_SW = -1; 
                     BH900.EVS_SLUT_EJER.SIDSTE.BOMBTILBUDL_01_SW = -1; 
                     BH900.EVS_SLUT_EJER.FØRSTE.BBERGRLUDL_01_SW = -1;  
                     BH900.EVS_SLUT_EJER.SIDSTE.BBERGRLUDL_01_SW = -1;*/
                  END;                                                  
                                                                        
               IF BH900.EVS_SLUT_ÆGTF.DCPRN = 0                         
               THEN                                                     
                  DO;                                                   
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.GPCTEJER_SW = -1;       
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER_SW = -1;       
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_SW = -1;       
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_SW = -1;       
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BNETTO_SW = -1;         
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BNETTO_SW = -1;         
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BEJERAN_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BEJERAN_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BFASTSTIGBGR_SW = -1;   
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BFASTSTIGBGR_SW = -1;   
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BEVSMAN_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BEVSMAN_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BMANEVSSTI_SW = -1;     
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BMANEVSSTI_SW = -1;     
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL1_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL1_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL2_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL2_SW = -1;        
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_02ANV_SW = -1;  
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_02ANV_SW = -1;  
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_02ANV_SW = -1; 
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_02ANV_SW = -1; 
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_AKT_SW = -1;   
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_AKT_SW = -1;   
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BSUM1_SW = -1;          
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BSUM1_SW = -1;          
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BSUM3_SW = -1;          
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BSUM3_SW = -1;          
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_015ANV_SW = -1; 
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_015ANV_SW = -1; 
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_015ANV_SW = -1;
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_015ANV_SW = -1;
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.MANNEDSLSTI_SW = -1;    
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.MANNEDSLSTI_SW = -1;    
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.MANPENSSTI_SW = -1;     
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.MANPENSSTI_SW = -1;     
    /*#SLUT10        BH900.EVS_SLUT_ÆGTF.FØRSTE.BOMBTILBUDL_01_SW = -1; 
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BOMBTILBUDL_01_SW = -1; 
                     BH900.EVS_SLUT_ÆGTF.FØRSTE.BBERGRLUDL_01_SW = -1;  
                     BH900.EVS_SLUT_ÆGTF.SIDSTE.BBERGRLUDL_01_SW = -1*/ 
                  END;                                                  
                                                                        
               IF BH900.EVS_FORSK_EJER.DCPRN = 0                        
               THEN                                                     
                  DO;                                                   
                     BH900.EVS_FORSK_EJER.B100_SW = -1;                 
                     BH900.EVS_FORSK_EJER.BBRUTTO_SW = -1;              
                     BH900.EVS_FORSK_EJER.BEJERAN_SW = -1;              
                     BH900.EVS_FORSK_EJER.BNYMAN_SW = -1;               
                     BH900.EVS_FORSK_EJER.BFORSKAT_SW = -1;             
                  END;                                                  
                                                                        
               IF BH900.EVS_FORSK_ÆGTF.DCPRN = 0                        
               THEN                                                     
                  DO;                                                   
                     BH900.EVS_FORSK_ÆGTF.B100_SW = -1;                 
                     BH900.EVS_FORSK_ÆGTF.BBRUTTO_SW = -1;              
                     BH900.EVS_FORSK_ÆGTF.BEJERAN_SW = -1;              
                     BH900.EVS_FORSK_ÆGTF.BNYMAN_SW = -1;               
                     BH900.EVS_FORSK_ÆGTF.BFORSKAT_SW = -1;             
                  END;                                                  
            END;                                                        
                                                                        
         BH900.EJENDOM.EJDBELIG = SUBSTR(BH900.ESR.ABELMAT,1,31);       
                                                                        
         HJKOMNR = BH900.ESR.EKOMNR;                                    
         CALL RCPROC;       /* BEREGN RC-KODE FOR BELIGGENHEDSKOMMUNE */
         BH900.CRCKO = HJCRCKO;                                         
                                                                        
         IF BH900.ESR.EJER.FEJER = 2 &                                  
            BH900.ESR.EJER.GANE = 0                                     
         THEN                                                           
            TV.TO_EJER_NUL = TV.TO_EJER_NUL + 1;                        
                                                                        
         IF BH900.ESR.EJER.FEJER > 2 &                                  
            BH900.ESR.EJER.GANE = 0                                     
         THEN                                                           
            TV.FL_EJER_NUL = TV.FL_EJER_NUL + 1;                        
                                                                        
         /* KONTROLLER STATUS FOR EJERS CPRNR, D.V.S. OM DER ER   */    
         /* TALE OM ET RIGTIGT CPRNR, ET SE-NR, ET INVALIDT CPRNR */    
         /* ELLER ET LØBENR.                                      */    
                                                                        
         HJ_CPR = BH900.SORT_CPR;                                       
                                                                        
         CALL DAN_CPRNR_STATUS(HJ_CPR,BH900.AKT_EJER.CEJFORH,CRETUR);   
                                                                        
         BH900.CINVPNR = CRETUR;                                        
                                                                        
         IF BH900.ESR.EJER.CEJFORH = '50' ! /*HVIS EJEREN ER */         
            BH900.ESR.EJER.CEJFORH = '60' ! /*OFFENTLIG D.V.S.*/        
            BH900.ESR.EJER.CEJFORH = '70' ! /*KOMM./AMT/STAT */         
            BH900.ESR.EJER.CEJFORH = '80'                               
         THEN                                                           
            DO;                                                         
               IF BH900.CINVPNR = '0' /* HVIS PNR. ER VALIDT */         
               THEN                   /* BEHANDLES 'NORMALT' */         
                  TV.OFF_CPR = TV.OFF_CPR + 1;                          
               ELSE                                                     
                  DO;                                                   
                     TV.OFF_EJ_CPR = TV.OFF_EJ_CPR + 1;                 
                     CALL SKRIV_PERSON;                                 
                     RETURN;                                            
                  END;                                                  
            END;                                                        
                                                                        
         IF BH900.CINVPNR = '0'                /* PERSONNR. ER VALIDT */
         THEN                                                           
            DO;                                                         
               BH900.TIL_EVS.CPTYPSLUT = '1';  /*PERSONTYPE=ALM PERSON*/
               BH900.TIL_EVS.CPTYPFOR = '1';                            
            END;                                                        
         ELSE                                                           
            DO;                                                         
               IF BH900.CINVPNR = '2'        /* DETTE ER VALIDT SE-NR */
               THEN                                                     
                  /* DETTE ER EJENDOMME SOM IKKE ER OMFATTET */         
                  /* AF EVS-REGLERNE                         */         
                  TV.OVERSPR_SE = TV.OVERSPR_SE + 1;                    
               ELSE                                                     
                  TV.OVERSPR_CPR = TV.OVERSPR_CPR + 1;                  
               CALL SKRIV_PERSON;                                       
               RETURN;                                                  
            END;                                                        
                                                                        
         /* OPTÆL PGF 4 VURDEREDE EJD */    /*SLUT05*/                  
         IF BH900.ESR.STAMOPL.VURDOPLNY.ÅRSVURD.BEJDVÆP4A ^= 0          
         THEN                                                           
            TV.PGF4A = TV.PGF4A + 1;                                    
         IF BH900.ESR.STAMOPL.BEJDVÆP4B ^= 0                            
         THEN                                                           
            TV.PGF4B = TV.PGF4B + 1;                                    
                                                                        
         IF BH900.ESR.VURDOPLNY.ÅRSVURD.CFORSKEL = '1' /*SLUT05*/       
         THEN                                                           
            TV.FORSKEL1 = TV.FORSKEL1 + 1;                              
         IF BH900.ESR.VURDOPLNY.ÅRSVURD.CFORSKEL = '2' /*SLUT05*/       
         THEN                                                           
            TV.FORSKEL2 = TV.FORSKEL2 + 1;                              
         IF BH900.ESR.VURDOPLNY.ÅRSVURD.CFORSKEL = '3'  /*SLUT05*/      
         THEN                                                           
            TV.FORSKEL3 = TV.FORSKEL3 + 1;                              
                                                                        
         CALL SKRIV_PERSON;                                             
 END BEHANDL;                                                           
 /*********************************************************************/
 /*      KONTROLLER OVERTAGELSES- OG AFSTÅELSESDATO OG 'REPARER' EVT. */
 /*      IKKE VALIDE DATOER A.H.T. OPSÆTNINGEN SENERE SOM 'DB2-DATO'. */
 /*********************************************************************/
 VALIDER_DATO:                                                          
         PROC;                                                          
                                                                        
         HJ_DATOEN = BH6141.DOVTG;                                      
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 01;                                          
              HJ_DATO.DG = 01;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         BH6141.DOVTG = HJ_DATOEN;                                      
                                                                        
                                                                        
         HJ_DATOEN = BH6141.DAFSTÅ;                                     
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 12;                                          
              HJ_DATO.DG = 31;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         BH6141.DAFSTÅ = HJ_DATOEN;                                     
                                                                        
 END VALIDER_DATO;                                                      
 /*********************************************************************/
 /*      SKAF RC-KODE PÅ GRUNDLAG AF BELIGGENHEDSKOMMUNE              */
 /*                                                                   */
 /*      OPSÆTNINGEN SKAL IKKE ÆNDRES P.G.A. FLYTNING AF HADSTEN (709)*/
 /*      OG RANDERS (731) FRA KMÅ TIL KMA DA ESR-TRANSER STADIG SKAL  */
 /*      SENDES TIL KMÅ.                                              */
 /*********************************************************************/
 RCPROC:                                                                
         PROC;                                                          
         SELECT;                                                        
           WHEN (HJKOMNR = 0)                                           
              HJCRCKO = 6; /* KMB */                                    
           WHEN (HJKOMNR < 129)                                         
              HJCRCKO = 1; /* KMV */                                    
           WHEN (HJKOMNR <= 411)                                        
              HJCRCKO = 6; /* KMB */                                    
           WHEN (HJKOMNR <= 499)                                        
              HJCRCKO = 5; /* KMO */                                    
           WHEN (HJKOMNR = 751)                                         
              HJCRCKO = 4; /* KMÅ */                                    
           OTHERWISE                                                    
              HJCRCKO = 3; /* KMA */                                    
         END;                                                           
 END RCPROC;                                                            
 /********************************************************************* 
 *       BEHANDLING AF INDIVID FRA EVS UDTRÆK                         * 
 *********************************************************************/ 
 BEHANDL_EVS_UDTRÆK:                                                    
         PROC;                                                          
                                                                        
         /* INITIER DIVERSE INDIKATOR-FELTER */                         
         /* HVIS INTET EVS-UDTRÆK FOR EJER OG/ELLER ÆGTEFÆLLE */        
                                                                        
         IF BH6142.EVS_SLUT_EJER.DCPRN = 0                              
         THEN                                                           
            DO;                                                         
               BH6142.EVS_SLUT_EJER.FØRSTE.GPCTEJER_SW = -1;            
               BH6142.EVS_SLUT_EJER.SIDSTE.GPCTEJER_SW = -1;            
               BH6142.EVS_SLUT_EJER.FØRSTE.BBERGRL_SW = -1;             
               BH6142.EVS_SLUT_EJER.SIDSTE.BBERGRL_SW = -1;             
               BH6142.EVS_SLUT_EJER.FØRSTE.BBER2FAM_SW = -1;            
               BH6142.EVS_SLUT_EJER.SIDSTE.BBER2FAM_SW = -1;            
               BH6142.EVS_SLUT_EJER.FØRSTE.BNETTO_SW = -1;              
               BH6142.EVS_SLUT_EJER.SIDSTE.BNETTO_SW = -1;              
               BH6142.EVS_SLUT_EJER.FØRSTE.BEJERAN_SW = -1;             
               BH6142.EVS_SLUT_EJER.SIDSTE.BEJERAN_SW = -1;             
               BH6142.EVS_SLUT_EJER.FØRSTE.BFASTSTIGBGR_SW = -1;        
               BH6142.EVS_SLUT_EJER.SIDSTE.BFASTSTIGBGR_SW = -1;        
               BH6142.EVS_SLUT_EJER.FØRSTE.BEVSMAN_SW = -1;             
               BH6142.EVS_SLUT_EJER.SIDSTE.BEVSMAN_SW = -1;             
               BH6142.EVS_SLUT_EJER.FØRSTE.BMANEVSSTI_SW = -1;          
               BH6142.EVS_SLUT_EJER.SIDSTE.BMANEVSSTI_SW = -1;          
               BH6142.EVS_SLUT_EJER.FØRSTE.BEJBOL1_SW = -1;             
               BH6142.EVS_SLUT_EJER.SIDSTE.BEJBOL1_SW = -1;             
               BH6142.EVS_SLUT_EJER.FØRSTE.BEJBOL2_SW = -1;             
               BH6142.EVS_SLUT_EJER.SIDSTE.BEJBOL2_SW = -1;             
               BH6142.EVS_SLUT_EJER.FØRSTE.BBERGRL_02ANV_SW = -1;       
               BH6142.EVS_SLUT_EJER.SIDSTE.BBERGRL_02ANV_SW = -1;       
               BH6142.EVS_SLUT_EJER.FØRSTE.BBER2FAM_02ANV_SW = -1;      
               BH6142.EVS_SLUT_EJER.SIDSTE.BBER2FAM_02ANV_SW = -1;      
               BH6142.EVS_SLUT_EJER.FØRSTE.BBER2FAM_AKT_SW = -1;        
               BH6142.EVS_SLUT_EJER.SIDSTE.BBER2FAM_AKT_SW = -1;        
               BH6142.EVS_SLUT_EJER.FØRSTE.BSUM1_SW = -1;               
               BH6142.EVS_SLUT_EJER.SIDSTE.BSUM1_SW = -1;               
               BH6142.EVS_SLUT_EJER.FØRSTE.BSUM3_SW = -1;               
               BH6142.EVS_SLUT_EJER.SIDSTE.BSUM3_SW = -1;               
               BH6142.EVS_SLUT_EJER.FØRSTE.BBERGRL_015ANV_SW = -1;      
               BH6142.EVS_SLUT_EJER.SIDSTE.BBERGRL_015ANV_SW = -1;      
               BH6142.EVS_SLUT_EJER.FØRSTE.BBER2FAM_015ANV_SW = -1;     
               BH6142.EVS_SLUT_EJER.SIDSTE.BBER2FAM_015ANV_SW = -1;     
               BH6142.EVS_SLUT_EJER.FØRSTE.MANNEDSLSTI_SW = -1;         
               BH6142.EVS_SLUT_EJER.SIDSTE.MANNEDSLSTI_SW = -1;         
               BH6142.EVS_SLUT_EJER.FØRSTE.MANPENSSTI_SW = -1;          
               BH6142.EVS_SLUT_EJER.SIDSTE.MANPENSSTI_SW = -1;          
   /*#SLUT10   BH6142.EVS_SLUT_EJER.FØRSTE.BOMBTILBUDL_01_SW = -1;      
               BH6142.EVS_SLUT_EJER.SIDSTE.BOMBTILBUDL_01_SW = -1;      
               BH6142.EVS_SLUT_EJER.FØRSTE.BBERGRLUDL_01_SW = -1;       
               BH6142.EVS_SLUT_EJER.SIDSTE.BBERGRLUDL_01_SW = -1; */    
            END;                                                        
                                                                        
         IF BH6142.EVS_SLUT_ÆGTF.DCPRN = 0                              
         THEN                                                           
            DO;                                                         
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.GPCTEJER_SW = -1;            
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.GPCTEJER_SW = -1;            
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_SW = -1;            
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_SW = -1;            
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BNETTO_SW = -1;              
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BNETTO_SW = -1;              
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BEJERAN_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BEJERAN_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BFASTSTIGBGR_SW = -1;        
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BFASTSTIGBGR_SW = -1;        
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BEVSMAN_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BEVSMAN_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BMANEVSSTI_SW = -1;          
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BMANEVSSTI_SW = -1;          
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL1_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL1_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BEJBOL2_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BEJBOL2_SW = -1;             
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_02ANV_SW = -1;       
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_02ANV_SW = -1;       
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_02ANV_SW = -1;      
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_02ANV_SW = -1;      
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_AKT_SW = -1;        
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_AKT_SW = -1;        
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BSUM1_SW = -1;               
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BSUM1_SW = -1;               
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BSUM3_SW = -1;               
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BSUM3_SW = -1;               
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBERGRL_015ANV_SW = -1;      
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBERGRL_015ANV_SW = -1;      
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBER2FAM_015ANV_SW = -1;     
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBER2FAM_015ANV_SW = -1;     
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.MANNEDSLSTI_SW = -1;         
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.MANNEDSLSTI_SW = -1;         
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.MANPENSSTI_SW = -1;          
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.MANPENSSTI_SW = -1;          
   /*#SLUT10   BH6142.EVS_SLUT_ÆGTF.FØRSTE.BOMBTILBUDL_01_SW = -1;      
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BOMBTILBUDL_01_SW = -1;      
               BH6142.EVS_SLUT_ÆGTF.FØRSTE.BBERGRLUDL_01_SW = -1;       
               BH6142.EVS_SLUT_ÆGTF.SIDSTE.BBERGRLUDL_01_SW = -1;  */   
            END;                                                        
                                                                        
         IF BH6142.EVS_FORSK_EJER.DCPRN = 0                             
         THEN                                                           
            DO;                                                         
               BH6142.EVS_FORSK_EJER.B100_SW = -1;                      
               BH6142.EVS_FORSK_EJER.BBRUTTO_SW = -1;                   
               BH6142.EVS_FORSK_EJER.BEJERAN_SW = -1;                   
               BH6142.EVS_FORSK_EJER.BNYMAN_SW = -1;                    
               BH6142.EVS_FORSK_EJER.BFORSKAT_SW = -1;                  
            END;                                                        
                                                                        
         IF BH6142.EVS_FORSK_ÆGTF.DCPRN = 0                             
         THEN                                                           
            DO;                                                         
               BH6142.EVS_FORSK_ÆGTF.B100_SW = -1;                      
               BH6142.EVS_FORSK_ÆGTF.BBRUTTO_SW = -1;                   
               BH6142.EVS_FORSK_ÆGTF.BEJERAN_SW = -1;                   
               BH6142.EVS_FORSK_ÆGTF.BNYMAN_SW = -1;                    
               BH6142.EVS_FORSK_ÆGTF.BFORSKAT_SW = -1;                  
            END;                                                        
                                                                        
         GEM.EVS_UDTRÆK = BH6142, BY NAME;                              
                                                                        
         IF BH6142.EKOMNUM = 999                                        
         THEN                                                           
            DO;                                                         
               /* UDENLANDSK EJENDOM */                                 
               TV.FUDLANDSK = TV.FUDLANDSK + 1;                         
               GEM = '';                                                
            END;                                                        
         ELSE                                                           
            /* IKKE UDENLANDSK EJENDOM */                               
            TV.FØVREVS = TV.FØVREVS + 1;                                
                                                                        
 END BEHANDL_EVS_UDTRÆK;                                                
                                                                        
 %INCLUDE BH60105M; /* UNDERSØG STATUS FOR EJERENS CPRNR */             
                                                                        
 /********************************************************************* 
 *       ALLE INDIVIDER SKRIVES A.H.T. OPDATERING AF EVS EJD.TABEL    * 
 *********************************************************************/ 
 SKRIV_PERSON:                                                          
 PROC;                                                                  
                                                                        
         BH900.CPENS_TESR = '-';                                        
                                                                        
         BH900.TIL_EVS.DOVTG = BH900.ESR.EJER.DOVTG;                    
         BH900.TIL_EVS.DAFSTAA = BH900.ESR.EJER.DAFSTÅ;                 
                                                                        
         SELECT;                                                        
           WHEN (BH900.EVS_SLUT_EJER.DCPRN > 0 &                        
                 BH900.EVS_SLUT_EJER.SIDSTE.CSLET < '1')                
             DO;                                                        
                IF BH900.EVS_SLUT_EJER.SIDSTE.DOVTG > 0 &  /* A.H.T.  */
                  (BH900.EVS_SLUT_EJER.SIDSTE.DOVTG <      /* EVT. PE-*/
                   BH900.AKT_EJER.DOVTG_GL)                /* RIODISE-*/
                THEN                                       /* RING AF */
                   DO;                                     /* DØDES   */
                      BH900.AKT_EJER.DOVTG_GL =            /* BFORSKAT*/
                      BH900.EVS_SLUT_EJER.SIDSTE.DOVTG;                 
                      IF BH900.ESR.EJER.DAFSTÅ = 0                      
                      THEN                                              
                         BH900.AKT_EJER.CTILKØB = 'J';                  
                   END;                                                 
             END;                                                       
           WHEN (BH900.EVS_FORSK_EJER.DCPRN > 0 &                       
                 BH900.EVS_FORSK_EJER.CEJBEVS < '9' &                   
                 BH900.EVS_FORSK_EJER.DOVTG_GL > 0 &                    
                (BH900.EVS_FORSK_EJER.DOVTG_GL <                        
                 BH900.AKT_EJER.DOVTG_GL) &                             
                 BH900.ESR.EJER.DAFSTÅ = 0)                             
             BH900.AKT_EJER.CTILKØB = 'J';                              
           OTHERWISE;                                                   
         END;  /* SELECT */                                             
                                                                        
         IF BH900.CINVPNR = '0'                                         
         THEN                                                           
            DO;                                                         
               TV.SKREVET = TV.SKREVET + 1;                             
               IF BH900.ESR.EJER.FEJER > 2                              
               THEN                                                     
                  TV.FL_EJER = TV.FL_EJER + 1;                          
               WRITE FILE (BH905O) FROM (BH900);                        
               RETURN;                                                  
            END;                                                        
                                                                        
         /* ØVRIGE INDIVIDER SKAL IKKE BEHANDLES */                     
         /* I DE EFTERFØLGENDE PROGRAMMER        */                     
                                                                        
         TV.FRASORTERET = TV.FRASORTERET + 1;                           
                                                                        
 END SKRIV_PERSON;                                                      
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH614;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK FRA ESR+EVS  B.H61400D';
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS;                                    
         DETLIN1.TEKST = '   HERAF INDIVIDER FRA EVS             ';     
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS_F;                                  
         DETLIN1.TEKST = '         HERAF KUN FRA FORSKUD 2011';         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS_S;                                  
         DETLIN1.TEKST = '         HERAF KUN FRA SLUT 2010';            
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_EVS_FS;                                 
         DETLIN1.TEKST = '         HERAF BÅDE FORSKUD 2011+SLUT 2010';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FESR_MATCH;                                 
         DETLIN1.TEKST = '         HERAF EJER+EJD OGSÅ FRA ESR';        
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.LÆS_ESR;                                    
         DETLIN1.TEKST = '   HERAF INDIVIDER FRA ESR                ';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST PERSONNUMMER LIG 0 '; 
         DETLIN1.ANTAL = TV.CPRNR_NUL;                                  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST EJER SLET MED BK16 '; 
         DETLIN1.ANTAL = TV.OVERSPR_SLT16;                              
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST EJER SLETTET I ESR '; 
         DETLIN1.ANTAL = TV.OVERSPR_SLT;                                
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SALG_FØR;                                   
         DETLIN1.TEKST = '         HERAF OVERLÆST SALG FØR 2010-03-01'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.KØB_EFTER;                                  
         DETLIN1.TEKST = '         HERAF OVERLÆST KØB EFTER 2012-01-31';
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST EJER MED BK14 ';      
         DETLIN1.ANTAL = TV.OVERSPR_BK14;                               
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST EJER MED BK20 ';      
         DETLIN1.ANTAL = TV.OVERSPR_BK20;                               
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST EJER MED BK78 ';      
         DETLIN1.ANTAL = TV.OVERSPR_BK78;                               
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OVERLÆST EJER MED BK79 ';      
         DETLIN1.ANTAL = TV.OVERSPR_BK79;                               
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF UØNSKET BENYTTELSESKODE    ';  
         DETLIN1.ANTAL = TV.OVERSPR_BK;                                 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF OPTÆLLINGSINDIVID OVERLÆST';   
         DETLIN1.ANTAL = TV.LÆS_OPTÆL;                                  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF PGF4/4A VURDEREDE     ';       
         DETLIN1.ANTAL = TV.PGF4A;                                      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = '         HERAF PGF4B VURDEREDE       ';       
         DETLIN1.ANTAL = TV.PGF4B;                                      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OFF_EJ_CPR;                                 
         DETLIN1.TEKST = '         HERAF OFFENTLIGT EJET (IKKE P-NR)';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OFF_CPR;                                    
         DETLIN1.TEKST = '         HERAF OFFENTLIGT EJET (MED P-NR)';   
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OVERSPR_CPR;                                
         DETLIN1.TEKST = '         HERAF EJ MED VALIDT PERSONNR.';      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.OVERSPR_SE;                                 
         DETLIN1.TEKST = '         HERAF SE-NUMRE KUN TIL SLS   ';      
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.TO_EJER_NUL;                                
         DETLIN1.TEKST = '         HERAF 2-EJERE UDEN EJERANDEL';       
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.FL_EJER_NUL;                                
         DETLIN1.TEKST = '         HERAF OVER 2 EJERE UDEN EJERANDEL';  
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FRASORTERET;                                
         DETLIN1.TEKST = 'ANTAL ØVRIGE FRASORTEREDE (INGEN ESR-EJER) '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SKREVNE INDIVIDER           B.H90500D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.FL_EJER;                                    
         DETLIN1.TEKST = '      HERAF MED FLERE END 2 EJERE';           
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = 'ANTAL CFORSKEL=1 (EVT. REDUCERET I 2011)  ';  
         DETLIN1.ANTAL = TV.FORSKEL1;                                   
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = 'ANTAL CFORSKEL=2 (EJ REDUKTION-BYGGERI>100';  
         DETLIN1.ANTAL = TV.FORSKEL2;                                   
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.TEKST = 'ANTAL CFORSKEL=3 (BENYT 2011 - BYGGERI<101';  
         DETLIN1.ANTAL = TV.FORSKEL3;                                   
         CALL ZZ20300 (DETLIN1,'01');                                   
  END TOTALLISTE;                                                       
 /********************************************************************* 
 *       SKRIVNING AF OPTÆLLINGSINDIVID                               * 
 *********************************************************************/ 
 SKRIV_OPTÆLLING:                                                       
         PROC;                                                          
                                                                        
         BH90099            = '';                                       
         BH90099.SORT_CPR   = 99999999999;                              
         BH90099.SORT_KOMNR = 999;                                      
         BH90099.SORT_EJDNR = 9999999;                                  
         BH90099.ANT_INDV   = TV.SKREVET;                               
         WRITE FILE (BH905O) FROM (BH90099);                            
                                                                        
 END SKRIV_OPTÆLLING;                                                   
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
         CALL TOTALLISTE;                                               
         CALL SKRIV_OPTÆLLING;                                          
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH614I),                                           
               FILE (BH905O);                                           
 END AFSLUT;                                                            
 END  BH90500;                                                          
