 /**********************************************************************
 * MACRO  BE86005M  REF. AKTIVITETSBESKRIVELSE EVS SLUT 2013:          *
 *                                                                     *
 * MACROEN BENYTTES TIL UDFØRSEL AF DIVERSE KONTROLLER  F Ø R          *
 * BEREGNINGEN AF KMD'S DEL AF EVS SLUT 2013 I MACRO BE13907M.         *
 *                                                                     *
 * FORMÅLET MED MACROEN ER AT AFSLØRE EVT. PROGRAMFEJL I DE FORANLIG-  *
 * GENDE PROGRAMMER/MACROER.                                           *
 *                                                                     *
 * FEJL_TAB INDEHOLDER SAMTLIGE FUNDNE FEJL (FEJLNUMRE).               *
 *                                                                     *
 * FEJL_TAB(1) LIG 0 BETYDER AT SAMTLIGE DATA OPFYLDER GÆLDENDE KRAV.  *
 * (BE13907M KALDES DEREFTER HVIS FEJL_TAB(1) ER LIG 0).               *
 *            INDLÆGGELSE AF EU LOVGIVNING VEDR. BEGRÆNSET SKATTEPLIGT *
 *            OG DOBBELTDOMICILERING FOR PENSIONSTER    / SØG #01      *
 * Årsrullet 2024  HNK                                      OKT. 2023  *
 *  NY EVS BH --> BE og BQ --> BE                                      *
 **********************************************************************/
 UDFØR_KONTROLLER:                                                      
 PROC(FEJL1,                                                            
      FEJL2,                                                            
      FEJL3,                                                            
      FEJL4,                                                            
      FEJL5,                                                            
      FEJL6,                                                            
      FEJL7,                                                            
      FEJL8,                                                            
      FEJL9,                                                            
      FEJL10,                                                           
      FEJL11,                                                           
      FEJL12);                                                          
                                                                        
 /*********************************************************************/
 /*      DECLARE AF PARAMETRE TIL DENNE MACRO                         */
 /*********************************************************************/
 DCL     FEJL1           BIN FIXED (31);                                
 DCL     FEJL2           BIN FIXED (31);                                
 DCL     FEJL3           BIN FIXED (31);                                
 DCL     FEJL4           BIN FIXED (31);                                
 DCL     FEJL5           BIN FIXED (31);                                
 DCL     FEJL6           BIN FIXED (31);                                
 DCL     FEJL7           BIN FIXED (31);                                
 DCL     FEJL8           BIN FIXED (31);                                
 DCL     FEJL9           BIN FIXED (31);                                
 DCL     FEJL10          BIN FIXED (31);                                
 DCL     FEJL11          BIN FIXED (31);                                
 DCL     FEJL12          BIN FIXED (31);                                
                                                                        
 DCL     FEJL_TAB (12)   BIN FIXED (31);                                
                                                                        
 /********************************************************************* 
 *       DECLARE AF DIV. HJÆLPEFELTER                                 * 
 *********************************************************************/ 
                                                                        
 DCL     I               BIN FIXED (15);                                
                                                                        
         FEJL_TAB(1) = FEJL1;                                           
         FEJL_TAB(2) = FEJL2;                                           
         FEJL_TAB(3) = FEJL3;                                           
         FEJL_TAB(4) = FEJL4;                                           
         FEJL_TAB(5) = FEJL5;                                           
         FEJL_TAB(6) = FEJL6;                                           
         FEJL_TAB(7) = FEJL7;                                           
         FEJL_TAB(8) = FEJL8;                                           
         FEJL_TAB(9) = FEJL9;                                           
         FEJL_TAB(10) = FEJL10;                                         
         FEJL_TAB(11) = FEJL11;                                         
         FEJL_TAB(12) = FEJL12;                                         
                                                                        
         DO I = 1 TO 12;                                                
            FEJL_TAB(I) = 0;                                            
         END;                                                           
                                                                        
         I = 0;                                                         
                                                                        
                                                                        
         IF BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '1' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '3' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '4' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '5' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '7' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '8' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '9'                       
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5032;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.EJERSKAB_BBERGRL_SW = 0                           
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5033;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.TILEVS_CNEDSL1 >= '10' &                          
            BE78_AREA.TILEVS_CNEDSL1 <= '50'                            
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5035;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.TILEVS_DOVTG > 0 &                                
           (BE78_AREA.TILEVS_DOVTG > BE76_AREA.DRGNÅRTIL)               
         THEN                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5036;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.TILEVS_FELT759 = ' ' !                            
            BE78_AREA.TILEVS_FELT759 = '1' !                            
            BE78_AREA.TILEVS_FELT759 = '2'                              
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5039;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '4' !                     
            BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '5'                       
         THEN                                                           
            DO;                                                         
               IF BE78_AREA.EJERSKAB_BBER2FAM_SW = 0                    
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     I = I + 1;                                         
                     FEJL_TAB(I) = 5055;                                
                  END;                                                  
            END;                                                        
                                                                        
         IF BE78_AREA.TILEVS_CEJBEVS >= '0' &                           
            BE78_AREA.TILEVS_CEJBEVS <= '9'                             
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5077;                                      
            END;                                                        
                                                                        
         IF (BE78_AREA.TILEVS_CPTYPSLUT = '1' &                         
             BE78_AREA.TILEVS_CSKPLOMF = ' ') !                         
            (BE78_AREA.TILEVS_CPTYPSLUT = '2' &                         
             BE78_AREA.TILEVS_CPTYP_ÆND = ' ' &                         
             BE78_AREA.TILEVS_CSKPLOMF = ' ') !                         
            (BE78_AREA.TILEVS_CPTYPSLUT = '3' &                         
            (BE78_AREA.TILEVS_CSKPLOMF = ' ' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '0' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '2' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '4' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '5' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '6' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '7')) !                        
            (BE78_AREA.TILEVS_CPTYPSLUT = '4' &  /* #01 */              
            (BE78_AREA.TILEVS_CSKPLOMF = '1' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '3' !                          
             BE78_AREA.TILEVS_CSKPLOMF = '8'))                          
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5091;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.TILEVS_CPTYPSLUT = '3'                            
          ! BE78_AREA.TILEVS_CPTYPSLUT = '4'   /* #01 */                
         THEN                                                           
            DO;                                                         
               IF ((BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '3' !             
                    BE78_AREA.EJERSKAB_CEJDTYPE_AKT = '8') &            
                    BE78_AREA.TILEVS_FELT759 = '2') !                   
                    BE78_AREA.TILEVS_FELT759 = '1'                      
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     I = I + 1;                                         
                     FEJL_TAB(I) = 5087;                                
                  END;                                                  
            END;                                                        
                                                                        
    /*     IF BE78_AREA.TILEVS_CPTYPGL = ' ' !                          
            BE78_AREA.TILEVS_CPTYPGL = '1' !                            
            BE78_AREA.TILEVS_CPTYPGL = '2' !                            
            BE78_AREA.TILEVS_CPTYPGL = '3' !                            
            BE78_AREA.TILEVS_CPTYPGL = '4'       § #01 §                
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5097;                                      
            END;   Feltet udgået i slut 2024*/                          
                                                                        
         IF BE78_AREA.TILEVS_CPTYPSLUT = '1' !                          
            BE78_AREA.TILEVS_CPTYPSLUT = '2' !                          
            BE78_AREA.TILEVS_CPTYPSLUT = '3' !                          
            BE78_AREA.TILEVS_CPTYPSLUT = '4'     /* #01 */              
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5098;                                      
            END;                                                        
                                                                        
         IF BE78_AREA.TILEVS_CFRED = ' ' !                              
            BE78_AREA.TILEVS_CFRED = '1'                                
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5099;                                      
            END;                                                        
                                                                        
         FEJL1  =  FEJL_TAB(1);                                         
         FEJL2  =  FEJL_TAB(2);                                         
         FEJL3  =  FEJL_TAB(3);                                         
         FEJL4  =  FEJL_TAB(4);                                         
         FEJL5  =  FEJL_TAB(5);                                         
         FEJL6  =  FEJL_TAB(6);                                         
         FEJL7  =  FEJL_TAB(7);                                         
         FEJL8  =  FEJL_TAB(8);                                         
         FEJL9  =  FEJL_TAB(9);                                         
         FEJL10 =  FEJL_TAB(10);                                        
         FEJL11 =  FEJL_TAB(11);                                        
         FEJL12 =  FEJL_TAB(12);                                        
                                                                        
 END UDFØR_KONTROLLER;                                                  
