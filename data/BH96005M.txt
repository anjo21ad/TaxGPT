 /**********************************************************************
 * MACRO  BH96005M  REF. AKTIVITETSBESKRIVELSE EVS SLUT 2013:          *
 *                                                                     *
 * MACROEN BENYTTES TIL UDFØRSEL AF DIVERSE KONTROLLER  F Ø R          *
 * BEREGNINGEN AF KMD'S DEL AF EVS SLUT 2013 I MACRO BQ13907M.         *
 *                                                                     *
 * FORMÅLET MED MACROEN ER AT AFSLØRE EVT. PROGRAMFEJL I DE FORANLIG-  *
 * GENDE PROGRAMMER/MACROER.                                           *
 *                                                                     *
 * FEJL_TAB INDEHOLDER SAMTLIGE FUNDNE FEJL (FEJLNUMRE).               *
 *                                                                     *
 * FEJL_TAB(1) LIG 0 BETYDER AT SAMTLIGE DATA OPFYLDER GÆLDENDE KRAV.  *
 * (BQ13907M KALDES DEREFTER HVIS FEJL_TAB(1) ER LIG 0).               *
 *            INDLÆGGELSE AF EU LOVGIVNING VEDR. BEGRÆNSET SKATTEPLIGT *
 *            OG DOBBELTDOMICILERING FOR PENSIONSTER    / SØG #01      *
 **********************************************************************/
 UDFØR_KONTROLLER:                                                      
 PROC(FEJL_TAB);                                                        
                                                                        
 /*********************************************************************/
 /*      DECLARE AF PARAMETRE TIL DENNE MACRO                         */
 /*********************************************************************/
                                                                        
 DCL     FEJL_TAB (12)   BIN FIXED (31);                                
                                                                        
 /********************************************************************* 
 *       DECLARE AF DIV. HJÆLPEFELTER                                 * 
 *********************************************************************/ 
                                                                        
 DCL     I               BIN FIXED (15);                                
                                                                        
         DO I = 1 TO 12;                                                
            FEJL_TAB(I) = 0;                                            
         END;                                                           
                                                                        
         I = 0;                                                         
                                                                        
                                                                        
         IF BH945.EJERSKAB.CEJDTYPE_AKT = '1' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '3' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '4' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '5' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '7' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '8' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '9'                           
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5032;                                      
            END;                                                        
                                                                        
         IF BH945.EJERSKAB.BBERGRL_SW = 0                               
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5033;                                      
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.CNEDSL1 >= '10' &                             
            BH945.TIL_EVS.CNEDSL1 <= '50'                               
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5035;                                      
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.DOVTG > 0 &                                   
           (BH945.TIL_EVS.DOVTG > BH945.MT.DRGNÅRTIL)                   
         THEN                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5036;                                      
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.FELT759 = ' ' !                               
            BH945.TIL_EVS.FELT759 = '1' !                               
            BH945.TIL_EVS.FELT759 = '2'                                 
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5039;                                      
            END;                                                        
                                                                        
         IF BH945.EJERSKAB.CEJDTYPE_AKT = '4' !                         
            BH945.EJERSKAB.CEJDTYPE_AKT = '5'                           
         THEN                                                           
            DO;                                                         
               IF BH945.EJERSKAB.BBER2FAM_SW = 0                        
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     I = I + 1;                                         
                     FEJL_TAB(I) = 5055;                                
                  END;                                                  
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.CEJBEVS >= '0' &                              
            BH945.TIL_EVS.CEJBEVS <= '9'                                
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5077;                                      
            END;                                                        
                                                                        
         IF (BH945.TIL_EVS.CPTYPSLUT = '1' &                            
             BH945.TIL_EVS.CSKPLOMF = ' ') !                            
            (BH945.TIL_EVS.CPTYPSLUT = '2' &                            
             BH945.TIL_EVS.CPTYP_ÆND = ' ' &                            
             BH945.TIL_EVS.CSKPLOMF = ' ') !                            
            (BH945.TIL_EVS.CPTYPSLUT = '3' &                            
            (BH945.TIL_EVS.CSKPLOMF = ' ' !                             
             BH945.TIL_EVS.CSKPLOMF = '0' !                             
             BH945.TIL_EVS.CSKPLOMF = '2' !                             
             BH945.TIL_EVS.CSKPLOMF = '4' !                             
             BH945.TIL_EVS.CSKPLOMF = '5' !                             
             BH945.TIL_EVS.CSKPLOMF = '6' !                             
             BH945.TIL_EVS.CSKPLOMF = '7')) !                           
            (BH945.TIL_EVS.CPTYPSLUT = '4' &  /* #01 */                 
            (BH945.TIL_EVS.CSKPLOMF = '1' !                             
             BH945.TIL_EVS.CSKPLOMF = '3' !                             
             BH945.TIL_EVS.CSKPLOMF = '8'))                             
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5091;                                      
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.CPTYPSLUT = '3'                               
          ! BH945.TIL_EVS.CPTYPSLUT = '4'   /* #01 */                   
         THEN                                                           
            DO;                                                         
               IF ((BH945.EJERSKAB.CEJDTYPE_AKT = '3' !                 
                    BH945.EJERSKAB.CEJDTYPE_AKT = '8') &                
                    BH945.TIL_EVS.FELT759 = '2') !                      
                    BH945.TIL_EVS.FELT759 = '1'                         
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     I = I + 1;                                         
                     FEJL_TAB(I) = 5087;                                
                  END;                                                  
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.CPTYPGL = ' ' !                               
            BH945.TIL_EVS.CPTYPGL = '1' !                               
            BH945.TIL_EVS.CPTYPGL = '2' !                               
            BH945.TIL_EVS.CPTYPGL = '3' !                               
            BH945.TIL_EVS.CPTYPGL = '4'       /* #01 */                 
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5097;                                      
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.CPTYPSLUT = '1' !                             
            BH945.TIL_EVS.CPTYPSLUT = '2' !                             
            BH945.TIL_EVS.CPTYPSLUT = '3' !                             
            BH945.TIL_EVS.CPTYPSLUT = '4'     /* #01 */                 
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5098;                                      
            END;                                                        
                                                                        
         IF BH945.TIL_EVS.CFRED = ' ' !                                 
            BH945.TIL_EVS.CFRED = '1'                                   
         THEN;                                                          
         ELSE                                                           
            DO;                                                         
               I = I + 1;                                               
               FEJL_TAB(I) = 5099;                                      
            END;                                                        
                                                                        
 END UDFØR_KONTROLLER;                                                  
