 /********************************************************************/ 
 /*      BH96071M:                                                   */ 
 /*      OPSÆT CEJBEVS (BEREGNINGSKODE), FEJLNR M.V. TIL EVS SLUT    */ 
 /*      HUSK EFTER KALD AF MACROEN AT SÆTTE CEJBEVS = '0'           */ 
 /*      HVIS FEJLNR = 0.                                            */ 
 /*   SLUT05       SUSANNE KROGH VILLUMSEN              11/11-2005   */ 
 /*                TILRETTET SLUT 2005                               */ 
 /*                VURDOPL1 RETTET TIL VURDOPLGL                     */ 
 /*   SLUT06       BO SCHMIDT                           04/10-2006   */ 
 /*                TILRETTET SLUT 2006                               */ 
 /*   SLUT07       BO SCHMIDT                           20/11-2007   */ 
 /*                TILRETTET SLUT 2007                               */ 
 /*   SLUT08       BO SCHMIDT                           15/11-2008   */ 
 /*                TILRETTET SLUT 2008                               */ 
 /*   SLUT09       GERD HOLM-PEDERSEN                   08/10-2009   */ 
 /*                TILRETTET SLUT 2009                               */ 
 /*   SLUT10       GERD HOLM-PEDERSEN                   11/11-2010   */ 
 /*                TILRETTET SLUT 2010                               */ 
 /*   SLUT11       GERD HOLM-PEDERSEN                   20/10-2011   */ 
 /*                TILRETTET SLUT 2011                               */ 
 /*   SLUT12       LARS KAAE HARRITSHØJ                 SEP 2012     */ 
 /*                TILRETTET SLUT 2012                               */ 
 /*   SLUT13       JØRGEN SAUGMANN                      OKT 2013     */ 
 /*                TILRETTET SLUT 2013                               */ 
 /*   SLUT14       ESBEN BRODERSEN                      NOV 2014     */ 
 /*                TILRETTET SLUT 2014                               */ 
 /*   SLUT15:      Årsrullet 2014 - 2015            JNK : 30/11-2015 */ 
 /*   SLUT15:      Årstal tages fra BH65300M        QEB : 01/06-2015 */ 
 /*   SLUT17:      Årstal tages fra BH65300M        QEB : 07/06-2017 */ 
 /*                KS02-39-01 Tilretning af felt 705                 */ 
 /*                CEANV lig 521 og 522 lagt ind                     */ 
 /*********************************************************************/
 OPSÆT_FEJLNR:                                                          
 PROC;                                                                  
                                                                        
         /* FEJLNR. 5007,5008 OG/ELLER 5009 SKAL ALTID OPSÆTTES */      
         /* TO GANGE IDET DE BEVIRKER NULSTILLING AF DIVERSE    */      
         /* BEREGNINGSGRUNDLAG SÅ DISSE IKKE BENYTTES VED EVT.  */      
         /* SENERE OPRETTEDE EJERE.                             */      
                                                                        
         SELECT;                                                        
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '06' !                        
                  BH945.AKT_VURD.CBENYT = '07' !                        
                  BH945.AKT_VURD.CBENYT = '13' !                        
                  BH945.AKT_VURD.CBENYT = '34' !                        
                  BH945.AKT_VURD.CBENYT = '03' !                        
                  BH945.AKT_VURD.CBENYT = '04' !                        
                  BH945.AKT_VURD.CBENYT = '23' !                        
                  BH945.AKT_VURD.CBENYT = '24' !                        
                  BH945.AKT_VURD.CBENYT = '31' !                        
                  BH945.AKT_VURD.CBENYT = '33' !                        
                  BH945.AKT_VURD.CBENYT = '43' !                        
                  BH945.AKT_VURD.CBENYT = '44' !                        
                  BH945.AKT_VURD.CBENYT = '49' )                        
             DO;                                                        
                IF (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) = 0                       
                THEN                                                    
                   BH945.FEJLNR = 5008;                                 
             END;                                                       
                                                                        
           WHEN (((BH945.AKT_VURD.ANT_FOR_4 +                           
                   BH945.AKT_VURD.ANT_FOR_5 +                           
                   BH945.AKT_VURD.ANT_FOR_6 +                           
                   BH945.AKT_VURD.ANT_FOR_8 +                           
                   BH945.AKT_VURD.ANT_FOR_9) > 1) &                     
                   BH945.EJERSKAB.BBERGRL_SW = -1)                      
             DO;                                                        
                BH945.FEJLNR = 5007;                                    
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '02' !                        
                  BH945.AKT_VURD.CBENYT = '05' !                        
                  BH945.AKT_VURD.CBENYT = '22' !                        
                  BH945.AKT_VURD.CBENYT = '42' )                        
             DO;                                                        
                IF (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) = 0                       
                THEN                                                    
                   BH945.FEJLNR = 5008;                                 
             END;                                                       
                                                                        
           WHEN (((BH945.AKT_VURD.CBENYT = '02' &                       
                   BH945.AKT_VURD.FLEJL = 2) !                          
                  (BH945.AKT_VURD.CBENYT = '22' &                       
                   BH945.AKT_VURD.FLEJL = 2) !                          
                  (BH945.AKT_VURD.CBENYT = '42' &                       
                   BH945.AKT_VURD.FLEJL = 2)) &                         
                   BH945.EJERSKAB.BBERGRL_SW = -1)                      
             DO;                                                        
                BH945.FEJLNR = 5009;                                    
             END;                                                       
                                                                        
           WHEN ((BH945.AKT_VURD.CBENYT = '01' &                        
                  BH945.AKT_VURD.FLEJL = 2) !                           
                 (BH945.AKT_VURD.CBENYT = '41' &                        
                  BH945.AKT_VURD.FLEJL = 2) !                           
                 (BH945.AKT_VURD.CBENYT = '45' &                        
                  BH945.AKT_VURD.FLEJL = 2))                            
             DO;                                                        
                IF (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) = 0                       
                THEN                                                    
                   BH945.FEJLNR = 5008;                                 
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF BH945.FEJLNR = 5007 !                                       
            BH945.FEJLNR = 5008 !                                       
            BH945.FEJLNR = 5009                                         
         THEN                                                           
            DO;                                                         
               BH945.EJERSKAB.CBERGROP = ' ';                           
               BH945.EJERSKAB.CBERGRGLOP = ' ';                         
               BH945.EJENDOM.CBERGRL = '9';                             
                                                                        
               BH945.EJERSKAB.BBERGRL = 0;                              
               BH945.EJERSKAB.BBERGRL_SW = -1;                          
               BH945.EJERSKAB.BBER2FAM = 0;                             
               BH945.EJERSKAB.BBER2FAM_SW = -1;                         
               BH945.EJERSKAB.BEJBOLANV = 0;                            
               BH945.EJERSKAB.BEJBOLANV_SW = -1;                        
               BH945.EJERSKAB.CANVEBOL = ' ';                           
                                                                        
               BH945.VURD_AKT.BBERGRL_AKT = 0;                          
               BH945.VURD_AKT.BBERGRL_AKT_SW = -1;                      
               BH945.VURD_AKT.BBER2FAM_AKT = 0;                         
               BH945.VURD_AKT.BBER2FAM_AKT_SW = -1;                     
               BH945.VURD_AKT.CBERGRL_AKT = '9';                        
               BH945.VURD_AKT.BEJBOLANV_AKT = 0;                        
               BH945.VURD_AKT.BEJBOLANV_AKT_SW = -1;                    
               BH945.VURD_AKT.CANVEBOL_AKT = ' ';                       
                                                                        
               BH945.VURD_02.BBERGRL_02 = 0;                            
               BH945.VURD_02.BBERGRL_02_SW = -1;                        
               BH945.VURD_02.BBER2FAM_02 = 0;                           
               BH945.VURD_02.BBER2FAM_02_SW = -1;                       
               BH945.VURD_02.CBERGRL_02 = '9';                          
               BH945.VURD_02.BEJBOLANV_02 = 0;                          
               BH945.VURD_02.BEJBOLANV_02_SW = -1;                      
               BH945.VURD_02.CANVEBOL_02 = ' ';                         
                                                                        
               BH945.VURD_02OM.BBERGRL_02OM = 0;                        
               BH945.VURD_02OM.BBERGRL_02OM_SW = -1;                    
               BH945.VURD_02OM.BBER2FAM_02OM = 0;                       
               BH945.VURD_02OM.BBER2FAM_02OM_SW = -1;                   
               BH945.VURD_02OM.CBERGRL_02OM = '9';                      
               BH945.VURD_02OM.BEJBOLANV_02OM = 0;                      
               BH945.VURD_02OM.BEJBOLANV_02OM_SW = -1;                  
               BH945.VURD_02OM.CANVEBOL_02OM = ' ';                     
                                                                        
               BH945.VURD_02OMNY.BBERGRL_02OMNY = 0;                    
               BH945.VURD_02OMNY.BBERGRL_02OMNY_SW = -1;                
               BH945.VURD_02OMNY.BBER2FAM_02OMNY = 0;                   
               BH945.VURD_02OMNY.BBER2FAM_02OMNY_SW = -1;               
               BH945.VURD_02OMNY.CBERGRL_02OMNY = '9';                  
               BH945.VURD_02OMNY.BEJBOLANV_02OMNY = 0;                  
               BH945.VURD_02OMNY.BEJBOLANV_02OMNY_SW = -1;              
               BH945.VURD_02OMNY.CANVEBOL_02OMNY = ' ';                 
                                                                        
               BH945.VURD_01OM.BBERGRL_01OM = 0;                        
               BH945.VURD_01OM.BBERGRL_01OM_SW = -1;                    
               BH945.VURD_01OM.BBER2FAM_01OM = 0;                       
               BH945.VURD_01OM.BBER2FAM_01OM_SW = -1;                   
               BH945.VURD_01OM.CBERGRL_01OM = '9';                      
               BH945.VURD_01OM.BEJBOLANV_01OM = 0;                      
               BH945.VURD_01OM.BEJBOLANV_01OM_SW = -1;                  
               BH945.VURD_01OM.CANVEBOL_01OM = ' ';                     
                                                                        
               BH945.VURD_01OMNY.BBERGRL_01OMNY = 0;                    
               BH945.VURD_01OMNY.BBERGRL_01OMNY_SW = -1;                
               BH945.VURD_01OMNY.BBER2FAM_01OMNY = 0;                   
               BH945.VURD_01OMNY.BBER2FAM_01OMNY_SW = -1;               
               BH945.VURD_01OMNY.CBERGRL_01OMNY = '9';                  
               BH945.VURD_01OMNY.BEJBOLANV_01OMNY = 0;                  
               BH945.VURD_01OMNY.BEJBOLANV_01OMNY_SW = -1;              
               BH945.VURD_01OMNY.CANVEBOL_01OMNY = ' ';                 
                                                                        
               BH945.VURD_015PCT.BBERGRL_015PCT = 0;                    
               BH945.VURD_015PCT.BBERGRL_015PCT_SW = -1;                
               BH945.VURD_015PCT.BBER2FAM_015PCT = 0;                   
               BH945.VURD_015PCT.BBER2FAM_015PCT_SW = -1;               
               BH945.VURD_015PCT.CBERGRL_015PCT = '9';                  
               BH945.VURD_015PCT.BEJBOLANV_015PCT = 0;                  
               BH945.VURD_015PCT.BEJBOLANV_015PCT_SW = -1;              
               BH945.VURD_015PCT.CANVEBOL_015PCT = ' ';                 
                                                                        
               BH945.VURD_02ANV.BBERGRL_02ANV = 0;                      
               BH945.VURD_02ANV.BBERGRL_02ANV_SW = -1;                  
               BH945.VURD_02ANV.BBER2FAM_02ANV = 0;                     
               BH945.VURD_02ANV.BBER2FAM_02ANV_SW = -1;                 
               BH945.VURD_02ANV.CBERGRL_02ANV = '9';                    
               BH945.VURD_02ANV.BEJBOLANV_02ANV = 0;                    
               BH945.VURD_02ANV.BEJBOLANV_02ANV_SW = -1;                
               BH945.VURD_02ANV.CANVEBOL_02ANV = ' ';                   
                                                                        
               BH945.VURD_015ANV.BBERGRL_015ANV = 0;                    
               BH945.VURD_015ANV.BBERGRL_015ANV_SW = -1;                
               BH945.VURD_015ANV.BBER2FAM_015ANV = 0;                   
               BH945.VURD_015ANV.BBER2FAM_015ANV_SW = -1;               
               BH945.VURD_015ANV.CBERGRL_015ANV = '9';                  
               BH945.VURD_015ANV.BEJBOLANV_015ANV = 0;                  
               BH945.VURD_015ANV.BEJBOLANV_015ANV_SW = -1;              
               BH945.VURD_015ANV.CANVEBOL_015ANV = ' ';                 
            END;                                                        
                                                                        
         /* NB. HEREFTER STARTER DEN 'NORMALE' OPSÆTNING AF */          
         /* FEJLNUMRE (OGSÅ FEJLNUMRENE 5007, 5008 OG 5009. */          
                                                                        
         SELECT;                                                        
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '09' !                        
                  BH945.AKT_VURD.CBENYT = '17' !                        
                  BH945.AKT_VURD.CBENYT = '98' )                        
             DO;                                                        
                BH945.FEJLNR = 5001;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '03' !                        
                  BH945.AKT_VURD.CBENYT = '04' !                        
                  BH945.AKT_VURD.CBENYT = '23' !                        
                  BH945.AKT_VURD.CBENYT = '24' !                        
                  BH945.AKT_VURD.CBENYT = '31' !                        
                  BH945.AKT_VURD.CBENYT = '33' !                        
                  BH945.AKT_VURD.CBENYT = '43' !                        
                  BH945.AKT_VURD.CBENYT = '44' !                        
                  BH945.AKT_VURD.CBENYT = '49' )                        
             DO;                                                        
                IF (BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !          
                    BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !          
                    BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' !          
                    BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '6') &         
                    BH945.EVS_SLUT_EJER.SIDSTE.CSLET < '1' &            
                    BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS < '9' &          
                    BH945.EVS_SLUT_EJER.SIDSTE.DAFSTAA = 0 &            
                    BH945.EVS_SLUT_EJER.SIDSTE.DFRAFLYT = 0 &           
                    BH945.EVS_SLUT_EJER.SIDSTE.CÆGTOPR < '1' &          
                   (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) > 0                       
                THEN;                                                   
                ELSE                                                    
                   DO;                                                  
                      BH945.FEJLNR = 5001;                              
                      BH945.TIL_EVS.CEJBEVS = '1';                      
                   END;                                                 
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.ANT_FOR_2 > 0 )                        
             DO;                                                        
                BH945.FEJLNR = 5003;                                    
                BH945.TIL_EVS.CEJBEVS = '2';                            
                BH945.EJERSKAB.BBERGRL = 0;                             
                BH945.EJERSKAB.BBERGRL_SW = -1;                         
                BH945.EJERSKAB.BBER2FAM = 0;                            
                BH945.EJERSKAB.BBER2FAM_SW = -1;                        
                BH945.EJENDOM.CBERGRL = '9';                            
             END;                                                       
                                                                        
  /*       WHEN ( BH945.AKT_VURD.CBENYT = '70'  !                       
                  BH945.AKT_VURD.CBENYT = '71'  !                       
                  BH945.AKT_VURD.CUOP   = '6' )                         
             DO;                                                        
                BH945.FEJLNR = 5002;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                          SLUT10 */    
                                                                        
           WHEN ( BH945.AKT_VURD.CUOP   = '6' )        /*  SLUT10 */    
             DO;                                                        
                BH945.FEJLNR = 5002;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CUOP = '5' )                           
             DO;                                                        
                BH945.FEJLNR = 5025;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                                       
                                                                        
           /* CEJSO er taget ud til slut 2017 */                        
         /* WHEN ( BH945.ESR.STAMOPL.CEJSO = '1' !                      
                  BH945.ESR.STAMOPL.CEJSO = '3' ! */                    
           WHEN((BH945.AKT_VURD.CBENYT = '21' !                         
                 BH945.AKT_VURD.CBENYT = '22' !                         
                 BH945.AKT_VURD.CBENYT = '25' !                         
                 BH945.AKT_VURD.CBENYT = '26' !                         
                 BH945.AKT_VURD.CBENYT = '27' !                         
                 BH945.AKT_VURD.CBENYT = '28' !                         
                 BH945.AKT_VURD.CBENYT = '29') &                        
                 BH945.AKT_VURD.CEJERL = '1')                           
             DO;                                                        
                BH945.FEJLNR = 5014;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.FLEJL > 2 &                            
                 (BH945.AKT_VURD.ANT_FOR_4 +                            
                  BH945.AKT_VURD.ANT_FOR_5 +                            
                  BH945.AKT_VURD.ANT_FOR_6 +                            
                  BH945.AKT_VURD.ANT_FOR_8 +                            
                  BH945.AKT_VURD.ANT_FOR_9) = 0 &                       
                  BH945.AKT_VURD.ANT_FOR_1 > 2 )                        
             DO;                                                        
                BH945.FEJLNR = 5003;                                    
                BH945.TIL_EVS.CEJBEVS = '2';                            
                BH945.EJERSKAB.BBERGRL = 0;                             
                BH945.EJERSKAB.BBERGRL_SW = -1;                         
                BH945.EJERSKAB.BBER2FAM = 0;                            
                BH945.EJERSKAB.BBER2FAM_SW = -1;                        
                BH945.EJENDOM.CBERGRL = '9';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.FLEJL > 2 &                            
                 (BH945.AKT_VURD.ANT_FOR_1 +                            
                  BH945.AKT_VURD.ANT_FOR_4 +                            
                  BH945.AKT_VURD.ANT_FOR_5 +                            
                  BH945.AKT_VURD.ANT_FOR_6 +                            
                  BH945.AKT_VURD.ANT_FOR_8 +                            
                  BH945.AKT_VURD.ANT_FOR_9) = 0 )                       
             DO;                                                        
                BH945.FEJLNR = 5024;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.FLEJL > 2 &                            
                  BH945.AKT_VURD.ANT_FOR_1 = 0 &                        
                 (BH945.AKT_VURD.ANT_FOR_4 +                            
                  BH945.AKT_VURD.ANT_FOR_5 +                            
                  BH945.AKT_VURD.ANT_FOR_6 +                            
                  BH945.AKT_VURD.ANT_FOR_8 +                            
                  BH945.AKT_VURD.ANT_FOR_9) > 2 )                       
             DO;                                                        
                BH945.FEJLNR = 5024;                                    
                BH945.TIL_EVS.CEJBEVS = '1';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '06' !                        
                  BH945.AKT_VURD.CBENYT = '07' !                        
                  BH945.AKT_VURD.CBENYT = '13' !                        
                  BH945.AKT_VURD.CBENYT = '34' )                        
             DO;                                                        
                IF (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) = 0                       
                THEN                                                    
                   DO;                                                  
                      BH945.FEJLNR = 5008;                              
                      BH945.TIL_EVS.CEJBEVS = '1';                      
                   END;                                                 
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '  ' !                        
                  BH945.AKT_VURD.DVURDÅR ^= BH65300M.INDKÅR1)/*SLUTÅR*/ 
             DO;                                                        
                SELECT;                                                 
                  WHEN ( BH945.VURDOPLGL.ÅRSVURD.CBENYT = '09' !        
                         BH945.VURDOPLGL.ÅRSVURD.CBENYT = '17' !        
                         BH945.VURDOPLGL.ÅRSVURD.CBENYT = '98' )        
                    DO;                                                 
                       BH945.FEJLNR = 5001;                             
                       BH945.TIL_EVS.CEJBEVS = '1';                     
                    END;                                                
                  WHEN ( BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_2 > 0 )        
                    DO;                                                 
                       BH945.FEJLNR = 5003;                             
                       BH945.TIL_EVS.CEJBEVS = '2';                     
                       BH945.EJERSKAB.BBERGRL = 0;                      
                       BH945.EJERSKAB.BBERGRL_SW = -1;                  
                       BH945.EJERSKAB.BBER2FAM = 0;                     
                       BH945.EJERSKAB.BBER2FAM_SW = -1;                 
                       BH945.EJENDOM.CBERGRL = '9';                     
                    END;                                                
                  WHEN ( BH945.VURDOPLGL.ÅRSVURD.FLEJL > 2 &            
                        (BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_1 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_4 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_5 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_6 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_8 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_9) = 0 )       
                    DO;                                                 
                       BH945.FEJLNR = 5024;                             
                       BH945.TIL_EVS.CEJBEVS = '1';                     
                    END;                                                
                  WHEN ( BH945.VURDOPLGL.ÅRSVURD.FLEJL > 2 &            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_1 = 0 &        
                        (BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_4 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_5 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_6 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_8 +            
                         BH945.VURDOPLGL.ÅRSVURD.ANT_FOR_9) > 2 )       
                    DO;                                                 
                       BH945.FEJLNR = 5024;                             
                       BH945.TIL_EVS.CEJBEVS = '1';                     
                    END;                                                
                  OTHERWISE                                             
                    DO;                                                 
                       BH945.FEJLNR = 5019;                             
                       BH945.EJERSKAB.BBERGRL = 0;                      
                       BH945.EJERSKAB.BBERGRL_SW = -1;                  
                       BH945.EJERSKAB.BBER2FAM = 0;                     
                       BH945.EJERSKAB.BBER2FAM_SW = -1;                 
                       BH945.EJENDOM.CBERGRL = '9';                     
                       BH945.TIL_EVS.CEJBEVS = '2';                     
                    END;                                                
                END;                                                    
             END;                                                       
                                                                        
           WHEN ((BH945.VURD_AKT.CBENYT_AKT ^= '  '  &                  
                  BH945.VURDOPLGL.ÅRSVURD.CBENYT ^= '  ') &             
                 (BH945.VURD_AKT.CEJERL_AKT = '2' &                     
                  BH945.EJENDOM.CEJERL_GL = '1'))                       
             DO;                                                        
               BH945.FEJLNR = 5181;                                     
               BH945.TIL_EVS.CEJBEVS = '2';                             
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '45' &                        
                  BH945.AKT_VURD.FLEJL = 0 )                            
             DO;                                                        
                BH945.FEJLNR = 5006;                                    
                BH945.TIL_EVS.CEJBEVS = '2';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '29' &                        
                  BH945.AKT_VURD.FLEJL ^= 1 )                           
             DO;                                                        
                BH945.FEJLNR = 5005;                                    
                BH945.TIL_EVS.CEJBEVS = '2';                            
             END;                                                       
                                                                        
           WHEN (((BH945.AKT_VURD.ANT_FOR_4 +                           
                   BH945.AKT_VURD.ANT_FOR_5 +                           
                   BH945.AKT_VURD.ANT_FOR_6 +                           
                   BH945.AKT_VURD.ANT_FOR_8 +                           
                   BH945.AKT_VURD.ANT_FOR_9) > 1) &                     
                  (BH945.FEJLNR = 5007 !                                
                   BH945.FEJLNR = 5009))                                
                /* D.V.S. AT BH945.EJERSKAB.BBERGRL_SW = -1 */          
             DO;                                                        
                BH945.FEJLNR = 5007;                                    
                BH945.TIL_EVS.CEJBEVS = '2';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '02' !                        
                  BH945.AKT_VURD.CBENYT = '05' !                        
                  BH945.AKT_VURD.CBENYT = '22' !                        
                  BH945.AKT_VURD.CBENYT = '42' )                        
             DO;                                                        
                IF (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) = 0                       
                THEN                                                    
                   DO;                                                  
                      IF BH945.AKT_EJER.DINDFLYT > 0                    
                       & BH945.AKT_EJER.DINDFLYT <= BH945.MT.DRGNÅRTIL  
                      THEN                                              
                         DO;                                            
                           BH945.FEJLNR = 5008;                         
                           BH945.TIL_EVS.CEJBEVS = '2';                 
                         END;                                           
                      ELSE                                              
                      IF BH945.AKT_EJER.DFRAFLYT > 0                    
                       & BH945.AKT_EJER.DFRAFLYT >= BH945.MT.DRGNÅRFRA  
                      THEN                                              
                         DO;                                            
                           BH945.FEJLNR = 5008;                         
                           BH945.TIL_EVS.CEJBEVS = '2';                 
                         END;                                           
                      ELSE                                              
                         DO;                                            
                           BH945.FEJLNR = 5155;                         
                           BH945.TIL_EVS.CEJBEVS = '1';                 
                         END;                                           
                   END;                                                 
             END;                                                       
                                                                        
           WHEN (((BH945.AKT_VURD.CBENYT = '02' &                       
                   BH945.AKT_VURD.FLEJL = 2) !                          
                  (BH945.AKT_VURD.CBENYT = '22' &                       
                   BH945.AKT_VURD.FLEJL = 2) !                          
                  (BH945.AKT_VURD.CBENYT = '42' &                       
                   BH945.AKT_VURD.FLEJL = 2)) &                         
                  (BH945.FEJLNR = 5007 !                                
                   BH945.FEJLNR = 5009))                                
                /* D.V.S. AT BH945.EJERSKAB.BBERGRL_SW = -1 */          
             DO;                                                        
                BH945.FEJLNR = 5009;                                    
                BH945.TIL_EVS.CEJBEVS = '2';                            
             END;                                                       
                                                                        
           WHEN ((BH945.AKT_VURD.CBENYT = '01' &                        
                  BH945.AKT_VURD.FLEJL = 2) !                           
                 (BH945.AKT_VURD.CBENYT = '41' &                        
                  BH945.AKT_VURD.FLEJL = 2) !                           
                 (BH945.AKT_VURD.CBENYT = '45' &                        
                  BH945.AKT_VURD.FLEJL = 2))                            
             DO;                                                        
                IF (BH945.AKT_VURD.ANT_FOR_4 +                          
                    BH945.AKT_VURD.ANT_FOR_5 +                          
                    BH945.AKT_VURD.ANT_FOR_6 +                          
                    BH945.AKT_VURD.ANT_FOR_8 +                          
                    BH945.AKT_VURD.ANT_FOR_9) = 0                       
                THEN                                                    
                   DO;                                                  
                      BH945.FEJLNR = 5008;                              
                      BH945.TIL_EVS.CEJBEVS = '2';                      
                   END;                                                 
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.CBENYT = '25' )                        
             DO;                                                        
                IF BH945.AKT_VURD.CEJERL = '1'  /* D.V.S. ER UDLEJET */ 
                THEN                                                    
                   DO;                                                  
                      BH945.FEJLNR = 5014;                              
                      BH945.TIL_EVS.CEJBEVS = '1';                      
                   END;                                                 
                ELSE  /*SLUT 2012-KRAV1801 CEANV START */               
                IF(BH945.ESR.CEANV = '150' !           /*KOLLEGIUM*/    
                   BH945.ESR.CEANV = '510' !           /*SOMMERHUS*/    
                   BH945.ESR.CEANV = '520' !           /*FERIEBYGNING*/ 
                   BH945.ESR.CEANV = '521' !           /*FERIECENTER*/  
                   BH945.ESR.CEANV = '522')  &         /*FERIELEJL.*/   
                   BH945.EJERSKAB.BBERGRL_SW = 0                        
                THEN                                                    
                   DO; /*SKAL IKKE AFVISES*/                            
                   END;                                                 
                ELSE                                                    
                   DO;                                                  
                      IF BH945.AKT_VURD.BEJDVÆR <= 25000                
                      THEN                                              
                         BH945.FEJLNR = 5010;                           
                      ELSE                                              
                         BH945.FEJLNR = 5011;                           
                      BH945.TIL_EVS.CEJBEVS = '3';                      
                   END;                                                 
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF (BH945.FEJLNR = 5010 !                                      
             BH945.FEJLNR = 5011) &                                     
             BH945.EVS_SLUT_EJER.DCPRN > 0 &                            
           ((BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '0' !                 
             BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '4' !                 
             BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '5' !                 
             BH945.EVS_SLUT_EJER.SIDSTE.CEJBEVS = '6') &                
             BH945.EVS_SLUT_EJER.SIDSTE.CSLET < '1') &                  
             BH945.EJERSKAB.BBERGRL_SW = 0                              
         THEN                                                           
            BH945.FEJLNR = 0;                                           
                                                                        
                                                                        
         IF BH945.FEJLNR ^= 0                                           
         THEN                                                           
            RETURN;                                                     
         SELECT;                                                        
                                                                        
           WHEN ( BH945.AKT_VURD.BEJDVÆR = 0 &                          
                  BH945.AKT_VURD.CVURDOPR = '1' )                       
             DO;                                                        
                BH945.FEJLNR = 5015;                                    
                BH945.TIL_EVS.CEJBEVS = '3';                            
                BH945.EJERSKAB.BBERGRL = 0;                             
                BH945.EJERSKAB.BBERGRL_SW = -1;                         
                BH945.EJERSKAB.BBER2FAM = 0;                            
                BH945.EJERSKAB.BBER2FAM_SW = -1;                        
                BH945.EJENDOM.CBERGRL = '9';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.BEJDVÆR = 0 &                          
                  BH945.AKT_VURD.CVURDOPR = '2' &                       
                  BH945.VURD_01OM.BBERGRL_01OM_SW = -1 &                
                  BH945.VURD_01OMNY.BBERGRL_01OMNY_SW = -1 &            
                  BH945.VURD_02OM.BBERGRL_02OM_SW = -1 &                
                  BH945.VURD_02OMNY.BBERGRL_02OMNY_SW = -1 )            
             DO;                                                        
                BH945.FEJLNR = 5015;                                    
                BH945.TIL_EVS.CEJBEVS = '3';                            
                BH945.EJERSKAB.BBERGRL = 0;                             
                BH945.EJERSKAB.BBERGRL_SW = -1;                         
                BH945.EJERSKAB.BBER2FAM = 0;                            
                BH945.EJERSKAB.BBER2FAM_SW = -1;                        
                BH945.EJENDOM.CBERGRL = '9';                            
             END;                                                       
                                                                        
           WHEN ( BH945.AKT_VURD.BEJDVÆR < 0 )                          
             DO;                                                        
                BH945.FEJLNR = 5016;                                    
                BH945.TIL_EVS.CEJBEVS = '3';                            
                BH945.EJERSKAB.BBERGRL = 0;                             
                BH945.EJERSKAB.BBERGRL_SW = -1;                         
                BH945.EJERSKAB.BBER2FAM = 0;                            
                BH945.EJERSKAB.BBER2FAM_SW = -1;                        
                BH945.EJENDOM.CBERGRL = '9';                            
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF BH945.FEJLNR ^= 0                                           
         THEN                                                           
            RETURN;                                                     
                                                                        
         SELECT;                                                        
                                                                        
           WHEN ((BH945.VURD_AKT.CBENYT_AKT ^= '  '  &                  
                  BH945.VURDOPLGL.ÅRSVURD.CBENYT ^= '  ') &             
                 (BH945.VURD_AKT.CBENYT_AKT ^=                          
                  BH945.VURDOPLGL.ÅRSVURD.CBENYT) &                     
                 (BH945.EJENDOM.CSTOPÅR = ' '))                         
             DO;                                                        
                                                                        
               SELECT;                                                  
                                                                        
                 WHEN (BH945.VURD_AKT.CBENYT_AKT = '05' &               
                      (BH945.VURDOPLGL.ÅRSVURD.CBENYT = '06' !          
                       BH945.VURDOPLGL.ÅRSVURD.CBENYT = '07'))          
                   DO;                                                  
                      /* NY UNDTAGELSE INDFØRT SLUT 2003 */             
                   END;                                                 
                                                                        
                 WHEN (BH945.VURD_AKT.CBENYT_AKT = '06' &               
                      (BH945.VURDOPLGL.ÅRSVURD.CBENYT = '05' !          
                       BH945.VURDOPLGL.ÅRSVURD.CBENYT = '07'))          
                   DO;                                                  
                      /* NY UNDTAGELSE INDFØRT SLUT 2003 */             
                   END;                                                 
                                                                        
                 WHEN (BH945.VURD_AKT.CBENYT_AKT = '07' &               
                      (BH945.VURDOPLGL.ÅRSVURD.CBENYT = '05' !          
                       BH945.VURDOPLGL.ÅRSVURD.CBENYT = '06'))          
                   DO;                                                  
                      /* NY UNDTAGELSE INDFØRT SLUT 2003 */             
                   END;                                                 
                                                                        
                 WHEN (BH945.VURD_AKT.CBENYT_AKT = '48' &               
                       BH945.VURDOPLGL.ÅRSVURD.CBENYT = '78')           
                   DO;                                                  
                      /* NY UNDTAGELSE INDFØRT SLUT 2003 */             
                   END;                                                 
                                                                        
                 OTHERWISE                                              
                   DO;                                                  
                     BH945.FEJLNR = 5180;                               
                     BH945.TIL_EVS.CEJBEVS = '3';                       
                     BH945.EJERSKAB.BBERGRL = 0;                        
                     BH945.EJERSKAB.BBERGRL_SW = -1;                    
                     BH945.EJENDOM.CBERGRL = '9';                       
                                                                        
                     BH945.VURD_AKT.BBERGRL_AKT = 0;                    
                     BH945.VURD_AKT.BBERGRL_AKT_SW = -1;                
                     BH945.VURD_AKT.BBER2FAM_AKT = 0;                   
                     BH945.VURD_AKT.BBER2FAM_AKT_SW = -1;               
                     BH945.VURD_AKT.CBERGRL_AKT = '9';                  
                     BH945.VURD_AKT.BEJBOLANV_AKT = 0;                  
                     BH945.VURD_AKT.BEJBOLANV_AKT_SW = -1;              
                     BH945.VURD_AKT.CANVEBOL_AKT = ' ';                 
                   END;                                                 
                                                                        
               END; /* SELECT */                                        
                                                                        
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
         IF BH945.FEJLNR ^= 0                                           
         THEN                                                           
            RETURN;                                                     
                                                                        
         SELECT;                                                        
                                                                        
           WHEN ( BH945.VURD_AKT.BBERGRL_AKT_SW = 0 &                   
                  BH945.VURD_02ANV.BBERGRL_02ANV_SW = 0 &               
                  BH945.VURD_015ANV.BBERGRL_015ANV_SW = 0 );            
                                                                        
           WHEN ( BH945.VURD_AKT.BBERGRL_AKT_SW = 0 !                   
                  BH945.VURD_02ANV.BBERGRL_02ANV_SW = 0 !               
                  BH945.VURD_015ANV.BBERGRL_015ANV_SW = 0 )             
             DO;                                                        
                BH945.FEJLNR = 5057;                                    
                BH945.TIL_EVS.CEJBEVS = '3';                            
                BH945.EJERSKAB.BBERGRL = 0;                             
                BH945.EJERSKAB.BBERGRL_SW = -1;                         
                BH945.EJERSKAB.BBER2FAM = 0;                            
                BH945.EJERSKAB.BBER2FAM_SW = -1;                        
                BH945.EJENDOM.CBERGRL = '9';                            
             END;                                                       
                                                                        
           OTHERWISE;                                                   
                                                                        
         END; /* SELECT */                                              
                                                                        
 END OPSÆT_FEJLNR;                                                      
