                                                                        
 /*********************************************************************/
 /*      BH60121M:                                                    */
 /*                                                                   */
 /*      OPTÆLLING AF EJERE PÅ BEREGNINGSBÅNDET TIL DIVERSE           */
 /*      BENYTTELSESKODE-STATISTIKKER OG                              */
 /*      UDSKRIVNING AF DIVERSE BENYTTELSESKODE-STATISTIKKER          */
 /*                                                                   */
 /* ÅRSTILRETNING BESTÅR MINDST AF 'RULNING' AF TO FIRECIFREDE ÅRSTAL */
 /* I OVERSKRIFTER OG DATANAVNE.                                      */
 /*********************************************************************/
                                                                        
 /********************************************************************* 
 *       OPTÆL ANTAL EJERE FORDELT PÅ BENYTTELSES- OG/ELLER           * 
 *       BBR-ANVENDELSESKODER                                         * 
 *********************************************************************/ 
                                                                        
 OPTÆL_EJERE_PR_BENYTTELSESKODE:                                        
         PROC;                                                          
                                                                        
         HJBENYT = BH601.CBENYT;                                        
                                                                        
         IF HJBENYT >= '01' & HJBENYT <= '99'                           
         THEN                                                           
            I = HJBENYTP;                                               
         ELSE                                                           
            I = 100;                                                    
                                                                        
         TABBENYT(I).TVIALT = TABBENYT(I).TVIALT + 1;                   
                                                                        
         IF BH601.DAFSTÅ = ÅR0101 ! SOLGT_I_ÅR = JA                     
         THEN                                                           
            TABBENYT(I).TVSÆLGER = TABBENYT(I).TVSÆLGER + 1;            
         ELSE                                                           
            TABBENYT(I).TVNUVÆR  = TABBENYT(I).TVNUVÆR  + 1;            
                                                                        
         CALL OPTÆL_BBRANV_PR_BK;                                       
                                                                        
         IF BH601.BBRANV = '510'                                        
         THEN                                                           
            CALL OPTÆL_BK_FOR_BBRANV_510;                               
                                                                        
 END OPTÆL_EJERE_PR_BENYTTELSESKODE;                                    
                                                                        
                                                                        
 /********************************************************************* 
 *       OPTÆL ANTAL EJERE PR. BENYTTELSESKODE FORDELT                * 
 *       PR. BBR-ANVENDELSESKODE                                      * 
 *********************************************************************/ 
                                                                        
 OPTÆL_BBRANV_PR_BK:                                                    
         PROC;                                                          
                                                                        
         TAB_BK(I).ANTAL = TAB_BK(I).ANTAL + 1;                         
                                                                        
         IF BH601.BBRANV > '000'                                        
         THEN                                                           
            HJANV = BH601.BBRANV;                                       
         ELSE                                                           
            HJANV = '999';                                              
                                                                        
         N = 0;                                                         
                                                                        
         IF HJANV = '999'                                               
         THEN                                                           
            N = 50;                                                     
         ELSE                                                           
            DO;                                                         
               DO K = 1 TO 49;                                          
                  IF TAB_BK(I).TAB_ANV(K).ANVKODE = HJANV               
                  THEN                                                  
                     DO;                                                
                        N = K;                                          
                        K = 49;                                         
                     END;                                               
                  ELSE                                                  
                     IF TAB_BK(I).TAB_ANV(K).ANVKODE = '   '            
                     THEN                                               
                        DO;                                             
                           TAB_BK(I).TAB_ANV(K).ANVKODE = HJANV;        
                           N = K;                                       
                           K = 49;                                      
                        END;                                            
               END;                                                     
            END;                                                        
                                                                        
         IF N = 0                                                       
         THEN                                                           
            RETURN; /* SIKKERHED - MÅ IKKE OPFYLDES */                  
                                                                        
         TAB_BK(I).TAB_ANV(N).TVIALT =                                  
         TAB_BK(I).TAB_ANV(N).TVIALT + 1;                               
                                                                        
         IF BH601.BLEJE1 = 0 &                                          
            BH601.BLEJE2 = 0                                            
         THEN;                                                          
         ELSE                                                           
            TAB_BK(I).TAB_ANV(N).TVLEJE1999 =                           
            TAB_BK(I).TAB_ANV(N).TVLEJE1999 + 1;                        
                                                                        
         IF BH601.CERKLÆR = 1                                           
         THEN                                                           
            TAB_BK(I).TAB_ANV(N).TVERKLÆR =                             
            TAB_BK(I).TAB_ANV(N).TVERKLÆR + 1;                          
                                                                        
 END OPTÆL_BBRANV_PR_BK;                                                
                                                                        
                                                                        
 /********************************************************************* 
 *       OPTÆL ANTAL EJERE FORDELT PÅ BENYTTELSESKODE, MEN KUN HVIS   * 
 *       BBR-ANVENDELSESKODEN ER LIG 510 D.V.S. SOMMERHUSE            * 
 *********************************************************************/ 
                                                                        
 OPTÆL_BK_FOR_BBRANV_510:                                               
         PROC;                                                          
                                                                        
         TAB_ANV510(I).TVIALT = TAB_ANV510(I).TVIALT + 1;               
                                                                        
         IF BH601.BLEJE1 = 0 &                                          
            BH601.BLEJE2 = 0                                            
         THEN;                                                          
         ELSE                                                           
            TAB_ANV510(I).TVLEJE1999 = TAB_ANV510(I).TVLEJE1999 + 1;    
                                                                        
         IF BH601.CERKLÆR = 1                                           
         THEN                                                           
            TAB_ANV510(I).TVERKLÆR = TAB_ANV510(I).TVERKLÆR + 1;        
                                                                        
 END OPTÆL_BK_FOR_BBRANV_510;                                           
                                                                        
 /*********************************************************************/
 /*      UDSKRIV STATISTIK OVER ANTAL EJERE PR. BENYTTELSESKODE       */
 /*********************************************************************/
 STATISTIK_PR_BENYT:                                                    
         PROC;                                                          
                                                                        
         OVERLINZ.CCA = ZZIK1;                                          
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINX.CCA = ZZWS2;                                          
         OVERLINX.DATO = UDDATO;                                        
         CALL ZZ20300(OVERLINX,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS3;                                          
         OVERLINZ.TEKST = (37)' ' !!                                    
         'STATISTIK OVER ANTAL EJERE FORDELT PÅ BENYTTELSESKODE';       
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS1;                                          
         OVERLINZ.TEKST = 'BENYTTEL-    ANTAL EJERE          HERAF      
     HERAF            BENYTTEL-    ANTAL EJERE          HERAF          H
 ERAF';                                                                 
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS2;                                          
         OVERLINZ.TEKST = 'SESKODE             IALT      NUVÆRENDE      
   SÆLGERE            SESKODE             IALT      NUVÆRENDE        SÆL
 GERE';                                                                 
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
                                                                        
         TABBK = '';                                                    
                                                                        
         K = 0;                                                         
                                                                        
         DO I = 1 TO 100 WHILE (K < 50);                                
                                                                        
            IF TABBENYT(I).TVIALT ^= 0                                  
            THEN                                                        
               DO;                                                      
                  K = K + 1;                                            
                  TABBK(K).BENYT = I;                                   
                  TABBK(K).TVANTAL1 = TABBENYT(I).TVIALT;               
                  TABBK(K).TVANTAL2 = TABBENYT(I).TVNUVÆR;              
                  TABBK(K).TVANTAL3 = TABBENYT(I).TVSÆLGER;             
               END;                                                     
                                                                        
         END;                                                           
                                                                        
         IF K = 0          /* SIKKERHEDS-TEST - MÅ IKKE VÆRE OPFYLDT */ 
         THEN                                                           
            RETURN;                                                     
                                                                        
         DO I = 1 TO 25 WHILE (TABBK(I).TVANTAL1 ^= 0);                 
                                                                        
            DETLINX = '';                                               
                                                                        
            IF TABBK(I).BENYT < 100                                     
            THEN                                                        
               DETLINX.SIDE(1).TEKST = '  ' !! TABBK(I).BENYT;          
            ELSE                                                        
               DETLINX.SIDE(1).TEKST = ' ØVRIGE';                       
                                                                        
            DETLINX.SIDE(1).ANTAL1 = TABBK(I).TVANTAL1;                 
            DETLINX.SIDE(1).ANTAL2 = TABBK(I).TVANTAL2;                 
            DETLINX.SIDE(1).ANTAL3 = TABBK(I).TVANTAL3;                 
                                                                        
            IF TABBK(I+25).TVANTAL1 ^= 0                                
            THEN                                                        
               DO;                                                      
                  IF TABBK(I+25).BENYT < 100                            
                  THEN                                                  
                     DETLINX.SIDE(2).TEKST = '  ' !! TABBK(I+25).BENYT; 
                  ELSE                                                  
                     DETLINX.SIDE(2).TEKST = ' ØVRIGE';                 
                  DETLINX.SIDE(2).ANTAL1 = TABBK(I+25).TVANTAL1;        
                  DETLINX.SIDE(2).ANTAL2 = TABBK(I+25).TVANTAL2;        
                  DETLINX.SIDE(2).ANTAL3 = TABBK(I+25).TVANTAL3;        
               END;                                                     
            ELSE                                                        
               DO;                                                      
                  DETLINX.SIDE(2).TEKST  = '';                          
                  DETLINX.SIDE(2).ANTAL1 = 0;                           
                  DETLINX.SIDE(2).ANTAL2 = 0;                           
                  DETLINX.SIDE(2).ANTAL3 = 0;                           
               END;                                                     
                                                                        
            IF I < 25                                                   
            THEN                                                        
               DETLINX.CCA = ZZWS2;                                     
            ELSE                                                        
               DETLINX.CCA = ZZWS0;                                     
                                                                        
            CALL ZZ20300 (DETLINX,LISTE_ID);                            
                                                                        
         END;                                                           
                                                                        
 END STATISTIK_PR_BENYT;                                                
                                                                        
 /*********************************************************************/
 /*      UDSKRIV STATISTIK OVER ANTAL EJERE PR. BENYTTELSESKODE       */
 /*      MEN KUN HVIS BBR-ANVENDELSESKODE ER LIG 510 (SOMMERHUSE)     */
 /*********************************************************************/
 STATISTIK_PR_BENYT_ANV_510:                                            
         PROC;                                                          
                                                                        
         OVERLINZ.CCA = ZZIK1;                                          
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINX.CCA = ZZWS2;                                          
         OVERLINX.DATO = UDDATO;                                        
         CALL ZZ20300(OVERLINX,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS1;                                          
         OVERLINZ.TEKST = (35)' ' !!                                    
         'STATISTIK OVER ANTAL EJERE FORDELT PÅ BENYTTELSESKODE';       
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS2;                                          
         OVERLINZ.TEKST = (35)' ' !!                                    
         'FOR EJENDOMME MED BBR-ANVENDELSESKODE = 510 (SOMMERHUSE)';    
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS1;                                          
         OVERLINZ.TEKST = 'BENYTTEL-    ANTAL EJERE   HERAF BEREG-  HERA
 F ERKLÆR-            BENYTTEL-    ANTAL EJERE   HERAF BEREG-  HERAF ERK
 LÆR-';                                                                 
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS2;                                          
         OVERLINZ.TEKST = 'SESKODE             IALT   NET FOR 1999  BARE
  I 2000              SESKODE             IALT   NET FOR 1999  ' !!     
         'BARE I 2000';                                                 
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
                                                                        
         TABBK = '';                                                    
                                                                        
         K = 0;                                                         
                                                                        
         DO I = 1 TO 100 WHILE (K < 50);                                
                                                                        
            IF TAB_ANV510(I).TVIALT ^= 0                                
            THEN                                                        
               DO;                                                      
                  K = K + 1;                                            
                  TABBK(K).BENYT = I;                                   
                  TABBK(K).TVANTAL1 = TAB_ANV510(I).TVIALT;             
                  TABBK(K).TVANTAL2 = TAB_ANV510(I).TVLEJE1999;         
                  TABBK(K).TVANTAL3 = TAB_ANV510(I).TVERKLÆR;           
               END;                                                     
                                                                        
         END;                                                           
                                                                        
         IF K = 0          /* SIKKERHEDS-TEST - MÅ IKKE VÆRE OPFYLDT */ 
         THEN                                                           
            RETURN;                                                     
                                                                        
         DO I = 1 TO 25 WHILE (TABBK(I).TVANTAL1 ^= 0);                 
                                                                        
            DETLINX = '';                                               
                                                                        
            IF TABBK(I).BENYT < 100                                     
            THEN                                                        
               DETLINX.SIDE(1).TEKST = '  ' !! TABBK(I).BENYT;          
            ELSE                                                        
               DETLINX.SIDE(1).TEKST = ' ØVRIGE';                       
                                                                        
            DETLINX.SIDE(1).ANTAL1 = TABBK(I).TVANTAL1;                 
            DETLINX.SIDE(1).ANTAL2 = TABBK(I).TVANTAL2;                 
            DETLINX.SIDE(1).ANTAL3 = TABBK(I).TVANTAL3;                 
                                                                        
            IF TABBK(I+25).TVANTAL1 ^= 0                                
            THEN                                                        
               DO;                                                      
                  IF TABBK(I+25).BENYT < 100                            
                  THEN                                                  
                     DETLINX.SIDE(2).TEKST = '  ' !! TABBK(I+25).BENYT; 
                  ELSE                                                  
                     DETLINX.SIDE(2).TEKST = ' ØVRIGE';                 
                  DETLINX.SIDE(2).ANTAL1 = TABBK(I+25).TVANTAL1;        
                  DETLINX.SIDE(2).ANTAL2 = TABBK(I+25).TVANTAL2;        
                  DETLINX.SIDE(2).ANTAL3 = TABBK(I+25).TVANTAL3;        
               END;                                                     
            ELSE                                                        
               DO;                                                      
                  DETLINX.SIDE(2).TEKST  = '';                          
                  DETLINX.SIDE(2).ANTAL1 = 0;                           
                  DETLINX.SIDE(2).ANTAL2 = 0;                           
                  DETLINX.SIDE(2).ANTAL3 = 0;                           
               END;                                                     
                                                                        
            IF I < 25                                                   
            THEN                                                        
               DETLINX.CCA = ZZWS2;                                     
            ELSE                                                        
               DETLINX.CCA = ZZWS0;                                     
                                                                        
            CALL ZZ20300 (DETLINX,LISTE_ID);                            
                                                                        
         END;                                                           
                                                                        
 END STATISTIK_PR_BENYT_ANV_510;                                        
                                                                        
 /*********************************************************************/
 /*      UDSKRIV STATISTIK OVER ANTAL EJERE PR. BBR-ANVENDELSESKODE   */
 /*      INDERFOR HVER BENYTTELSESKODE                                */
 /*********************************************************************/
 STATISTIK_PR_ANV_PR_BENYT:                                             
         PROC;                                                          
                                                                        
         DO I = 1 TO 100;                                               
                                                                        
            IF TAB_BK(I).ANTAL ^= 0                                     
            THEN                                                        
               CALL SKRIV_PR_ANV_PR_BENYT;                              
                                                                        
         END;                                                           
                                                                        
                                                                        
 SKRIV_PR_ANV_PR_BENYT:                                                 
         PROC;                                                          
                                                                        
         DETLINX = '';                                                  
                                                                        
         IF I < 100                                                     
         THEN                                                           
            HJBENYTP = I;                                               
         ELSE                                                           
            HJ_BENYT = 'ØVRIGE';                                        
                                                                        
         CALL DROP_EJ_BRUGT_ANV;                                        
                                                                        
         CALL OVERSKRIFT_PR_BENYT;                                      
                                                                        
         DO K = 1 TO 25 WHILE (TAB_BK(I).TAB_ANV(K).TVIALT ^= 0);       
                                                                        
            IF TAB_BK(I).TAB_ANV(K).ANVKODE ^= '999'                    
            THEN                                                        
               DETLINX.SIDE(1).TEKST = '  ' !!                          
               TAB_BK(I).TAB_ANV(K).ANVKODE;                            
            ELSE                                                        
               DETLINX.SIDE(1).TEKST = ' ØVRIGE';                       
                                                                        
            DETLINX.SIDE(1).ANTAL1 =                                    
            TAB_BK(I).TAB_ANV(K).TVIALT;                                
            DETLINX.SIDE(1).ANTAL2 =                                    
            TAB_BK(I).TAB_ANV(K).TVLEJE1999;                            
            DETLINX.SIDE(1).ANTAL3 =                                    
            TAB_BK(I).TAB_ANV(K).TVERKLÆR;                              
                                                                        
            IF TAB_BK(I).TAB_ANV(K+25).TVIALT ^= 0                      
            THEN                                                        
               DO;                                                      
                  IF TAB_BK(I).TAB_ANV(K+25).ANVKODE ^= '999'           
                  THEN                                                  
                     DETLINX.SIDE(2).TEKST = '  ' !!                    
                     TAB_BK(I).TAB_ANV(K+25).ANVKODE;                   
                  ELSE                                                  
                     DETLINX.SIDE(2).TEKST = ' ØVRIGE';                 
                  DETLINX.SIDE(2).ANTAL1 =                              
                  TAB_BK(I).TAB_ANV(K+25).TVIALT;                       
                  DETLINX.SIDE(2).ANTAL2 =                              
                  TAB_BK(I).TAB_ANV(K+25).TVLEJE1999;                   
                  DETLINX.SIDE(2).ANTAL3 =                              
                  TAB_BK(I).TAB_ANV(K+25).TVERKLÆR;                     
               END;                                                     
            ELSE                                                        
               DO;                                                      
                  DETLINX.SIDE(2).TEKST  = '';                          
                  DETLINX.SIDE(2).ANTAL1 = 0;                           
                  DETLINX.SIDE(2).ANTAL2 = 0;                           
                  DETLINX.SIDE(2).ANTAL3 = 0;                           
               END;                                                     
                                                                        
            IF K < 25                                                   
            THEN                                                        
               DETLINX.CCA = ZZWS2;                                     
            ELSE                                                        
               DETLINX.CCA = ZZWS0;                                     
                                                                        
            CALL ZZ20300 (DETLINX,LISTE_ID);                            
                                                                        
         END;                                                           
                                                                        
 END SKRIV_PR_ANV_PR_BENYT;                                             
                                                                        
                                                                        
 OVERSKRIFT_PR_BENYT:                                                   
         PROC;                                                          
                                                                        
         OVERLINZ.CCA = ZZIK1;                                          
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINX.CCA = ZZWS2;                                          
         OVERLINX.DATO = UDDATO;                                        
         CALL ZZ20300(OVERLINX,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS3;                                          
         OVERLINZ.TEKST = (30)' ' !! 'STATISTIK OVER ANTAL EJERE FOR EJE
 NDOMME MED BENYTTELSESKODE ' !! HJ_BENYT;                              
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS1;                                          
         OVERLINZ.TEKST = 'ANVENDEL-    ANTAL EJERE   HERAF BEREG-  HERA
 F ERKLÆR-            ANVENDEL-    ANTAL EJERE   HERAF BEREG-  HERAF ERK
 LÆR-';                                                                 
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
         OVERLINZ.CCA = ZZWS2;                                          
         OVERLINZ.TEKST = 'SESKODE             IALT   NET FOR 1999  BARE
  I 2000              SESKODE             IALT   NET FOR 1999  ' !!     
         'BARE I 2000';                                                 
         CALL ZZ20300(OVERLINZ,LISTE_ID);                               
                                                                        
 END OVERSKRIFT_PR_BENYT;                                               
                                                                        
                                                                        
 DROP_EJ_BRUGT_ANV:                                                     
         PROC;                                                          
                                                                        
         HJTAB_ANV(*) = '';                                             
         N = 0;                                                         
                                                                        
         DO K = 1 TO 50 WHILE (N < 50);                                 
            IF TAB_BK(I).TAB_ANV(K).TVIALT ^= 0                         
            THEN                                                        
               DO;                                                      
                  N = N + 1;                                            
                  HJTAB_ANV(N).ANVKODE =                                
                  TAB_BK(I).TAB_ANV(K).ANVKODE;                         
                  HJTAB_ANV(N).TVIALT =                                 
                  TAB_BK(I).TAB_ANV(K).TVIALT;                          
                  HJTAB_ANV(N).TVLEJE1999 =                             
                  TAB_BK(I).TAB_ANV(K).TVLEJE1999;                      
                  HJTAB_ANV(N).TVERKLÆR =                               
                  TAB_BK(I).TAB_ANV(K).TVERKLÆR;                        
               END;                                                     
         END;                                                           
                                                                        
         DO K = 1 TO 50;                                                
            TAB_BK(I).TAB_ANV(K).ANVKODE =                              
            HJTAB_ANV(K).ANVKODE;                                       
            TAB_BK(I).TAB_ANV(K).TVIALT =                               
            HJTAB_ANV(K).TVIALT;                                        
            TAB_BK(I).TAB_ANV(K).TVLEJE1999 =                           
            HJTAB_ANV(K).TVLEJE1999;                                    
            TAB_BK(I).TAB_ANV(K).TVERKLÆR =                             
            HJTAB_ANV(K).TVERKLÆR;                                      
         END;                                                           
                                                                        
 END DROP_EJ_BRUGT_ANV;                                                 
                                                                        
                                                                        
 END STATISTIK_PR_ANV_PR_BENYT;                                         
