 /*********************************************************************/
 /*                                                                   */
 /*                     B H 6 0 1 9 1 M                               */
 /*                                                                   */
 /* MACRO TIL BEREGNING AF NETTORESULTAT I ESKEMA SOM P.T. BENYTTES I */
 /* FØLGENDE PROGRAMMER:                                              */
 /*                                                                   */
 /*          BH60100 ORDINÆR ESKEMA-LEJEVÆRDIBEREGNING                */
 /*                                                                   */
 /*********************************************************************/
 NETTORESULTAT:                                                         
         PROC;                                                          
 DCL     ANT_VÆRDIER FIXED (5);                                         
         IF BH601.CINVPNR ^= '0'          /* KUN 'VALIDE' PERSONNUMRE */
         THEN                             /* SKAL EVT. BEREGNES       */
            RETURN;                                                     
         SELECT(BH601.CBENYT);                                          
           WHEN('01','02','05','08','09','17','21', /*BENYTTELSESKODER*/
                '22','26','27','28','29','41','42', /*SOM MÅSKE SKAL  */
                '45','48','49','70','71');          /*BEREGNES        */
           OTHERWISE                                                    
               RETURN;                                                  
         END;                                                           
         /* HEREFTER FINDES EJENDOMME SOM SKAL BETRAGTES SOM ERKLÆ-   */
         /* RINGSEJENDOMME MED NETTORESULTAT SAT TIL 0 OG KOMPONENT-  */
         /* KODE (TIL SLS) SAT LIG 2 (PERSONLIG INDKOMST)             */
         IF BH601.CUDLEJET   = '1'  ! /* LEJEVÆRDIKODE 7, EJ SOLGT EJL*/
            BH601.CUDLEJNING = '1'  ! /* BK 02,22,42+LEJL=2, LEJL>2   */
            BH601.CBENYT     = '17' ! /* UBEBYGGET LANDBRUGSLOD       */
            BH601.CBENYT     = '49'   /* AREAL M BYGNING PÅ FREM GRUND*/
         THEN                                                           
            DO;                                                         
               BH601.CERKLÆR = 1;                                       
               BH601.CKOMPONEN = '2';                                   
               RETURN;                                                  
            END;                                                        
         /* HEREFTER FINDES EJENDOMME SOM SKAL BETRAGTES SOM ERKLÆ-   */
         /* RINGSEJENDOMME MED NETTORESULTAT SAT TIL 0 OG KOMPONENT-  */
         /* KODE (TIL SLS) SAT LIG 3 (I K K E  PERSONLIG INDKOMST)    */
         IF BH601.CLEJE      = '6'  ! /* LEJEVÆRDIKODE 6              */
            BH601.CEJEV      = '5'  ! /* EJENDOM UNDER OPFØRSEL       */
            BH601.CBENYT     = '09' ! /* UBEBYGGET GRUND              */
            BH601.CBENYT     = '70' ! /* NYOPSTÅET EJENDOM            */
            BH601.CBENYT     = '71'   /* NYOPSTÅET EJERLEJLIGHED      */
         THEN                                                           
            DO;                                                         
               BH601.CERKLÆR = 1;                                       
               BH601.CKOMPONEN = '3';                                   
               RETURN;                                                  
            END;                                                        
 /*      HVILKE UNDTAGELSER ER DER FOR BEREGNING AF NETTORESULTAT     */
         IF BH601.BLEJE1 = 0 &              /*ALTID UNDTAGELSE NÅR DER*/
            BH601.BLEJE2 = 0                /*IKKE ER BEREGNET LEJE-  */
         THEN                               /*VÆRDI                   */
            RETURN;                                                     
         IF BH601.CFRED = '1'               /*UNDTAGELSE FREDET EJEND.*/
         THEN                                                           
            DO;                                                         
               IF BH601.CBENYT = '21' !                                 
                  BH601.CBENYT = '22' !                                 
                  BH601.CBENYT = '26' !                                 
                  BH601.CBENYT = '27' !                                 
                  BH601.CBENYT = '28' !                                 
                  BH601.CBENYT = '29'                                   
               THEN;                                                    
                   /* FOR EJERLIGHEDER KAN VI GODT BEREGNE (-STD.FRD) */
               ELSE                                                     
                  RETURN;                                               
            END;                                                        
         IF BH601.FEJER < 2 &              /* HVIS KUN EN EJER, MEN  */ 
           (BH601.GANE > 0  &              /* EJERANDEL IKKE ER 100% */ 
            BH601.GANE < 10000)                                         
         THEN                                                           
            RETURN;                                                     
         ANT_VÆRDIER = BH601.ANT_FOR_4 +                                
                       BH601.ANT_FOR_5 +                                
                       BH601.ANT_FOR_6;                                 
         SELECT ( BH601.CBENYT );                                       
            WHEN ('01','41')                     /* BEBOELSE          */
               DO;                               /* EN_FAMILIEHUSE    */
                  IF BH601.FLEJL < 2 &                                  
                     ANT_VÆRDIER = 0 &                                  
                     BH601.BSTDF > 0                                    
                  THEN;  /*** SÅ SKAL DER BEREGNES ***/                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('02','42')                     /* BEBOELSE          */
               DO;                               /* BLANDEDE EJENDOMME*/
                  IF BH601.FLEJL < 2 &                                  
                     (ANT_VÆRDIER = 1 & BH601.ANT_FOR_4 = 0) &          
                     BH601.EJEBOL(1).BEJEBOL > 0 &                      
                     BH601.BSTDF > 0                                    
                  THEN;  /*** SÅ SKAL DER BEREGNES ***/                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('22')                          /* EJERLEJLIGHED     */
               DO;                               /* BLANDEDE EJENDOMME*/
                  IF BH601.FLEJL < 2 &           /* NB. DER BEREGNES  */
                     (ANT_VÆRDIER = 1 &          /* IKKE STD.FRADRAG  */
                      BH601.ANT_FOR_4 = 0) &     /* FOR EJERLEJLIGHED.*/
                     BH601.EJEBOL(1).BEJEBOL > 0                        
                  THEN;  /*** SÅ SKAL DER BEREGNES ***/                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('05')                          /* LANDBRUG          */
               DO;                                                      
                  IF BH601.FLEJL < 2   &                                
                     (ANT_VÆRDIER = 1 & BH601.ANT_FOR_4 = 1) &          
                     BH601.EJEBOL(1).BEJEBOL > 0 &                      
                     BH601.BSTDF > 0                                    
                  THEN;  /*** SÅ SKAL DER BEREGNES ***/                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('08')                     /* SOMMERHUS              */
               DO;                                                      
                  IF ANT_VÆRDIER = 0 &                                  
                     BH601.BSTDF  > 0                                   
                  THEN;  /*** SÅ SKAL DER BEREGNES ***/                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('48')                     /* SOMMERHUS PÅ           */
               DO;                          /* FREMMED GRUND.         */
                  IF ANT_VÆRDIER = 0 &                                  
                     BH601.BSTDF  > 0                                   
                  THEN;                                                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('45')                                                 
               DO;                                                      
                  IF BH601.FLEJL = 1  &                                 
                     ANT_VÆRDIER = 0 &                                  
                     BH601.BSTDF  > 0                                   
                  THEN;                                                 
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            WHEN ('21','26','27','28','29') /* EJERLEJLIGHED,BEBOELSE */
               DO;                                                      
                  IF ANT_VÆRDIER = 0                                    
                  THEN;                   /*** SÅ SKAL DER BEREGNES ***/
                  ELSE                                                  
                     RETURN;                                            
               END;                                                     
            OTHERWISE                                                   
               RETURN;                                                  
         END;                                                           
         IF BH601.BLEJE2 > 0                                            
         THEN                                                           
            BH601.BNETTO = BH601.BLEJE2 - BH601.BSTDF;                  
         ELSE                                                           
            BH601.BNETTO = BH601.BLEJE1 - BH601.BSTDF;                  
         BH601.CERKLÆR = 1;                                             
         BH601.CKOMPONEN = '1';              /* KOMPONENTKODE TIL SLS */
 END NETTORESULTAT;                                                     
