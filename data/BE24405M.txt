 /********************************************************************/ 
 /*  MACRO BE24405M : konverterer                                    */ 
 /*  BRUGES AF PROGRAMMERNE                                          */ 
 /*  -  BE24400                                                      */ 
 /*  -  BE24600                                                      */ 
 /*                                                                  */ 
 /*  Rettet: LTJ 02. november 2023                                   */ 
 /*          Ny udgave af macro BQ24405M til BE24405M ifm. EVS Ny    */ 
 /*          lov modtag individ 132                                  */ 
 /********************************************************************/ 
 /*-------------------------------------------------------------------*/
 /* Makro der konverterer fra char 04 til BIN FIXED 15                */
 /* Macro : BE24405M                                                  */
 /*-------------------------------------------------------------------*/
 KONV_CH4_BF15: PROC (TAL_CHAR)                                         
                             RETURNS (BIN FIXED (15));                  
 DCL     TAL_CHAR      CHAR (04);                                       
 DCL     TAL_CHARG     CHAR (04);                                       
 DCL     TAL_PIC       PIC '9999' DEF TAL_CHAR;                         
 DCL     TAL_BINFIXED  BIN FIXED (15);                                  
                                                                        
         TAL_BINFIXED = 0;                                              
         TAL_CHARG = ZM_RENS_STR((TAL_CHAR));                           
         IF ZM90002M.LGD > 0                                            
         THEN                                                           
            DO;                                                         
                TAL_CHAR = '';                                          
                SUBSTR(TAL_CHAR, 5-ZM90002M.LGD, ZM90002M.LGD) =        
                SUBSTR(TAL_CHARG, 1, ZM90002M.LGD);                     
                TAL_BINFIXED = TAL_PIC;                                 
            END;                                                        
         RETURN (TAL_BINFIXED);                                         
                                                                        
 END KONV_CH4_BF15;                                                     
 /*-------------------------------------------------------------------*/
 /* Makro der konverterer fra char 03 til BIN FIXED 15                */
 /* Macro : BE24405M                                                  */
 /*-------------------------------------------------------------------*/
 KONV_CH3_BF15: PROC (TAL_CHAR)                                         
                             RETURNS (BIN FIXED (15));                  
 DCL     TAL_CHAR      CHAR (03);                                       
 DCL     TAL_CHARG     CHAR (03);                                       
 DCL     TAL_PIC       PIC '999' DEF TAL_CHAR;                          
 DCL     TAL_BINFIXED  BIN FIXED (15);                                  
                                                                        
         TAL_BINFIXED = 0;                                              
         TAL_CHARG = ZM_RENS_STR((TAL_CHAR));                           
         IF ZM90002M.LGD > 0                                            
         THEN                                                           
            DO;                                                         
                TAL_CHAR = '';                                          
                SUBSTR(TAL_CHAR, 4-ZM90002M.LGD, ZM90002M.LGD) =        
                SUBSTR(TAL_CHARG, 1, ZM90002M.LGD);                     
                TAL_BINFIXED = TAL_PIC;                                 
            END;                                                        
         RETURN (TAL_BINFIXED);                                         
 END KONV_CH3_BF15;                                                     
                                                                        
