 BH30100: PROCEDURE OPTIONS (MAIN);                                     
 /**********************************************************************
 * PROJEKT:     EVS FORSKUD/SLUT                                       *
 * PROGRAMNAVN: BH30100.                                               *
 * PROGRAMTYPE: BATCH.                                                 *
 * FUNKTION:    PROGRAMMET UDTRÆKKER ALLE AKTIVE OG VALIDE EJENDOMME   *
 *              FRA SIDSTE EVS FORSKUD                                 *
 * PGMFORLØB:   1. ÅBEN EVS UDTRÆKSFIL.                                *
 *              2. DECLARE PERSONEJENDOMSOPL.                          *
 *              3. OPEN PERSONEJENDOMSOPL.                             *
 *              4. LÆS/FETCH RÆKKE PÅ PERSONTABEL.                     *
 *              5. BEHANDL DATA TIL FILSTRUKTUR.                       *
 *              6. SKRIV RÆKKE PÅ EVS FIL.                             *
 *              7. LUK PERSONEJENDOMSOPL.                              *
 *              8. LUK EVS UDTRÆKSFIL.                                 *
 *              9. SKRIV KONTROLLISTE.                                 *
 * INDDATA:     BS00500T - EVS EJENDOMSTABEL.                          *
 *              BS00600T - EVS PERSONTABEL.                            *
 * UDDATA:      BH30100O - UDTRÆK FRA EVS FORSKUD 2017 EXCL. KOMMUNE   *
 *                         999 (UDENLANDSKE EJENDOMME).                *
 *              BH30110O - UDTRÆK FRA EVS FORSKUD 2017  K U N  KOMMUNE *
 *                         999 (UDENLANDSKE EJENDOMME).                *
 *              BH30101Y - KONTROLLISTE.                               *
 * KONSTRUKTØR: THOMAS FLINDT         THF, PUS/T&S BRØNDBY 16.07.2001. *
 ***********************************************************************
 * ÆNDRINGSLOG: HANS E KJELDSEN       HKS, PUS/T&S BRØNDBY 01.11.2001. *
 ***********************************************************************
 *              OLUF MØRK.            OMO, PUS/T&S BRØNDBY 20.06.2002. *
 *              ÅRSRULNING.                                            *
 ***********************************************************************
 *              ESBEN BRODERSEN       ESB, PUS/T&S BRØNDBY 30.07.2002. *
 *              TILRETTET TIL FORSKUD  2003                            *
 ***********************************************************************
 *              ESBEN BRODERSEN       ESB, LSU/T&S BRØNDBY 14.11.2002. *
 *              TILRETTET TIL EVS-SLUT 2002                            *
 ***********************************************************************
 *              ESBEN BRODERSEN       ESB, LSU/T&S BALLERUP 30.07.2003.*
 *              TILRETTET TIL FORSKUD  2004                            *
 ***********************************************************************
 *              BO SCHMIDT            BOB, LSU/T&S BALLERUP 09.06.2004.*
 *              TILRETTET TIL FORSKUD  2006                            *
 ***********************************************************************
 * FORSKUD06    SUSANNE KROGH VILLUMSEN  SKV   T&S BALLERUP 25.05.2005.*
 *              TILRETTET TIL FORSKUD  2006                            *
 ********************************************************************** 
 * *SLUT05*     SUSANNE KROGH VILLUMSEN SKV,  T&S BALLERUP 07.11.2005. *
 *             -PROGRAMMET ER TILRETTET TIL SLUT 2005                  *
 *              KONVERTERING AF ÆRØ KOMMUNE.  KMNR 443 OG 492  TIL 443 *
 ********************************************************************** 
 * FORSKUD07    BO SCHMIDT               BOB   T&S BALLERUP 11.05.2006.*
 *              TILRETTET TIL FORSKUD  2007                            *
 ********************************************************************** 
 * FORSKUD08    BO SCHMIDT               BOB   T&S BALLERUP 23.05.2007.*
 *              TILRETTET TIL FORSKUD  2008                            *
 ********************************************************************** 
 * FORSKUD09    BO SCHMIDT               BOB   T&S BALLERUP 24.04.2008.*
 *              TILRETTET TIL FORSKUD  2009                            *
 ********************************************************************** 
 * FORSKUD10    GERD HOLM-PEDERSEN       GEH   PKF/PKA      07.04.2009.*
 *              TILRETTET TIL FORSKUD  2010                            *
 *              NYE FELTER, BBERGRL OG BBER2FAM         KRAVNR.#06-02  *
 *              NYT FELT    CEKSEMP.                    KRAVNR.#09-04  *
 ********************************************************************** 
 * FORSKUD11    GERD HOLM-PEDERSEN       GEH   PKF/PKA      28.05.2010.*
 *              TILRETTET TIL FORSKUD  2011                            *
 ********************************************************************** 
 * FORSKUD12    GERD HOLM-PEDERSEN       GEH   PR           16.05.2011.*
 *              TILRETTET TIL FORSKUD  2012                            *
 ********************************************************************** 
 * FORSKUD13    ESBEN BRODERSEN          ESB   PR           15.05.2012.*
 *              TILRETTET TIL FORSKUD  2013                            *
 *              DEFECT #521 BUDLSKC FELT 910 HENTES FRA TABEL BS00600T *
 ********************************************************************** 
 * FORSKUD14    ESBEN BRODERSEN          ESB   PR           21.05.2013.*
 *              TILRETTET TIL FORSKUD  2014                            *
 ********************************************************************** 
 * FORSKUD15    JØRGEN SAUGMANN          QQS   PR           27.06.2014.*
 *              TILRETTET TIL FORSKUD  2015                            *
 ***********************************************************************
 * FORSKUD16    JENS HOLGER KJÆR         JNK                08.06.2015.*
 *              ÅRSRULLET TIL FORSKUD  2016                            *
 ***********************************************************************
 * SLUT15       ESBEN BRODERSEN        Z8QEB                09.03.2015 *
 *              INDFØRT ÅRTALS/DATO INCLUDE BH65300M  #01              *
 ***********************************************************************
 * FORSKUD17    ESBEN BRODERSEN          QEB   PR           08.06.2016.*
 *              TILRETTET TIL FORSKUD  2017                            *
 *              KS30-01 justeret behandling af CSLET                   *
 *              RETTELSE DEN 19.09.2016 CSLET MED I FETCH #01          *
 ***********************************************************************
 * FORSKUD18    ESBEN BRODERSEN          QEB   PR           05.06.2017.*
 *              KUN KOMMENTARER OG KOMPILERET  TIL FORSKUD  2018       *
 ***********************************************************************
 * SLUT18       ESBEN BRODERSEN        Z6EBD                14.09.2018 *
 *              2-FAMILIE BOLIGER 02-23                                *
 *              felt EENHEDLBNR er indført i output struktur           *
 *              BH30100N men ikke i tabellerne det skal først ske      *
 *              til Forskud 2020 så EENHEDLBNR sættes til 0            *
 ***********************************************************************
 * FORSKUD20    ESBEN BRODERSEN        Z6EBD                16.04.2019 *
 * SLUT19       NYT PROGRAM BH40100 OPRETTET SOM KOPI AF BH30100       *
 *              LÆSER FRA DE NYE FORSKUDS TABELLER BS00500 OG BS00600T *
 *              SOM ER INFØRT FOR AT UNDERSTØTTE 2FAMHUSE              *
 *              Programmet skal først bruges i slut 2020/Forskud 2021  *
 * SLUT 2019    ESBEN BRODERSEN Z6EBD BALLERUP 22.03.2019              *
 *              SLETTEDE DANSKE EJERSKABER CSLET = 1 SKAL SKRIVES SÅ   *
 *              DE KAN BRUGES TIL FJERNE EVS SLUT OPLYSNINGER          *
 *              I BH317000L KS02-34A                                   *
 * FORSKUD21    MERGE AF PROGRAM BH30100 OG BH40100                    *
 *              Defect 425 der skal skrives en record pr ENHED         *
 * FORSKUD22    Per Brunk                                   28.01.2021 *
 *              MP Nye felter                                          *
 * SLUT 2021    Z6SEP                                       Marts 2021 *
 *              Rettet BH65300M til BH55300M                           *
 * FORSKUD22    Per Brunk                                   12.08.2021 *
 *              KS46 og MP Nye felter                                  *
 * SLUT 2024    Jan Erik Jensen (Z6XJY)                     21.10.2024 *
 *              #1888922 Konvertering af udenlandske ejendomsnumre:    *
 *              * Fikset produktionsfejl med at sidst indlæste record  *
 *                ikke blev skrevet til output datasettene.            *
 *              * Rettet logning af SQL kode i abend meddelelse, hvor  *
 *                fortegnet fejlagtigt blev fjernet.                   *
 *              * Udkommenteret kald til CLOSE_PERSONEJENDOMSOPL fra   *
 *                proceduren SQL_FEJL pga. risiko for uendeligt loop.  *
 *              * Implementeret kode i proceduren RET_UDENL_EJDNR til  *
 *                at konvertere udenlandske ejendomsnumre via kald     *
 *                til procedurer i makroen BE83000M.                   *
 *                                                                     *
 **********************************************************************/
                                                                        
 DEFAULT RANGE (*) STATIC; /* LAGERTYPE AHT. KALD AF EKSTERNE MODULER */
                                                                        
 DCL     COPYRIGHT      CHAR (30) INIT ('(C) KMD A/S 2017');            
                                                                        
 /*********************************************************************/
 /* DECLARE AF DB2                                                    */
 /*********************************************************************/
                                                                        
         EXEC SQL INCLUDE BS00500T;        /* EVS EJENDOMSTABELLEN */   
         EXEC SQL INCLUDE BS00600T;        /* EVS PERSONTABELLEN   */   
         EXEC SQL INCLUDE BN03300T;        /* LANDEKODE TABELLEN   */   
                                                                        
         EXEC SQL INCLUDE BE83000T;        /* UDL.EJD. MAPNING     */   
         EXEC SQL INCLUDE BE83100T;        /* UDL.EJD. LOGNING     */   
                                                                        
         EXEC SQL INCLUDE SQLCA;           /* SQL KOMMUNIKATIONSAREAL */
                                                                        
 /**********************************************************************
 * DECLARE AF ABEND RUTINE                                             *
 **********************************************************************/
                                                                        
 DCL     ZS30101        ENTRY;                                          
 DCL     ZS67000        ENTRY;                                          
 DCL     ZS61900        ENTRY;                        /* KST/SSI INFO */
 DCL     ZS62500        ENTRY OPTIONS(INTER ASM);    /* SKAF JOB INFO */
                                                                        
 /*********************************************************************/
 /* DECLARE AF DIVERSE                                                */
 /*********************************************************************/
                                                                        
 DCL     HJ_DCPRN       CHAR (10);                                      
 DCL     HJ_DCPRN_PIC   PIC  '(10)9' BASED(ADDR(HJ_DCPRN));             
 DCL     HJ_EKOMNR      CHAR (03);                                      
 DCL     HJ_EEJDNR      CHAR (06);                                      
 DCL     EKOMEEJD_NR    CHAR (09);                                      
 DCL     OK             CHAR (01)        INIT('J');                     
 DCL     FEJLTEKST      CHAR (20)        INIT(' ');                     
 DCL     ABENDMEDD      CHAR (56)        INIT(' ');                     
 DCL     GEM_EENHEDLBNR BIN FIXED (15) INIT(0);                         
 DCL     GEM_EEJDNR     BIN FIXED (31) INIT(0);                         
 DCL     GEM_DCPRN      FIXED (11) INIT(0);                             
 DCL     SW_FDAGEJ_NUL  BIT(01)    INIT('0'B);                          
 DCL     FETCH_SQLKODE  FIXED BIN(15)    INIT(0);                       
                                                                        
 DCL     DT             CHAR (6);                                       
 DCL     1 DAT          BASED(ADDR(DT)),                                
           2 ÅR         PIC   '99',                                     
           2 MD         PIC   '99',                                     
           2 DAG        PIC   '99';                                     
                                                                        
 DCL     HJ_DATOEN      PIC '(8)9';                                     
 DCL     1 HJ_DATO      BASED(ADDR(HJ_DATOEN)),                         
           2 AAR        PIC  '9999',                                    
           2 MD         PIC  '99',                                      
           2 DG         PIC  '99';                                      
                                                                        
 DCL     1 BH55300M,                             /*#01*/                
           %INCLUDE BH55300M;                    /* DATO OG ÅR MACRO */ 
                                                                        
 DCL     ZS625P1         CHAR (08); /* Jobnavn */                       
 DCL     ZS625P2         CHAR (16); /* Job step navn/procedure */       
 DCL     ZS625P3         CHAR (08); /* Job step program navn */         
 DCL     ZS625P4         CHAR (04); /* Account info pointer */          
                                                                        
 /*********************************************************************/
 /* DECLARE DATASÆT                                                   */
 /*********************************************************************/
                                                                        
 DCL     SYSPRINT FILE STREAM PRINT;                                    
 DCL     BH3010O FILE OUTPUT RECORD; /* EVS UDTRÆK EXCL. KOMMUNE 999 */ 
 DCL     BH3011O FILE OUTPUT RECORD; /* EVS UDTRÆK KUN   KOMMUNE 999 */ 
                                                                        
 /*********************************************************************/
 /* DECLARE STRUKTURER                                                */
 /*********************************************************************/
                                                                        
 DCL     1 UDTRÆK_FORS,                                                 
           %INCLUDE BH30100N;;                                          
                                                                        
 DCL     1 INDK_PERS,                                                   
           2 BNYMAN_I       BIN FIXED (15);                             
                                                                        
 /*********************************************************************/
 /* DECLARE AF BUILTIN                                                */
 /*********************************************************************/
                                                                        
 DCL     (ADDR,DATE,VERIFY,NULL,MOD,SUBSTR,PLIDUMP) BUILTIN;            
                                                                        
 /*********************************************************************/
 /* DECLARE AF TÆLLERE                                                */
 /*********************************************************************/
                                                                        
 DCL     ANTLÆS_PERSON   BIN FIXED (31) INIT(0);/* LÆSTE PERSONTABEL  */
 DCL     ANTSKRIV_PERSON BIN FIXED (31) INIT(0);/* SKREVET UDTRÆKSFIL */
 DCL     ANTSKRIV_ØVR    BIN FIXED (31) INIT(0);/* SKREVET EXCL UDLAND*/
 DCL     ANTSKRIV_UDL    BIN FIXED (31) INIT(0);/* SKREVET KUN  UDLAND*/
 DCL     ANTCEJBEVS_9    BIN FIXED (31) INIT(0);/* CEJBEVS=9(SLETTET) */
 DCL     ANTCSLET_1      BIN FIXED (31) INIT(0);/* CSLET=1(SLETTET)   */
 DCL     ANTEJENDOM_0    BIN FIXED (31) INIT(0);/* EEJDNR =0          */
 DCL     ANTEJENDOM      BIN FIXED (31) INIT(0);/* HJÆLPE FELT        */
 DCL     TV_SUMMERET      BIN FIXED (31) INIT(0);/* ANTAL SUMMERET    */
 DCL     TV_IKKE_SUMMERET BIN FIXED (31) INIT(0);/*ANTAL IKKE SUMMERET*/
 DCL     TV_STOR_FDAGIALT BIN FIXED (31) INIT(0);/*ANTAL FDAGIALT>360 */
                                                                        
 DCL     ANT_ÆA73_TJEKKET               BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_EJ_MAPPET             BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_MAPPET                BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_SLETTET               BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_SAMME                 BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_DUBLET                BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_OK                    BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_SKREVNE               BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_EJDNR_ÆNDRET          BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_EJDNR_UÆNDRET         BIN FIXED (31) INIT(0);         
 DCL     ANT_ÆA73_EJ_SKREVNE            BIN FIXED (31) INIT(0);         
                                                                        
 DCL     TFLAG            BIT(1)         INIT('0'B);                    
                                                                        
 /*********************************************************************/
 /* PARM KORT                                                         */
 /*********************************************************************/
  DCL     EOF_PARM         BIT (1) INIT ('0'B);                         
  DCL     PARMKORT         FILE RECORD INPUT;                           
  DCL     PARM_AR          CHAR  (80)  INIT (' ');                      
  DCL     PARM_MEDTAGET    BIT (1)       INIT ('0'B);                   
  DCL     PARM_FEJL        BIT (1)       INIT ('0'B);                   
                                                                        
  DCL     1 PARMLINIE  BASED (ADDR (PARM_AR) ),                         
            2 PARMSTART    CHAR      (02),                              
            2 PROGNAVN     CHAR      (07),                              
            2 KOMNR1       CHAR      (03),                              
            2 KOMNR2       CHAR      (03),                              
            2 KOMNR3       CHAR      (03),                              
            2 REST         CHAR      (62);                              
                                                                        
  DCL     PARMKOMNR1     BIN FIXED (15);                                
  DCL     PARMKOMNR2     BIN FIXED (15);                                
  DCL     PARMKOMNR3     BIN FIXED (15);                                
                                                                        
                                                                        
 /*********************************************************************/
 /* PRINTLINIER TIL SPOOL                                             */
 /*********************************************************************/
                                                                        
 DCL     LINIE           CHAR (133);                                    
 DCL     1 LIN           BASED(ADDR(LINIE)),                            
           2 CC          CHAR (1),                                      
           2 FIL1        CHAR (3),                                      
           2 TEKST       CHAR (56),                                     
           2 ANT         PIC  '---------9',                             
           2 FIL2        CHAR (63);                                     
 DCL     1 LIN2          BASED(ADDR(LINIE)),                            
           2 CC          CHAR (1),                                      
           2 FIL1        CHAR (21),                                     
           2 TEKST       CHAR (111);                                    
         %INCLUDE ZZ20301M;                                             
                                                                        
 /*********************************************************************/
 /* ON - CONDITIONS                                                   */
 /*********************************************************************/
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
                ON ERROR SYSTEM;                                        
                PUT SKIP LIST ('PROGRAMFEJL');                          
                CALL PLIDUMP  ('SBHO','MODUL BH30100');                 
            END;                                                        
                                                                        
 /*********************************************************************/
 /* HOUSEKEEPING                                                      */
 /*********************************************************************/
                                                                        
         PERSONEJENDOMSOPL = '';                                        
         EJENDOMSOPL = '';                                              
         UDTRÆK_FORS = '';                                              
         UDTRÆK_FORS.BFORSKAT_SW = -1;                                  
         DT = DATE;                                                     
                                                                        
         OPEN FILE (BH3010O) TITLE ('BH30100O');                        
         OPEN FILE (BH3011O) TITLE ('BH30110O');                        
                                                                        
         CALL ZZ20390('*OPEN','BH30101Y');       /* ÅBEN KONTROLLISTE */
                                                                        
         CALL ZS61900;                              /* KST/SSI INFO   */
                                                                        
         CALL ZS62500 (ZS625P1,                 /* SKAF JOB/STEP INFO */
                       ZS625P2,                                         
                       ZS625P3,                                         
                       ZS625P4);                                        
                                                                        
         CALL OPSTART_INIT;                               /* Parmkort */
                                                                        
 /*********************************************************************/
 /* PROCES                                                            */
 /*********************************************************************/
                                                                        
         CALL DECLARE_PERSONEJENDOMSOPL;                                
         CALL OPEN_PERSONEJENDOMSOPL;                                   
         CALL FETCH_PERSONEJENDOMSOPL;                                  
                                                                        
         SELECT (FETCH_SQLKODE);  /*GEMT SQLCODE FRA FETCH_PERSONEJ. */ 
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               GEM_EENHEDLBNR = PERSONEJENDOMSOPL.EENHEDLBNR;  /*D425*/ 
               GEM_EEJDNR     = PERSONEJENDOMSOPL.EEJDNR;               
               GEM_DCPRN      = PERSONEJENDOMSOPL.PERSONNUMMER;         
               DO WHILE (FETCH_SQLKODE = 0);                            
                  IF TFLAG                                              
                  THEN DO;                                              
                     PUT SKIP LIST('DINDKAAR     = '!!                  
                                   PERSONEJENDOMSOPL.DINDKAAR);         
                     PUT SKIP LIST('PERSONNUMMER = '!!                  
                                   PERSONEJENDOMSOPL.PERSONNUMMER);     
                     PUT SKIP LIST('EKOMNR       = '!!                  
                                   PERSONEJENDOMSOPL.EKOMNR);           
                     PUT SKIP LIST('EEJDNR       = '!!                  
                                   PERSONEJENDOMSOPL.EEJDNR);           
     /*D425*/        PUT SKIP LIST('EENHEDLBNR   = '!!                  
                                   PERSONEJENDOMSOPL.EENHEDLBNR);       
                     PUT SKIP LIST('EPLBNR        = '!!                 
                                   PERSONEJENDOMSOPL.EPLBNR);           
                     PUT SKIP LIST('IP DFRAGLD   = '!!                  
                                   PERSONEJENDOMSOPL.DFRAGLD);          
                  END;                                                  
                  CALL BEHANDL_OG_SKRIV;                                
                  CALL FETCH_PERSONEJENDOMSOPL;                         
               END;                                                     
                                                                        
               CALL SKRIV_PERSON;                                       
                                                                        
             END;                                                       
                                                                        
           WHEN (100)                                                   
               PUT SKIP LIST ('INGEN RÆKKER LÆST');                     
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'FETCH PERSON_CURSOR ';                     
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
         CALL AFSLUT;                                                   
                                                                        
 /*********************************************************************/
 /* OPEN CURSOR TIL LÆS AF PERSONTABEL BS00600T                RUTINE */
 /*********************************************************************/
 OPEN_PERSONEJENDOMSOPL: PROC;                                          
                                                                        
         EXEC SQL OPEN PERSON_CURSOR;                                   
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'OPEN PERSON_CURSOR';                         
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END OPEN_PERSONEJENDOMSOPL;                                            
 /*********************************************************************/
 /* CLOSE CURSOR TIL LÆS AF PERSONTABEL BS00600T               RUTINE */
 /*********************************************************************/
 CLOSE_PERSONEJENDOMSOPL: PROC;                                         
                                                                        
         EXEC SQL CLOSE PERSON_CURSOR;                                  
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST = 'CLOSE PERSON_CURSOR';                        
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END CLOSE_PERSONEJENDOMSOPL;                                           
 /*********************************************************************/
 /* BEHANDL OG SKRIV EVS OPLYSNINGER                           RUTINE */
 /*********************************************************************/
 BEHANDL_OG_SKRIV: PROC;                                                
                                                                        
         IF PERSONEJENDOMSOPL.EKOMNR ^= 999       /*FORSKUD09*/         
          & PERSONEJENDOMSOPL.CEJBEVS = '9'                             
         THEN                                                           
            DO;                                                         
               ANTCEJBEVS_9 = ANTCEJBEVS_9 + 1;                         
               RETURN;                                                  
            END;                                                        
                                                                        
         IF PERSONEJENDOMSOPL.EEJDNR = 0                                
         THEN                                                           
            DO;                                                         
               ANTEJENDOM_0 = ANTEJENDOM_0 + 1;                         
               RETURN;                                                  
            END;                                                        
                                                                        
         /* Ændret behandling i forbindelse med Forskud 2017     */     
         /* Der trækkes nu ud på CSLET = 1 men kun til optælling */     
         /* KS30-01                                              */     
         /* Defect 248 udlandske slettede skrives så de senere   */     
         /* kan afgører om data fra EVS SLUT/Forskud skal bruges */     
         /* Slut 2019 Danske med CSLET = 1 skal skrives          */     
         IF PERSONEJENDOMSOPL.CSLET = '1'                               
         THEN                                                           
            DO;                                                         
               ANTCSLET_1 = ANTCSLET_1 + 1;                             
            END;                                                        
                                                                        
         IF GEM_EENHEDLBNR ^= PERSONEJENDOMSOPL.EENHEDLBNR   /*D425*/   
          ! GEM_EEJDNR     ^= PERSONEJENDOMSOPL.EEJDNR                  
          ! GEM_DCPRN      ^= PERSONEJENDOMSOPL.PERSONNUMMER            
         THEN                                                           
           DO;                                                          
             CALL SKRIV_PERSON;                                         
                                                                        
             GEM_EENHEDLBNR = PERSONEJENDOMSOPL.EENHEDLBNR;  /*D425*/   
             GEM_EEJDNR     = PERSONEJENDOMSOPL.EEJDNR;                 
             GEM_DCPRN      = PERSONEJENDOMSOPL.PERSONNUMMER;           
                                                                        
             SW_FDAGEJ_NUL = '0'B;                                      
             UDTRÆK_FORS = '';                                          
             UDTRÆK_FORS.BFORSKAT_SW = -1;                              
             ANTEJENDOM = 0;                                            
           END;                                                         
                                                                        
         CALL OVERFØRDATA;                                              
                                                                        
 END BEHANDL_OG_SKRIV;                                                  
                                                                        
 /*********************************************************************/
 /* SKRIV_PERSON                                               RUTINE */
 /*********************************************************************/
 SKRIV_PERSON: PROC;                                                    
                                                                        
    IF ANTEJENDOM = 1                                                   
    THEN                                                                
       UDTRÆK_FORS.CEVSSUM = ' ';                                       
                                                                        
    IF SW_FDAGEJ_NUL = '1'B  & UDTRÆK_FORS.CEVSSUM = '1'                
    THEN                                                                
       UDTRÆK_FORS.CEVSSUM = '2'; /* TIL PERIODE OPDELING    */         
                                  /* ESB OG AAR EVS SLUT 2002*/         
                                                                        
    IF TFLAG                                                            
      THEN DO;                                                          
         PUT SKIP LIST('OP DFRAGLD   = '!!                              
                       UDTRÆK_FORS.DFRAGLD);                            
      END;                                                              
                                                                        
    IF UDTRÆK_FORS.EKOMNR ^= 999                                        
    THEN                                                                
       DO;                                                              
          ANTSKRIV_PERSON += 1;                                         
                                                                        
          WRITE FILE (BH3010O) FROM (UDTRÆK_FORS);                      
          ANTSKRIV_ØVR += 1;                                            
       END;                                                             
    ELSE                                                                
       DO;                                                              
          /* XJY 22.10.2024 ÆA73: Ret udenlandske ejendomsnumre.   */   
          /* Ved slettemarkerede ejendomsnumre skrives de ikke til */   
          /* output filen.                                         */   
          IF RET_UDENL_EJDNR (UDTRÆK_FORS.EKOMNR,                       
                              UDTRÆK_FORS.EEJDNR,                       
                              UDTRÆK_FORS.DCPRN) THEN                   
          DO;                                                           
             ANTSKRIV_PERSON += 1;                                      
                                                                        
             WRITE FILE (BH3011O) FROM (UDTRÆK_FORS);                   
             ANTSKRIV_UDL += 1;                                         
                                                                        
             ANT_ÆA73_SKREVNE += 1;                                     
          END;                                                          
          ELSE                                                          
          DO;                                                           
             ANT_ÆA73_EJ_SKREVNE += 1;                                  
          END;                                                          
       END;                                                             
                                                                        
       /* XJY 23.10.2024: Denne optælling er flyttet i forbindelse */   
       /* med rettelse af produktionsproblemet med, at den sidst   */   
       /* indlæste record ikke blev skrevet, så der også optælles  */   
       /* for den sidst læste record. Bemærk at feltet FDAGIALT    */   
       /* tilsyneladende er UDTRÆK_FORS.FDAGIALT.                  */   
       IF FDAGIALT > 360 THEN                                           
         TV_STOR_FDAGIALT = TV_STOR_FDAGIALT + 1;                       
                                                                        
 END SKRIV_PERSON;                                                      
                                                                        
 /*********************************************************************/
 /* Ret de udenlandske ejendomsnumre på baggrund af ændringsanmodning */
 /* ÆA73.                                                             */
 /*                                                                   */
 /* Proceduren returnerer en bit værdi som indikerer, om der skal     */
 /* skrives en record på output filen:                                */
 /* 1/true  = Der skal skrives en record                              */
 /* 0/false = Der skal ikke skrives en record, da mapningen er        */
 /*           slettemarkeret.                                         */
 /*********************************************************************/
 RET_UDENL_EJDNR: PROC (P_EKOMNR                                        
                       ,P_EEJDNR                                        
                       ,P_DCPRN) RETURNS(BIT(1));                       
                                                                        
 DCL P_EKOMNR                       BIN FIXED (15) UNAL;                
 DCL P_EEJDNR                       BIN FIXED (31) UNAL;                
 DCL P_DCPRN                        DEC FIXED (11);                     
                                                                        
 DCL NYT_EEJDNR                     BIN FIXED (31);                     
 DCL SLET_MARK                      CHAR(1);                            
                                                                        
                                                                        
    ANT_ÆA73_TJEKKET += 1;                                              
                                                                        
    /* Tjek om der findes mapning på ejendomsnummeret */                
    IF FINDES_UDENL_EJD_MAPNING (BH55300M.TIL_EVS_AAR                   
                                ,BH55300M.AFVIKLINGS_ID                 
                                ,BH55300M.DATA_ID                       
                                ,(P_EKOMNR)                             
                                ,(P_EEJDNR)                             
                                ,NYT_EEJDNR                             
                                ,SLET_MARK) THEN                        
    DO;                                                                 
       ANT_ÆA73_MAPPET += 1;                                            
                                                                        
       /* Tjek om mapningen indeholder slettemarkering */               
       IF SLET_MARK = '0' THEN                                          
       DO;                                                              
          /* Tjek om der mappes fra og til samme ejendomsnummer  */     
          /* hvilket blot er en bevarelse af det aktuelle        */     
          /* ejendomsnummer.                                     */     
          IF P_EEJDNR = NYT_EEJDNR THEN                                 
          DO;                                                           
             /* Der mappes fra og til samme ejendomsnummer og det  */   
             /* tillades altid ubetinget.                          */   
             ANT_ÆA73_SAMME += 1;                                       
                                                                        
             CALL OPRET_UDENL_EJD_LOGNING (                             
                     BH55300M.TIL_EVS_AAR                               
                    ,BH55300M.AFVIKLINGS_ID                             
                    ,BH55300M.DATA_ID                                   
                    ,(P_EKOMNR)                                         
                    ,(P_EEJDNR)                                         
                    ,NYT_EEJDNR                                         
                    ,PACKAGENAME()                                      
                    ,ZS625P1                                            
                    ,P_DCPRN                                            
                    ,0                                                  
                    ,'U');                                              
                                                                        
             ANT_ÆA73_EJDNR_UÆNDRET += 1;                               
          END;                                                          
          ELSE                                                          
          DO;                                                           
             /* Tjek om der samtidigt mappes fra et andet ejendoms- */  
             /* nummer til det nye ejendomsnummer, hvilket i givet  */  
             /* fald er en ikke tilladt dublet mapning.             */  
             IF ^FINDES_ANDEN_GÆLD_UDENL_EJD_LOGNING (                  
                    BH55300M.TIL_EVS_AAR                                
                   ,BH55300M.AFVIKLINGS_ID                              
                   ,BH55300M.DATA_ID                                    
                   ,(P_EKOMNR)                                          
                   ,(P_EEJDNR)                                          
                   ,NYT_EEJDNR                                          
                   ,PACKAGENAME()                                       
                   ,ZS625P1                                             
                   ,P_DCPRN) THEN                                       
             DO;                                                        
                /* Der er førstegangs-mappet til det nye ejendoms-   */ 
                /* nummer eller i forvejen mappet fra fra-ejendoms-  */ 
                /* nummeret til det nye ejendomsnummer og det er     */ 
                /* tilladt.                                          */ 
                ANT_ÆA73_OK += 1;                                       
                                                                        
                CALL OPRET_UDENL_EJD_LOGNING (                          
                        BH55300M.TIL_EVS_AAR                            
                       ,BH55300M.AFVIKLINGS_ID                          
                       ,BH55300M.DATA_ID                                
                       ,(P_EKOMNR)                                      
                       ,(P_EEJDNR)                                      
                       ,NYT_EEJDNR                                      
                       ,PACKAGENAME()                                   
                       ,ZS625P1                                         
                       ,P_DCPRN                                         
                       ,0                                               
                       ,'J');                                           
                                                                        
                UDTRÆK_FORS.EEJDNR = NYT_EEJDNR;                        
                ANT_ÆA73_EJDNR_ÆNDRET += 1;                             
             END;                                                       
             ELSE                                                       
             DO;                                                        
                /* Der er mappet fra flere forskellige samtidige    */  
                /* fra-ejendomsnumre til det nye ejendomsnummer     */  
                /* og derfor er det en ikke tilladt dublet mapning. */  
                ANT_ÆA73_DUBLET += 1;                                   
                                                                        
                CALL OPRET_UDENL_EJD_LOGNING (                          
                        BH55300M.TIL_EVS_AAR                            
                       ,BH55300M.AFVIKLINGS_ID                          
                       ,BH55300M.DATA_ID                                
                       ,(P_EKOMNR)                                      
                       ,(P_EEJDNR)                                      
                       ,NYT_EEJDNR                                      
                       ,PACKAGENAME()                                   
                       ,ZS625P1                                         
                       ,P_DCPRN                                         
                       ,0                                               
                       ,'D');                                           
                                                                        
                ANT_ÆA73_EJDNR_UÆNDRET += 1;                            
             END;                                                       
          END;                                                          
       END;                                                             
       ELSE                                                             
       DO;                                                              
          ANT_ÆA73_SLETTET += 1;                                        
                                                                        
          CALL OPRET_UDENL_EJD_LOGNING (                                
                  BH55300M.TIL_EVS_AAR                                  
                 ,BH55300M.AFVIKLINGS_ID                                
                 ,BH55300M.DATA_ID                                      
                 ,(P_EKOMNR)                                            
                 ,(P_EEJDNR)                                            
                 ,NYT_EEJDNR                                            
                 ,PACKAGENAME()                                         
                 ,ZS625P1                                               
                 ,P_DCPRN                                               
                 ,0                                                     
                 ,'N');                                                 
                                                                        
          RETURN ('0'B);                                                
       END;                                                             
    END;                                                                
    ELSE                                                                
    DO;                                                                 
       ANT_ÆA73_EJ_MAPPET += 1;                                         
                                                                        
       CALL OPRET_UDENL_EJD_LOGNING (                                   
               BH55300M.TIL_EVS_AAR                                     
              ,BH55300M.AFVIKLINGS_ID                                   
              ,BH55300M.DATA_ID                                         
              ,(P_EKOMNR)                                               
              ,(P_EEJDNR)                                               
              ,0                                                        
              ,PACKAGENAME()                                            
              ,ZS625P1                                                  
              ,P_DCPRN                                                  
              ,0                                                        
              ,'M');                                                    
                                                                        
       ANT_ÆA73_EJDNR_UÆNDRET += 1;                                     
    END;                                                                
                                                                        
    RETURN ('1'B);                                                      
                                                                        
 END RET_UDENL_EJDNR;                                                   
                                                                        
 /*********************************************************************/
 /* OVERFØRDATA                                                RUTINE */
 /*********************************************************************/
 OVERFØRDATA: PROC;                                                     
                                                                        
         HJ_DATOEN = PERSONEJENDOMSOPL.DOVTG;                           
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 01;                                          
              HJ_DATO.DG = 01;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         PERSONEJENDOMSOPL.DOVTG = HJ_DATOEN;                           
                                                                        
                                                                        
         HJ_DATOEN = PERSONEJENDOMSOPL.DAFSTAA;                         
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 12;                                          
              HJ_DATO.DG = 31;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         PERSONEJENDOMSOPL.DAFSTAA = HJ_DATOEN;                         
                                                                        
                                                                        
         HJ_DATOEN = PERSONEJENDOMSOPL.DATO0107;                        
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 01;                                          
              HJ_DATO.DG = 01;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         PERSONEJENDOMSOPL.DATO0107 = HJ_DATOEN;                        
                                                                        
                                                                        
         HJ_DATOEN = PERSONEJENDOMSOPL.DINDFLYT;                        
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 01;                                          
              HJ_DATO.DG = 01;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         PERSONEJENDOMSOPL.DINDFLYT = HJ_DATOEN;                        
                                                                        
                                                                        
         HJ_DATOEN = PERSONEJENDOMSOPL.DFRAFLYT;                        
                                                                        
         IF HJ_DATOEN = 0                                               
         THEN;                                                          
         ELSE                                                           
         IF HJ_DATO.MD < 01                                             
          ! HJ_DATO.MD > 12                                             
         THEN                                                           
            DO;                                                         
              HJ_DATO.MD = 12;                                          
              HJ_DATO.DG = 31;                                          
            END;                                                        
         ELSE                                                           
         IF HJ_DATO.DG < 01                                             
         THEN                                                           
            HJ_DATO.DG = 01;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 31                                             
          & (HJ_DATO.MD = 01 !                                          
             HJ_DATO.MD = 03 !                                          
             HJ_DATO.MD = 05 !                                          
             HJ_DATO.MD = 07 !                                          
             HJ_DATO.MD = 08 !                                          
             HJ_DATO.MD = 10 !                                          
             HJ_DATO.MD = 12)                                           
         THEN                                                           
            HJ_DATO.DG = 31;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 30                                             
          & (HJ_DATO.MD = 04 !                                          
             HJ_DATO.MD = 06 !                                          
             HJ_DATO.MD = 09 !                                          
             HJ_DATO.MD = 11)                                           
         THEN                                                           
            HJ_DATO.DG = 30;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 29                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) = 0                                      
         THEN                                                           
            HJ_DATO.DG = 29;                                            
         ELSE                                                           
         IF HJ_DATO.DG > 28                                             
          & HJ_DATO.MD = 02                                             
          & MOD(HJ_DATO.AAR,4) > 0                                      
         THEN                                                           
            HJ_DATO.DG = 28;                                            
                                                                        
         PERSONEJENDOMSOPL.DFRAFLYT = HJ_DATOEN;                        
                                                                        
         ANTEJENDOM = ANTEJENDOM + 1;                                   
         UDTRÆK_FORS.DCPRN = PERSONEJENDOMSOPL.PERSONNUMMER;            
                                                                        
         UDTRÆK_FORS.EKOMNR        = PERSONEJENDOMSOPL.EKOMNR;          
         UDTRÆK_FORS.EEJDNR        = PERSONEJENDOMSOPL.EEJDNR;          
         UDTRÆK_FORS.EENHEDLBNR    = PERSONEJENDOMSOPL.EENHEDLBNR;      
                                                                        
         UDTRÆK_FORS.EJDBELIG      = EJENDOMSOPL.EJDBELIG;              
         /* nye felter indført i slut 2018 først med i Forskud 2020*/   
         UDTRÆK_FORS.VEJK_EJD      = EJENDOMSOPL.EJD_VEJK;              
         UDTRÆK_FORS.HUSNR_EJD     = EJENDOMSOPL.EJD_HUSNR;             
         UDTRÆK_FORS.ETAGE_EJD     = EJENDOMSOPL.EJD_ETAGE;             
         UDTRÆK_FORS.SDØR_EJD      = EJENDOMSOPL.EJD_SDØR;              
         UDTRÆK_FORS.ENHEDBELIG    = EJENDOMSOPL.ENHEDBELIG;            
         UDTRÆK_FORS.VEJK_ENHED    = EJENDOMSOPL.ENHED_VEJK;            
         UDTRÆK_FORS.HUSNR_ENHED   = EJENDOMSOPL.ENHED_HUSNR;           
         UDTRÆK_FORS.ETAGE_ENHED   = EJENDOMSOPL.ENHED_ETAGE;           
         UDTRÆK_FORS.SDØR_ENHED    = EJENDOMSOPL.ENHED_SDØR;            
                                                                        
         UDTRÆK_FORS.BBERGRL       = PERSONEJENDOMSOPL.BBERGRL;         
         UDTRÆK_FORS.BBER2FAM      = PERSONEJENDOMSOPL.BBER2FAM;        
                                                                        
                                                                        
         IF PERSONEJENDOMSOPL.EKOMNR = 999                              
         THEN                                                           
            UDTRÆK_FORS.CLANDEKODE    = EJENDOMSOPL.LANDEKODE;          
         ELSE                                                           
            UDTRÆK_FORS.CLANDEKODE    = '';                             
                                                                        
         UDTRÆK_FORS.CFRATYPE      = '4';                               
         IF PERSONEJENDOMSOPL.DAFSTAA > 0                               
         THEN                                                           
            UDTRÆK_FORS.DSORTDAT1  = PERSONEJENDOMSOPL.DAFSTAA;         
         ELSE                                                           
            UDTRÆK_FORS.DSORTDAT1  = 99991231;                          
         UDTRÆK_FORS.DSORTDAT2     = PERSONEJENDOMSOPL.DOVTG;           
         UDTRÆK_FORS.EPLBNR        = PERSONEJENDOMSOPL.EPLBNR;          
         UDTRÆK_FORS.DFRAGLD       = PERSONEJENDOMSOPL.DFRAGLD;         
         UDTRÆK_FORS.DTILGLD       = PERSONEJENDOMSOPL.DTILGLD;         
         UDTRÆK_FORS.CEVSBENY      = PERSONEJENDOMSOPL.CEVSBENY;        
         UDTRÆK_FORS.CEJBEVS       = PERSONEJENDOMSOPL.CEJBEVS;         
         UDTRÆK_FORS.COPR_CEJBEVS  = PERSONEJENDOMSOPL.COPR_CEJBEVS;    
         UDTRÆK_FORS.CEJDTYPE      = PERSONEJENDOMSOPL.CEJDTYPE;        
         UDTRÆK_FORS.CFRED         = PERSONEJENDOMSOPL.CFRED;           
         UDTRÆK_FORS.CNEDSL1       = PERSONEJENDOMSOPL.CNEDSL1;         
         UDTRÆK_FORS.DATO0107      = PERSONEJENDOMSOPL.DATO0107;        
         UDTRÆK_FORS.DOVTG         = PERSONEJENDOMSOPL.DOVTG;           
         IF ANTEJENDOM = 1                                              
         THEN                                                           
            UDTRÆK_FORS.DOVTG_GL   = PERSONEJENDOMSOPL.DOVTG;           
         UDTRÆK_FORS.DAFSTAA       = PERSONEJENDOMSOPL.DAFSTAA;         
         UDTRÆK_FORS.DINDFLYT      = PERSONEJENDOMSOPL.DINDFLYT;        
         UDTRÆK_FORS.DFRAFLYT      = PERSONEJENDOMSOPL.DFRAFLYT;        
         UDTRÆK_FORS.GPCTEJER      = PERSONEJENDOMSOPL.GPCTEJER;        
         UDTRÆK_FORS.FDAGUDLE      = PERSONEJENDOMSOPL.FDAGUDLE;        
         UDTRÆK_FORS.GPCTUDLE      = PERSONEJENDOMSOPL.GPCTUDLE;        
         UDTRÆK_FORS.FDAGERHV      = PERSONEJENDOMSOPL.FDAGERHV;        
         UDTRÆK_FORS.GPCTERHV      = PERSONEJENDOMSOPL.GPCTERHV;        
         UDTRÆK_FORS.BPROM1        = PERSONEJENDOMSOPL.BPROM1;          
         UDTRÆK_FORS.BUDLSKC   = PERSONEJENDOMSOPL.BUDLSKC; /*DEF #521*/
     /*  IF PERSONEJENDOMSOPL.BUDLSKC > 0                               
         THEN                                                           
           DO;                                                          
             PUT SKIP LIST('PERSON =',PERSONEJENDOMSOPL.PERSONNUMMER);  
             PUT SKIP LIST('BUDLSKC=',PERSONEJENDOMSOPL.BUDLSKC);       
           END; */                                                      
                                                                        
         IF PERSONEJENDOMSOPL.CEJBEVS = '0' !                           
            PERSONEJENDOMSOPL.CEJBEVS = '4' !                           
            PERSONEJENDOMSOPL.CEJBEVS = '5'                             
         THEN                                                           
            DO;                                                         
               UDTRÆK_FORS.BBRUTTO_SW = 0;                              
               UDTRÆK_FORS.BBRUTTO    = PERSONEJENDOMSOPL.BBRUTTO;      
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_FORS.BBRUTTO_SW = -1;                             
               UDTRÆK_FORS.BBRUTTO    = 0;                              
            END;                                                        
                                                                        
         UDTRÆK_FORS.CENKE      = PERSONEJENDOMSOPL.CENKE;              
         UDTRÆK_FORS.FDAGEJ     = PERSONEJENDOMSOPL.FDAGEJ;/* ESB */    
                                                                        
         UDTRÆK_FORS.CEKSEMP    = PERSONEJENDOMSOPL.CEKSEMP;  /*#09-04*/
         UDTRÆK_FORS.COPR_EKSEMP =                                      
                               PERSONEJENDOMSOPL.COPR_EKSEMP; /*#09-04*/
                                                                        
         /* 2021 Vurmark */                                             
         UDTRÆK_FORS.VURMARK_AKT_PER = PERSONEJENDOMSOPL.VURMARK_AKT;   
         UDTRÆK_FORS.VURMARK_02ANV   = PERSONEJENDOMSOPL.VURMARK_02ANV; 
         UDTRÆK_FORS.VURMARK_015ANV  = PERSONEJENDOMSOPL.VURMARK_015ANV;
         UDTRÆK_FORS.VURMARK_PER     = PERSONEJENDOMSOPL.VURMARK;       
         UDTRÆK_FORS.VURMARK_AKT_EJD = EJENDOMSOPL.VURMARK_AKT;         
         UDTRÆK_FORS.VURMARK_OM      = EJENDOMSOPL.VURMARK_OM;          
         UDTRÆK_FORS.VURMARK_02      = EJENDOMSOPL.VURMARK_02;          
         UDTRÆK_FORS.VURMARK_015PCT  = EJENDOMSOPL.VURMARK_015PCT;      
         UDTRÆK_FORS.VURMARK_EJD     = EJENDOMSOPL.VURMARK;             
                                                                        
         /* KS46 */                                                     
         UDTRÆK_FORS.CRTEKORNS           = PERSONEJENDOMSOPL.CRTEKORNS; 
         UDTRÆK_FORS.COPR_CRTEKORNS      =                              
                                      PERSONEJENDOMSOPL.COPR_CRTEKORNS; 
                                                                        
         UDTRÆK_FORS.BFENR               = EJENDOMSOPL.BFENR;           
         UDTRÆK_FORS.VUREJENDOMID        = EJENDOMSOPL.VUREJENDOMID;    
                                                                        
         IF INDK_PERS.BNYMAN_I = 0                                      
         THEN                                                           
            DO;                                                         
               UDTRÆK_FORS.BNYMAN_SW = 0;                               
               UDTRÆK_FORS.BNYMAN = PERSONEJENDOMSOPL.BNYMAN;           
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_FORS.BNYMAN_SW = -1;                              
               UDTRÆK_FORS.BNYMAN = 0;                                  
            END;                                                        
                                                                        
         IF PERSONEJENDOMSOPL.CEJBEVS = '0' !                           
            PERSONEJENDOMSOPL.CEJBEVS = '4' !                           
            PERSONEJENDOMSOPL.CEJBEVS = '5'                             
         THEN                                                           
            DO;                                                         
               UDTRÆK_FORS.B100_SW = 0;                                 
               UDTRÆK_FORS.B100 = PERSONEJENDOMSOPL.B100;               
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_FORS.B100_SW = -1;                                
               UDTRÆK_FORS.B100 = 0;                                    
            END;                                                        
                                                                        
         IF PERSONEJENDOMSOPL.BEJERAN > 0      &                        
            (PERSONEJENDOMSOPL.CEJBEVS = '0'   !                        
             PERSONEJENDOMSOPL.CEJBEVS = '4'   !                        
             PERSONEJENDOMSOPL.CEJBEVS = '5')  &                        
            (PERSONEJENDOMSOPL.GPCTEJER > 0    &                        
             PERSONEJENDOMSOPL.GPCTEJER < 10000)                        
         THEN                                                           
            DO;                                                         
               UDTRÆK_FORS.BEJERAN_SW = 0;                              
               UDTRÆK_FORS.BEJERAN = PERSONEJENDOMSOPL.BEJERAN;         
            END;                                                        
         ELSE                                                           
            DO;                                                         
               UDTRÆK_FORS.BEJERAN_SW = -1;                             
               UDTRÆK_FORS.BEJERAN = 0;                                 
            END;                                                        
                                                                        
         /* Nyt felt Forskud 2020 */                                    
         UDTRÆK_FORS.CSLET = PERSONEJENDOMSOPL.CSLET;                   
                                                                        
         SELECT;                                                        
         WHEN (BNYMAN_SW = 0                      &                     
               PERSONEJENDOMSOPL.CEJBEVS  ^= '9'  & /*BEHOLD SOM INFO */
               PERSONEJENDOMSOPL.CEVSBENY  = '0'  &                     
               (PERSONEJENDOMSOPL.CEJBEVS  = 'A'  !                     
                PERSONEJENDOMSOPL.CEJBEVS  = '6'))                      
            DO;                                                         
               UDTRÆK_FORS.BFORSKAT = UDTRÆK_FORS.BFORSKAT +            
                                      UDTRÆK_FORS.BNYMAN;               
               UDTRÆK_FORS.BFORSKAT_SW = 0;                             
               UDTRÆK_FORS.CEVSSUM = '1';                               
               UDTRÆK_FORS.FDAGIALT = FDAGIALT + UDTRÆK_FORS.FDAGEJ;    
               IF UDTRÆK_FORS.FDAGEJ = 0                                
               THEN                                                     
                  SW_FDAGEJ_NUL = '1'B;                                 
               TV_SUMMERET = TV_SUMMERET + 1;                           
            END;                                                        
         WHEN (BEJERAN_SW = 0                     &                     
               PERSONEJENDOMSOPL.CEVSBENY  = '0'  &                     
               PERSONEJENDOMSOPL.CEJBEVS  ^= '9') /*BEHOLDES SOM INFO*/ 
            DO;                                                         
               UDTRÆK_FORS.BFORSKAT = UDTRÆK_FORS.BFORSKAT +            
                                         + PERSONEJENDOMSOPL.BEJERAN;   
               UDTRÆK_FORS.BFORSKAT_SW = 0;                             
               UDTRÆK_FORS.CEVSSUM = '1';                               
               UDTRÆK_FORS.FDAGIALT = FDAGIALT + UDTRÆK_FORS.FDAGEJ;    
               IF UDTRÆK_FORS.FDAGEJ = 0                                
               THEN                                                     
                  SW_FDAGEJ_NUL = '1'B;                                 
               TV_SUMMERET = TV_SUMMERET + 1;                           
            END;                                                        
         WHEN (B100_SW = 0                         &                    
               PERSONEJENDOMSOPL.CEVSBENY  = '0'   &                    
               PERSONEJENDOMSOPL.CEJBEVS  ^= '9') /*BEHOLDES SOM INFO*/ 
            DO;                                                         
               UDTRÆK_FORS.BFORSKAT = UDTRÆK_FORS.BFORSKAT +            
                                         + PERSONEJENDOMSOPL.B100;      
               UDTRÆK_FORS.BFORSKAT_SW = 0;                             
               UDTRÆK_FORS.CEVSSUM = '1';                               
               UDTRÆK_FORS.FDAGIALT = FDAGIALT + UDTRÆK_FORS.FDAGEJ;    
               IF UDTRÆK_FORS.FDAGEJ = 0                                
               THEN                                                     
                  SW_FDAGEJ_NUL = '1'B;                                 
               TV_SUMMERET = TV_SUMMERET + 1;                           
            END;                                                        
         OTHERWISE                                                      
            TV_IKKE_SUMMERET = TV_IKKE_SUMMERET + 1;                    
         END; /*SELECT*/                                                
                                                                        
                                                                        
 END OVERFØRDATA;                                                       
 /*********************************************************************/
 OPSTART_INIT: PROC;                                                    
                                                                        
   DCL     HJ_KOMNR     PIC '(03)9';                                    
                                                                        
   /* PARMKORT ER EVT. MEDTAGET I KØRSLEN */                            
   ON  ENDFILE (PARMKORT)                                               
   BEGIN;                                                               
      EOF_PARM  = '1'B;                                                 
      GO TO INIT_SLUT;                                                  
   END;                                                                 
                                                                        
   PARMLINIE = '';                                                      
                                                                        
   READ FILE (PARMKORT) INTO  (PARM_AR);                                
                                                                        
   IF PARMLINIE.PROGNAVN ^= 'BH30100'                                   
   THEN                                                                 
     PARM_FEJL = '1'B;                                                  
                                                                        
    IF VERIFY (PARMLINIE.KOMNR1,'0123456789')  >  0                     
    THEN                                                                
      DO;                                                               
        PARM_FEJL = '1'B;                                               
      END;                                                              
                                                                        
    /*Første kommunenummer skal være udfyldt når der er parmkort*/      
    IF PARMLINIE.KOMNR1  <  '100' !                                     
       PARMLINIE.KOMNR1  >  '999'                                       
    THEN                                                                
      DO;                                                               
        PARM_FEJL = '1'B;                                               
      END;                                                              
                                                                        
    IF PARM_FEJL                                                        
    THEN                                                                
       DO;                                                              
         PUT SKIP LIST ('FEJL I PARMKORT: ',PARM_AR);                   
         ABENDMEDD = '101 FEJL I PARMKORT';                             
         CALL ZS30101(5,ABENDMEDD,2);                                   
       END;                                                             
    ELSE                                                                
       DO;                                                              
         PARM_MEDTAGET  = '1'B;                                         
         PUT SKIP LIST('PARMKORT MEDTAGET: ' !!                         
                PARMLINIE.PROGNAVN  !! PARMLINIE.KOMNR1 !!              
                PARMLINIE.KOMNR2 !! PARMLINIE.KOMNR3);                  
       END;                                                             
                                                                        
   INIT_SLUT:                                                           
                                                                        
   IF PARMLINIE.KOMNR1 = ''                                             
   THEN                                                                 
     DO;                                                                
       PARMKOMNR1 = 0;                                                  
       PARMKOMNR2 = 0;                                                  
       PARMKOMNR3 = 0;                                                  
     END;                                                               
   ELSE                                                                 
     DO;                                                                
       HJ_KOMNR  = PARMLINIE.KOMNR1;                                    
       PARMKOMNR1 = HJ_KOMNR;                                           
       IF PARMLINIE.KOMNR2 > '000'                                      
       THEN                                                             
         DO;                                                            
           HJ_KOMNR  = PARMLINIE.KOMNR2;                                
           PARMKOMNR2 = HJ_KOMNR;                                       
         END;                                                           
                                                                        
       IF PARMLINIE.KOMNR3 > '000'                                      
       THEN                                                             
         DO;                                                            
           HJ_KOMNR  = PARMLINIE.KOMNR3;                                
           PARMKOMNR3 = HJ_KOMNR;                                       
         END;                                                           
                                                                        
       PUT SKIP LIST('PARMLINIE.KOMNR1 =',PARMKOMNR1);                  
       PUT SKIP LIST('PARMLINIE.KOMNR2 =',PARMKOMNR2);                  
       PUT SKIP LIST('PARMLINIE.KOMNR3 =',PARMKOMNR3);                  
     END;                                                               
                                                                        
                                                                        
  END OPSTART_INIT;                                                     
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         CALL LUK_FILER;                                                
                                                                        
         /* XJY 22.10.2024: Udkommenteret dette kald, da det vil */     
         /* resultere i et uendeligt loop, hvis SQL kalder deri  */     
         /* fejl, da proceduren CLOSE_PERSONEJENDOMSOPL også     */     
         /* kalder SQL_FEJL!                                     */     
         /*                                                             
         CALL CLOSE_PERSONEJENDOMSOPL;                                  
         */                                                             
         CALL ZS67000(SQLCA);                                           
                                                                        
         ABENDMEDD = 'BH30100 ** 250 ' !! FEJLTEKST !!                  
                     TRIM(CHAR(SQLCA.SQLCODE));                         
                                                                        
         CALL ZS30101 (5, ABENDMEDD, 2);                                
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* LUK FILER, CURSOR OG UDSKRIV AFSTEMNINGS- OG KONTROLLISTE  RUTINE */
 /*********************************************************************/
 AFSLUT: PROC;                                                          
                                                                        
         CALL LUK_FILER;                                                
                                                                        
         CALL CLOSE_PERSONEJENDOMSOPL;                                  
                                                                        
         CALL DAN_AFSTEMNINGSLISTE;                                     
                                                                        
 END AFSLUT;                                                            
                                                                        
 /*********************************************************************/
 /* LUK FILER                                                         */
 /*********************************************************************/
 LUK_FILER: PROC;                                                       
                                                                        
         CLOSE FILE (BH3010O);                                          
         CLOSE FILE (BH3011O);                                          
                                                                        
 END LUK_FILER;                                                         
                                                                        
 /*********************************************************************/
 /* DAN AFSTEMNINGS- OG KONTROLLISTEN                                 */
 /*********************************************************************/
 DAN_AFSTEMNINGSLISTE: PROC;                                            
                                                                        
         LINIE = ZZWS3 !! ' KONTROL- & AFSTEMNINGSTOTAL FOR'            
                       !! ' UDTRÆK FRA EVS FORSKUD '                    
         /*#01*/       !! BH55300M.INDKÅR1                              
                       !! ' DATO: '                                     
                       !! DAT.DAG !! '.' !! DAT.MD !! '.' !! DAT.ÅR;    
                                                                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE = ZZWS3 !! ' PROGRAMID: BH30100 ';                       
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LINIE = ZZWS2;                                                 
         CALL ZZ20300(LINIE,'01');                                      
         LINIE = ZZWS2;                                                 
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL LÆSTE FRA PERSONTABELLEN . . . . . . . .';  
         LIN.ANT   = ANTLÆS_PERSON;                                     
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET MED CEJBEVS LIG 9 . . . . . .';  
         LIN.ANT   = ANTCEJBEVS_9;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL SKREVET MED CSLET LIG 1. . . . . . . . .';  
         LIN.ANT   = ANTCSLET_1;                                        
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL EJ SKREVET MED EEJDNR LIG 0. . . . . . .';  
         LIN.ANT   = ANTEJENDOM_0;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL SKREVNE IALT . . . . . . . . . . . . . .';  
         LIN.ANT   = ANTSKRIV_PERSON;                                   
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '      HERAF DANSKE EJENDOMME . . . . . . . . .';  
         LIN.ANT   = ANTSKRIV_ØVR;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '      HERAF UDENLANDSKE EJENDOMME. . . . . . .';  
         LIN.ANT   = ANTSKRIV_UDL;                                      
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL HVOR DER ER SUMMERET SKAT. . . . . . . .';  
         LIN.ANT   = TV_SUMMERET;                                       
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL HVOR DER IKKE ER SUMMERET SKAT . . . . .';  
         LIN.ANT   = TV_IKKE_SUMMERET;                                  
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'ANTAL MED FDAGIALT STØRRE END 360 DAGE . . . .';  
         LIN.ANT   = TV_STOR_FDAGIALT;                                  
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'Antal udenl.ejd. kontrolleret for ejd.nr.skift';  
         LIN.ANT   = ANT_ÆA73_TJEKKET;                                  
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '- heraf med ikke mappet ejd.nr (Mangler) . . .';  
         LIN.ANT   = ANT_ÆA73_EJ_MAPPET;                                
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '- heraf med mappet ejendomsnummer  . . . . . .';  
         LIN.ANT   = ANT_ÆA73_MAPPET;                                   
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '  - heraf mappet som slettet (Slettet) . . . .';  
         LIN.ANT   = ANT_ÆA73_SLETTET;                                  
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '  - heraf mappet til samme (Uændret) . . . . .';  
         LIN.ANT   = ANT_ÆA73_SAMME;                                    
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '  - heraf med anvendt til-ejd.nr (Dublet)  . .';  
         LIN.ANT   = ANT_ÆA73_DUBLET;                                   
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '  - heraf med ikke anvendt til-ejd.nr (OK) . .';  
         LIN.ANT   = ANT_ÆA73_OK;                                       
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'Antal skrevne udenlandske ejendomme  . . . . .';  
         LIN.ANT   = ANT_ÆA73_SKREVNE;                                  
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '- heraf med nyt ejendomsnummer . . . . . . . .';  
         LIN.ANT   = ANT_ÆA73_EJDNR_ÆNDRET;                             
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = '- heraf med nuværende ejendomsnummer . . . . .';  
         LIN.ANT   = ANT_ÆA73_EJDNR_UÆNDRET;                            
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         LIN.TEKST = 'Antal ikke skrevne udenlandske ejendomme . . .';  
         LIN.ANT   = ANT_ÆA73_EJ_SKREVNE;                               
         CALL ZZ20300(LINIE,'01');                                      
                                                                        
         CALL ZZ20300(' ','99');                      /* LUK KMDSPOOL */
                                                                        
 END DAN_AFSTEMNINGSLISTE;                                              
 /*********************************************************************/
 /* HER STARTER APPLIKATIONENS EGNE INCLUDES                          */
 /*********************************************************************/
 %INCLUDE BH30100M;             /* DECLARE OG FETCH SQL STATEMENTS.   */
 %INCLUDE ZM90051M;             /* KONV BIN15 TIL CHAR                */
 %INCLUDE BS34307M;             /* KONV BF31 TIL CHAR6                */
 %INCLUDE ZM90013M;             /* OMSÆT DATO TIL/FRA DB2-DATOFORMAT  */
                                                                        
 /**********************************************************************
 * Inkluderede procedurer                                              *
 **********************************************************************/
 %INCLUDE BE99900M; /* SQL_ERROR                                      */
 %INCLUDE BE99901M; /* ABEND                                          */
 %INCLUDE BE83000M; /* FINDES_UDENL_EJD_MAPNING                       */
                    /* FINDES_ANDEN_GÆLD_UDENL_EJD_LOGNING            */
                    /* OPRET_UDENL_EJD_LOGNING                        */
                    /* SÆT_GLNY_LOV_UD_FRA_JOBNAVN                    */
                                                                        
 /*********************************************************************/
 /* Håndter afslutning af programmet umiddelbart før abend.           */
 /*                                                                   */
 /* Kode udført heri og procedurer kaldt herfra bør IKKE kalde        */
 /* SQL_ERROR eller ABEND procedurerne, da det resulterer i et        */
 /* uendeligt loop.                                                   */
 /*********************************************************************/
 AFSLUT_PROGRAM_FØR_ABEND: PROC (P_PROCNAME,                            
                                 P_USER_ABEND_CODE, P_USER_ABEND_TEXT); 
                                                                        
 DCL P_PROCNAME                     CHAR(*) VAR;                        
 DCL P_USER_ABEND_CODE              PIC '999';                          
 DCL P_USER_ABEND_TEXT              CHAR(*) VAR;                        
                                                                        
    /* Udskriv afstemningsliste fra programmet */                       
    CALL DAN_AFSTEMNINGSLISTE;                                          
                                                                        
    /* Luk filer */                                                     
    CALL LUK_FILER;                                                     
                                                                        
 END AFSLUT_PROGRAM_FØR_ABEND;                                          
                                                                        
 END BH30100;                                                           
