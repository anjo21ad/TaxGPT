  PROCESS OPT(TIME);                                                    
 BH97900: /* OPDATER EVS TABELLER SAMT DAN DATA TIL SLUT PÅ CSC */      
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /**********************************************************************
 *                                                                     *
 * FORMÅL : OPDATER EVS SLUT TABELLER SAMT DAN DATA TIL SLUT PÅ CSC    *
 *          I.F.M. KØRSEL LIG 'SUPPLEMENTSLEVERING'.                   *
 *                                                                     *
 * INPUT  : B.H96000D  BEREGNINGSBÅND TIL SLUT 2004                    *
 *                                                                     *
 * UPDATE : BQ2X000T+BQ3X000T - EVS SLUT TABELLER                      *
 *                                                                     *
 * OUTPUT : D0311603.A782 UDTRÆK - EVS DATA TIL SLUT PÅ CSC            *
 *          BH97901Y   KØRSELSKONTROLLISTE                             *
 *                                                                     *
 * PROGRAMMØR: BO SCHMIDT      JUNI      2004                          *
 *                                                                     *
 **********************************************************************/
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
                                                                        
         DCL COPYRIGHT   CHAR      (30) STATIC                          
         INIT ('COPYRIGHT KOMMUNEDATA I/S 2005');                       
 /*********************************************************************/
 /* DECLARE AF DB2                                                    */
 /*********************************************************************/
         EXEC SQL INCLUDE SQLCA;        /* SQL KOMMUNIKATIONSAREAL   */ 
         EXEC SQL INCLUDE BQ30000T;     /* EVS SLUT EJERSKABSTABEL   */ 
         EXEC SQL INCLUDE BQ31000T;     /* EVS SLUT EJERSKABSFELTTAB */ 
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH960I  FILE RECORD INPUT;     /* BEREGN.BÅND EFTER BEREGN. */ 
 DCL     BH979O  FILE RECORD OUTPUT;    /* EVS DATA TIL SLUT PÅ CSC  */ 
 /********************************************************************* 
 *       DECLARE AF BEREGNINGSBÅND                                    * 
 *********************************************************************/ 
 DCL     BH960_AR        CHAR (23472) VAR;                              
 DCL     1 BH960         BASED     (ADDR(BH960_AR)),                    
           3 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH90000N;;                                          
                                                                        
 /********************************************************************* 
 *       DECLARE AF OUTPUT HERUNDER EVT. TEST IND-/UDDATA             * 
 *********************************************************************/ 
 DCL     1 BH979,                                                       
           %INCLUDE BH96110N;;                                          
                                                                        
 DCL     1 BQ04907N,                                                    
           %INCLUDE BQ04907N;;             /* BEREGN EVS KMD DEL    */  
                                                                        
 DCL     1 KOM_AREAL ALIGNED,                                           
           %INCLUDE BQ04010N;                                           
                                                                        
 DCL     1 BQ_IND ALIGNED,                                              
           %INCLUDE BQ04011N;;                                          
                                                                        
 DCL     1 BQ_UD ALIGNED,                                               
           %INCLUDE BQ04011N;;                                          
                                                                        
 DCL 1 STYR_FELTER,                                                     
       5 DCPRN          DEC FIXED (11), /* PERSONNUMMER              */ 
       5 DINDKAAR       BIN FIXED (15), /* INDKOMSTÅR                */ 
       5 EKOMNR         BIN FIXED (15), /* KOMMUNENUMMER             */ 
       5 EEJDNR         BIN FIXED (31), /* EJENDOMSNUMMER            */ 
       5 ELBNR          BIN FIXED (15), /* LØBENUMMER                */ 
       5 EGENNR         BIN FIXED (15), /* GENERATIONSNUMMER         */ 
       5 TYPE           BIN FIXED (15), /* TYPE                      */ 
       5 STATUS         BIN FIXED (15), /* STATUS                    */ 
       5 RETURKODE      BIN FIXED (15), /* RETURKODE                 */ 
       5 RETURTEKST     CHAR      (70), /* RETURTEKST                */ 
       5 FEJLNR         PIC     '9999', /* FEJLNR                    */ 
       5 FEJLTEKST      CHAR      (70); /* FEJLTEKST                 */ 
                                                                        
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_UDTRÆK    FIXED DEC (7),                               
           2 LÆS_BH960     FIXED DEC (7),                               
           2 SKREVET       FIXED DEC (7);                               
                                                                        
 DCL     TV_LÆS          FIXED     (7)       INIT      (0);             
 DCL     TV_LÆS_EVS      FIXED     (7)       INIT      (0);             
 DCL     TV_SKRIV_EVS    FIXED     (7)       INIT      (0);             
 DCL     TV_LIN          FIXED     (7)       INIT      (0);             
                                                                        
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     BQ04110         ENTRY;                                         
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS67000         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    LIN_DEB          CHAR      (133);                               
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH97900L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (                
           'OPDATER EVS TABELLER OG DAN DATA TIL SLUT PÅ CSC'),         
           2 F2          CHAR      (12)      INIT      (' '),           
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 LIN3,                                                        
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (2)       INIT      (' '),           
          2 TEKST        CHAR      (52),                                
          2 ANT          PIC       'ZZZ.ZZZ.ZZZ.ZZZ.ZZ9',               
          2 REST         CHAR      (59)      INIT      (' ');           
 DCL     1 LIN_BLANK,                                                   
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (132)     INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
                                    EXTERNAL INIT ('NOTEST(ALL,,;)');   
 DCL     EOF_BH960       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     I               BIN FIXED (15);                                
                                                                        
 DCL     HJ_CHAR3        CHAR      (3);                                 
 DCL     HJ_PIC3         PIC       '999'   BASED(ADDR(HJ_CHAR3));       
 DCL     HJ_CHAR7        CHAR      (7);                                 
 DCL     HJ_PIC7         PIC       '(7)9'  BASED(ADDR(HJ_CHAR7));       
                                                                        
 DCL     FEJLTEKST       CHAR      (20)    INIT (' ');                  
 DCL     ABENDMEDD       CHAR      (56)    INIT (' ');                  
                                                                        
 DCL     1 BH65300M,                                                    
           %INCLUDE BH65300M;                                           
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
 DCL     HJ_TIMESTAMP    CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         EOF_BH960 = NEJ;                                               
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
               ON ERROR SYSTEM;                                         
               PUT SKIP LIST ('PROGRAMFEJL');                           
               CALL PLIDUMP  ('SNHOB','MODUL BH97900');                 
            END;                                                        
                                                                        
         OPEN FILE (BH960I) TITLE ('BH96000I');                         
         OPEN FILE (BH979O) TITLE ('BH97900O');                         
                                                                        
         ON ENDFILE (BH960I)                                            
            EOF_BH960 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH97901Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         TV = 0;                                                        
                                                                        
         STYR_FELTER.DINDKAAR = SLUTÅR;                                 
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL DECLARE_EVS_CUR;                                          
                                                                        
         EXEC SQL OPEN EVS_CUR;                                         
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST  = 'OPEN EVS_CURSOR ';                          
              FEJLTEKST  = 'BH97900 ** 251 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
         CALL LÆS_UDTRÆK;                                               
         CALL LÆS_BH960;                                                
                                                                        
         DO WHILE (SQLCODE = 0 & EOF_BH960 = NEJ);                      
                                                                        
            DO WHILE (STYR_FELTER.DCPRN > BH960.SORT_CPR &              
                      EOF_BH960 = NEJ );                                
               CALL LÆS_BH960;                                          
            END;/* DO WHILE*/                                           
            DO WHILE (STYR_FELTER.DCPRN = BH960.SORT_CPR &              
                      STYR_FELTER.EKOMNR > BH960.SORT_KOMNR &           
                      EOF_BH960 = NEJ );                                
               CALL LÆS_BH960;                                          
            END;/* DO WHILE*/                                           
            DO WHILE (STYR_FELTER.DCPRN = BH960.SORT_CPR &              
                      STYR_FELTER.EKOMNR = BH960.SORT_KOMNR &           
                      STYR_FELTER.EEJDNR > BH960.SORT_EJDNR &           
                      EOF_BH960 = NEJ );                                
               CALL LÆS_BH960;                                          
            END;/* DO WHILE*/                                           
                                                                        
            IF STYR_FELTER.DCPRN = BH960.SORT_CPR                       
             & STYR_FELTER.EKOMNR = BH960.SORT_KOMNR                    
             & STYR_FELTER.EEJDNR = BH960.SORT_EJDNR                    
             & EOF_BH960 = NEJ                                          
            THEN                                                        
               DO;                                                      
                 STYR_FELTER.TYPE      = 0;                             
                 STYR_FELTER.RETURKODE = 0;                             
                                                                        
                 CALL DATA_MODUL('LÆS');                                
                                                                        
                 IF (BQ_IND.PERSON.CEJDTYPE_AKT = '3' !                 
                     BQ_IND.PERSON.CEJDTYPE_AKT = '8')                  
                  & (BH960.EJERSKAB.CEJDTYPE_AKT = '1' !                
                     BH960.EJERSKAB.CEJDTYPE_AKT = '7')                 
                  & BH960.CHELÅR >= '0'                                 
                 THEN                                                   
                    DO;                                                 
                      CALL BEHANDL_PERSON;                              
                      CALL DAN_DATA_TIL_SLUT;                           
                    END;                                                
               END;                                                     
                                                                        
            CALL LÆS_UDTRÆK;                                            
         END;                                                           
                                                                        
         EXEC SQL CLOSE EVS_CUR;                                        
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST  = 'CLOSE EVS_CURSOR ';                         
              FEJLTEKST  = 'BH97900 ** 251 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /*********************************************************************/
 /* DECLARE CURSOR TIL UDTRÆK                                         */
 /*********************************************************************/
 DECLARE_EVS_CUR: PROC;                                                 
                                                                        
         EXEC SQL                                                       
                                                                        
              DECLARE EVS_CUR CURSOR FOR                                
                                                                        
              SELECT T1.DCPRN,                                          
                     T1.EKOMNR,                                         
                     T1.EEJDNR,                                         
                     T1.ELBNR                                           
              FROM   BQ30000T T1                                        
              WHERE  T1.DINDKAAR = :STYR_FELTER.DINDKAAR                
              AND    T1.DTILGLD  = '9999-12-31-23.59.59.999999'         
              AND    T1.EGENNR = (SELECT MAX(EGENNR)                    
                                  FROM BQ31000T T2                      
                                  WHERE T2.DINDKAAR = T1.DINDKAAR       
                                   AND T2.DCPRN    = T1.DCPRN           
                                   AND T2.EKOMNR   = T1.EKOMNR          
                                   AND T2.EEJDNR   = T1.EEJDNR          
                                   AND T2.ELBNR    = T1.ELBNR           
                                   AND T2.FELTKODE = 86                 
                                   AND T2.INDHOLD_C = '3')              
              AND    T1.EGENNR = (SELECT MAX(EGENNR)                    
                                  FROM BQ31000T T3                      
                                  WHERE T3.DINDKAAR = T1.DINDKAAR       
                                   AND T3.DCPRN    = T1.DCPRN           
                                   AND T3.EKOMNR   = T1.EKOMNR          
                                   AND T3.EEJDNR   = T1.EEJDNR          
                                   AND T3.ELBNR    = T1.ELBNR           
                                   AND T3.FELTKODE = 204                
                                   AND T3.INDHOLD_C IN ('3','8'))       
                                                                        
              ORDER BY 1, 2, 3, 4                                       
              FOR FETCH ONLY                                            
         ;                                                              
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
              FEJLTEKST  = 'DECLARE EVS_CURSOR ';                       
              FEJLTEKST  = 'BH97900 ** 251 ' !! FEJLTEKST;              
              CALL SQL_FEJL;                                            
            END;                                                        
                                                                        
 END DECLARE_EVS_CUR;                                                   
 /********************************************************************* 
 *       LÆS UDTRÆK                                                   * 
 *********************************************************************/ 
 LÆS_UDTRÆK:                                                            
                                                                        
         PROC;                                                          
                                                                        
         EXEC SQL                                                       
                                                                        
              FETCH EVS_CUR                                             
                                                                        
              INTO  :STYR_FELTER.DCPRN,                                 
                    :STYR_FELTER.EKOMNR,                                
                    :STYR_FELTER.EEJDNR,                                
                    :STYR_FELTER.ELBNR;                                 
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0)                                                     
              TV.LÆS_UDTRÆK = TV.LÆS_UDTRÆK + 1;                        
                                                                        
           WHEN (100);                                                  
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'FETCH EVS_CURSOR ';                        
               FEJLTEKST  = 'BH97900 ** 251 ' !! FEJLTEKST;             
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* END-SELECT */                                          
                                                                        
 END LÆS_UDTRÆK;                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR                                           * 
 *********************************************************************/ 
 LÆS_BH960:                                                             
         PROC;                                                          
                                                                        
         READ FILE (BH960I) INTO (BH960_AR);                            
                                                                        
         IF EOF_BH960 = NEJ                                             
         THEN                                                           
            TV.LÆS_BH960 = TV.LÆS_BH960 + 1;                            
                                                                        
 END LÆS_BH960;                                                         
 /********************************************************************* 
 *       PERSONER SOM EVT. SKAL OPDATERES                             * 
 *********************************************************************/ 
 BEHANDL_PERSON:                                                        
         PROC;                                                          
                                                                        
         BQ_UD = BQ_IND, BY NAME;                                       
                                                                        
         BQ_UD.PERSON.CAJOUR = '1';                                     
                                                                        
         CALL ZS38100(HJ_TIMESTAMP);                                    
                                                                        
         BQ_UD.PERSON.DFRAGLD = HJ_TIMESTAMP;                           
         BQ_UD.PERSON.DTILGLD = '9999-12-31-23.59.59.999999';           
                                                                        
         BQ_UD.PERSON.FELT759 = '1';                                    
         BQ_UD.PERSON.CEJDTYPE_AKT = BH960.EJERSKAB.CEJDTYPE_AKT;       
                                                                        
         IF BQ_UD.PERSON.CEJBEVS = '1'                                  
          ! BQ_UD.PERSON.CEJBEVS = '2'                                  
          ! BQ_UD.PERSON.CEJBEVS = '3'                                  
          ! BQ_UD.PERSON.CEJBEVS = '6'                                  
          ! BQ_UD.PERSON.CEJBEVS = '7'                                  
          ! BQ_UD.PERSON.CEJBEVS = '8'                                  
          ! BQ_UD.PERSON.CEJBEVS = '9'                                  
          ! BQ_UD.PERSON.CSLET   = '1'                                  
          ! BQ_UD.PERSON.FERHVFLER = 360                                
          ! BQ_UD.INDK_PERS.BEVSMAN_I = 0                               
         THEN                                                           
            DO;                                                         
              BQ_UD.PERSON.BGRPROM1        = 0;                         
              BQ_UD.PERSON.BPROM1          = 0;                         
              BQ_UD.INDK_PERS.BGRPROM1_I   = -1;                        
              BQ_UD.INDK_PERS.BPROM1_I     = -1;                        
              BQ_UD.PERSON.BGRPROM2        = 0;                         
              BQ_UD.PERSON.BPROM2          = 0;                         
              BQ_UD.INDK_PERS.BGRPROM2_I   = -1;                        
              BQ_UD.INDK_PERS.BPROM2_I     = -1;                        
              BQ_UD.PERSON.BNEDSL1         = 0;                         
              BQ_UD.INDK_PERS.BNEDSL1_I    = -1;                        
              BQ_UD.PERSON.BNEDSL2         = 0;                         
              BQ_UD.INDK_PERS.BNEDSL2_I    = -1;                        
              BQ_UD.PERSON.BPENSNED        = 0;                         
              BQ_UD.INDK_PERS.BPENSNED_I   = -1;                        
              BQ_UD.PERSON.BPENSNÆ         = 0;                         
              BQ_UD.INDK_PERS.BPENSNÆ_I    = -1;                        
              BQ_UD.PERSON.BPENSNEDGL      = 0;                         
              BQ_UD.INDK_PERS.BPENSNEDGL_I = -1;                        
              BQ_UD.PERSON.BGLSUM1         = 0;                         
              BQ_UD.INDK_PERS.BGLSUM1_I    = -1;                        
              BQ_UD.PERSON.CBGLSUM1        = ' ';                       
              BQ_UD.PERSON.BSTIBEGR        = 0;                         
              BQ_UD.INDK_PERS.BSTIBEGR_I   = -1;                        
              BQ_UD.PERSON.CSTIBLB         = ' ';                       
              BQ_UD.PERSON.BSTITIL         = 0;                         
              BQ_UD.INDK_PERS.BSTITIL_I    = -1;                        
              BQ_UD.PERSON.BSUM1           = 0;                         
              BQ_UD.INDK_PERS.BSUM1_I      = -1;                        
              BQ_UD.PERSON.BSUM2           = 0;                         
              BQ_UD.INDK_PERS.BSUM2_I      = -1;                        
              BQ_UD.PERSON.BSUM3           = 0;                         
              BQ_UD.INDK_PERS.BSUM3_I     = -1;                         
              BQ_UD.PERSON.BNETTO          = 0;                         
              BQ_UD.INDK_PERS.BNETTO_I     = -1;                        
            END;                                                        
                                                                        
         ELSE                                                           
            DO;                                                         
              BQ04907N.TIL.BEVSGL    = BQ_UD.PERSON.BEVSGL;             
              BQ04907N.TIL.BEVSGL_SW = BQ_UD.INDK_PERS.BEVSGL_I;        
              BQ04907N.TIL.BPENSNÆGL = BQ_UD.PERSON.BPENSNÆGL;          
              BQ04907N.TIL.BPENSNÆGL_SW = BQ_UD.INDK_PERS.BPENSNÆGL_I;  
              BQ04907N.TIL.CPTYPGL   = BQ_UD.PERSON.CPTYPGL;            
              BQ04907N.TIL.CPTYPSLUT = BQ_UD.PERSON.CPTYPSLUT;          
              BQ04907N.TIL.BBERGRL   = BQ_UD.PERSON.BBERGRL;            
              BQ04907N.TIL.BBERGRL_SW = BQ_UD.INDK_PERS.BBERGRL_I;      
              BQ04907N.TIL.BBER2FAM    = BQ_UD.PERSON.BBER2FAM;         
              BQ04907N.TIL.BBER2FAM_SW = BQ_UD.INDK_PERS.BBER2FAM_I;    
              BQ04907N.TIL.CEJDTYPE_AKT = BQ_UD.PERSON.CEJDTYPE_AKT;    
              BQ04907N.TIL.CNEDSL1 = BQ_UD.PERSON.CNEDSL1;              
              BQ04907N.TIL.FELT760 = BQ_UD.PERSON.FELT760;              
              BQ04907N.TIL.FELT759 = BQ_UD.PERSON.FELT759;              
              BQ04907N.TIL.BFASTSTIGBGR_SW =                            
                                    BQ_UD.INDK_PERS.BFASTSTIGBGR_I;     
              BQ04907N.TIL.BFASTSTIGBGR = BQ_UD.PERSON.BFASTSTIGBGR;    
                                                                        
              CALL BEREGN_EVS_KMD_DEL(BQ04907N);                        
                                                                        
              BQ_UD.PERSON.BGLSUM1       = BQ04907N.FRA.BGLSUM1;        
              BQ_UD.INDK_PERS.BGLSUM1_I  = BQ04907N.FRA.BGLSUM1_SW;     
              BQ_UD.PERSON.BPENSNEDGL    = BQ04907N.FRA.BPENSNEDGL;     
              BQ_UD.INDK_PERS.BPENSNEDGL_I = BQ04907N.FRA.BPENSNEDGL_SW;
              BQ_UD.PERSON.CBGLSUM1      = BQ04907N.FRA.CBGLSUM1;       
              BQ_UD.PERSON.BGRPROM1      = BQ04907N.FRA.BGRPROM1;       
              BQ_UD.INDK_PERS.BGRPROM1_I = BQ04907N.FRA.BGRPROM1_SW;    
              BQ_UD.PERSON.BGRPROM2      = BQ04907N.FRA.BGRPROM2;       
              BQ_UD.INDK_PERS.BGRPROM2_I = BQ04907N.FRA.BGRPROM2_SW;    
              BQ_UD.PERSON.BSTITIL       = BQ04907N.FRA.BSTITIL;        
              BQ_UD.INDK_PERS.BSTITIL_I  = BQ04907N.FRA.BSTITIL_SW;     
              BQ_UD.PERSON.CSTIBLB       = BQ04907N.FRA.CSTIBLB;        
              BQ_UD.PERSON.BPROM1        = BQ04907N.FRA.BPROM1;         
              BQ_UD.INDK_PERS.BPROM1_I   = BQ04907N.FRA.BPROM1_SW;      
              BQ_UD.PERSON.BPROM2        = BQ04907N.FRA.BPROM2;         
              BQ_UD.INDK_PERS.BPROM2_I   = BQ04907N.FRA.BPROM2_SW;      
              BQ_UD.PERSON.BNEDSL1       = BQ04907N.FRA.BNEDSL1;        
              BQ_UD.INDK_PERS.BNEDSL1_I  = BQ04907N.FRA.BNEDSL1_SW;     
              BQ_UD.PERSON.CNEDSL2       = BQ04907N.FRA.CNEDSL2;        
              BQ_UD.PERSON.BNEDSL2       = BQ04907N.FRA.BNEDSL2;        
              BQ_UD.INDK_PERS.BNEDSL2_I  = BQ04907N.FRA.BNEDSL2_SW;     
              BQ_UD.PERSON.BPENSNED      = BQ04907N.FRA.BPENSNED;       
              BQ_UD.INDK_PERS.BPENSNED_I = BQ04907N.FRA.BPENSNED_SW;    
              BQ_UD.PERSON.BPENSNÆ       = BQ04907N.FRA.BPENSNÆ;        
              BQ_UD.INDK_PERS.BPENSNÆ_I  = BQ04907N.FRA.BPENSNÆ_SW;     
              BQ_UD.PERSON.BSUM1         = BQ04907N.FRA.BSUM1;          
              BQ_UD.INDK_PERS.BSUM1_I    = BQ04907N.FRA.BSUM1_SW;       
              BQ_UD.PERSON.BSUM2         = BQ04907N.FRA.BSUM2;          
              BQ_UD.INDK_PERS.BSUM2_I    = BQ04907N.FRA.BSUM2_SW;       
              BQ_UD.PERSON.BSUM3         = BQ04907N.FRA.BSUM3;          
              BQ_UD.INDK_PERS.BSUM3_I    = BQ04907N.FRA.BSUM3_SW;       
              BQ_UD.PERSON.BSTIBEGR      = BQ04907N.FRA.BSTIBEGR;       
              BQ_UD.INDK_PERS.BSTIBEGR_I = BQ04907N.FRA.BSTIBEGR_SW;    
              BQ_UD.PERSON.BNETTO        = BQ04907N.FRA.BNETTO;         
              BQ_UD.INDK_PERS.BNETTO_I   = BQ04907N.FRA.BNETTO_SW;      
            END;                                                        
                                                                        
         CALL DATA_MODUL('SKRIV');                                      
                                                                        
 END BEHANDL_PERSON;                                                    
 /**********************************************************************
 **     DATA_MODUL                                                    **
 **********************************************************************/
 DATA_MODUL: PROC (FUNKTION);                                           
                                                                        
         DCL FUNKTION    CHAR (10);                                     
                                                                        
         KOM_AREAL.KOMM         = '';                                   
         KOM_AREAL.SØG          = '';                                   
         KOM_AREAL.SØG.DCPRN    = STYR_FELTER.DCPRN;                    
         KOM_AREAL.SØG.DINDKAAR = STYR_FELTER.DINDKAAR;                 
         KOM_AREAL.SØG.EKOMNR   = STYR_FELTER.EKOMNR;                   
         KOM_AREAL.SØG.EEJDNR   = STYR_FELTER.EEJDNR;                   
         KOM_AREAL.SØG.ELBNR    = STYR_FELTER.ELBNR;                    
         KOM_AREAL.KOMM.TYPE    = STYR_FELTER.TYPE;                     
                                                                        
         SELECT (FUNKTION);                                             
                                                                        
            WHEN ('LÆS')                                                
              DO;                                                       
                KOM_AREAL.FUNKTION = 1;                                 
                CALL BQ04110 (KOM_AREAL,BQ_IND);                        
              END;                                                      
                                                                        
            WHEN ('SKRIV')                                              
              DO;                                                       
                 KOM_AREAL.FUNKTION = 2;                                
                 CALL BQ04110 (KOM_AREAL,BQ_UD);                        
              END;                                                      
                                                                        
            OTHER                                                       
              PUT SKIP LIST ('BQ04110 DATAMODUL FORKERT FUNKTION'!!     
                                                        FUNKTION);      
         END; /*SELECT (FUNKTION)*/                                     
                                                                        
                                                                        
         STYR_FELTER.RETURKODE  = KOM_AREAL.RETURKODE;                  
         STYR_FELTER.RETURTEKST = KOM_AREAL.RETURTEKST;                 
         STYR_FELTER.FEJLTEKST  = KOM_AREAL.RETURTEKST;                 
                                                                        
         IF KOM_AREAL.RETURKODE = 0                                     
         THEN                                                           
            DO;                                                         
              IF KOM_AREAL.FUNKTION = 1                                 
              THEN                                                      
                 TV_LÆS_EVS = TV_LÆS_EVS + 1;                           
              ELSE                                                      
                 TV_SKRIV_EVS = TV_SKRIV_EVS + 1;                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               IF KOM_AREAL.RETURKODE < 0                               
               THEN                                                     
                  DO;                                                   
                    STYR_FELTER.FEJLNR = 9999;                          
                    PUT SKIP LIST (' ALVORLIG FEJL ' );                 
                 END;                                                   
            END;                                                        
                                                                        
         IF KOM_AREAL.RETURKODE ^= 0                                    
         THEN                                                           
            CALL ZS30101 (5,STYR_FELTER.FEJLTEKST,2);                   
                                                                        
 END DATA_MODUL;                                                        
 /*********************************************************************/
 /*      DANNE DATA TIL SLUT CSC VEDR. SUPPLEMENTSLEVERINGEN          */
 /*********************************************************************/
 DAN_DATA_TIL_SLUT: PROC;                                               
                                                                        
    BH979                   = '';                                       
    BH979.INDVNR            = 810;                                      
    BH979.INDVLGD           = 554;                                      
    BH979.FELTLGD           = 554;                                      
    BH979.HEADER            = 'EVSGRUND';                               
    BH979.DINDKAAR          = '2004';                                   
    BH979.DCPRN             = STYR_FELTER.DCPRN;                        
    BH979.EKOMNR            = STYR_FELTER.EKOMNR;                       
    BH979.EEJDNR            = STYR_FELTER.EEJDNR;                       
    BH979.ELBNR             = STYR_FELTER.ELBNR;                        
    BH979.CSLET             = BQ_UD.PERSON.CSLET;                       
    BH979.CSKPLOMF          = BQ_UD.PERSON.CSKPLOMF;                    
    BH979.CEJBEVS           = BQ_UD.PERSON.CEJBEVS;                     
    BH979.BOBEHAKOD         = BQ_UD.PERSON.BOBEHAKOD;                   
    BH979.MANPENSSTI_I      = BQ_UD.INDK_PERS.MANPENSSTI_I;             
    BH979.MANPENSSTI        = BQ_UD.PERSON.MANPENSSTI;                  
    BH979.BBERGRL_015ANV_I  = BQ_UD.INDK_PERS.BBERGRL_015ANV_I;         
    BH979.BBERGRL_015ANV    = BQ_UD.PERSON.BBERGRL_015ANV;              
    BH979.BBERGRL_02ANV_I   = BQ_UD.INDK_PERS.BBERGRL_02ANV_I;          
    BH979.BBERGRL_02ANV     = BQ_UD.PERSON.BBERGRL_02ANV;               
    BH979.BBERGRL_AKT_I     = BQ_UD.INDK_PERS.BBERGRL_AKT_I;            
    BH979.BBERGRL_AKT       = BQ_UD.PERSON.BBERGRL_AKT;                 
    BH979.BBERGRLUDL_01_I   = BQ_UD.INDK_PERS.BBERGRLUDL_01_I;          
    BH979.BBERGRLUDL_01     = BQ_UD.PERSON.BBERGRLUDL_01;               
    BH979.BOMBTILBUDL_01_I  = BQ_UD.INDK_PERS.BOMBTILBUDL_01_I;         
    BH979.BOMBTILBUDL_01    = BQ_UD.PERSON.BOMBTILBUDL_01;              
    BH979.BBER2FAM_015ANV_I = BQ_UD.INDK_PERS.BBER2FAM_015ANV_I;        
    BH979.BBER2FAM_015ANV   = BQ_UD.PERSON.BBER2FAM_015ANV;             
    BH979.BBER2FAM_02ANV_I  = BQ_UD.INDK_PERS.BBER2FAM_02ANV_I;         
    BH979.BBER2FAM_02ANV    = BQ_UD.PERSON.BBER2FAM_02ANV;              
    BH979.BBER2FAM_AKT_I    = BQ_UD.INDK_PERS.BBER2FAM_AKT_I;           
    BH979.BBER2FAM_AKT      = BQ_UD.PERSON.BBER2FAM_AKT;                
    BH979.EJDBELIG          = BQ_UD.EJENDOM.EJDBELIG;                   
    BH979.CEJDTYPE          = BQ_UD.PERSON.CEJDTYPE_AKT;                
    BH979.CÆGTOPR           = BQ_UD.PERSON.CÆGTOPR;                     
    BH979.DOVTG             = BQ_UD.PERSON.DOVTG;                       
    BH979.DAFSTAA           = BQ_UD.PERSON.DAFSTAA;                     
    BH979.GPCTEJER          = BQ_UD.PERSON.GPCTEJER;                    
    BH979.GPCTEJER_I        = BQ_UD.INDK_PERS.GPCTEJER_I;               
    BH979.FDAGUDLE          = BQ_UD.PERSON.FDAGUDLE;                    
    BH979.GPCTUDLE          = BQ_UD.PERSON.GPCTUDLE;                    
    BH979.FUDL100           = BQ_UD.PERSON.FUDL100;                     
    BH979.GPCTERHV          = BQ_UD.PERSON.GPCTERHV;                    
    BH979.FDAGERHV          = BQ_UD.PERSON.FDAGERHV;                    
    BH979.FERHVFLER         = BQ_UD.PERSON.FERHVFLER;                   
    BH979.CENKE             = BQ_UD.PERSON.CENKE;                       
    BH979.CPTYPSLUT         = BQ_UD.PERSON.CPTYPSLUT;                   
    BH979.CPTYPGL           = BQ_UD.PERSON.CPTYPGL;                     
    BH979.FELT759           = BQ_UD.PERSON.FELT759;                     
    BH979.FELT760           = BQ_UD.PERSON.FELT760;                     
    BH979.BEVSGL_I          = BQ_UD.INDK_PERS.BEVSGL_I;                 
    BH979.BEVSGL            = BQ_UD.PERSON.BEVSGL;                      
    BH979.BPENSNEDGL_I      = BQ_UD.INDK_PERS.BPENSNEDGL_I;             
    BH979.BPENSNEDGL        = BQ_UD.PERSON.BPENSNEDGL;                  
    BH979.DINDFLYT          = BQ_UD.PERSON.DINDFLYT;                    
    BH979.DFRAFLYT          = BQ_UD.PERSON.DFRAFLYT;                    
    BH979.FUBEBOELIG        = BQ_UD.PERSON.FUBEBOELIG;                  
    BH979.BFASTSTIGBGR_I    = BQ_UD.INDK_PERS.BFASTSTIGBGR_I;           
    BH979.BFASTSTIGBGR      = BQ_UD.PERSON.BFASTSTIGBGR;                
    BH979.CINDFLYT          = BQ_UD.PERSON.CINDFLYT;                    
    BH979.CBERGRGLOP        = BQ_UD.PERSON.CBERGRGLOP;                  
    BH979.BMANEVSSTI_I      = BQ_UD.INDK_PERS.BMANEVSSTI_I;             
    BH979.BMANEVSSTI        = BQ_UD.PERSON.BMANEVSSTI;                  
    BH979.BEVSMAN_I         = BQ_UD.INDK_PERS.BEVSMAN_I;                
    BH979.BEVSMAN           = BQ_UD.PERSON.BEVSMAN;                     
    BH979.BMANNEDSL_I       = BQ_UD.INDK_PERS.BMANNEDSL_I;              
    BH979.BMANNEDSL         = BQ_UD.PERSON.BMANNEDSL;                   
    BH979.CEKSEMP           = BQ_UD.PERSON.CEKSEMP;                     
    BH979.MANNEDSLSTI_I     = BQ_UD.INDK_PERS.MANNEDSLSTI_I;            
    BH979.MANNEDSLSTI       = BQ_UD.PERSON.MANNEDSLSTI;                 
    BH979.BUDLSKC_I         = BQ_UD.INDK_PERS.BUDLSKC_I;                
    BH979.BUDLSKC           = BQ_UD.PERSON.BUDLSKC;                     
    BH979.BEJBOL1_AKT_I     = BQ_UD.INDK_PERS.BEJBOL1_AKT_I;            
    BH979.BEJBOL1_AKT       = BQ_UD.PERSON.BEJBOL1_AKT;                 
    BH979.BEJBOL2_AKT_I     = BQ_UD.INDK_PERS.BEJBOL2_AKT_I;            
    BH979.BEJBOL2_AKT       = BQ_UD.PERSON.BEJBOL2_AKT;                 
    BH979.DAFSTAAFOR        = BQ_UD.PERSON.DAFSTAAFOR;                  
    BH979.CVURDOPR          = BQ_UD.EJENDOM.CVURDOPR;                   
    BH979.BEJBOL1_02ANV_I   = BQ_UD.INDK_PERS.BEJBOL1_02ANV_I;          
    BH979.BEJBOL1_02ANV     = BQ_UD.PERSON.BEJBOL1_02ANV;               
    BH979.BEJBOL2_02ANV_I   = BQ_UD.INDK_PERS.BEJBOL2_02ANV_I;          
    BH979.BEJBOL2_02ANV     = BQ_UD.PERSON.BEJBOL2_02ANV;               
    BH979.CBENYT            = BQ_UD.EJENDOM.CBENYT;                     
    BH979.CSCREGISTMP       = BQ_UD.PERSON.CSCREGISTMP;                 
    BH979.COMBYG            = BQ_UD.EJENDOM.COMBYG;                     
    BH979.CBERGRL           = BQ_UD.EJENDOM.CBERGRL;                    
    BH979.BPROM2_I          = BQ_UD.INDK_PERS.BPROM2_I;                 
    BH979.BPROM2            = BQ_UD.PERSON.BPROM2;                      
    BH979.BPROM1_I          = BQ_UD.INDK_PERS.BPROM1_I;                 
    BH979.BPROM1            = BQ_UD.PERSON.BPROM1;                      
    BH979.CELØNCOR          = BQ_UD.PERSON.CELØNCOR;                    
    BH979.GPCTEJERFOR       = BQ_UD.PERSON.GPCTEJERFOR;                 
    BH979.CERHV             = BQ_UD.PERSON.CERHV;                       
    BH979.BGLSUM1_I         = BQ_UD.INDK_PERS.BGLSUM1_I;                
    BH979.BGLSUM1           = BQ_UD.PERSON.BGLSUM1;                     
    BH979.BBERGRL_I         = BQ_UD.INDK_PERS.BBERGRL_I;                
    BH979.BBERGRL           = BQ_UD.PERSON.BBERGRL;                     
    BH979.CBERGROP          = BQ_UD.PERSON.CBERGROP;                    
    BH979.BSTIBEGR_I        = BQ_UD.INDK_PERS.BSTIBEGR_I;               
    BH979.BSTIBEGR          = BQ_UD.PERSON.BSTIBEGR;                    
    BH979.BFORSKAT_I        = BQ_UD.INDK_PERS.BFORSKAT_I;               
    BH979.BFORSKAT          = BQ_UD.PERSON.BFORSKAT;                    
    BH979.CFORSKAT          = BQ_UD.PERSON.CFORSKAT;                    
    BH979.BNEDSL1_I         = BQ_UD.INDK_PERS.BNEDSL1_I;                
    BH979.BNEDSL1           = BQ_UD.PERSON.BNEDSL1;                     
    BH979.BPENSNED_I        = BQ_UD.INDK_PERS.BPENSNED_I;               
    BH979.BPENSNED          = BQ_UD.PERSON.BPENSNED;                    
    BH979.BNEDSL2_I         = BQ_UD.INDK_PERS.BNEDSL2_I;                
    BH979.BNEDSL2           = BQ_UD.PERSON.BNEDSL2;                     
    BH979.CNULSTIL          = BQ_UD.PERSON.CNULSTIL;                    
    BH979.CUDLMAN           = BQ_UD.PERSON.CUDLMAN;                     
    BH979.BBER2FAM_I        = BQ_UD.INDK_PERS.BBER2FAM_I;               
    BH979.BBER2FAM          = BQ_UD.PERSON.BBER2FAM;                    
    BH979.FEJLNR            = BQ_UD.PERSON.FEJLNR;                      
    BH979.BEJBOL1_015ANV_I  = BQ_UD.INDK_PERS.BEJBOL1_015ANV_I;         
    BH979.BEJBOL1_015ANV    = BQ_UD.PERSON.BEJBOL1_015ANV;              
    BH979.BEJBOL2_015ANV_I  = BQ_UD.INDK_PERS.BEJBOL2_015ANV_I;         
    BH979.BEJBOL2_015ANV    = BQ_UD.PERSON.BEJBOL2_015ANV;              
    BH979.CSKPLOMFGL        = BQ_UD.PERSON.CSKPLOMFGL;                  
    BH979.DFRAGLD           = BQ_UD.PERSON.DFRAGLD;                     
    BH979.CNEDSL1           = BQ_UD.PERSON.CNEDSL1;                     
    BH979.FLEJL             = BQ_UD.EJENDOM.FLEJL;                      
    BH979.BGRPROM2_I        = BQ_UD.INDK_PERS.BGRPROM2_I;               
    BH979.BGRPROM2          = BQ_UD.PERSON.BGRPROM2;                    
    BH979.DOVTGFOR          = BQ_UD.PERSON.DOVTGFOR;                    
    BH979.CSTIBLB           = BQ_UD.PERSON.CSTIBLB;                     
    BH979.CDATAFRA          = BQ_UD.PERSON.CDATAFRA;                    
    BH979.CUDLHEL           = BQ_UD.PERSON.CUDLHEL;                     
    BH979.CUDLDEL           = BQ_UD.PERSON.CUDLDEL;                     
    BH979.BGRPROM1_I        = BQ_UD.INDK_PERS.BGRPROM1_I;               
    BH979.BGRPROM1          = BQ_UD.PERSON.BGRPROM1;                    
    BH979.EKOMNR_GL         = ' ';                                      
    BH979.EEJDNR_GL         = ' ';                                      
                                                                        
    TV.SKREVET = TV.SKREVET + 1;                                        
                                                                        
    WRITE FILE (BH979O) FROM (BH979);                                   
                                                                        
 END DAN_DATA_TIL_SLUT;                                                 
                                                                        
 /*-------------------------------------------------------------------*/
 /* DB2_DATO_TIL_FIX09                                                */
 /* HVIS DATO = BLANKE, RETURNES 0                                    */
 /*-------------------------------------------------------------------*/
 DB2_DATO_TIL_FIX09: PROC (DB2_DATO_IND) RETURNS (DEC FIXED (09));      
                                                                        
 DCL     DB2_DATO_IND    CHAR      (10);   /* ÅÅÅÅ-MM-DD*/              
 DCL     DATO_CHAR       CHAR      (08);   /* ÅÅÅÅMMDD  */              
 DCL     DATO_PIC        PIC       '99999999' DEF DATO_CHAR;            
 DCL     DATO_FIX        DEC FIXED (09);                                
                                                                        
         DATO_CHAR = SUBSTR (DB2_DATO_IND,1,4) !!                       
                     SUBSTR (DB2_DATO_IND,6,2) !!                       
                     SUBSTR (DB2_DATO_IND,9,2);                         
         IF DB2_DATO_IND = ''                                           
         THEN                                                           
            DATO_PIC = 0;                                               
                                                                        
         DATO_FIX = DATO_PIC;                                           
                                                                        
         RETURN (DATO_FIX);                                             
                                                                        
 END DB2_DATO_TIL_FIX09;                                                
 /*-------------------------------------------------------------------*/
 /* DB2_DATO_TIL_FIX09                                                */
 /* NB HVIS DATO = 0, SÆTTES DB2-DATO = BLANKE                        */
 /*-------------------------------------------------------------------*/
 FIX09_TIL_DB2_DATO: PROC (FIX_DATO_IND) RETURNS (CHAR (10));           
                                                                        
 DCL     FIX_DATO_IND        DEC FIXED (09);                            
 DCL     DATO_PIC        PIC       '99999999';                          
 DCL     1 DATO          BASED (ADDR(DATO_PIC)),                        
          2 ÅR           PIC      '9999',                               
          2 MD           PIC        '99',                               
          2 DG           PIC        '99';                               
 DCL     DATO_CHAR       CHAR      (10);   /* ÅÅÅÅ-MM-DD*/              
                                                                        
         DATO_PIC  = FIX_DATO_IND;                                      
         DATO_CHAR = DATO.ÅR !! '-' !!                                  
                     DATO.MD !! '-' !!                                  
                     DATO.DG;                                           
                                                                        
         IF FIX_DATO_IND = 0                                            
         THEN                                                           
            DATO_CHAR = '';                        /** ?? **/           
                                                                        
         RETURN (DATO_CHAR);                                            
                                                                        
 END FIX09_TIL_DB2_DATO;                                                
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_UDTRÆK;                                 
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK                      '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH960;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ BEREGN BÅND        B.H96000D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV_SKRIV_EVS;                                  
         DETLIN1.TEKST = 'ANTAL AJOURFØRTE EVS                        ';
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SUPPL INDIVIDER TIL CSC D0311604.A782'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
 END TOTALLISTE;                                                        
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL:                                                              
         PROC;                                                          
                                                                        
         CLOSE FILE (BH960I);                                           
         CLOSE FILE (BH979O);                                           
         CALL ZS67000(SQLCA);                                           
                                                                        
         ABENDMEDD =  FEJLTEKST;                                        
                                                                        
         CALL ZS30101 (5, ABENDMEDD, 2);                                
                                                                        
 END SQL_FEJL;                                                          
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
                                                                        
         CALL TOTALLISTE;                                               
                                                                        
         CALL ZZ20300((133)' ','99');                                   
                                                                        
         CLOSE FILE (BH960I);                                           
         CLOSE FILE (BH979O);                                           
                                                                        
 END AFSLUT;                                                            
 /*********************************************************************/
         %INCLUDE BH00001M;                    /* CHAR4_TIL_BIN15     */
                                               /* CHAR10_TIL_FIX11    */
                                                                        
         %INCLUDE BQ04907M;                    /* BEREGN_EVS_KMD_DEL  */
                                                                        
 END  BH97900;                                                          
