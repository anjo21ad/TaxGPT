  PROCESS OPT(TIME);                                                    
 BH88200: /** SLET TABELLER FOR EVS OPRET FOR ET BESTEMT ÅR OG AFVID **/
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 DCL COPYRIGHT CHAR (30) STATIC INIT ('COPYRIGHT KOMMUNEDATA I/S 2013');
 /**********************************************************************
 * FORMÅL:                                                             *
 * Slet tabelindhold fra BQ62, 63, 64, 68, 69, 75, 76, 77 og 78        *
 * for et enkelt år med en given afviklings_id                         *
 * f.eks.  2018  OPRET_EVS_FORSK                                       *
 *                                                                     *
 * PROGRAMMERET AF  Lene Maj Jensen, Oktober 2017                      *
 *                                                                     *
 * Tabellerne slettes via en cursor med 500 ad gangen, pånær de to     *
 * tabeller til kørselsnr og flow. Disse kan slettes normalt           *
 *                                                                     *
 * OBS.: Dette modul skal kun køres i nødstilfælde, for at nustille en *
 *       hel kørsel for at starte på en frisk afvikling.               *
 **********************************************************************/
         DEFAULT RANGE(*) STATIC UNALIGNED CONN;                        
                                                                        
 /*********************************************************************/
 /*      DECLARE AF FILER                                             */
 /*********************************************************************/
                                                                        
 DCL     BH882I      FILE RECORD INPUT;     /* Parameter Forskud-Slut */
 DCL     SYSPRINT EXTERNAL FILE PRINT;                                  
 /*********************************************************************/
 /*      DECLARE AF AREALER TIL SQL                                   */
 /*********************************************************************/
         EXEC SQL INCLUDE SQLCA;           /* SQL KOMMUNIKATIONSAREAL */
                                                                        
 /*********************************************************************/
 /*      DECLARE AF DIVERSE                                           */
 /*********************************************************************/
                                                                        
 DCL     WS_PROGRAMNAVN                 CHAR(8)  INIT ('BH88200');      
 DCL     WS_TIL_EVS_AAR                 BIN FIXED (15);                 
 DCL     WS_FORSKUD_SLUT_TXT               CHAR(16) INIT (' ');         
                                                                        
 DCL     1 BH882_PARM,                                                  
           3 TIL_EVS_AAR   pic '9999',                                  
           3 AFVIKLINGS_ID CHAR(16),                                    
           3 REST          CHAR(60);                                    
                                                                        
 DCL     EOF_BH882       BIT       (1);                                 
                                                                        
 DCL     JA              BIT       (1) INIT ('1'B);                     
 DCL     NEJ             BIT       (1) INIT ('0'B);                     
 DCL     TEST_PUT        BIT       (1) INIT ('0'B);                     
 DCL     ADDR            BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF ABEND STRUKTUR m.v.                               */
 /*                                                                   */
 /*********************************************************************/
 DCL     ABENDKODE     FIXED       (2) INIT(5);                         
 DCL     1 ABENDMEDD,                                                   
          2 ABENDMODUL CHAR      (7) INIT ('BH88200'),                  
          2 ABENDFILL1 CHAR      (1) INIT (' '),                        
          2 ABENDMEDNR CHAR      (2) INIT ('**'),                       
          2 ABENDFILL2 CHAR      (1) INIT (' '),                        
          2 ABENDTXT   CHAR      (45);                                  
                                                                        
 DCL     ABENDRTKODE   FIXED     (1) INIT (2);                          
 /*********************************************************************/
 /*      DECLARE AF ENTRIES                                           */
 /*********************************************************************/
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS67000         ENTRY;                                         
 /*********************************************************************/
 /* DECLARE AF TÆLLERE                                                */
 /*********************************************************************/
                                                                        
 DCL     ANT_DEL  BIN FIXED (31) INIT(0);  /* ANTAL SLETNINGER        */
                                                                        
 DCL     BQ62_ANTAL                     DEC FIXED(31) init (0);         
 DCL     BQ63_ANTAL                     DEC FIXED(31) init (0);         
 DCL     BQ64_ANTAL                     DEC FIXED(31) init (0);         
 DCL     BQ75_ANTAL                     DEC FIXED(31) init (0);         
 DCL     BQ76_ANTAL                     DEC FIXED(31) init (0);         
 DCL     BQ77_ANTAL                     DEC FIXED(31) init (0);         
 DCL     BQ78_ANTAL                     DEC FIXED(31) init (0);         
                                                                        
 DCL     BQ62HIST_ANTAL                 DEC FIXED(31) init (0);         
 DCL     BQ63HIST_ANTAL                 DEC FIXED(31) init (0);         
 DCL     BQ64HIST_ANTAL                 DEC FIXED(31) init (0);         
 DCL     BQ75HIST_ANTAL                 DEC FIXED(31) init (0);         
 DCL     BQ76HIST_ANTAL                 DEC FIXED(31) init (0);         
 DCL     BQ77HIST_ANTAL                 DEC FIXED(31) init (0);         
 DCL     BQ78HIST_ANTAL                 DEC FIXED(31) init (0);         
                                                                        
 DCL     ANTAL_DEL62_500                PIC '9999999999' init (0);      
 DCL     ANTAL_DEL63_500                PIC '9999999999' init (0);      
 DCL     ANTAL_DEL64_500                PIC '9999999999' init (0);      
 DCL     ANTAL_DEL75_500                PIC '9999999999' init (0);      
 DCL     ANTAL_DEL76_500                PIC '9999999999' init (0);      
 DCL     ANTAL_DEL77_500                PIC '9999999999' init (0);      
 DCL     ANTAL_DEL78_500                PIC '9999999999' init (0);      
                                                                        
 DCL     ANTAL_DEL62HIST_500            PIC '9999999999' init (0);      
 DCL     ANTAL_DEL63HIST_500            PIC '9999999999' init (0);      
 DCL     ANTAL_DEL64HIST_500            PIC '9999999999' init (0);      
 DCL     ANTAL_DEL75HIST_500            PIC '9999999999' init (0);      
 DCL     ANTAL_DEL76HIST_500            PIC '9999999999' init (0);      
 DCL     ANTAL_DEL77HIST_500            PIC '9999999999' init (0);      
 DCL     ANTAL_DEL78HIST_500            PIC '9999999999' init (0);      
                                                                        
 DCL     TOTAL_DEL62_500                PIC '9999999999' init (0);      
 DCL     TOTAL_DEL63_500                PIC '9999999999' init (0);      
 DCL     TOTAL_DEL64_500                PIC '9999999999' init (0);      
 DCL     TOTAL_DEL75_500                PIC '9999999999' init (0);      
 DCL     TOTAL_DEL76_500                PIC '9999999999' init (0);      
 DCL     TOTAL_DEL77_500                PIC '9999999999' init (0);      
 DCL     TOTAL_DEL78_500                PIC '9999999999' init (0);      
                                                                        
 DCL     TOTAL_DEL62HIST_500            PIC '9999999999' init (0);      
 DCL     TOTAL_DEL63HIST_500            PIC '9999999999' init (0);      
 DCL     TOTAL_DEL64HIST_500            PIC '9999999999' init (0);      
 DCL     TOTAL_DEL75HIST_500            PIC '9999999999' init (0);      
 DCL     TOTAL_DEL76HIST_500            PIC '9999999999' init (0);      
 DCL     TOTAL_DEL77HIST_500            PIC '9999999999' init (0);      
 DCL     TOTAL_DEL78HIST_500            PIC '9999999999' init (0);      
                                                                        
 DCL     UDDATO          CHAR      (10);                                
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2                              BASED(ADDR(DATO1)),       
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 /*********************************************************************/
 /* includes til DB2-tabeller                                         */
 /*********************************************************************/
         EXEC SQL INCLUDE BQ62000T;  /* SLUT UDTRÆK                   */
         EXEC SQL INCLUDE BQ63000T;  /* PENSIONSUDTRÆK                */
         EXEC SQL INCLUDE BQ64000T;  /* COR UDTRÆK                    */
         EXEC SQL INCLUDE BQ68000T;  /* FLOWTABEL                     */
         EXEC SQL INCLUDE BQ69000T;  /* Kørselstabel                  */
         EXEC SQL INCLUDE BQ75000T;  /* ESR (FORSKUD)                 */
         EXEC SQL INCLUDE BQ76000T;  /* MANDTAL (FORSKUD)             */
         EXEC SQL INCLUDE BQ77000T;  /* EVS_UDTRÆK (FORSKUD)          */
         EXEC SQL INCLUDE BQ78000T;  /* EVS_RESULTAT (FORSKUD)        */
                                                                        
         EXEC SQL INCLUDE BQ6200HT;  /* SLUT UDTRÆK HISTORIK          */
         EXEC SQL INCLUDE BQ6300HT;  /* PENSIONSUDTRÆK HISTORIK       */
         EXEC SQL INCLUDE BQ6400HT;  /* COR UDTRÆK HIST               */
         EXEC SQL INCLUDE BQ6900HT;  /* KØRSELSDATA                   */
         EXEC SQL INCLUDE BQ7500HT;  /* ESR (FORSKUD) HIST            */
         EXEC SQL INCLUDE BQ7600HT;  /* MANDTAL (FORSKUD) HIST        */
         EXEC SQL INCLUDE BQ7700HT;  /* EVS_UDTRÆK (FORSKUD) HIST     */
         EXEC SQL INCLUDE BQ7800HT;  /* EVS_RESULTAT (FORSKUD) HIST   */
                                                                        
 /*********************************************************************/
 /* Declare af CURSORS                                                */
 /*********************************************************************/
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF PRINTLINIER                                       */
 /*                                                                   */
 /*********************************************************************/
 DCL   1 LIN1,                                                          
        2 CTL      CHAR (1),                                            
        2 TX1      CHAR (47)      INIT ('PROGRAM: BH88200L'),           
        2 TX2      CHAR (59)      INIT                                  
                   ('SLETNING AF EN TOTAL AFVIKLING    '),              
        2 TX3      CHAR (14)      INIT ('UDSKREVET DEN '),              
        2 DATO     CHAR (10),                                           
        2 REST     CHAR (02)      INIT (' ');                           
 DCL   1 LIN2,                                                          
        2 CTL      CHAR (1),                                            
        2 F1       CHAR (54)      INIT ('  '),                          
        2 TX1      CHAR (20)      INIT ('KØRSELSKONTROLLISTE'),         
        2 REST     CHAR (58)      INIT (' ');                           
 DCL   1 LIN3,                                                          
        2 CTL      CHAR (1),                                            
        2 TEKST    CHAR (54),                                           
        2 ANT      PIC  'Z.ZZZ.ZZZ',                                    
        2 REST     CHAR (69)      INIT (' ');                           
 DCL   1 LIN_BLANK,                                                     
        2 CTL      CHAR (1),                                            
        2 F1       CHAR (132)     INIT (' ');                           
       %INCLUDE ZZ20301M;                                               
 /*********************************************************************/
 /*      HOUSEKEEPING                                                 */
 /*********************************************************************/
                                                                        
         PUT SKIP LIST ('START ' !! WS_PROGRAMNAVN);                    
                                                                        
         CALL ZS61900;                     /* UDSKRIVNING AF KST-DATO */
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
                ON ERROR SYSTEM;                                        
                PUT SKIP LIST ('PROGRAMFEJL');                          
                CALL PLIDUMP  ('SNHOB','PROGRAM BH88200L');             
            END;                                                        
                                                                        
         EOF_BH882 = NEJ;                                               
         OPEN FILE (BH882I) TITLE ('BH88200P');                         
                                                                        
         ON ENDFILE (BH882I)                                            
         BEGIN;                                                         
            EOF_BH882 = JA;                                             
         END;                                                           
                                                                        
         LIN_BLANK.CTL = ZZIK1;                                         
         LIN1.CTL = ZZWS2;                                              
         LIN2.CTL = ZZWS3;                                              
         LIN3.CTL = ZZWS2;                                              
         CALL ZZ20390 ('*OPEN','BH88201Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !! '-' !! DATO2.ÅR;       
         LIN1.DATO = UDDATO;                                            
 /*********************************************************************/
 /*      HOVEDSTYRING                                                 */
 /*********************************************************************/
         READ FILE (BH882I) INTO (BH882_PARM);                          
                                                                        
         IF EOF_BH882 = NEJ                                             
         THEN DO;                                                       
            put skip list ('sletning af indhold i tabeller fra ' !!     
            bh882_parm.til_evs_aar !! ' med afviklings_id ' !!          
            bh882_parm.afviklings_id);                                  
            IF BH882_PARM.TIL_EVS_AAR = 0 !                             
               BH882_PARM.AFVIKLINGS_ID = ' '                           
            THEN DO;                                                    
               PUT SKIP LIST ('PARAMETER skal udfyldes med ' !!         
               'til_evs_aar+afviklings_id der skal slettes');           
               ABENDTXT = '101 PARAMETERFEJL';                          
               CALL PROGRAM_FEJL;                                       
            END;                                                        
            ELSE DO;                                                    
               WS_TIL_EVS_AAR      = BH882_PARM.TIL_EVS_AAR;            
               WS_FORSKUD_SLUT_TXT = BH882_PARM.AFVIKLINGS_ID;          
                                                                        
               /* først de 2 små som alm. delete */                     
               CALL RYD_STAM68;                                         
               CALL RYD_STAM69;                                         
               CALL RYD_HIST69;                                         
                                                                        
               /* så slettes de store via cursor */                     
               CALL RYD_STAM62;                                         
               CALL RYD_HIST62;                                         
               CALL RYD_STAM63;                                         
               CALL RYD_HIST63;                                         
               CALL RYD_STAM64;                                         
               CALL RYD_HIST64;                                         
               CALL RYD_STAM75;                                         
               CALL RYD_HIST75;                                         
               CALL RYD_STAM76;                                         
               CALL RYD_HIST76;                                         
               CALL RYD_STAM77;                                         
               CALL RYD_HIST77;                                         
               CALL RYD_STAM78;                                         
               CALL RYD_HIST78;                                         
            END;                                                        
         END;                                                           
         ELSE DO;                                                       
            PUT SKIP LIST ('PARAMETERKORT MANGLER');                    
            ABENDTXT = '101 PARAMETERFEJL';                             
            CALL PROGRAM_FEJL;                                          
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM62: PROC;                                                      
                                                                        
         put skip list ('ryd_stam62 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ62000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM62  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM62;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST62: PROC;                                                      
                                                                        
        put skip list ('ryd_hist62 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ6200HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST62  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST62;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM63: PROC;                                                      
                                                                        
         put skip list ('ryd_stam63 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ63000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM63  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM63;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST63: PROC;                                                      
                                                                        
        put skip list ('ryd_hist63 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ6300HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST63  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST63;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM64: PROC;                                                      
                                                                        
         put skip list ('ryd_stam64 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ64000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM64  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM64;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST64: PROC;                                                      
                                                                        
        put skip list ('ryd_hist64 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ6400HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST64  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST64;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM68: PROC;                                                      
                                                                        
         put skip list ('ryd_stam68 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ68000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM68  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM68;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM69: PROC;                                                      
                                                                        
         put skip list ('ryd_stam69 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ69000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM69  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM69;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST69: PROC;                                                      
                                                                        
        put skip list ('ryd_hist69 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ6900HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST69  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST69;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM75: PROC;                                                      
                                                                        
         put skip list ('ryd_stam75 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ75000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM75  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM75;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST75: PROC;                                                      
                                                                        
        put skip list ('ryd_hist75 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ7500HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST75  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST75;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM76: PROC;                                                      
                                                                        
         put skip list ('ryd_stam76 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ76000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM76  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM76;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST76: PROC;                                                      
                                                                        
        put skip list ('ryd_hist76 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ7600HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST76  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST76;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM77: PROC;                                                      
                                                                        
         put skip list ('ryd_stam77 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ77000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM77  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM77;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST77: PROC;                                                      
                                                                        
        put skip list ('ryd_hist77 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ7700HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST77  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST77;                                                        
 /*********************************************************************/
 /* Ryd stamtabel                                                     */
 /*********************************************************************/
 RYD_STAM78: PROC;                                                      
                                                                        
         put skip list ('ryd_stam78 starter ');                         
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ78000T                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_STAM78  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_STAM78;                                                        
 /*********************************************************************/
 /* Ryd histtabel                                                     */
 /*********************************************************************/
 RYD_HIST78: PROC;                                                      
                                                                        
        put skip list ('ryd_hist78 starter ');                          
                                                                        
         EXEC SQL                                                       
         DELETE                                                         
         FROM                                                           
            BQ7800HT                                                    
         WHERE TIL_EVS_AAR   = :WS_TIL_EVS_AAR                          
         AND   AFVIKLINGS_ID = :WS_FORSKUD_SLUT_TXT;                    
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0)                                                     
             DO;                                                        
             END;                                                       
           WHEN (100)                                                   
             DO;                                                        
             END;                                                       
           OTHERWISE                                                    
             DO;                                                        
               ABENDTXT = '101 RYD_HIST78  ';                           
               CALL PUTSKIP_FEJL;                                       
               CALL SQL_FEJL;                                           
             END;                                                       
         END; /* SELECT*/                                               
                                                                        
         EXEC SQL COMMIT;                                               
                                                                        
 END RYD_HIST78;                                                        
 /*********************************************************************/
 /*          UDSKRIVNING AF TOTALLISTE                                */
 /*********************************************************************/
 SKRIV_TOTALER:                                                         
 PROC;                                                                  
         CALL ZZ20300(LIN_BLANK,'01');                                  
         CALL ZZ20300(LIN1,'01');                                       
         CALL ZZ20300(LIN2,'01');                                       
         LIN3.CTL = ZZWS2;                                              
         LIN3.TEKST = 'ANTAL SLETNINGER';                               
         LIN3.ANT = 0;  /* her skal lige rettes til et felt */          
         CALL ZZ20300(LIN3,'01');                                       
                                                                        
 END SKRIV_TOTALER;                                                     
 /*********************************************************************/
 /* HER UDSKRIVES SQL FEJL                                     RUTINE */
 /*********************************************************************/
 SQL_FEJL: PROC;                                                        
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED SQLCODE: ' !! SQLCA.SQLCODE);  
         PUT SKIP LIST ('*****************************************');   
                                                                        
         CALL ZS67000(SQLCA);                                           
                                                                        
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END SQL_FEJL;                                                          
 /*********************************************************************/
 /* PUT SKIP ABENDTXT = '101  VED SQL-fejl                     RUTINE */
 /*********************************************************************/
 PUTSKIP_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*******************************');             
         PUT SKIP LIST ('* FEJL   ' !! ABENDTXT !!                      
                        ' SQLCODE ' !! SQLCA.SQLCODE);                  
         PUT SKIP LIST ('*******************************');             
                                                                        
 END PUTSKIP_FEJL;                                                      
 /*********************************************************************/
 /* HER UDSKRIVES ØVRIGE FEJL                                  RUTINE */
 /*********************************************************************/
 PROGRAM_FEJL: PROC;                                                    
                                                                        
         PUT SKIP LIST ('*****************************************');   
         PUT SKIP LIST ('DER ABENDES MED PROGRAMFEJL');                 
         PUT SKIP LIST ('ABENDTXT:                ' !! ABENDTXT);       
         PUT SKIP LIST ('*****************************************');   
         CALL ZS30101(ABENDKODE,ABENDMEDD,ABENDRTKODE);                 
                                                                        
 END PROGRAM_FEJL;                                                      
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT: PROC;                                                          
                                                                        
         CALL SKRIV_TOTALER;                                            
         CALL ZZ20300(LIN_BLANK,'99');                                  
                                                                        
 END AFSLUT;                                                            
                                                                        
 END  BH88200;                                                          
