  PROCESS OPT(TIME);                                                    
 BH90300: /* EVS - BEHANDLING AF 2-EJERES EJERANDELSPROCENT */          
         PROC OPTIONS (MAIN) REORDER;                                   
 /*********************************************************************/
                                                                        
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 2001');       
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      ÅRSTILRETNING VIL 'NORMALT' KUN BESTÅ AF REKOMPILERING       */
 /*      PÅ GRUND AF ÆNDRING(ER) I INPUT-STRUKTURER.                  */
 /*                                                                   */
 /*********************************************************************/
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*      PROGRAMMET BEHANDLER EJENDOMME MED 2 EJERE.                  */
 /*      PROGRAMMETS FORMÅL ER AT KONTROLLERE OG EVT. OPSÆTTE         */
 /*      OG/ELLER NULSTILLE EJERANDELS-PROCENTEN.                     */
 /*                                                                   */
 /*      INDDATA : B.H90X91D (SORTERET UDTRÆK AF 2-EJERE)             */
 /*                                                                   */
 /*      UDDATA  : B.H90300D (BEHANDLET UDTRÆK AF 2-EJERE)            */
 /*              : BH90301Y  KONTROLLISTE                             */
 /*              : BH90302Y  FEJLLISTE VEDR. MASKINEL AFSTEMNING      */
 /*                                                                   */
 /*      EXT. REF: ZS61900   (SSI-DATO)                               */
 /*                                                                   */
 /* PROGRAMMØR:    AAGE RASMUSSEN, PUS T&S  AUG.   1999               */
 /* ÅRSTILRETTET:                ,                      SE SEKV  ?->80*/
 /*                                                                   */
 /*********************************************************************/
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /*********************************************************************/
 /*      DECLARE AF ENTRIES                                           */
 /*********************************************************************/
 DCL     ZS61900   ENTRY OPTIONS (INTER ASM);          /* UDSKRIV SSI */
 DCL     ZS30101   ENTRY;                                               
 DCL     ZS38100   ENTRY OPTIONS (INTER ASM);          /* TIMESTAMP   */
 DCL     ADDR      BUILTIN;                                             
 /*********************************************************************/
 /*      DECLARE AF FILER                                             */
 /*********************************************************************/
 DCL     BH903I          FILE RECORD INPUT;                             
 DCL     BH903O          FILE RECORD OUTPUT;                            
 /*********************************************************************/
 /*      DECLARE AF INPUT                                             */
 /*********************************************************************/
 DCL     BH903_P1   CHAR      (4000) VAR;   /* BEREGNINGSBÅND         */
 DCL     1 PERSON1                        BASED(ADDR(BH903_P1)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH90100N;;                                          
 DCL     1 OPTÆL1                         BASED(ADDR(BH903_P1)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH90099N;                                           
 DCL     BH903_P2   CHAR      (4000) VAR;   /* BEREGNINGSBÅND         */
 DCL     1 PERSON2                        BASED(ADDR(BH903_P2)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH90100N;;                                          
 DCL     1 OPTÆL2                         BASED(ADDR(BH903_P2)),        
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH90099N;                                           
 DCL     1 BH90399,                                                     
           %INCLUDE BH90099N;                                           
 /*********************************************************************/
 /*      DECLARE AF TÆLLEVÆRKER                                       */
 /*********************************************************************/
 DCL     1 TV,                                                          
           2  LÆSTEH     FIXED DEC (7),      /* LÆSTE HOP             */
           2  LÆSTEB     FIXED DEC (7),      /* LÆSTE BIP             */
           2  SAMGIFTH   FIXED DEC (7),      /* SAMGIFTE HOP          */
           2  SAMGIFTB   FIXED DEC (7),      /* SAMGIFTE BIP          */
           2  OVFH       FIXED DEC (7),      /* OVERFØRTE HOVEDPERS.  */
           2  OVFB       FIXED DEC (7),      /* OVERFØRTE BIPERSONER  */
           2  DELING     FIXED DEC (7);      /* DELING AF ANDEL LAVET */
 DCL     IALT            FIXED DEC (7);                                 
 /*********************************************************************/
 /*      DECLARE AF DIVERSE FELTER                                    */
 /*********************************************************************/
 DCL     EOF_BH903       BIT       (1)       INIT ('0'B);               
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     SKRIVES         CHAR      (01);                                
 DCL     1 GEM,                              /* BRUGES VED FORDELING  */
           2 EEJDNR      FIXED     (7),      /* AF EJERANDEL FOR      */
           2 GANE        FIXED     (5);      /* 2-EJERE UDEN MAKKER   */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER TIL KONTROLLISTE                      */
 /*********************************************************************/
 DCL     1 OVLIN1,                                                      
           2 CTL         CHAR      (01),                                
           2 TXT1        CHAR      (50) INIT ('PROGRAM: BH90300L'),     
           2 TXT2        CHAR      (58) INIT                            
             ('BEHANDLE TO-EJERE FØR EVS-BEREGNING   '),                
           2 TXT3        CHAR      (14) INIT ('UDSKREVET DEN'),         
           2 DATO        CHAR      (10);                                
 DCL     1 OVLIN2,                                                      
           2 CTL         CHAR      (01),                                
           2 F1          CHAR      (51) INIT (' '),                     
           2 TXT1        CHAR      (91) INIT                            
           ('          KØRSELSKONTROLLISTE');                           
 DCL     LINIE           CHAR      (133);                               
 DCL     1  DETAIL                           DEF LINIE,                 
          2  STYR        CHAR      (1),                                 
          2  TEKST       CHAR      (44),                                
          2  ANTALH      PIC       'Z.ZZZ.ZZ9',                         
          2  BLANKE1     CHAR      (8),                                 
          2  ANTALB      PIC       'Z.ZZZ.ZZ9',                         
          2  BLANKE2     CHAR      (11),                                
          2  ANTALF      PIC       'Z.ZZZ.ZZ9',                         
          2  BLANKE3     CHAR      (11),                                
          2  ANTALIALT   PIC       'Z.ZZZ.ZZ9';                         
 DCL     1  DETAIL2                          DEF LINIE,                 
          2  STYR        CHAR      (1),                                 
          2  TEKST       CHAR      (44),                                
          2  BLANKE      CHAR      (37),                                
          2  IALT        PIC       'Z.ZZZ.ZZ9';                         
         %INCLUDE ZZ20301M;                                             
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER TIL FEJLLISTE                         */
 /*********************************************************************/
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (33),                                
           2 RCKOD       CHAR      (01)      INIT      (' '),           
           2 F1          CHAR      (19)      INIT      (' '),           
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (68)      INIT      (' ');           
 /*********************************************************************/
 /*      H O U S E - K E E P I N G                                    */
 /*********************************************************************/
         CALL ZS61900;                                                  
         CALL ZZ20390 ('*OPEN','BH90301Y');                             
         CALL ZZ20390 ('*OPEN','BH90302Y');                             
         ON ENDFILE (BH903I)                                            
         BEGIN;                                                         
            EOF_BH903 = '1'B;                                           
            PERSON2.DSORP = 9999999999;                                 
         END;                                                           
         OPEN FILE (BH903I)  TITLE ('BH90300I');                        
         OPEN FILE (BH903O)  TITLE ('BH90300O');                        
         TV = '';                                                       
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
 /*********************************************************************/
 /*      P R O C E S S                                                */
 /*********************************************************************/
         READ FILE (BH903I) INTO (BH903_P1);                            
         READ FILE (BH903I) INTO (BH903_P2);                            
         IF PERSON1.CPART = '1'                                         
         THEN                                                           
            TV.LÆSTEH = 1;                                              
         ELSE                                                           
            TV.LÆSTEB = 1;                                              
         IF PERSON2.CPART = '1'                                         
         THEN                                                           
            TV.LÆSTEH = TV.LÆSTEH + 1;                                  
         ELSE                                                           
            TV.LÆSTEB = TV.LÆSTEB + 1;                                  
         GEM = '';                                                      
         DO WHILE (^EOF_BH903);                                         
            IF PERSON1.ESR.EEJDNR =            /* 2 PERSONER DER EJER */
               PERSON2.ESR.EEJDNR              /* SAMME EJENDOM       */
            THEN                                                        
               DO;                                                      
                  GEM = '';                                             
                  IF PERSON1.DSORP = PERSON2.DSORP /* PERSON1 OG 2 ER */
                                                   /* GIFT MED HINAND.*/
                  THEN                                                  
                     CALL BEHANDL_ÆGTEPAR;                              
                  ELSE                       /* PERSON1 OG 2 ER IKKE  */
                                             /* GIFT MED HINANDEN     */
                     CALL BEHANDL_SAMBO;                                
                  READ FILE (BH903I) INTO (BH903_P1);                   
                  IF PERSON1.SORT_KOMNR = 999                           
                  THEN                                                  
                     DO;                                                
                        BH90399 = OPTÆL1, BY NAME;                      
                        SIGNAL ENDFILE (BH903I);                        
                     END;                                               
                  IF ^EOF_BH903                                         
                  THEN                                                  
                     DO;                                                
                        IF PERSON1.CPART = '1'                          
                        THEN                                            
                           TV.LÆSTEH = TV.LÆSTEH + 1;                   
                        ELSE                                            
                           TV.LÆSTEB = TV.LÆSTEB + 1;                   
                        READ FILE (BH903I) INTO (BH903_P2);             
                        IF PERSON2.SORT_KOMNR = 999                     
                        THEN                                            
                           DO;                                          
                              BH90399 = OPTÆL2, BY NAME;                
                              SIGNAL ENDFILE (BH903I);                  
                           END;                                         
                        IF ^EOF_BH903                                   
                        THEN                                            
                           DO;                                          
                              IF PERSON2.CPART = '1'                    
                              THEN                                      
                                 TV.LÆSTEH = TV.LÆSTEH + 1;             
                              ELSE                                      
                                 TV.LÆSTEB = TV.LÆSTEB + 1;             
                           END;                                         
                        ELSE                                            
                           CALL BEHANDL_ENLIG;                          
                     END;                                               
               END;                                                     
            ELSE                /* HVIS DER IKKE FINDES NOGEN MAKKER */ 
               DO;                                                      
                  CALL BEHANDL_ENLIG;                                   
                  PERSON1 = PERSON2, BY NAME;                           
                  READ FILE (BH903I) INTO (BH903_P2);                   
                  IF PERSON2.SORT_KOMNR = 999                           
                  THEN                                                  
                     DO;                                                
                        BH90399 = OPTÆL2, BY NAME;                      
                        SIGNAL ENDFILE (BH903I);                        
                     END;                                               
                  IF ^EOF_BH903                                         
                  THEN                                                  
                     DO;                                                
                        IF PERSON2.CPART = '1'                          
                        THEN                                            
                           TV.LÆSTEH = TV.LÆSTEH + 1;                   
                        ELSE                                            
                           TV.LÆSTEB = TV.LÆSTEB + 1;                   
                     END;                                               
                  ELSE                                                  
                     CALL BEHANDL_ENLIG;                                
               END;                                                     
         END;     /* DO WHILE */                                        
         CALL KONTROLLISTE;                                             
         CALL MASK_AFSTEMNING;                                          
         CALL AFSLUT;                                                   
 /*********************************************************************/
 /*         BEHANDL ÆGTEPAR,SOM EJER EJENDOM SAMMEN                   */
 /*********************************************************************/
 BEHANDL_ÆGTEPAR:                                                       
         PROC;                                                          
         CALL FORETAG_DELING;                                           
         PERSON1.SORT_CPR = PERSON1.DCPRCIR;                            
         IF PERSON1.ESR.DAFSTÅ > 0                                      
         THEN                                                           
            PERSON1.SORT_DATO = PERSON1.ESR.DAFSTÅ;                     
         ELSE                                                           
            PERSON1.SORT_DATO = 99991231;                               
         WRITE FILE (BH903O) FROM (BH903_P1);                           
         PERSON2.SORT_CPR = PERSON2.DCPRCIR;                            
         IF PERSON2.ESR.DAFSTÅ > 0                                      
         THEN                                                           
            PERSON2.SORT_DATO = PERSON2.ESR.DAFSTÅ;                     
         ELSE                                                           
            PERSON2.SORT_DATO = 99991231;                               
         WRITE FILE (BH903O) FROM (BH903_P2);                           
         TV.OVFB = TV.OVFB + 1;                                         
         TV.OVFH = TV.OVFH + 1;                                         
         TV.SAMGIFTH = TV.SAMGIFTH + 1;                                 
         TV.SAMGIFTB = TV.SAMGIFTB + 1;                                 
 END BEHANDL_ÆGTEPAR;                                                   
 /*********************************************************************/
 /*         BEHANDL TO-EJERE, SOM IKKE ER GIFT MED HINANDEN.          */
 /*********************************************************************/
 BEHANDL_SAMBO:                                                         
         PROC;                                                          
         CALL FORETAG_DELING;                                           
         PERSON1.SORT_CPR  = PERSON1.DCPRCIR;                           
         IF PERSON1.ESR.DAFSTÅ > 0                                      
         THEN                                                           
            PERSON1.SORT_DATO = PERSON1.ESR.DAFSTÅ;                     
         ELSE                                                           
            PERSON1.SORT_DATO = 99991231;                               
         WRITE FILE (BH903O) FROM (BH903_P1);                           
         PERSON2.SORT_CPR  = PERSON2.DCPRCIR;                           
         IF PERSON2.ESR.DAFSTÅ > 0                                      
         THEN                                                           
            PERSON2.SORT_DATO = PERSON2.ESR.DAFSTÅ;                     
         ELSE                                                           
            PERSON2.SORT_DATO = 99991231;                               
         WRITE FILE (BH903O) FROM (BH903_P2);                           
         IF PERSON1.CPART = '1'                                         
         THEN                                                           
            TV.OVFH = TV.OVFH + 1;                                      
         ELSE                                                           
            TV.OVFB = TV.OVFB + 1;                                      
         IF PERSON2.CPART = '1'                                         
         THEN                                                           
            TV.OVFH = TV.OVFH + 1;                                      
         ELSE                                                           
            TV.OVFB = TV.OVFB + 1;                                      
 END BEHANDL_SAMBO;                                                     
 /*********************************************************************/
 /*         BEHANDL TO-EJER, HVORTIL DER IKKE ER FUNDET EN MAKKER.    */
 /*         DET KAN F.EKS. FOREKOMME HVIS KUN EN I ET TO-EJER FOR-    */
 /*         HOLD SÆLGER.                                              */
 /*********************************************************************/
 BEHANDL_ENLIG:                                                         
         PROC;                                                          
         IF PERSON1.GANE > 0  /* BEHOLD INDBERETTET ANDEL */            
         THEN;                                                          
         ELSE                                                           
            IF PERSON1.GANE = 0 & PERSON1.ESR.EEJDNR = GEM.EEJDNR       
            THEN                                                        
               DO;                                                      
                   /* MODREGN MEDEJERS ANDEL */                         
                   PERSON1.GANE = 10000 - GEM.GANE;                     
                   TV.DELING = TV.DELING + 1;                           
               END;                                                     
         IF PERSON1.GANE = 0                                            
         THEN                                                           
            PERSON1.CEJ_100 = ' '; /* UNDLAD EFTERFØLGENDE BEREGNING */ 
         PERSON1.SORT_CPR  = PERSON1.DCPRCIR;                           
         IF PERSON1.ESR.DAFSTÅ > 0                                      
         THEN                                                           
            PERSON1.SORT_DATO = PERSON1.ESR.DAFSTÅ;                     
         ELSE                                                           
            PERSON1.SORT_DATO = 99991231;                               
         WRITE FILE (BH903O) FROM (BH903_P1);                           
         IF PERSON1.CPART = '1'                                         
         THEN                                                           
            TV.OVFH = TV.OVFH + 1;                                      
         ELSE                                                           
            TV.OVFB = TV.OVFB + 1;                                      
         GEM = '';                                                      
 END BEHANDL_ENLIG;                                                     
 /*********************************************************************/
 /*      FORDELING AF EJERANDELE                                      */
 /*********************************************************************/
 FORETAG_DELING: PROC;                                                  
         IF PERSON1.GANE = 0 !                                          
            PERSON2.GANE = 0                                            
         THEN                                                           
            CALL CHECK_EJET_EEN_DAG;                                    
         IF PERSON1.GANE = 0                 /* FORDELING AF EJER-    */
         THEN                                /* ANDELE                */
            IF PERSON2.GANE = 0                                         
            THEN                                                        
               DO;                                                      
                  TV.DELING = TV.DELING + 2;                            
                  PERSON1.GANE = 5000;                                  
                  PERSON2.GANE = 5000;                                  
               END;                                                     
            ELSE                                                        
               DO;                                                      
                  TV.DELING = TV.DELING + 1;                            
                  PERSON1.GANE = 10000 - PERSON2.GANE;                  
               END;                                                     
         ELSE                                                           
            IF PERSON2.GANE = 0                                         
            THEN                                                        
               DO;                                                      
                  TV.DELING = TV.DELING + 1;                            
                  PERSON2.GANE = 10000 - PERSON1.GANE;                  
               END;                                                     
         IF PERSON1.ESR.CITYP < 5 & PERSON2.ESR.CITYP < 5               
         THEN                                                           
            DO;                                                         
               /* A.H.T. TO 'KØBERE', SOM EVT. EFTERFØLGES AF  */       
               /* EN 'ENLIG' SÆLGER', GEMMES EJERANDELEN FOR   */       
               /* DEN PERSON, DER EJEDE EJENDOMMEN SAMTIDIG    */       
               /* MED SÆLGEREN, FOR AT KUNNE BEREGNE SÆLGERENS */       
               /* EJERANDEL, NÅR DENNE ER LIG 0.               */       
               GEM.EEJDNR = PERSON1.ESR.EEJDNR;                         
               IF PERSON1.ESR.DOVTG < PERSON2.ESR.DOVTG                 
               THEN                                                     
                  GEM.GANE = PERSON1.GANE;                              
               ELSE                                                     
                  GEM.GANE = PERSON2.GANE;                              
            END;                                                        
 END FORETAG_DELING;                                                    
 /*********************************************************************/
 /*      HVIS DEN ENE EJER KUN HAR EJET EJENDOMMEN EEN DAG            */
 /*      SKAL DER EVT. IKKE FORETAGES DELING AF EJERANDEL             */
 /*********************************************************************/
 CHECK_EJET_EEN_DAG:                                                    
         PROC;                                                          
         IF (PERSON1.ESR.DAFSTÅ > 0 &                                   
            (PERSON1.ESR.DAFSTÅ = PERSON1.ESR.DOVTG)) &                 
            (PERSON2.ESR.DAFSTÅ > 0 &                                   
            (PERSON2.ESR.DAFSTÅ = PERSON2.ESR.DOVTG)) &                 
            (PERSON1.ESR.DAFSTÅ = PERSON2.ESR.DAFSTÅ)                   
         THEN                                                           
            RETURN; /* NORMAL DELING HVIS EJET SAMME ENE DAG */         
         IF (PERSON1.ESR.DAFSTÅ > 0 &                                   
            (PERSON1.ESR.DAFSTÅ = PERSON1.ESR.DOVTG)) !                 
            (PERSON2.ESR.DAFSTÅ > 0 &                                   
            (PERSON2.ESR.DAFSTÅ = PERSON2.ESR.DOVTG))                   
         THEN                                                           
            DO;                                                         
               /* LAV 'DELING' HVIS KUN DEN ENE EJER */                 
               /* HAR EJET EJENDOMMEN NETOP EEN DAG  */                 
               IF PERSON1.GANE = 0 &                                    
                  PERSON2.GANE = 0                                      
               THEN                                                     
                  DO;                                                   
                     TV.DELING = TV.DELING + 2;                         
                     PERSON1.GANE = 10000;                              
                     PERSON2.GANE = 10000;                              
                     RETURN;                                            
                  END;                                                  
               IF PERSON1.GANE = 0                                      
               THEN                                                     
                  DO;                                                   
                     TV.DELING = TV.DELING + 1;                         
                     PERSON1.GANE = 10000;                              
                  END;                                                  
               ELSE                                                     
                  IF PERSON2.GANE = 0                                   
                  THEN                                                  
                     DO;                                                
                        TV.DELING = TV.DELING + 1;                      
                        PERSON2.GANE = 10000;                           
                     END;                                               
            END;                                                        
 END CHECK_EJET_EEN_DAG;                                                
 /*********************************************************************/
 /*      UDSKRIV KØRSELSKONTROLLISTE                                  */
 /*********************************************************************/
 KONTROLLISTE:                                                          
         PROC;                                                          
         LINIE = ZZIK1;                                                 
         CALL ZZ20300 (LINIE,'01');                                     
         OVLIN1.CTL= ZZWS1;                                             
         OVLIN1.DATO = UDDATO;                                          
         CALL ZZ20300 (OVLIN1,'01');                                    
         OVLIN2.CTL= ZZWS2;                                             
         CALL ZZ20300 (OVLIN2,'01');                                    
         LINIE = ZZWS2 !! (40)' ' !! 'HOVEDPERSONER       BIPERSONER' !!
                 '    DELING FORETAGET' !!                              
                 (16)' ' !! 'IALT';                                     
         CALL ZZ20300 (LINIE,'01');                                     
         LINIE = '';                                                    
         DETAIL.STYR = ZZWS2;                                           
         DETAIL.TEKST = 'ANTAL LÆSTE TO-EJERE';                         
         DETAIL.ANTALH = TV.LÆSTEH;                                     
         DETAIL.ANTALB = TV.LÆSTEB;                                     
         IALT = TV.LÆSTEH + TV.LÆSTEB;                                  
         ANTALIALT = IALT;                                              
         CALL ZZ20300 (LINIE,'01');                                     
         LINIE = '';                                                    
         DETAIL.STYR = ZZWS2;                                           
         DETAIL.TEKST = 'ANTAL SAMGIFTE TO-EJERE';                      
         DETAIL.ANTALH = TV.SAMGIFTH;                                   
         DETAIL.ANTALB = TV.SAMGIFTB;                                   
         CALL ZZ20300 (LINIE,'01');                                     
         DETAIL.TEKST = 'ANTAL OVERFØRTE ';                             
         DETAIL.ANTALH = TV.OVFH;                                       
         DETAIL.ANTALB = TV.OVFB;                                       
         DETAIL.ANTALF = TV.DELING;                                     
         IALT = TV.OVFH + TV.OVFB;                                      
         ANTALIALT = IALT;                                              
         DETAIL.STYR = ZZWS3;                                           
         CALL ZZ20300 (LINIE,'01');                                     
 END KONTROLLISTE;                                                      
 /*********************************************************************/
 /*      MASKINEL AFSTEMNING                                          */
 /*********************************************************************/
 MASK_AFSTEMNING:                                                       
         PROC;                                                          
         IF (BH90399.ANT_INDV ^= TV.LÆSTEH + TV.LÆSTEB) !               
            (BH90399.ANT_INDV ^= TV.OVFH   + TV.OVFB  )                 
         THEN                                                           
            DO;                                                         
               CALL FEJLLISTE('1');                                     
               CALL ZS30101(5,'BH90300 ** 251 ' !!                      
                    'MASKINEL KONSTATERET AFSTEMNINGSFEJL     ',2);     
            END;                                                        
         WRITE FILE (BH903O) FROM (BH90399);                            
 END MASK_AFSTEMNING;                                                   
 /*********************************************************************/
 /*      UDSKRIV FEJLLISTE VEDR. KONSTATERET AFSTEMNINGFEJL           */
 /*********************************************************************/
 FEJLLISTE:                                                             
         PROC(FEJL);                                                    
 DCL     FEJL            CHAR      (01);                                
         LINIE = ZZIK1;                                                 
         CALL ZZ20300 (LINIE,'02');                                     
         OVLIN1.CTL= ZZWS1;                                             
         OVLIN1.DATO = UDDATO;                                          
         CALL ZZ20300 (OVLIN1,'02');                                    
         OVLIN2.CTL= ZZWS2;                                             
         OVLIN2.TXT1 = 'FEJLLISTE VEDR. MASKINEL AFSTEMNING';           
         CALL ZZ20300 (OVLIN2,'02');                                    
         IF FEJL = '1'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  = 'ANTAL LÆSTE PERSONER PÅ  B.H90X91D';   
               DETLIN1.ANTAL = TV.LÆSTEH + TV.LÆSTEB;                   
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST  =                                         
               'ANTAL PERSONER IFØLGE OPTÆLLINGSREGISTER';              
               DETLIN1.ANTAL = BH90399.ANT_INDV;                        
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
 END FEJLLISTE;                                                         
 /*********************************************************************/
 /*      AFSLUTNING                                                   */
 /*********************************************************************/
 AFSLUT:                                                                
         PROC;                                                          
         CALL ZZ20300(' ','99');                                        
         CLOSE FILE (BH903I),                                           
               FILE (BH903O);                                           
 END AFSLUT;                                                            
 END BH90300;                                                           
