 /********************************************************************* 
 *       Finder kørselstype udfra længde på data                      * 
 *********************************************************************/ 
 FIND_KØRSELSTYPE:  PROC(REC_LÆNGDE)  RETURNS(CHAR(8));                 
                                                                        
 DCL   REC_LÆNGDE    FIXED BIN (15);                                    
 DCL 1 REC_SLUT,                                                        
    %INCLUDE BH90000N;;  /* DENNE STRUKTUR NÅR KØRSEL=SLUT    */        
 DCL 1 REC_FORSKUD,                                                     
    %INCLUDE BH90100N;;  /* DENNE STRUKTUR NÅR KØRSEL=FORSKUD */        
                                                                        
 DCL   JA                   BIT(1)    VALUE('1'B);                      
 DCL   NEJ                  BIT(1)    VALUE('0'B);                      
                                                                        
 DCL   KØRSELSTYPE          CHAR(8)   STATIC;                           
 DCL   KØRSELSTYPE_FUNDET   BIT(1)    STATIC  INIT(NEJ);                
                                                                        
    IF KØRSELSTYPE_FUNDET THEN                                          
    DO;                                                                 
       RETURN(KØRSELSTYPE);                                             
    END;                                                                
                                                                        
    IF SIZE(REC_SLUT) = SIZE(REC_FORSKUD) THEN                          
    DO;                                                                 
       CALL ZS30101(4,'BH94200 ** 550 ' !!                              
                   'KAN IKKE AFGØRE KØRSELSTYPE',2);                    
    END;                                                                
                                                                        
    SELECT (REC_LÆNGDE);                                                
    WHEN (SIZE(REC_FORSKUD))                                            
       DO;                                                              
          PUT SKIP LIST('Dette er en FORSKUD kørsel');                  
          KØRSELSTYPE = 'FORSKUD';                                      
          KØRSELSTYPE_FUNDET = JA;                                      
       END;                                                             
    WHEN (SIZE(REC_SLUT))                                               
       DO;                                                              
          PUT SKIP LIST('Dette er en EVS SLUT kørsel');                 
          KØRSELSTYPE = 'EVSSLUT';                                      
          KØRSELSTYPE_FUNDET = JA;                                      
       END;                                                             
    OTHERWISE                                                           
       DO;                                                              
          CALL ZS30101(4,'BH94200 ** 550 ' !!                           
                      'KAN IKKE AFGØRE KØRSELSTYPE (2)',2);             
       END;                                                             
    END;                                                                
                                                                        
    RETURN(KØRSELSTYPE);                                                
                                                                        
 END FIND_KØRSELSTYPE;                                                  
