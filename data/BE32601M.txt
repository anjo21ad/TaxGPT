 /********************************************************************/ 
 /* MACRO BE32601M                                                   */ 
 /********************************************************************/ 
 DECLARE_CURSOR: PROC;                                                  
                                                                        
         HJSLUTÅR = GLSLUTÅR - 1;                                       
         EVS_ESK.DCPRN = BE321.DCPRCIR;                                 
                                                                        
         EXEC SQL DECLARE BE300_Å1_CURSOR  CURSOR FOR                   
         SELECT                                                         
                T1.DCPRN,                                               
                T1.COMPLA,                                              
                T1.DOMPLACPR                                            
                                                                        
         FROM BE30000T T1                                               
                                                                        
         WHERE T1.DINDKAAR = :GLSLUTÅR                                  
          AND  T1.DCPRN    = :EVS_ESK.DCPRN                             
         ;                                                              
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
           DO;                                                          
             SQLCODE_PIC = SQLCODE;                                     
              ABENDTXT   =  '261 DECLARE BE300_Å1_CURSOR,SQLCODE= '     
                                  !! SQLCODE_CH;                        
             CALL SQL_FEJL;                                             
           END;                                                         
      /*************************/                                       
         EXEC SQL DECLARE BE300_Å2_CURSOR  CURSOR FOR                   
         SELECT                                                         
                T2.DCPRN,                                               
                T2.COMPLA,                                              
                T2.DOMPLACPR                                            
                                                                        
         FROM BE30000T T2                                               
                                                                        
         WHERE T2.DINDKAAR = :HJSLUTÅR                                  
          AND  T2.DCPRN    = :EVS_ESK.DCPRN                             
         ;                                                              
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
           DO;                                                          
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '265 DECLARE BE300_Å2_CURSOR,SQLCODE= '    
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
           END;                                                         
                                                                        
 END DECLARE_CURSOR;                                                    
                                                                        
 /********************************************************************/ 
 /* FETCH CURSOR                                                     */ 
 /********************************************************************/ 
                                                                        
 FETCH_BE300_Å1_CURSOR: PROC;                                           
                                                                        
         EVS_ESK.COMPLA = ' ';                                          
                                                                        
         EXEC SQL FETCH BE300_Å1_CURSOR                                 
                                                                        
         INTO :EVS_ESK.DCPRN                                            
             ,:EVS_ESK.COMPLA                                           
             ,:EVS_ESK.DOMPLACPR                                        
                ;                                                       
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0);                                                    
           WHEN (100);                                                  
           OTHERWISE                                                    
             DO;                                                        
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '262 FETCH BE300_Å1_CURSOR,SQLCODE= '      
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
               EXEC SQL CLOSE BE300_Å1_CURSOR;                          
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
         IF EVS_ESK.COMPLA = '1'                                        
         THEN                                                           
            ICOMPLA = '1'B;                                             
                                                                        
 END FETCH_BE300_Å1_CURSOR;                                             
                                                                        
                                                                        
 /********************************************************************/ 
 OPEN_BE300_Å1_CURSOR: PROC;                                            
                                                                        
         EXEC SQL OPEN BE300_Å1_CURSOR;                                 
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '263 OPEN BE300_Å1_CURSOR,SQLCODE= '       
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
            END;                                                        
                                                                        
 END OPEN_BE300_Å1_CURSOR;                                              
                                                                        
                                                                        
 /********************************************************************/ 
 CLOSE_BE300_Å1_CURSOR: PROC;                                           
                                                                        
         EXEC SQL CLOSE BE300_Å1_CURSOR;                                
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '264 CLOSE BE300_Å1_CURSOR,SQLCODE= '      
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
            END;                                                        
                                                                        
 END CLOSE_BE300_Å1_CURSOR;                                             
                                                                        
 /********************************************************************/ 
 /* FETCH CURSOR                                                     */ 
 /********************************************************************/ 
                                                                        
 FETCH_BE300_Å2_CURSOR: PROC;                                           
                                                                        
         EVS_ESK.COMPLA = ' ';                                          
                                                                        
         EXEC SQL FETCH BE300_Å2_CURSOR                                 
                                                                        
         INTO :EVS_ESK.DCPRN                                            
             ,:EVS_ESK.COMPLA                                           
             ,:EVS_ESK.DOMPLACPR                                        
                ;                                                       
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0);                                                    
           WHEN (100);                                                  
           OTHERWISE                                                    
             DO;                                                        
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '266 FETCH BE300_Å2_CURSOR,SQLCODE= '      
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
               EXEC SQL CLOSE BE300_Å2_CURSOR;                          
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
         IF EVS_ESK.COMPLA = '1'                                        
         THEN                                                           
            IICOMPLA = '1'B;                                            
                                                                        
 END FETCH_BE300_Å2_CURSOR;                                             
                                                                        
                                                                        
 /********************************************************************/ 
 OPEN_BE300_Å2_CURSOR: PROC;                                            
                                                                        
         EXEC SQL OPEN BE300_Å2_CURSOR;                                 
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '267 OPEN BE300_Å2_CURSOR,SQLCODE= '       
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
            END;                                                        
                                                                        
 END OPEN_BE300_Å2_CURSOR;                                              
                                                                        
                                                                        
 /********************************************************************/ 
 CLOSE_BE300_Å2_CURSOR: PROC;                                           
                                                                        
         EXEC SQL CLOSE BE300_Å2_CURSOR;                                
                                                                        
         IF SQLCA.SQLCODE ^= 0                                          
         THEN                                                           
            DO;                                                         
               SQLCODE_PIC = SQLCODE;                                   
               ABENDTXT   =  '268 CLOSE BE300_Å2_CURSOR,SQLCODE= '      
                                  !! SQLCODE_CH;                        
               CALL SQL_FEJL;                                           
            END;                                                        
                                                                        
 END CLOSE_BE300_Å2_CURSOR;                                             
                                                                        
                                                                        
 /********************************************************************/ 
 SQL_FEJL: PROC;                                                        
                                                                        
       CALL ZS67000(SQLCA);                                             
        ABENDFILL1  = ' ';                                              
        ABENDFILL2  = ' ';                                              
        ABENDMODUL   = 'BE32600';                                       
        ABENDMEDNR   = '**';                                            
        CALL ZS30101(5,ABENDMEDD,2);                                    
 END SQL_FEJL;                                                          
