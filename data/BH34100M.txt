                                                                        
 /**********************************************************************
 * PROJEKT:     EVS SLUT 2001                                          *
 * PROGRAMNAVN: BH34100M.                                              *
 * PROGRAMTYPE: MAKRO.                                                 *
 * FUNKTION:    SQL UDTRÆK ALLE AKTIVE OG VALIDE EJENDOMME FRA         *
 *              EVS SLUT 2000 *                                         
 * PROGRAMMØR:  HANS ERIK KJLEDSEN    HKS, PUS/T&S BRØNDBY 04.12.2001. *
 * ÆNDRINGSLOG: XXXXXX XXXXXX         XXX, PUS/T&S BRØNDBY 00.00.2000. *
 **********************************************************************/
 /*********************************************************************/
 /* DECLARE CURSOR TIL LÆS AF TABEL             BQ00100T       RUTINE */
 /*********************************************************************/
 DECLARE_EJENDOMSOPL: PROC;                                             
                                                                        
         EXEC SQL DECLARE EJENDOM_CURSOR CURSOR FOR                     
                                                                        
              SELECT T1.DINDKAAR                                        
                    ,T1.EKOMNR                                          
                    ,T1.EEJDNR                                          
                    ,T1.DFRAGLD                                         
                    ,T1.EJDBELIG                                        
                    ,T1.BBERGRL                                         
                    ,T1.CBERGRL                                         
                    ,T1.CEJDTYPE                                        
                    ,T1.FEJLNR                                          
                    ,T1.CBENYT                                          
                    ,T1.FLEJL                                           
                    ,T1.CEJV                                            
                    ,T1.BBER2FAM                                        
                    ,T1.BEJBOL1                                         
                    ,T1.CEJBOLTYP1                                      
                    ,T1.BEJBOL2                                         
                    ,T1.CEJBOLTYP2                                      
                    ,T1.CFRED                                           
                    ,T1.BEJDVÆR                                         
                                                                        
         FROM   BQ00100T T1                                             
         WHERE  T1.DINDKAAR = 2000                                      
         ORDER BY T1.EKOMNR,                                            
                  T1.EEJDNR;                                            
                                                                        
         IF SQLCA.SQLCODE ^= 0 THEN                                     
           DO;                                                          
             FEJLTEKST = 'DECLARE EJENDOMSOPL';                         
             CALL SQL_FEJL;                                             
           END;                                                         
                                                                        
 END DECLARE_EJENDOMSOPL;                                               
 /*********************************************************************/
 /* FETCH CURSOR TIL LÆS AF EJENDOMSTABEL BQ00100T             RUTINE */
 /*********************************************************************/
 FETCH_EJENDOMSOPL: PROC;                                               
                                                                        
         EXEC SQL FETCH EJENDOM_CURSOR                                  
                                                                        
          INTO :EJENDOM.DINDKAAR ,                                      
               :EJENDOM.EKOMNR   ,                                      
               :EJENDOM.EEJDNR   ,                                      
               :EJENDOM.DFRAGLD  ,                                      
               :EJENDOM.EJDBELIG ,                                      
               :EJENDOM.BBERGRL:INDK_EJENDOM.BBERGRL_I,                 
               :EJENDOM.CBERGRL  ,                                      
               :EJENDOM.CEJDTYPE ,                                      
               :EJENDOM.FEJLNR   ,                                      
               :EJENDOM.CBENYT   ,                                      
               :EJENDOM.FLEJL    ,                                      
               :EJENDOM.CEJV     ,                                      
               :EJENDOM.BBER2FAM:INDK_EJENDOM.BBER2FAM_I,               
               :EJENDOM.BEJBOL1:INDK_EJENDOM.BEJBOL1_I,                 
               :EJENDOM.CEJBOLTYP1,                                     
               :EJENDOM.BEJBOL2:INDK_EJENDOM.BEJBOL2_I,                 
               :EJENDOM.CEJBOLTYP2,                                     
               :EJENDOM.CFRED     ,                                     
               :EJENDOM.BEJDVÆR   ;                                     
                                                                        
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
                                                                        
           WHEN (0)                                                     
             DO;                                                        
               ANTLÆS = ANTLÆS + 1;                                     
             END;                                                       
                                                                        
           WHEN (100);                                                  
                                                                        
           OTHERWISE                                                    
             DO;                                                        
               FEJLTEKST  = 'FETCH EJENDOMOPL';                         
               PUT SKIP LIST('SQLKODE',SQLCODE);                        
               CALL SQL_FEJL;                                           
             END;                                                       
                                                                        
         END; /* SELECT*/                                               
                                                                        
 END FETCH_EJENDOMSOPL;                                                 
