 BH64400: /* BEHANDL SOMMERHUSE A.H.T. 2%-BEREGNING (HELÅRSBEBOELSE)  */
         PROCEDURE OPTIONS (MAIN);                                      
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 1998');       
 /********************************************************************* 
 *                                                                    * 
 * FORMÅL : PROGRAMMETS FORMÅL ER AT OVERFØRE KODE FOR 2%-BEREGNING   * 
 *          FRA EN ANDEN EJER AF SAMME EJENDOM TIL DEN AKTUELLE EJER, * 
 *          MEN KUN HVIS DEN AKTUELLE EJER OGSÅ ER TILMELDT EJENDOM-  * 
 *          MENS ADRESSE JVF. P-DATA. DESUDEN RETTES KODE FOR 2%-BE-  * 
 *          REGNING, HVIS DEN ANDEN EJER'S KODE HAR 'HØJERE' VÆRDI.   * 
 *                                                                    * 
 * INPUT  : B.H64201D  UDTRÆK FRA ESR (SORTERET I BH64300)            * 
 *                                                                    * 
 * OUTPUT : B.H64400D  BEHANDLET ESR-UDTRÆK                           * 
 *          BH64401Y   KONTROLLISTE OG STATISTIK                      * 
 *          BH64402Y   FEJLLISTE FRA MASKINEL AFSTEMNING              * 
 *                                                                    * 
 * PROGRAMMØR: AAGE RASMUSSEN  PUS AUGUST 1994                        * 
 * RETTET      AAGE RASMUSSEN  PUV JULI   1995                        * 
 *             AAGE RASMUSSEN  PUV NOV    1995                        * 
 *             AAGE RASMUSSEN  PFB JULI   1996                        * 
 *             AAGE RASMUSSEN  PFB JANUAR 1997                        * 
 *             AAGE RASMUSSEN  PFB AUGUST 1997                        * 
 *             AAGE RASMUSSEN  PFB JULI   1998                        * 
 *                                                                    * 
 *********************************************************************/ 
         DEFAULT RANGE (*) STATIC UNALIGNED;                            
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH642I FILE RECORD INPUT;                                      
 DCL     BH644O FILE RECORD OUTPUT;                                     
 DCL     SYSPRINT FILE OUTPUT;                                          
 /********************************************************************* 
 *       DECLARE AF UDTRÆK FRA ESR                                    * 
 *********************************************************************/ 
 DCL     1 BH642         BASED     (BH642_PTR),       %INCLUDE CN57000N;
                                                                        
 DCL     1 BH64299       BASED     (BH642_PTR),       %INCLUDE CN57099N;
 DCL     1 BH642_ID,                                                    
      2 EKOMNR       FIXED   (3),   /* KOM.NR. BELIG.                 */
      2 EEJDNR       FIXED   (7),   /* EJENDOMSNR.                    */
      2 C_SÆLGER     CHAR    (1);   /* KODE: ER PERSONEN EN SÆLGER?   */
 DCL     BH642ID         CHAR      (7)    BASED(ADDR(BH642_ID));        
 /********************************************************************* 
 *               DECLARE AF DIV. FÆLLESMACROER (ESKEMA/BOY/FORSKUD)   * 
 *********************************************************************/ 
 DCL     1 BH60100M,                                                    
           %INCLUDE BH60100M;                                           
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 STAT1998(100:999),      /* TÆLLEVÆRKER TIL STATISTIK   */    
           2 CLIN          PIC       '9'  INIT (0),                     
           2 PLIN(20),                                                  
             3 A379        FIXED DEC (7), /* BBRF379 = A          */    
             3 B379        FIXED DEC (7), /* BBRF379 = B          */    
             3 C379        FIXED DEC (7), /* BBRF379 = C          */    
             3 D379        FIXED DEC (7), /* BBRF379 = D          */    
             3 U379        FIXED DEC (7), /* BBRF379 = BLANK      */    
             3 IALT        FIXED DEC (7);                               
 DCL     1 STAT1999(100:999),      /* TÆLLEVÆRKER TIL STATISTIK   */    
           2 CLIN          PIC       '9'  INIT (0),                     
           2 PLIN(14),                                                  
             3 A379        FIXED DEC (7), /* BBRF379 = A          */    
             3 B379        FIXED DEC (7), /* BBRF379 = B          */    
             3 C379        FIXED DEC (7), /* BBRF379 = C          */    
             3 D379        FIXED DEC (7), /* BBRF379 = D          */    
             3 U379        FIXED DEC (7), /* BBRF379 = BLANK      */    
             3 IALT        FIXED DEC (7);                               
 DCL     1 TV,                    /* TÆLLEVÆRKER TIL TOTALLISTEN */     
           2 LÆS_BH642   FIXED DEC (9),                                 
           2 FSOM_UBOP   FIXED DEC (9),                                 
           2 FSOM_MBOP   FIXED DEC (9),                                 
           2 F1998_2PCT  FIXED DEC (9),                                 
           2 F1998_O59   FIXED DEC (9),                                 
           2 F1998_U60   FIXED DEC (9);                                 
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *********************************************************************/ 
 DCL     SWFEJL          CHAR      (1)       INIT      (' ');           
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     BH642_PTR       PTR;                                           
 DCL     EOF_BH642       BIT       (1);                                 
 DCL     I               BIN FIXED (15);                                
 DCL     INDX            BIN FIXED (31);                                
 DCL     HJ_ÆGT          PIC       '(10)9';                             
 DCL     HJ_CPR          PIC       '(10)9';                             
 DCL     ZC112_CPR       CHAR      (10)    DEF HJ_CPR;                  
 DCL     FEJLMARK        CHAR      (01);                                
 DCL     DATO1           CHAR      (26);                                
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DAG         CHAR      (02);                                
 DCL     C_OVERFØRT      CHAR      (1);                                 
 DCL     1 GEMEJD,                                                      
      2 EKOMNR       FIXED   (3),   /* KOM.NR. BELIG.                 */
      2 EEJDNR       FIXED   (7),   /* EJENDOMSNR.                    */
      2 C_SÆLGER     CHAR    (1),   /* KODE: ER PERSONEN EN SÆLGER?   */
      2 C_2PCT       CHAR    (1);   /* HELÅRS. JVF. BBR OG/ELL ESR?   */
 DCL     GEMID           CHAR      (7) BASED(ADDR(GEMEJD));             
 /********************************************************************* 
 *       DECLARE AF ENTRY OG BUILTIN                                  * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     LOW             BUILTIN;                                       
 DCL     HIGH            BUILTIN;                                       
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS11201         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
         EXTERNAL INIT ('NOTEST(ALL,,;)');                              
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVLIN1,                                                      
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH64400L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (                
           'STATISTIK M.V. VEDR. HELÅRSBEBOELSE I SOMMERHUSE'),         
           2 F2          CHAR      (09)      INIT      (' '),           
           2 TEKST3      CHAR      (14)      INIT      (                
           'UDSKREVET DEN '),                                           
           2 DATO,                                                      
             3 DAG         CHAR      (02),                              
             3 F1          CHAR      (01) INIT ('.'),                   
             3 MD          CHAR      (02),                              
             3 F2          CHAR      (01) INIT ('.'),                   
             3 ÅR          CHAR      (04);                              
 DCL     1 OVLIN2,                                                      
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 OVLIN3,                                                      
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (11),                                
           2 KOMNR       PIC      'ZZZ',                                
           2 FYLD        CHAR       (6)      INIT ((6)' '),             
           2 TEKST1      CHAR     (088),                                
           2 TEKST2      CHAR      (14)      INIT                       
           ('UDSKREVET DEN '),                                          
           2 DATO,                                                      
             3 DAG         CHAR      (02),                              
             3 F1          CHAR      (01) INIT ('.'),                   
             3 MD          CHAR      (02),                              
             3 F2          CHAR      (01) INIT ('.'),                   
             3 ÅR          CHAR      (04);                              
 DCL     1 OVLIN4,                                                      
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR     (132);                                
 DCL     1 DETLIN0,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (41),                                
           2 CPUÅR       PIC       '99',                                
           2 TEKST2      CHAR      (11),                                
           2 START       PIC       '999999',                            
           2 TEKST3      CHAR      (9),                                 
           2 SLUT        PIC       '999999',                            
           2 TEKST4      CHAR      (57);                                
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (80),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (41)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (33),                                
           2 RCKOD       CHAR      (01)      INIT      (' '),           
           2 F1          CHAR      (19)      INIT      (' '),           
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (68)      INIT      (' ');           
 DCL     1 DETLIN3,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (10)      INIT      (' '),           
           2 TEKST2      CHAR      (07)      INIT      ('BELØB: '),     
           2 ANTAL2      PIC       'ZZZZ.ZZZ.ZZZ.ZZ9',                  
           2 F3          CHAR      (28)      INIT      (' ');           
 DCL     1 DETLIN4,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (30),                                
           2 F1          CHAR      (5)       INIT      (' '),           
           2 ANTAL1      PIC       'ZZZ.ZZZ',                           
           2 F2          CHAR      (5)       INIT      (' '),           
           2 F3          CHAR      (5)       INIT      (' '),           
           2 ANTAL2      PIC       'ZZZ.ZZZ',                           
           2 F4          CHAR      (5)       INIT      (' '),           
           2 F5          CHAR      (5)       INIT      (' '),           
           2 ANTAL3      PIC       'ZZZ.ZZZ',                           
           2 F6          CHAR      (5)       INIT      (' '),           
           2 F7          CHAR      (5)       INIT      (' '),           
           2 ANTAL4      PIC       'ZZZ.ZZZ',                           
           2 F8          CHAR      (5)       INIT      (' '),           
           2 F9          CHAR      (5)       INIT      (' '),           
           2 ANTAL5      PIC       'ZZZ.ZZZ',                           
           2 F10         CHAR      (5)       INIT      (' '),           
           2 F11         CHAR      (5)       INIT      (' '),           
           2 ANTAL6      PIC       'ZZZ.ZZZ',                           
           2 F12         CHAR      (5)       INIT      (' ');           
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
         EOF_BH642 = '0'B;                                              
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (BH642I) TITLE ('BH64201I');                         
         OPEN FILE (BH644O) TITLE ('BH64400O');                         
         ON ENDFILE (BH642I)                                            
            EOF_BH642 = '1'B;                                           
         CALL ZZ20390 ('*OPEN','BH64401Y');                             
         CALL ZS38100(DATO1);                                           
         SIDELIN.CCA = ZZIK1;                                           
         OVLIN1.DATO = DATO2, BY NAME;                                  
         OVLIN1.CCA  = ZZWS2;                                           
         OVLIN2.CCA  = ZZWS3;                                           
         OVLIN3.CCA  = ZZWS1;                                           
         TV = 0;                                                        
         DO INDX = 100 TO 999;                                          
            STAT1998(INDX).CLIN = 0;                                    
            DO I = 1 TO 20;                                             
               STAT1998(INDX).PLIN(I).A379 = 0;                         
               STAT1998(INDX).PLIN(I).B379 = 0;                         
               STAT1998(INDX).PLIN(I).C379 = 0;                         
               STAT1998(INDX).PLIN(I).D379 = 0;                         
               STAT1998(INDX).PLIN(I).U379 = 0;                         
               STAT1998(INDX).PLIN(I).IALT = 0;                         
            END;                                                        
         END;                                                           
         STAT1998(100).CLIN = 1;                                        
         DO INDX = 100 TO 999;                                          
            STAT1999(INDX).CLIN = 0;                                    
            DO I = 1 TO 14;                                             
               STAT1999(INDX).PLIN(I).A379 = 0;                         
               STAT1999(INDX).PLIN(I).B379 = 0;                         
               STAT1999(INDX).PLIN(I).C379 = 0;                         
               STAT1999(INDX).PLIN(I).D379 = 0;                         
               STAT1999(INDX).PLIN(I).U379 = 0;                         
               STAT1999(INDX).PLIN(I).IALT = 0;                         
            END;                                                        
         END;                                                           
         STAT1999(100).CLIN = 1;                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
         CALL LÆS_BH642;                                                
         GEMEJD = BH642, BY NAME;                                       
         CALL SKRIV;                                                    
         CALL LÆS_BH642;                                                
         DO WHILE ( ^EOF_BH642 );                                       
            IF GEMID ^= BH642ID                                         
            THEN                                                        
               GEMEJD = BH642, BY NAME;                                 
            ELSE                                                        
               CALL BEHANDL;   /* BEHANDLING AF ESR-UDTRÆK */           
            CALL SKRIV;                                                 
            CALL LÆS_BH642;                                             
         END;                                                           
         CALL AFSLUT;                                                   
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR                                           * 
 *********************************************************************/ 
 LÆS_BH642:                                                             
         PROC;                                                          
         READ FILE (BH642I) SET (BH642_PTR);                            
         IF BH64299.DCPRCIR = 9999999999     /* OPTÆLLINGSINDIVID */    
         THEN                                                           
            DO;                                                         
               EOF_BH642 = '1'B;                                        
               CALL SKRIV;                                              
            END;                                                        
         IF ^EOF_BH642                                                  
         THEN                                                           
            DO;                                                         
               BH642_ID.EKOMNR   = BH642.EKOMNR;                        
               BH642_ID.EEJDNR   = BH642.EEJDNR;                        
               BH642_ID.C_SÆLGER = BH642.C_SÆLGER;                      
               TV.LÆS_BH642 = TV.LÆS_BH642 + 1;                         
            END;                                                        
 END LÆS_BH642;                                                         
 /********************************************************************* 
 *       HER AFGØRES OM DEN AKTUELLE EJER SKAL HAVE OVERFØRT KODE     * 
 *       FOR 2%-BEREGNING FRA EN ANDEN EJER.                          * 
 *       DER OVERFØRES IKKE TIL PERSONER MED STATUS SOM '67-ÅRIG'.    * 
 *********************************************************************/ 
 BEHANDL:                                                               
         PROC;                                                          
         IF BH642.BOPÆLSKODE > '0' &                                    
            BH642.C_2PCT < GEMEJD.C_2PCT                                
         THEN                                                           
            DO;                                                         
                                                                        
               BH642.C_2PCT = GEMEJD.C_2PCT;                            
                                                                        
               /* FØRST UNDERSØGES 1998 OG DER OVERFØRES   */           
               /* KUN HVIS PERSONEN IKKE ER '67 ÅRIG' M.V. */           
                                                                        
               IF BH642.C_2PCT_ORD = '1'                                
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     SELECT (BH642.C_2PCT);                             
                       WHEN ('1','2','3','7','8','9')                   
                         DO;                                            
                            BH642.C_2PCT_ORD = '4';                     
                         END;                                           
                       OTHERWISE;                                       
                     END;                                               
                  END;                                                  
                                                                        
               /* OG SÅ UNDERSØGES 1999 OG DER OVERFØRES   */           
               /* KUN HVIS PERSONEN IKKE ER '67 ÅRIG' M.V. */           
                                                                        
               IF BH642.C_2PCT_FOR = '1'                                
               THEN;                                                    
               ELSE                                                     
                  DO;                                                   
                     SELECT (BH642.C_2PCT);                             
                       WHEN ('4','5','6','7','8','9')                   
                         DO;                                            
                            BH642.C_2PCT_FOR = '4';                     
                         END;                                           
                       OTHERWISE;                                       
                     END;                                               
                  END;                                                  
            END;                                                        
 END BEHANDL;                                                           
 /********************************************************************* 
 *       PERSONEN HAR STATUS SOM '67 ÅRIG' I 1998 OG 1999             * 
 *       DERFOR NULSTILLES C_2PCT-KODEN.                              * 
 *********************************************************************/ 
 TILPAS_1998:                                                           
         PROC;                                                          
                                                                        
         BH642.C_2PCT = '0';                                            
                                                                        
 END TILPAS_1998;                                                       
 /********************************************************************* 
 *       PERSONEN HAR STATUS SOM '67 ÅRIG' I 1999 OG                  * 
 *       DERFOR TILPASSES C_2PCT-KODEN.                               * 
 *********************************************************************/ 
 TILPAS_1999:                                                           
         PROC;                                                          
                                                                        
         IF BH642.C_2PCT = '0' !                                        
            BH642.C_2PCT_ORD = '1'                                      
         THEN                                                           
            RETURN;                                                     
                                                                        
         SELECT (BH642.C_2PCT);                                         
           WHEN ('4','5','6')                                           
             DO;                                                        
                BH642.C_2PCT = '0';                                     
             END;                                                       
           WHEN ('7')                                                   
             DO;                                                        
                BH642.C_2PCT = '1';                                     
             END;                                                       
           WHEN ('8')                                                   
             DO;                                                        
                BH642.C_2PCT = '2';                                     
             END;                                                       
           WHEN ('9')                                                   
             DO;                                                        
                BH642.C_2PCT = '3';                                     
             END;                                                       
           OTHERWISE;                                                   
         END;                                                           
                                                                        
 END TILPAS_1999;                                                       
 /********************************************************************* 
 *       SKRIV ALLE INDIVIDER EFTER EVT. BEHANDLIG.                   * 
 *********************************************************************/ 
 SKRIV:                                                                 
         PROC;                                                          
                                                                        
         IF BH64299.DCPRCIR ^= 9999999999     /* OPTÆLLINGSINDIVID */   
         THEN                                                           
            DO;                                                         
               CALL KONTROL_OPTÆL;                                      
               IF BH642.C_2PCT_ORD = '1'                                
               THEN                                                     
                  CALL TILPAS_1998;                                     
               IF BH642.C_2PCT_FOR = '1'                                
               THEN                                                     
                  CALL TILPAS_1999;                                     
               IF BH642.C_2PCT = '1' !                                  
                  BH642.C_2PCT = '2' !                                  
                  BH642.C_2PCT = '3' !                                  
                  BH642.C_2PCT > '6'                                    
               THEN                                                     
                  DO;                                                   
                     TV.F1998_2PCT = TV.F1998_2PCT + 1;                 
                     IF BH642.C_2PCT_ORD = '0'                          
                     THEN                                               
                        CALL OPTÆL1998_U67;                             
                  END;                                                  
            END;                                                        
                                                                        
         WRITE FILE (BH644O) FROM (BH642);                              
                                                                        
 END SKRIV;                                                             
                                                                        
 OPTÆL1998_U67:                                                         
         PROC;                                                          
                                                                        
         HJ_CPR = BH642.DCPRCIR;                                        
         IF PERSON_ALDER_OK(BEREGN_ÅR1,HJ_CPR,'2')                      
         THEN                                                           
            DO;                                                         
               /* EJERE DER ER 60-66 ÅR I 1998 */                       
               TV.F1998_O59 = TV.F1998_O59 + 1;                         
            END;                                                        
                                                                        
         HJ_CPR = BH642.DCPRCIR;                                        
         IF PERSON_ALDER_OK(BEREGN_ÅR1,HJ_CPR,'3')                      
         THEN                                                           
            DO;                                                         
               /* EJERE DER ER UNDER 60 ÅR I 1998 */                    
               TV.F1998_U60 = TV.F1998_U60 + 1;                         
            END;                                                        
                                                                        
 END OPTÆL1998_U67;                                                     
                                                                        
 /********************************************************************* 
 *       OPTÆL INDIVIDER TIL STATISTIK                                * 
 *********************************************************************/ 
 KONTROL_OPTÆL:                                                         
         PROC;                                                          
                                                                        
         IF (BH642.DAFGDAT > 0 &        /* HVIS EJEREN ER   */          
             BH642.DAFSTÅ = 0)          /* SLETTET I ESR    */          
         THEN                           /* SPRINGES OVER    */          
            RETURN;                                                     
                                                                        
         IF (BH642.DAFSTÅ > 0 &         /* SALG FØR INDKOMSTÅRET */     
             BH642.DAFSTÅ < ÅR0101) !   /* SPRINGES OVER         */     
            BH642.DOVTG > ÅR1231        /* KØB EFTER INDKOMSTÅRET */    
         THEN                                                           
            RETURN;                                                     
                                                                        
         HJ_CPR = BH642.DCPRCIR;                                        
         FEJLMARK = ' ';                                                
         CALL ZS11201 (ZC112_CPR,FEJLMARK);                             
         IF FEJLMARK = '0'              /* VALIDT PERSONNR.? */         
         THEN;                          /* ELLERS            */         
         ELSE                           /* SPRINGES OVER     */         
            RETURN;                                                     
                                                                        
         INDX = BH642.EKOMNR;                                           
         STAT1998(INDX).CLIN = 1;                                       
         STAT1999(INDX).CLIN = 1;                                       
                                                                        
         IF BH642.BOPÆLSKODE < '1'                                      
         THEN                                                           
            DO;                                                         
               TV.FSOM_UBOP = TV.FSOM_UBOP + 1;                         
               /* OPTÆL INDIVIDER UDEN BOPÆLSKODE  */                   
               /* MEN MED DISP. IFLG. BBR F379     */                   
               IF (BH642.BBRF379 >= 'A' & BH642.BBRF379 <= 'D') &       
                  (BH642.BBRF380 <= '0000' ! BH642.BBRF380 >= '1998')   
               THEN                                                     
                  CALL OPTÆL_EJ_BOPÆL;                                  
               RETURN;                                                  
            END;                                                        
                                                                        
         TV.FSOM_MBOP = TV.FSOM_MBOP + 1;                               
                                                                        
         IF BH642.C_2PCT < '1' &                                        
            BH642.C_2PCT_ORD = '0'                                      
         THEN                                                           
            DO;                                                         
               /* OPTÆL 60-66 ÅRIGE OG/ELLER       */                   
               /* UNDER 60 ÅRIGE SOM IKKE HAR FÅET */                   
               /* DISPENSATION TIL HELÅRSBEBOELSE  */                   
               CALL OPTÆL_EJDISP;                                       
               RETURN;                                                  
            END;                                                        
                                                                        
         /* FØRST OPTÆLLES VEDR. 1998 */                                
                                                                        
         IF BH642.C_2PCT_ORD = '1'                                      
         THEN                                                           
            CALL OPTÆL1998_67;                                          
                                                                        
         IF BH642.C_2PCT_ORD = '2'                                      
         THEN                                                           
            CALL OPTÆL1998_60_66;                                       
                                                                        
         IF BH642.C_2PCT_ORD = '3'                                      
         THEN                                                           
            CALL OPTÆL1998_U60;                                         
                                                                        
         IF BH642.C_2PCT_ORD = '4'                                      
         THEN                                                           
            CALL OPTÆL1998_OVF;                                         
                                                                        
         /* SÅ OPTÆLLES VEDR. 1999 */                                   
         /* MEN IKKE SÆLGERE       */                                   
                                                                        
         IF BH642.C_SÆLGER = '1'                                        
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH642.C_2PCT_FOR = '1'                                      
         THEN                                                           
            CALL OPTÆL1999_67;                                          
                                                                        
         IF BH642.C_2PCT_FOR = '2'                                      
         THEN                                                           
            CALL OPTÆL1999_60_66;                                       
                                                                        
         IF BH642.C_2PCT_FOR = '3'                                      
         THEN                                                           
            CALL OPTÆL1999_U60;                                         
                                                                        
         IF BH642.C_2PCT_FOR = '4'                                      
         THEN                                                           
            CALL OPTÆL1999_OVF;                                         
                                                                        
 END KONTROL_OPTÆL;                                                     
                                                                        
 OPTÆL1998_67:                                                          
         PROC;                                                          
                                                                        
         /* OPTÆL HVIS EJER'S PERSONTYPE ER */                          
         /* OPSAT SOM 67-ÅRIG M.V.          */                          
         /* D.V.S. IKKE 2%-BEREGNING        */                          
                                                                        
         STAT1998(INDX).PLIN(1).IALT =                                  
         STAT1998(INDX).PLIN(1).IALT + 1;                               
         STAT1998(100).PLIN(1).IALT =                                   
         STAT1998(100).PLIN(1).IALT + 1;                                
                                                                        
         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1) &                    
            BH642.C_SÆLGER < '1'                                        
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(2).IALT =                             
              STAT1998(INDX).PLIN(2).IALT + 1;                          
              STAT1998(100).PLIN(2).IALT =                              
              STAT1998(100).PLIN(2).IALT + 1;                           
           END;                                                         
                                                                        
         IF BH642.C_SÆLGER = '1' &                                      
           (TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1) !                    
           ((BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1998')))                                 
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(4).IALT =                             
              STAT1998(INDX).PLIN(4).IALT + 1;                          
              STAT1998(100).PLIN(4).IALT =                              
              STAT1998(100).PLIN(4).IALT + 1;                           
           END;                                                         
                                                                        
         IF (BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1998')                                   
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(1).A379 =                     
                      STAT1998(INDX).PLIN(1).A379 + 1;                  
                      STAT1998(100).PLIN(1).A379 =                      
                      STAT1998(100).PLIN(1).A379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(4).A379 =                
                           STAT1998(INDX).PLIN(4).A379 + 1;             
                           STAT1998(100).PLIN(4).A379 =                 
                           STAT1998(100).PLIN(4).A379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(2).A379 =             
                              STAT1998(INDX).PLIN(2).A379 + 1;          
                              STAT1998(100).PLIN(2).A379 =              
                              STAT1998(100).PLIN(2).A379 + 1;           
                           END;                                         
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(1).B379 =                     
                      STAT1998(INDX).PLIN(1).B379 + 1;                  
                      STAT1998(100).PLIN(1).B379 =                      
                      STAT1998(100).PLIN(1).B379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(4).B379 =                
                           STAT1998(INDX).PLIN(4).B379 + 1;             
                           STAT1998(100).PLIN(4).B379 =                 
                           STAT1998(100).PLIN(4).B379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(2).B379 =             
                              STAT1998(INDX).PLIN(2).B379 + 1;          
                              STAT1998(100).PLIN(2).B379 =              
                              STAT1998(100).PLIN(2).B379 + 1;           
                           END;                                         
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(1).C379 =                     
                      STAT1998(INDX).PLIN(1).C379 + 1;                  
                      STAT1998(100).PLIN(1).C379 =                      
                      STAT1998(100).PLIN(1).C379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(4).C379 =                
                           STAT1998(INDX).PLIN(4).C379 + 1;             
                           STAT1998(100).PLIN(4).C379 =                 
                           STAT1998(100).PLIN(4).C379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(2).C379 =             
                              STAT1998(INDX).PLIN(2).C379 + 1;          
                              STAT1998(100).PLIN(2).C379 =              
                              STAT1998(100).PLIN(2).C379 + 1;           
                           END;                                         
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(1).D379 =                     
                      STAT1998(INDX).PLIN(1).D379 + 1;                  
                      STAT1998(100).PLIN(1).D379 =                      
                      STAT1998(100).PLIN(1).D379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(4).D379 =                
                           STAT1998(INDX).PLIN(4).D379 + 1;             
                           STAT1998(100).PLIN(4).D379 =                 
                           STAT1998(100).PLIN(4).D379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(2).D379 =             
                              STAT1998(INDX).PLIN(2).D379 + 1;          
                              STAT1998(100).PLIN(2).D379 =              
                              STAT1998(100).PLIN(2).D379 + 1;           
                           END;                                         
                   END;                                                 
                 OTHERWISE;                                             
               END;  /* SELECT (BH642.BBRF379) */                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1998(INDX).PLIN(1).U379 =                            
               STAT1998(INDX).PLIN(1).U379 + 1;                         
               STAT1998(100).PLIN(1).U379 =                             
               STAT1998(100).PLIN(1).U379 + 1;                          
               IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)                
               THEN                                                     
                 DO;                                                    
                    IF BH642.C_SÆLGER = '1'                             
                    THEN                                                
                      DO;                                               
                         STAT1998(INDX).PLIN(4).U379 =                  
                         STAT1998(INDX).PLIN(4).U379 + 1;               
                         STAT1998(100).PLIN(4).U379 =                   
                         STAT1998(100).PLIN(4).U379 + 1;                
                      END;                                              
                    ELSE                                                
                      DO;                                               
                         STAT1998(INDX).PLIN(2).U379 =                  
                         STAT1998(INDX).PLIN(2).U379 + 1;               
                         STAT1998(100).PLIN(2).U379 =                   
                         STAT1998(100).PLIN(2).U379 + 1;                
                      END;                                              
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1998_67;                                                      
                                                                        
 OPTÆL1998_60_66:                                                       
         PROC;                                                          
                                                                        
         STAT1998(INDX).PLIN(5).IALT =                                  
         STAT1998(INDX).PLIN(5).IALT + 1;                               
         STAT1998(100).PLIN(5).IALT =                                   
         STAT1998(100).PLIN(5).IALT + 1;                                
                                                                        
         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1) &                    
            BH642.C_SÆLGER < '1'                                        
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(6).IALT =                             
              STAT1998(INDX).PLIN(6).IALT + 1;                          
              STAT1998(100).PLIN(6).IALT =                              
              STAT1998(100).PLIN(6).IALT + 1;                           
           END;                                                         
                                                                        
         IF BH642.C_SÆLGER = '1' &                                      
           (TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1) !                    
           ((BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1998')))                                 
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(8).IALT =                             
              STAT1998(INDX).PLIN(8).IALT + 1;                          
              STAT1998(100).PLIN(8).IALT =                              
              STAT1998(100).PLIN(8).IALT + 1;                           
           END;                                                         
                                                                        
         IF (BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1998')                                   
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(5).A379 =                     
                      STAT1998(INDX).PLIN(5).A379 + 1;                  
                      STAT1998(100).PLIN(5).A379 =                      
                      STAT1998(100).PLIN(5).A379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(8).A379 =                
                           STAT1998(INDX).PLIN(8).A379 + 1;             
                           STAT1998(100).PLIN(8).A379 =                 
                           STAT1998(100).PLIN(8).A379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(6).A379 =             
                              STAT1998(INDX).PLIN(6).A379 + 1;          
                              STAT1998(100).PLIN(6).A379 =              
                              STAT1998(100).PLIN(6).A379 + 1;           
                           END;                                         
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(5).B379 =                     
                      STAT1998(INDX).PLIN(5).B379 + 1;                  
                      STAT1998(100).PLIN(5).B379 =                      
                      STAT1998(100).PLIN(5).B379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(8).B379 =                
                           STAT1998(INDX).PLIN(8).B379 + 1;             
                           STAT1998(100).PLIN(8).B379 =                 
                           STAT1998(100).PLIN(8).B379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(6).B379 =             
                              STAT1998(INDX).PLIN(6).B379 + 1;          
                              STAT1998(100).PLIN(6).B379 =              
                              STAT1998(100).PLIN(6).B379 + 1;           
                           END;                                         
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(5).C379 =                     
                      STAT1998(INDX).PLIN(5).C379 + 1;                  
                      STAT1998(100).PLIN(5).C379 =                      
                      STAT1998(100).PLIN(5).C379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(8).C379 =                
                           STAT1998(INDX).PLIN(8).C379 + 1;             
                           STAT1998(100).PLIN(8).C379 =                 
                           STAT1998(100).PLIN(8).C379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(6).C379 =             
                              STAT1998(INDX).PLIN(6).C379 + 1;          
                              STAT1998(100).PLIN(6).C379 =              
                              STAT1998(100).PLIN(6).C379 + 1;           
                           END;                                         
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(5).D379 =                     
                      STAT1998(INDX).PLIN(5).D379 + 1;                  
                      STAT1998(100).PLIN(5).D379 =                      
                      STAT1998(100).PLIN(5).D379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(8).D379 =                
                           STAT1998(INDX).PLIN(8).D379 + 1;             
                           STAT1998(100).PLIN(8).D379 =                 
                           STAT1998(100).PLIN(8).D379 + 1;              
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(6).D379 =             
                              STAT1998(INDX).PLIN(6).D379 + 1;          
                              STAT1998(100).PLIN(6).D379 =              
                              STAT1998(100).PLIN(6).D379 + 1;           
                           END;                                         
                   END;                                                 
                 OTHERWISE;                                             
               END;  /* SELECT (BH642.BBRF379) */                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1998(INDX).PLIN(5).U379 =                            
               STAT1998(INDX).PLIN(5).U379 + 1;                         
               STAT1998(100).PLIN(5).U379 =                             
               STAT1998(100).PLIN(5).U379 + 1;                          
               IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)                
               THEN                                                     
                 DO;                                                    
                    IF BH642.C_SÆLGER = '1'                             
                    THEN                                                
                      DO;                                               
                         STAT1998(INDX).PLIN(8).U379 =                  
                         STAT1998(INDX).PLIN(8).U379 + 1;               
                         STAT1998(100).PLIN(8).U379 =                   
                         STAT1998(100).PLIN(8).U379 + 1;                
                      END;                                              
                    ELSE                                                
                      DO;                                               
                         STAT1998(INDX).PLIN(6).U379 =                  
                         STAT1998(INDX).PLIN(6).U379 + 1;               
                         STAT1998(100).PLIN(6).U379 =                   
                         STAT1998(100).PLIN(6).U379 + 1;                
                      END;                                              
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1998_60_66;                                                   
                                                                        
 OPTÆL1998_U60:                                                         
         PROC;                                                          
                                                                        
         STAT1998(INDX).PLIN(9).IALT =                                  
         STAT1998(INDX).PLIN(9).IALT + 1;                               
         STAT1998(100).PLIN(9).IALT =                                   
         STAT1998(100).PLIN(9).IALT + 1;                                
                                                                        
         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1) &                    
            BH642.C_SÆLGER < '1'                                        
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(10).IALT =                            
              STAT1998(INDX).PLIN(10).IALT + 1;                         
              STAT1998(100).PLIN(10).IALT =                             
              STAT1998(100).PLIN(10).IALT + 1;                          
           END;                                                         
                                                                        
         IF BH642.C_SÆLGER = '1' &                                      
           (TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1) !                    
           ((BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1998')))                                 
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(12).IALT =                            
              STAT1998(INDX).PLIN(12).IALT + 1;                         
              STAT1998(100).PLIN(12).IALT =                             
              STAT1998(100).PLIN(12).IALT + 1;                          
           END;                                                         
                                                                        
         IF (BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1998')                                   
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(9).A379 =                     
                      STAT1998(INDX).PLIN(9).A379 + 1;                  
                      STAT1998(100).PLIN(9).A379 =                      
                      STAT1998(100).PLIN(9).A379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(12).A379 =               
                           STAT1998(INDX).PLIN(12).A379 + 1;            
                           STAT1998(100).PLIN(12).A379 =                
                           STAT1998(100).PLIN(12).A379 + 1;             
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(10).A379 =            
                              STAT1998(INDX).PLIN(10).A379 + 1;         
                              STAT1998(100).PLIN(10).A379 =             
                              STAT1998(100).PLIN(10).A379 + 1;          
                           END;                                         
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(9).B379 =                     
                      STAT1998(INDX).PLIN(9).B379 + 1;                  
                      STAT1998(100).PLIN(9).B379 =                      
                      STAT1998(100).PLIN(9).B379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(12).B379 =               
                           STAT1998(INDX).PLIN(12).B379 + 1;            
                           STAT1998(100).PLIN(12).B379 =                
                           STAT1998(100).PLIN(12).B379 + 1;             
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(10).B379 =            
                              STAT1998(INDX).PLIN(10).B379 + 1;         
                              STAT1998(100).PLIN(10).B379 =             
                              STAT1998(100).PLIN(10).B379 + 1;          
                           END;                                         
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(9).C379 =                     
                      STAT1998(INDX).PLIN(9).C379 + 1;                  
                      STAT1998(100).PLIN(9).C379 =                      
                      STAT1998(100).PLIN(9).C379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(12).C379 =               
                           STAT1998(INDX).PLIN(12).C379 + 1;            
                           STAT1998(100).PLIN(12).C379 =                
                           STAT1998(100).PLIN(12).C379 + 1;             
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(10).C379 =            
                              STAT1998(INDX).PLIN(10).C379 + 1;         
                              STAT1998(100).PLIN(10).C379 =             
                              STAT1998(100).PLIN(10).C379 + 1;          
                           END;                                         
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(9).D379 =                     
                      STAT1998(INDX).PLIN(9).D379 + 1;                  
                      STAT1998(100).PLIN(9).D379 =                      
                      STAT1998(100).PLIN(9).D379 + 1;                   
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(12).D379 =               
                           STAT1998(INDX).PLIN(12).D379 + 1;            
                           STAT1998(100).PLIN(12).D379 =                
                           STAT1998(100).PLIN(12).D379 + 1;             
                        END;                                            
                      ELSE                                              
                         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)      
                         THEN                                           
                           DO;                                          
                              STAT1998(INDX).PLIN(10).D379 =            
                              STAT1998(INDX).PLIN(10).D379 + 1;         
                              STAT1998(100).PLIN(10).D379 =             
                              STAT1998(100).PLIN(10).D379 + 1;          
                           END;                                         
                   END;                                                 
                 OTHERWISE;                                             
               END;  /* SELECT (BH642.BBRF379) */                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1998(INDX).PLIN(9).U379 =                            
               STAT1998(INDX).PLIN(9).U379 + 1;                         
               STAT1998(100).PLIN(9).U379 =                             
               STAT1998(100).PLIN(9).U379 + 1;                          
               IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)                
               THEN                                                     
                 DO;                                                    
                    IF BH642.C_SÆLGER = '1'                             
                    THEN                                                
                      DO;                                               
                         STAT1998(INDX).PLIN(12).U379 =                 
                         STAT1998(INDX).PLIN(12).U379 + 1;              
                         STAT1998(100).PLIN(12).U379 =                  
                         STAT1998(100).PLIN(12).U379 + 1;               
                      END;                                              
                    ELSE                                                
                      DO;                                               
                         STAT1998(INDX).PLIN(10).U379 =                 
                         STAT1998(INDX).PLIN(10).U379 + 1;              
                         STAT1998(100).PLIN(10).U379 =                  
                         STAT1998(100).PLIN(10).U379 + 1;               
                      END;                                              
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1998_U60;                                                     
                                                                        
 OPTÆL1998_OVF:                                                         
         PROC;                                                          
                                                                        
         STAT1998(INDX).PLIN(13).IALT =                                 
         STAT1998(INDX).PLIN(13).IALT + 1;                              
         STAT1998(100).PLIN(13).IALT =                                  
         STAT1998(100).PLIN(13).IALT + 1;                               
         IF BH642.C_SÆLGER = '1'                                        
         THEN                                                           
           DO;                                                          
              STAT1998(INDX).PLIN(14).IALT =                            
              STAT1998(INDX).PLIN(14).IALT + 1;                         
              STAT1998(100).PLIN(14).IALT =                             
              STAT1998(100).PLIN(14).IALT + 1;                          
           END;                                                         
                                                                        
         IF BH642.BBRF380  = '    ' !                                   
            BH642.BBRF380  = '0000' !                                   
            BH642.BBRF380 >= '1998'                                     
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(13).A379 =                    
                      STAT1998(INDX).PLIN(13).A379 + 1;                 
                      STAT1998(100).PLIN(13).A379 =                     
                      STAT1998(100).PLIN(13).A379 + 1;                  
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(14).A379 =               
                           STAT1998(INDX).PLIN(14).A379 + 1;            
                           STAT1998(100).PLIN(14).A379 =                
                           STAT1998(100).PLIN(14).A379 + 1;             
                        END;                                            
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(13).B379 =                    
                      STAT1998(INDX).PLIN(13).B379 + 1;                 
                      STAT1998(100).PLIN(13).B379 =                     
                      STAT1998(100).PLIN(13).B379 + 1;                  
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(14).B379 =               
                           STAT1998(INDX).PLIN(14).B379 + 1;            
                           STAT1998(100).PLIN(14).B379 =                
                           STAT1998(100).PLIN(14).B379 + 1;             
                        END;                                            
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(13).C379 =                    
                      STAT1998(INDX).PLIN(13).C379 + 1;                 
                      STAT1998(100).PLIN(13).C379 =                     
                      STAT1998(100).PLIN(13).C379 + 1;                  
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(14).C379 =               
                           STAT1998(INDX).PLIN(14).C379 + 1;            
                           STAT1998(100).PLIN(14).C379 =                
                           STAT1998(100).PLIN(14).C379 + 1;             
                        END;                                            
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(13).D379 =                    
                      STAT1998(INDX).PLIN(13).D379 + 1;                 
                      STAT1998(100).PLIN(13).D379 =                     
                      STAT1998(100).PLIN(13).D379 + 1;                  
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(14).D379 =               
                           STAT1998(INDX).PLIN(14).D379 + 1;            
                           STAT1998(100).PLIN(14).D379 =                
                           STAT1998(100).PLIN(14).D379 + 1;             
                        END;                                            
                   END;                                                 
                 OTHERWISE                                              
                   DO;                                                  
                      STAT1998(INDX).PLIN(13).U379 =                    
                      STAT1998(INDX).PLIN(13).U379 + 1;                 
                      STAT1998(100).PLIN(13).U379 =                     
                      STAT1998(100).PLIN(13).U379 + 1;                  
                      IF BH642.C_SÆLGER = '1'                           
                      THEN                                              
                        DO;                                             
                           STAT1998(INDX).PLIN(14).U379 =               
                           STAT1998(INDX).PLIN(14).U379 + 1;            
                           STAT1998(100).PLIN(14).U379 =                
                           STAT1998(100).PLIN(14).U379 + 1;             
                        END;                                            
                   END;                                                 
               END;                                                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1998(INDX).PLIN(13).U379 =                           
               STAT1998(INDX).PLIN(13).U379 + 1;                        
               STAT1998(100).PLIN(13).U379 =                            
               STAT1998(100).PLIN(13).U379 + 1;                         
               IF BH642.C_SÆLGER = '1'                                  
               THEN                                                     
                 DO;                                                    
                    STAT1998(INDX).PLIN(14).U379 =                      
                    STAT1998(INDX).PLIN(14).U379 + 1;                   
                    STAT1998(100).PLIN(14).U379 =                       
                    STAT1998(100).PLIN(14).U379 + 1;                    
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1998_OVF;                                                     
                                                                        
 OPTÆL_EJDISP:                                                          
         PROC;                                                          
                                                                        
         HJ_CPR = BH642.DCPRCIR;                                        
         IF PERSON_ALDER_OK(BEREGN_ÅR1,HJ_CPR,'2')                      
         THEN                                                           
            DO;                                                         
               /* EJERE DER ER 60-66 ÅR I 1998 */                       
               IF BH642.BBRF380  = '    ' !                             
                  BH642.BBRF380  = '0000' !                             
                  BH642.BBRF380 >= '1998'                               
               THEN                                                     
                  DO;                                                   
                     SELECT (BH642.BBRF379);                            
                       WHEN ('A')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(15).A379 =              
                            STAT1998(INDX).PLIN(15).A379 + 1;           
                            STAT1998(100).PLIN(15).A379 =               
                            STAT1998(100).PLIN(15).A379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(16).A379 =         
                                 STAT1998(INDX).PLIN(16).A379 + 1;      
                                 STAT1998(100).PLIN(16).A379 =          
                                 STAT1998(100).PLIN(16).A379 + 1;       
                              END;                                      
                         END;                                           
                       WHEN ('B')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(15).B379 =              
                            STAT1998(INDX).PLIN(15).B379 + 1;           
                            STAT1998(100).PLIN(15).B379 =               
                            STAT1998(100).PLIN(15).B379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(16).B379 =         
                                 STAT1998(INDX).PLIN(16).B379 + 1;      
                                 STAT1998(100).PLIN(16).B379 =          
                                 STAT1998(100).PLIN(16).B379 + 1;       
                              END;                                      
                         END;                                           
                       WHEN ('C')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(15).C379 =              
                            STAT1998(INDX).PLIN(15).C379 + 1;           
                            STAT1998(100).PLIN(15).C379 =               
                            STAT1998(100).PLIN(15).C379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(16).C379 =         
                                 STAT1998(INDX).PLIN(16).C379 + 1;      
                                 STAT1998(100).PLIN(16).C379 =          
                                 STAT1998(100).PLIN(16).C379 + 1;       
                              END;                                      
                         END;                                           
                       WHEN ('D')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(15).D379 =              
                            STAT1998(INDX).PLIN(15).D379 + 1;           
                            STAT1998(100).PLIN(15).D379 =               
                            STAT1998(100).PLIN(15).D379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(16).D379 =         
                                 STAT1998(INDX).PLIN(16).D379 + 1;      
                                 STAT1998(100).PLIN(16).D379 =          
                                 STAT1998(100).PLIN(16).D379 + 1;       
                              END;                                      
                         END;                                           
                       OTHERWISE                                        
                         DO;                                            
                            STAT1998(INDX).PLIN(15).U379 =              
                            STAT1998(INDX).PLIN(15).U379 + 1;           
                            STAT1998(100).PLIN(15).U379 =               
                            STAT1998(100).PLIN(15).U379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(16).U379 =         
                                 STAT1998(INDX).PLIN(16).U379 + 1;      
                                 STAT1998(100).PLIN(16).U379 =          
                                 STAT1998(100).PLIN(16).U379 + 1;       
                              END;                                      
                         END;                                           
                     END;    /*   SELECT (BH642.BBRF379)   */           
                  END;                                                  
               ELSE                                                     
                  DO;                                                   
                     STAT1998(INDX).PLIN(15).U379 =                     
                     STAT1998(INDX).PLIN(15).U379 + 1;                  
                     STAT1998(100).PLIN(15).U379 =                      
                     STAT1998(100).PLIN(15).U379 + 1;                   
                     IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)          
                     THEN                                               
                       DO;                                              
                          STAT1998(INDX).PLIN(16).U379 =                
                          STAT1998(INDX).PLIN(16).U379 + 1;             
                          STAT1998(100).PLIN(16).U379 =                 
                          STAT1998(100).PLIN(16).U379 + 1;              
                       END;                                             
                  END;                                                  
            END;                                                        
                                                                        
         HJ_CPR = BH642.DCPRCIR;                                        
         IF PERSON_ALDER_OK(BEREGN_ÅR1,HJ_CPR,'3')                      
         THEN                                                           
            DO;                                                         
               /* EJERE DER ER UNDER 60 ÅR I 1998 */                    
               IF BH642.BBRF380  = '    ' !                             
                  BH642.BBRF380  = '0000' !                             
                  BH642.BBRF380 >= '1998'                               
               THEN                                                     
                  DO;                                                   
                     SELECT (BH642.BBRF379);                            
                       WHEN ('A')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(17).A379 =              
                            STAT1998(INDX).PLIN(17).A379 + 1;           
                            STAT1998(100).PLIN(17).A379 =               
                            STAT1998(100).PLIN(17).A379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(18).A379 =         
                                 STAT1998(INDX).PLIN(18).A379 + 1;      
                                 STAT1998(100).PLIN(18).A379 =          
                                 STAT1998(100).PLIN(18).A379 + 1;       
                              END;                                      
                         END;                                           
                       WHEN ('B')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(17).B379 =              
                            STAT1998(INDX).PLIN(17).B379 + 1;           
                            STAT1998(100).PLIN(17).B379 =               
                            STAT1998(100).PLIN(17).B379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(18).B379 =         
                                 STAT1998(INDX).PLIN(18).B379 + 1;      
                                 STAT1998(100).PLIN(18).B379 =          
                                 STAT1998(100).PLIN(18).B379 + 1;       
                              END;                                      
                         END;                                           
                       WHEN ('C')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(17).C379 =              
                            STAT1998(INDX).PLIN(17).C379 + 1;           
                            STAT1998(100).PLIN(17).C379 =               
                            STAT1998(100).PLIN(17).C379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(18).C379 =         
                                 STAT1998(INDX).PLIN(18).C379 + 1;      
                                 STAT1998(100).PLIN(18).C379 =          
                                 STAT1998(100).PLIN(18).C379 + 1;       
                              END;                                      
                         END;                                           
                       WHEN ('D')                                       
                         DO;                                            
                            STAT1998(INDX).PLIN(17).D379 =              
                            STAT1998(INDX).PLIN(17).D379 + 1;           
                            STAT1998(100).PLIN(17).D379 =               
                            STAT1998(100).PLIN(17).D379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(18).D379 =         
                                 STAT1998(INDX).PLIN(18).D379 + 1;      
                                 STAT1998(100).PLIN(18).D379 =          
                                 STAT1998(100).PLIN(18).D379 + 1;       
                              END;                                      
                         END;                                           
                       OTHERWISE                                        
                         DO;                                            
                            STAT1998(INDX).PLIN(17).U379 =              
                            STAT1998(INDX).PLIN(17).U379 + 1;           
                            STAT1998(100).PLIN(17).U379 =               
                            STAT1998(100).PLIN(17).U379 + 1;            
                            IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)   
                            THEN                                        
                              DO;                                       
                                 STAT1998(INDX).PLIN(18).U379 =         
                                 STAT1998(INDX).PLIN(18).U379 + 1;      
                                 STAT1998(100).PLIN(18).U379 =          
                                 STAT1998(100).PLIN(18).U379 + 1;       
                              END;                                      
                         END;                                           
                     END;    /*   SELECT (BH642.BBRF379)   */           
                  END;                                                  
               ELSE                                                     
                  DO;                                                   
                     STAT1998(INDX).PLIN(17).U379 =                     
                     STAT1998(INDX).PLIN(17).U379 + 1;                  
                     STAT1998(100).PLIN(17).U379 =                      
                     STAT1998(100).PLIN(17).U379 + 1;                   
                     IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO1)          
                     THEN                                               
                       DO;                                              
                          STAT1998(INDX).PLIN(18).U379 =                
                          STAT1998(INDX).PLIN(18).U379 + 1;             
                          STAT1998(100).PLIN(18).U379 =                 
                          STAT1998(100).PLIN(18).U379 + 1;              
                       END;                                             
                  END;                                                  
            END;                                                        
                                                                        
 END OPTÆL_EJDISP;                                                      
                                                                        
 OPTÆL1999_67:                                                          
         PROC;                                                          
                                                                        
         STAT1999(INDX).PLIN(1).IALT =                                  
         STAT1999(INDX).PLIN(1).IALT + 1;                               
         STAT1999(100).PLIN(1).IALT =                                   
         STAT1999(100).PLIN(1).IALT + 1;                                
                                                                        
         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)                      
         THEN                                                           
           DO;                                                          
              STAT1999(INDX).PLIN(2).IALT =                             
              STAT1999(INDX).PLIN(2).IALT + 1;                          
              STAT1999(100).PLIN(2).IALT =                              
              STAT1999(100).PLIN(2).IALT + 1;                           
           END;                                                         
                                                                        
         IF (BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1999')                                   
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(1).A379 =                     
                      STAT1999(INDX).PLIN(1).A379 + 1;                  
                      STAT1999(100).PLIN(1).A379 =                      
                      STAT1999(100).PLIN(1).A379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(2).A379 =                
                           STAT1999(INDX).PLIN(2).A379 + 1;             
                           STAT1999(100).PLIN(2).A379 =                 
                           STAT1999(100).PLIN(2).A379 + 1;              
                        END;                                            
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(1).B379 =                     
                      STAT1999(INDX).PLIN(1).B379 + 1;                  
                      STAT1999(100).PLIN(1).B379 =                      
                      STAT1999(100).PLIN(1).B379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(2).B379 =                
                           STAT1999(INDX).PLIN(2).B379 + 1;             
                           STAT1999(100).PLIN(2).B379 =                 
                           STAT1999(100).PLIN(2).B379 + 1;              
                        END;                                            
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(1).C379 =                     
                      STAT1999(INDX).PLIN(1).C379 + 1;                  
                      STAT1999(100).PLIN(1).C379 =                      
                      STAT1999(100).PLIN(1).C379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(2).C379 =                
                           STAT1999(INDX).PLIN(2).C379 + 1;             
                           STAT1999(100).PLIN(2).C379 =                 
                           STAT1999(100).PLIN(2).C379 + 1;              
                        END;                                            
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(1).D379 =                     
                      STAT1999(INDX).PLIN(1).D379 + 1;                  
                      STAT1999(100).PLIN(1).D379 =                      
                      STAT1999(100).PLIN(1).D379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(2).D379 =                
                           STAT1999(INDX).PLIN(2).D379 + 1;             
                           STAT1999(100).PLIN(2).D379 =                 
                           STAT1999(100).PLIN(2).D379 + 1;              
                        END;                                            
                   END;                                                 
                 OTHERWISE;                                             
               END;  /* SELECT (BH642.BBRF379) */                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1999(INDX).PLIN(1).U379 =                            
               STAT1999(INDX).PLIN(1).U379 + 1;                         
               STAT1999(100).PLIN(1).U379 =                             
               STAT1999(100).PLIN(1).U379 + 1;                          
               IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)                
               THEN                                                     
                 DO;                                                    
                    STAT1999(INDX).PLIN(2).U379 =                       
                    STAT1999(INDX).PLIN(2).U379 + 1;                    
                    STAT1999(100).PLIN(2).U379 =                        
                    STAT1999(100).PLIN(2).U379 + 1;                     
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1999_67;                                                      
                                                                        
 OPTÆL1999_60_66:                                                       
         PROC;                                                          
                                                                        
         STAT1999(INDX).PLIN(5).IALT =                                  
         STAT1999(INDX).PLIN(5).IALT + 1;                               
         STAT1999(100).PLIN(5).IALT =                                   
         STAT1999(100).PLIN(5).IALT + 1;                                
                                                                        
         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)                      
         THEN                                                           
           DO;                                                          
              STAT1999(INDX).PLIN(6).IALT =                             
              STAT1999(INDX).PLIN(6).IALT + 1;                          
              STAT1999(100).PLIN(6).IALT =                              
              STAT1999(100).PLIN(6).IALT + 1;                           
           END;                                                         
                                                                        
         IF (BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1999')                                   
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(5).A379 =                     
                      STAT1999(INDX).PLIN(5).A379 + 1;                  
                      STAT1999(100).PLIN(5).A379 =                      
                      STAT1999(100).PLIN(5).A379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(6).A379 =                
                           STAT1999(INDX).PLIN(6).A379 + 1;             
                           STAT1999(100).PLIN(6).A379 =                 
                           STAT1999(100).PLIN(6).A379 + 1;              
                        END;                                            
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(5).B379 =                     
                      STAT1999(INDX).PLIN(5).B379 + 1;                  
                      STAT1999(100).PLIN(5).B379 =                      
                      STAT1999(100).PLIN(5).B379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(6).B379 =                
                           STAT1999(INDX).PLIN(6).B379 + 1;             
                           STAT1999(100).PLIN(6).B379 =                 
                           STAT1999(100).PLIN(6).B379 + 1;              
                        END;                                            
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(5).C379 =                     
                      STAT1999(INDX).PLIN(5).C379 + 1;                  
                      STAT1999(100).PLIN(5).C379 =                      
                      STAT1999(100).PLIN(5).C379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(6).C379 =                
                           STAT1999(INDX).PLIN(6).C379 + 1;             
                           STAT1999(100).PLIN(6).C379 =                 
                           STAT1999(100).PLIN(6).C379 + 1;              
                        END;                                            
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(5).D379 =                     
                      STAT1999(INDX).PLIN(5).D379 + 1;                  
                      STAT1999(100).PLIN(5).D379 =                      
                      STAT1999(100).PLIN(5).D379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(6).D379 =                
                           STAT1999(INDX).PLIN(6).D379 + 1;             
                           STAT1999(100).PLIN(6).D379 =                 
                           STAT1999(100).PLIN(6).D379 + 1;              
                        END;                                            
                   END;                                                 
                 OTHERWISE;                                             
               END;  /* SELECT (BH642.BBRF379) */                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1999(INDX).PLIN(5).U379 =                            
               STAT1999(INDX).PLIN(5).U379 + 1;                         
               STAT1999(100).PLIN(5).U379 =                             
               STAT1999(100).PLIN(5).U379 + 1;                          
               IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)                
               THEN                                                     
                 DO;                                                    
                    STAT1999(INDX).PLIN(6).U379 =                       
                    STAT1999(INDX).PLIN(6).U379 + 1;                    
                    STAT1999(100).PLIN(6).U379 =                        
                    STAT1999(100).PLIN(6).U379 + 1;                     
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1999_60_66;                                                   
                                                                        
 OPTÆL1999_U60:                                                         
         PROC;                                                          
                                                                        
         STAT1999(INDX).PLIN(9).IALT =                                  
         STAT1999(INDX).PLIN(9).IALT + 1;                               
         STAT1999(100).PLIN(9).IALT =                                   
         STAT1999(100).PLIN(9).IALT + 1;                                
                                                                        
         IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)                      
         THEN                                                           
           DO;                                                          
              STAT1999(INDX).PLIN(10).IALT =                            
              STAT1999(INDX).PLIN(10).IALT + 1;                         
              STAT1999(100).PLIN(10).IALT =                             
              STAT1999(100).PLIN(10).IALT + 1;                          
           END;                                                         
                                                                        
         IF (BH642.BBRF379 >= 'A' &                                     
             BH642.BBRF379 <= 'D') &                                    
            (BH642.BBRF380 <= '0000' !                                  
             BH642.BBRF380 >= '1999')                                   
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(9).A379 =                     
                      STAT1999(INDX).PLIN(9).A379 + 1;                  
                      STAT1999(100).PLIN(9).A379 =                      
                      STAT1999(100).PLIN(9).A379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(10).A379 =               
                           STAT1999(INDX).PLIN(10).A379 + 1;            
                           STAT1999(100).PLIN(10).A379 =                
                           STAT1999(100).PLIN(10).A379 + 1;             
                        END;                                            
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(9).B379 =                     
                      STAT1999(INDX).PLIN(9).B379 + 1;                  
                      STAT1999(100).PLIN(9).B379 =                      
                      STAT1999(100).PLIN(9).B379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(10).B379 =               
                           STAT1999(INDX).PLIN(10).B379 + 1;            
                           STAT1999(100).PLIN(10).B379 =                
                           STAT1999(100).PLIN(10).B379 + 1;             
                        END;                                            
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(9).C379 =                     
                      STAT1999(INDX).PLIN(9).C379 + 1;                  
                      STAT1999(100).PLIN(9).C379 =                      
                      STAT1999(100).PLIN(9).C379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(10).C379 =               
                           STAT1999(INDX).PLIN(10).C379 + 1;            
                           STAT1999(100).PLIN(10).C379 =                
                           STAT1999(100).PLIN(10).C379 + 1;             
                        END;                                            
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(9).D379 =                     
                      STAT1999(INDX).PLIN(9).D379 + 1;                  
                      STAT1999(100).PLIN(9).D379 =                      
                      STAT1999(100).PLIN(9).D379 + 1;                   
                      IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)         
                      THEN                                              
                        DO;                                             
                           STAT1999(INDX).PLIN(10).D379 =               
                           STAT1999(INDX).PLIN(10).D379 + 1;            
                           STAT1999(100).PLIN(10).D379 =                
                           STAT1999(100).PLIN(10).D379 + 1;             
                        END;                                            
                   END;                                                 
                 OTHERWISE;                                             
               END;  /* SELECT (BH642.BBRF379) */                       
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1999(INDX).PLIN(9).U379 =                            
               STAT1999(INDX).PLIN(9).U379 + 1;                         
               STAT1999(100).PLIN(9).U379 =                             
               STAT1999(100).PLIN(9).U379 + 1;                          
               IF TEST_EJET_8ÅR_OK(BH642.DOVTG,HJ_DATO2)                
               THEN                                                     
                 DO;                                                    
                    STAT1999(INDX).PLIN(10).U379 =                      
                    STAT1999(INDX).PLIN(10).U379 + 1;                   
                    STAT1999(100).PLIN(10).U379 =                       
                    STAT1999(100).PLIN(10).U379 + 1;                    
                 END;                                                   
            END;                                                        
                                                                        
 END OPTÆL1999_U60;                                                     
                                                                        
 OPTÆL1999_OVF:                                                         
         PROC;                                                          
                                                                        
         STAT1999(INDX).PLIN(13).IALT =                                 
         STAT1999(INDX).PLIN(13).IALT + 1;                              
         STAT1999(100).PLIN(13).IALT =                                  
         STAT1999(100).PLIN(13).IALT + 1;                               
                                                                        
         IF BH642.BBRF380  = '    ' !                                   
            BH642.BBRF380  = '0000' !                                   
            BH642.BBRF380 >= '1999'                                     
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(13).A379 =                    
                      STAT1999(INDX).PLIN(13).A379 + 1;                 
                      STAT1999(100).PLIN(13).A379 =                     
                      STAT1999(100).PLIN(13).A379 + 1;                  
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(13).B379 =                    
                      STAT1999(INDX).PLIN(13).B379 + 1;                 
                      STAT1999(100).PLIN(13).B379 =                     
                      STAT1999(100).PLIN(13).B379 + 1;                  
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(13).C379 =                    
                      STAT1999(INDX).PLIN(13).C379 + 1;                 
                      STAT1999(100).PLIN(13).C379 =                     
                      STAT1999(100).PLIN(13).C379 + 1;                  
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1999(INDX).PLIN(13).D379 =                    
                      STAT1999(INDX).PLIN(13).D379 + 1;                 
                      STAT1999(100).PLIN(13).D379 =                     
                      STAT1999(100).PLIN(13).D379 + 1;                  
                   END;                                                 
                 OTHERWISE                                              
                   DO;                                                  
                      STAT1999(INDX).PLIN(13).U379 =                    
                      STAT1999(INDX).PLIN(13).U379 + 1;                 
                      STAT1999(100).PLIN(13).U379 =                     
                      STAT1999(100).PLIN(13).U379 + 1;                  
                   END;                                                 
               END;                                                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
               STAT1999(INDX).PLIN(13).U379 =                           
               STAT1999(INDX).PLIN(13).U379 + 1;                        
               STAT1999(100).PLIN(13).U379 =                            
               STAT1999(100).PLIN(13).U379 + 1;                         
            END;                                                        
                                                                        
 END OPTÆL1999_OVF;                                                     
                                                                        
 OPTÆL_EJ_BOPÆL:                                                        
         PROC;                                                          
                                                                        
         IF BH642.FEJER < 2                                             
         THEN                                                           
            DO;                                                         
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(19).A379 =                    
                      STAT1998(INDX).PLIN(19).A379 + 1;                 
                      STAT1998(100).PLIN(19).A379 =                     
                      STAT1998(100).PLIN(19).A379 + 1;                  
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(19).B379 =                    
                      STAT1998(INDX).PLIN(19).B379 + 1;                 
                      STAT1998(100).PLIN(19).B379 =                     
                      STAT1998(100).PLIN(19).B379 + 1;                  
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(19).C379 =                    
                      STAT1998(INDX).PLIN(19).C379 + 1;                 
                      STAT1998(100).PLIN(19).C379 =                     
                      STAT1998(100).PLIN(19).C379 + 1;                  
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(19).D379 =                    
                      STAT1998(INDX).PLIN(19).D379 + 1;                 
                      STAT1998(100).PLIN(19).D379 =                     
                      STAT1998(100).PLIN(19).D379 + 1;                  
                   END;                                                 
                 OTHERWISE;                                             
               END;                                                     
            END;                                                        
         ELSE                                                           
            DO;                                                         
               /* FLERE END 1 EJER */                                   
               SELECT (BH642.BBRF379);                                  
                 WHEN ('A')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(20).A379 =                    
                      STAT1998(INDX).PLIN(20).A379 + 1;                 
                      STAT1998(100).PLIN(20).A379 =                     
                      STAT1998(100).PLIN(20).A379 + 1;                  
                   END;                                                 
                 WHEN ('B')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(20).B379 =                    
                      STAT1998(INDX).PLIN(20).B379 + 1;                 
                      STAT1998(100).PLIN(20).B379 =                     
                      STAT1998(100).PLIN(20).B379 + 1;                  
                   END;                                                 
                 WHEN ('C')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(20).C379 =                    
                      STAT1998(INDX).PLIN(20).C379 + 1;                 
                      STAT1998(100).PLIN(20).C379 =                     
                      STAT1998(100).PLIN(20).C379 + 1;                  
                   END;                                                 
                 WHEN ('D')                                             
                   DO;                                                  
                      STAT1998(INDX).PLIN(20).D379 =                    
                      STAT1998(INDX).PLIN(20).D379 + 1;                 
                      STAT1998(100).PLIN(20).D379 =                     
                      STAT1998(100).PLIN(20).D379 + 1;                  
                   END;                                                 
                 OTHERWISE;                                             
               END;                                                     
            END;                                                        
                                                                        
 END OPTÆL_EJ_BOPÆL;                                                    
                                                                        
 %INCLUDE BH64200M;                                                     
 %INCLUDE BH64201M; /* HAR PERSONEN EJET EJENDOMMEN I MINDST 8 ÅR? */   
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVLIN1,'01');                                     
         CALL ZZ20300(OVLIN2,'01');                                     
         DETLIN0.CCA = ZZWS2;                                           
         DETLIN0.TEKST1 = 'DENNE BEREGNING ER UDFØRT FOR INDKOMSTÅR=';  
         DETLIN0.CPUÅR = INDKÅR;                                        
         DETLIN0.TEKST2 = ' MED START=';                                
         DETLIN0.START = ÅR0101;                                        
         DETLIN0.TEKST3 = ' OG SLUT=';                                  
         DETLIN0.SLUT  = ÅR1231;                                        
         DETLIN0.TEKST4 = ' ';                                          
         CALL ZZ20300 (DETLIN0,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH642;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK FRA ESR B.H64201D';     
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.FSOM_UBOP;                                  
         DETLIN1.TEKST = 'ANTAL SOMMERHUSE UDEN HELÅRSBEBOELSE';        
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.FSOM_MBOP;                                  
         DETLIN1.TEKST = 'ANTAL SOMMERHUSE MED HELÅRSBEBOELSE';         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.F1998_2PCT;                                 
         DETLIN1.TEKST = 'ANTAL SOMMERHUSE MED 2%-BEREGNING  ';         
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.F1998_O59;                                  
         DETLIN1.TEKST = 'HERAF 60-66 ÅRIGE EVT. PRIVATE PENSIONISTER'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.F1998_U60;                                  
         DETLIN1.TEKST = 'HERAF U. 60 ÅRIGE EJ FØRTIDSPENS. IFLG. MT';  
         CALL ZZ20300 (DETLIN1,'01');                                   
  END TOTALLISTE;                                                       
 /********************************************************************* 
 *       SKRIV STATISTIK VEDR. 1998                                   * 
 *********************************************************************/ 
 STATISTIK_1998:                                                        
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         IF INDX = 100                                                  
         THEN                                                           
            DO;                                                         
               OVLIN3.TEKST = 'LANDSTOTAL';                             
               OVLIN3.KOMNR = 0;                                        
            END;                                                        
         ELSE                                                           
            DO;                                                         
               OVLIN3.TEKST = 'KOMMUNENR.';                             
               OVLIN3.KOMNR = INDX;                                     
            END;                                                        
         OVLIN3.TEKST1 = 'STATISTIK OVER ANTAL PERSONER MED MULIGHED FOR
  DISPENSATION TIL HELÅRSBEBOELSE';                                     
         OVLIN3.DATO = DATO2, BY NAME;                                  
         CALL ZZ20300(OVLIN3,'01');                                     
         OVLIN4.CCA = ZZWS3;                                            
         OVLIN4.TEKST1 = '                    (2 PCT BEREGNING) I SOMMER
 HUSE (BK 08, 28 ELLER 48) I INDKOMSTÅR 1998.';                         
         CALL ZZ20300(OVLIN4,'01');                                     
         OVLIN4.CCA = ZZWS1;                                            
         OVLIN4.TEKST1 = 'PERSONER MED BOPÆLSKODE       HERAF BBR F379=A
  HERAF BBR F379=B HERAF BBR F379=C HERAF BBR F379=D HERAF BBR F379    I
  ALT ANTAL';                                                           
         CALL ZZ20300(OVLIN4,'01');                                     
         OVLIN4.CCA = ZZWS2;                                            
         OVLIN4.TEKST1 = 'ALDER = STATUS I 1998         OG F380 > 1997  
  OG F380 > 1997   OG F380 > 1997   OG F380 > 1997      = BLANK';       
         CALL ZZ20300(OVLIN4,'01');                                     
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = '67-ÅRIGE M.V.                 ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(1).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(1).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(1).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(1).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(1).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(1).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE EXCL SÆLGER ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(2).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(2).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(2).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(2).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(2).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(2).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF SÆLGERE MED DISP.       ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(4).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(4).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(4).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(4).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(4).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(4).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = '6O-66 ÅRIGE M.V.              ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(5).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(5).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(5).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(5).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(5).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(5).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE EXCL SÆLGER ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(6).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(6).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(6).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(6).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(6).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(6).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF SÆLGERE MED DISP.       ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(8).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(8).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(8).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(8).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(8).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(8).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'UNDER 60-ÅRIGE PENSIONISTER   ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(9).A379;                  
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(9).B379;                  
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(9).C379;                  
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(9).D379;                  
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(9).U379;                  
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(9).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE EXCL SÆLGER ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(10).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(10).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(10).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(10).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(10).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(10).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF SÆLGERE MED DISP.       ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(12).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(12).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(12).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(12).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(12).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(12).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'OVERFØRT FRA OVENSTÅENDE      ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(13).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(13).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(13).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(13).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(13).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(13).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF SÆLGERE MED DISP.       ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(14).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(14).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(14).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(14).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(14).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(14).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         OVLIN4.CCA = ZZWS2;                                            
         OVLIN4.TEKST1 = 'ANTAL PERSONER UNDER 67 ÅR MED BOPÆLSKODE  M E
  N  UDEN DISPENSATION TIL HELÅRSBEBOELSE:';                            
         CALL ZZ20300(OVLIN4,'01');                                     
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = '6O-66 ÅRIGE M.V.              ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(15).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(15).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(15).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(15).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(15).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(15).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE             ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(16).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(16).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(16).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(16).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(16).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(16).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'UNDER 60 ÅRIGE                ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(17).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(17).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(17).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(17).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(17).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(17).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE             ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(18).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(18).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(18).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(18).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(18).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(18).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         OVLIN4.CCA = ZZWS2;                                            
         OVLIN4.TEKST1 = 'ANTAL PERSONER UDEN BOPÆLSKODE  M E N  MED BBR
  F379 FORSKELLIG FRA BLANK:';                                          
         CALL ZZ20300(OVLIN4,'01');                                     
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'EEN-EJERE                     ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(19).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(19).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(19).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(19).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(19).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(19).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWK1;                                           
         DETLIN4.TEKST = 'FLER-EJERE                    ';              
         DETLIN4.ANTAL1 = STAT1998(INDX).PLIN(20).A379;                 
         DETLIN4.ANTAL2 = STAT1998(INDX).PLIN(20).B379;                 
         DETLIN4.ANTAL3 = STAT1998(INDX).PLIN(20).C379;                 
         DETLIN4.ANTAL4 = STAT1998(INDX).PLIN(20).D379;                 
         DETLIN4.ANTAL5 = STAT1998(INDX).PLIN(20).U379;                 
         DETLIN4.ANTAL6 = STAT1998(INDX).PLIN(20).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
  END STATISTIK_1998;                                                   
 /********************************************************************* 
 *       SKRIV STATISTIK VEDR. 1999                                   * 
 *********************************************************************/ 
 STATISTIK_1999:                                                        
         PROC;                                                          
         CALL ZZ20300(SIDELIN,'01');                                    
         IF INDX = 100                                                  
         THEN                                                           
            DO;                                                         
               OVLIN3.TEKST = 'LANDSTOTAL';                             
               OVLIN3.KOMNR = 0;                                        
            END;                                                        
         ELSE                                                           
            DO;                                                         
               OVLIN3.TEKST = 'KOMMUNENR.';                             
               OVLIN3.KOMNR = INDX;                                     
            END;                                                        
         OVLIN3.TEKST1 = 'STATISTIK OVER ANTAL PERSONER MED MULIGHED FOR
  DISPENSATION TIL HELÅRSBEBOELSE';                                     
         OVLIN3.DATO = DATO2, BY NAME;                                  
         CALL ZZ20300(OVLIN3,'01');                                     
         OVLIN4.CCA = ZZWS3;                                            
         OVLIN4.TEKST1 = '                    (2 PCT BEREGNING) I SOMMER
 HUSE (BK 08, 28 ELLER 48) I INDKOMSTÅR 1999.';                         
         CALL ZZ20300(OVLIN4,'01');                                     
         OVLIN4.CCA = ZZWS1;                                            
         OVLIN4.TEKST1 = 'PERSONER MED BOPÆLSKODE       HERAF BBR F379=A
  HERAF BBR F379=B HERAF BBR F379=C HERAF BBR F379=D HERAF BBR F379    I
  ALT ANTAL';                                                           
         CALL ZZ20300(OVLIN4,'01');                                     
         OVLIN4.CCA = ZZWS2;                                            
         OVLIN4.TEKST1 = 'ALDER = STATUS I 1999         OG F380 > 1998  
  OG F380 > 1998   OG F380 > 1998   OG F380 > 1998      = BLANK';       
         CALL ZZ20300(OVLIN4,'01');                                     
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = '67-ÅRIGE M.V.                 ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(1).A379;                  
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(1).B379;                  
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(1).C379;                  
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(1).D379;                  
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(1).U379;                  
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(1).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE             ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(2).A379;                  
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(2).B379;                  
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(2).C379;                  
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(2).D379;                  
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(2).U379;                  
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(2).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = '6O-66 ÅRIGE M.V.              ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(5).A379;                  
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(5).B379;                  
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(5).C379;                  
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(5).D379;                  
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(5).U379;                  
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(5).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE             ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(6).A379;                  
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(6).B379;                  
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(6).C379;                  
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(6).D379;                  
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(6).U379;                  
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(6).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWS1;                                           
         DETLIN4.TEKST = 'UNDER 60-ÅRIGE PENSIONISTER   ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(9).A379;                  
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(9).B379;                  
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(9).C379;                  
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(9).D379;                  
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(9).U379;                  
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(9).IALT;                  
         CALL ZZ20300(DETLIN4,'01');                                    
         DETLIN4.CCA = ZZWS3;                                           
         DETLIN4.TEKST = 'HERAF 8 ÅRS EJERE             ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(10).A379;                 
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(10).B379;                 
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(10).C379;                 
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(10).D379;                 
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(10).U379;                 
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(10).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
         DETLIN4.CCA = ZZWK1;                                           
         DETLIN4.TEKST = 'OVERFØRT FRA OVENSTÅENDE      ';              
         DETLIN4.ANTAL1 = STAT1999(INDX).PLIN(13).A379;                 
         DETLIN4.ANTAL2 = STAT1999(INDX).PLIN(13).B379;                 
         DETLIN4.ANTAL3 = STAT1999(INDX).PLIN(13).C379;                 
         DETLIN4.ANTAL4 = STAT1999(INDX).PLIN(13).D379;                 
         DETLIN4.ANTAL5 = STAT1999(INDX).PLIN(13).U379;                 
         DETLIN4.ANTAL6 = STAT1999(INDX).PLIN(13).IALT;                 
         CALL ZZ20300(DETLIN4,'01');                                    
                                                                        
  END STATISTIK_1999;                                                   
 /********************************************************************* 
 *       MASKINEL AFSTEMNING                                          * 
 *********************************************************************/ 
 MASK_AFSTEMNING:                                                       
         PROC;                                                          
         IF BH64299.EKOMNR ^= 999                                       
         THEN                                                           
            CALL FEJLLISTE('1');                                        
         ELSE                                                           
            IF BH64299.ANT_INDV ^= TV.LÆS_BH642                         
            THEN                                                        
               CALL FEJLLISTE('2');                                     
 END MASK_AFSTEMNING;                                                   
 /*********************************************************************/
 /*      UDSKRIV FEJLLISTE VEDR. KONSTATERET AFSTEMNINGFEJL PÅ ???    */
 /*********************************************************************/
 FEJLLISTE:                                                             
         PROC(FEJL);                                                    
 DCL     FEJL            CHAR      (01);                                
         CALL ZZ20390 ('*OPEN','BH64402Y');                             
         CALL ZZ20300(SIDELIN,'02');                                    
         CALL ZZ20300(OVLIN1,'02');                                     
         OVLIN2.CCA = ZZWS3;                                            
         OVLIN2.TEKST1 = 'FEJLLISTE VEDR. MASKINEL AFSTEMNING';         
         CALL ZZ20300(OVLIN2,'02');                                     
         IF FEJL = '1'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  =                                         
               'AFSTEMNINGSINDIVID MANGLER PÅ B.H64201D';               
               DETLIN1.ANTAL = '';                                      
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
         IF FEJL = '2'                                                  
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA   = ZZWS3;                                   
               DETLIN1.TEKST  = 'ANTAL LÆSTE PERSONER PÅ  B.H64201D';   
               DETLIN1.ANTAL = TV.LÆS_BH642;                            
               CALL ZZ20300(DETLIN1,'02');                              
               DETLIN1.TEKST  =                                         
               'ANTAL PERSONER IFØLGE AFSTEMNINGSINDIVID IALT  :';      
               DETLIN1.ANTAL = BH64299.ANT_INDV;                        
               CALL ZZ20300(DETLIN1,'02');                              
            END;                                                        
            SWFEJL = '1';                                               
 END FEJLLISTE;                                                         
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
         CALL TOTALLISTE;                                               
     /*  DO INDX = 100 TO 999;  */                                      
         DO INDX = 100 TO 100;                                          
            IF STAT1998(INDX).CLIN = 1                                  
            THEN                                                        
               CALL STATISTIK_1998;                                     
         END;                                                           
         DO INDX = 100 TO 100;                                          
            IF STAT1999(INDX).CLIN = 1                                  
            THEN                                                        
               CALL STATISTIK_1999;                                     
         END;                                                           
         CALL MASK_AFSTEMNING;                                          
         CALL ZZ20300((133)' ','99');                                   
         CLOSE FILE (BH642I),                                           
               FILE (BH644O);                                           
         IF SWFEJL = '1'                                                
         THEN                                                           
            CALL ZS30101(4,'BH64400 ** 251 ' !!                         
                 'MASKINEL KONSTATERET AFSTEMNINGSFEJL',2);             
 END AFSLUT;                                                            
 END  BH64400;                                                          
