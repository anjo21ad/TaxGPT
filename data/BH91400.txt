  PROCESS OPT(TIME);                                                    
 BH91400: /* OPDATER EVS TABELLER SAMT DAN DATA TIL SLUT PÅ CSC */      
         PROCEDURE (EXECPARM) OPTIONS (MAIN) REORDER;                   
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
         INIT ('COPYRIGHT KOMMUNEDATA I/S 2002');                       
 /**********************************************************************
 *                                                                     *
 * FORMÅL : OPDATER EVS SLUT TABELLER SAMT DAN DATA TIL SLUT PÅ CSC    *
 *          I.F.M. KØRSEL LIG RETTELSE AF FEJLNR. 5154 OG/ELLER        *
 *          OPSÆTNING AF CELØNCOR                                      *
 *                                                                     *
 * INPUT  : B.HXXXXXD UDTRÆK FRA BERBÅND FRA EVS SLUT 2000 HOVEDLEV    *
 *                                                                     *
 * OUTPUT : BQ01100T+BQ01200T - EVS SLUT TABELLER                      *
 *          D0311601.A782 UDTRÆK - EVS DATA TIL SLUT PÅ CSC            *
 *          BH91410D - EJ BEHANDET P.G.A. OPDATERING EFTER HOVEDLEV    *
 *          BH91401Y - KØRSELSKONTROLLISTE                             *
 *                                                                     *
 * OBS.: B.H91480X  DATA FRA LÆS TAB'S   --> DISSE DATASÆT             *
 *       B.H91490X  DATA FRA SKRIV TAB'S --> DANNES KUN I TEST         *
 *                                       --> OG  K U N                 *
 *                                       --> HVIS EXECPARM = TDB2      *
 *                                                                     *
 * PROGRAMMØR: AAGE RASMUSSEN  FEBRUAR   2002                          *
 *                                                                     *
 *                                                                     *
 **********************************************************************/
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /*********************************************************************/
 /*      PARAMETER TIL ANGIVELSE AF OM DET ER PRODUKTION ELLER        */
 /*      TESTKØRSEL AF HENSYN TIL MASKINEL AFSTEMNING                 */
 /*********************************************************************/
 DCL     EXECPARM        CHAR      (6) VAR;                             
 DCL     EX_PARM         CHAR      (4);                                 
         EX_PARM = EXECPARM;                                            
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH914I FILE RECORD INPUT;      /* BEREGN.BÅNDS UDTRÆK       */ 
 DCL     BH9140O FILE RECORD OUTPUT;    /* EVS DATA TIL SLUT PÅ CSC  */ 
 DCL     BH9141O FILE RECORD OUTPUT;    /* EJ BEHANDLEDE             */ 
 DCL     SYSPRINT EXTERNAL FILE PRINT;                                  
 /* FØLGENDE 2 DATASÆT DANNES KUN EFTER BEHOV I.F.M. PROGRAM-TEST    */ 
 DCL     BH9148O FILE RECORD OUTPUT;  /* EVS DATA FRA LÆS TABELLER   */ 
 DCL     BH9149O FILE RECORD OUTPUT;  /* EVS DATA FRA SKRIV TABELLER */ 
 /********************************************************************* 
 *       DECLARE AF INPUT                                             * 
 *********************************************************************/ 
 DCL     BH914_AR        CHAR      (4000) VAR;                          
 DCL     1 BH914         BASED     (ADDR(BH914_AR)),                    
           2 LÆNGDE      BIN FIXED (15),                                
           %INCLUDE BH90000N;;                                          
 /********************************************************************* 
 *       DECLARE AF OUTPUT HERUNDER EVT. TEST IND-/UDDATA             * 
 *********************************************************************/ 
 DCL     1 BH9140,                                                      
           %INCLUDE BH97110N;                                           
                                                                        
 DCL     1 KOM_AREAL ALIGNED,                                           
         %INCLUDE BQ01010N;                                             
                                                                        
 DCL     1 BQ_IND ALIGNED,                                              
         %INCLUDE BQ01011N;;                                            
                                                                        
 DCL     1 BQ_UD ALIGNED,                                               
         %INCLUDE BQ01011N;;                                            
                                                                        
 /*  DCL     1 TEST ALIGNED,                                            
         %INCLUDE BH97150N;; */                                         
                                                                        
 /********************************************************************* 
 *               DECLARE AF DIV. TÆLLEVÆRKER                          * 
 *********************************************************************/ 
 DCL     1 TV,                   /* TÆLLEVÆRKER TIL TOTALLISTEN */      
           2 LÆS_BH914    FIXED DEC (7),                                
           2 LÆS_EJD      FIXED DEC (7),                                
           2 LÆS_PERS     FIXED DEC (7),                                
           2 SKRIV_EJD    FIXED DEC (7),                                
           2 SKRIV_PERS   FIXED DEC (7),                                
           2 SKREVET      FIXED DEC (7),                                
           2 SKR_BH914    FIXED DEC (7),                                
           2 EJ_BEHANDL   FIXED DEC (7),                                
           2 BEREGNET     FIXED DEC (7),                                
           2 EVS2001      FIXED DEC (15,2),                             
           2 BPROM1       FIXED DEC (7),                                
           2 BPROM2       FIXED DEC (7),                                
           2 BNEDSL1      FIXED DEC (7),                                
           2 BNEDSL2      FIXED DEC (7),                                
           2 CPENSN11     FIXED DEC (7),                                
           2 CPENSN14     FIXED DEC (7),                                
           2 CPENSN21     FIXED DEC (7),                                
           2 CSTIBLB(10)  FIXED DEC (7),                                
           2 BER_BOPÆL0   FIXED DEC (7),                                
           2 BER_BOPÆL1   FIXED DEC (7),                                
           2 BER_BOPÆL2   FIXED DEC (7),                                
           2 BER_BOPÆL3   FIXED DEC (7),                                
           2 BER_BOPÆL4   FIXED DEC (7),                                
           2 BER_BOPÆL5   FIXED DEC (7),                                
           2 BER_BOPÆL6   FIXED DEC (7),                                
           2 EJBEREGNET   FIXED DEC (7),                                
           2 EJBER_BOPÆL0 FIXED DEC (7),                                
           2 EJBER_BOPÆL1 FIXED DEC (7),                                
           2 EJBER_BOPÆL2 FIXED DEC (7),                                
           2 EJBER_BOPÆL3 FIXED DEC (7),                                
           2 EJBER_BOPÆL4 FIXED DEC (7),                                
           2 EJBER_BOPÆL5 FIXED DEC (7),                                
           2 EJBER_BOPÆL6 FIXED DEC (7);                                
                                                                        
 DCL     1 LÆST_FEJLNR(4000:6000), /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
                                                                        
 DCL     1 SKR_FEJLNR(4000:6000),  /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 SKR_EJBEVS(0:9),        /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_BERGRL(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
 DCL     1 LÆST_EJDTYP(0:9),       /* TÆLLEVÆRKER TIL TOTALLISTEN */    
           2 ANTAL       FIXED DEC (7);                                 
                                                                        
 DCL     TV_LÆS          FIXED     (7)       INIT      (0);             
 DCL     TV_LÆS_EVS      FIXED     (7)       INIT      (0);             
 DCL     TV_OVERLÆS      FIXED     (7)       INIT      (0);             
 DCL     TV_SKRIV_EVS    FIXED     (7)       INIT      (0);             
 DCL     TV_FEJL         FIXED     (7)       INIT      (0);             
 DCL     TV_LIN          FIXED     (7)       INIT      (0);             
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     BQ01110         ENTRY;                                         
 DCL     ZS30101         ENTRY;                                         
 DCL     ZS61900         ENTRY;                                         
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*      DECLARE AF PRINTLINIER                                       */
 /*********************************************************************/
 DCL    LIN_DEB          CHAR      (133);                               
 DCL    1 SIDELIN,                                                      
          2 CCA          CHAR      (01),                                
          2 FILLER       CHAR      (132)     INIT      (' ');           
 DCL     1 OVERLIN1,                                                    
           2 CCA         CHAR      (01),                                
           2 TEKST1      CHAR      (17)      INIT      (                
           'PROGRAM: BH91400L'),                                        
           2 F1          CHAR      (25)      INIT      (' '),           
           2 TEKST2      CHAR      (57)      INIT      (                
           'RET FEJLNR 5154 OG CELØNCOR (FEJL I HOVEDLEV)   '),         
           2 F2          CHAR      (12)      INIT      (' '),           
           2 TEKST3      CHAR      (11)      INIT      (                
           'UDSKREVET:'),                                               
           2 DATO        CHAR      (10);                                
 DCL     1 OVERLIN2,                                                    
           2 CCA         CHAR      (01),                                
           2 F1          CHAR      (46)      INIT      (' '),           
           2 TEKST1      CHAR      (86)      INIT                       
           ('          KØRSELSKONTROLLISTE');                           
 DCL     1 DETLIN1,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZZ',                       
           2 F2          CHAR      (61)      INIT      (' ');           
 DCL     1 DETLIN2,                                                     
           2 CCA         CHAR      (01),                                
           2 TEKST       CHAR      (60),                                
           2 ANTAL       PIC       'ZZZ.ZZZ.ZZ9',                       
           2 F2          CHAR      (10)      INIT      (' '),           
           2 TEKST2      CHAR      (07)      INIT      ('BELØB: '),     
           2 BELØB       PIC       'Z.ZZZ.ZZZ.ZZZ.ZZ9,V99',             
           2 F3          CHAR      (24)      INIT      (' ');           
 DCL     1 LIN3,                                                        
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (2)       INIT      (' '),           
          2 TEKST        CHAR      (52),                                
          2 ANT          PIC       'ZZZ.ZZZ.ZZZ.ZZZ.ZZ9',               
          2 REST         CHAR      (59)      INIT      (' ');           
 DCL     1 LIN_BLANK,                                                   
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (132)     INIT      (' ');           
 DCL     1 FEJL_LIN1,                                                   
          2 CTL           CHAR      (1),                                
          2 RECORDNR      PIC       'ZZZZ.999',                         
          2 F1            CHAR      (1),                                
          2 DCPRN         PIC       '(10)9',                            
          2 F2            CHAR      (1),                                
          2 EKOMNR        PIC       '(3)9',                             
          2 F3            CHAR      (1),                                
          2 EEJDNR        PIC       '(7)9',                             
          2 F4            CHAR      (1),                                
          2 ELBNR         PIC       '999',                              
          2 F5            CHAR      (1),                                
          2 FEJLNR        PIC       '9999',                             
          2 F6            CHAR      (1),                                
          2 FEJLTEKST     CHAR      (70),                               
          2 REST          CHAR      (21);                               
         % INCLUDE ZZ20301M;                                            
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     EOF_BH914       BIT       (1);                                 
 DCL     EVS_OPDATERET   BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     INDEX           BIN FIXED (31);                                
 DCL     I               BIN FIXED (15);                                
 DCL     HJ_CHAR4        CHAR      (4);                                 
 DCL     HJ_PIC4         PIC       '(4)9'  BASED(ADDR(HJ_CHAR4));       
 DCL     HJ_FEJLNR       PIC       '(4)9';                              
 DCL     HJ_FEJLNRC      CHAR      (4)     BASED(ADDR(HJ_FEJLNR));      
 DCL     HJ_CHAR1        CHAR      (1);                                 
 DCL     HJ_PIC1         PIC       '9'     BASED(ADDR(HJ_CHAR1));       
 DCL     HJ_CHAR2        CHAR      (2);                                 
 DCL     HJ_PIC2         PIC       '99'    BASED(ADDR(HJ_CHAR2));       
                                                                        
 DCL     GL_PNR          FIXED     (11);                                
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2         DEF DATO1,                                     
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 /********************************************************************* 
 *       DECLARE AF HJÆLPEFELTER TIL MASKINEL AFSTEMNING              * 
 *********************************************************************/ 
 DCL     BH914_ANT_INDV  FIXED     (7)       INIT      (0);             
 DCL     SWFEJL          CHAR      (1)       INIT      (' ');           
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL ZS61900;                          /* UDSKRIVNING AF SSI */
                                                                        
         EOF_BH914 = NEJ;                                               
                                                                        
         ON ERROR                                                       
            BEGIN;                                                      
               ON ERROR SYSTEM;                                         
               PUT SKIP LIST ('PROGRAMFEJL');                           
               CALL PLIDUMP  ('SNHOB','MODUL BH91400');                 
            END;                                                        
                                                                        
         OPEN FILE (BH914I)  TITLE ('BH91400I');                        
         OPEN FILE (BH9140O) TITLE ('BH91400O');                        
         OPEN FILE (BH9141O) TITLE ('BH91410O');                        
                                                                        
         IF EX_PARM = 'TDB2'                                            
         THEN                                                           
            DO;                                                         
               OPEN FILE (BH9148O) TITLE ('BH91480O');                  
               OPEN FILE (BH9149O) TITLE ('BH91490O');                  
            END;                                                        
                                                                        
         ON ENDFILE (BH914I)                                            
            EOF_BH914 = JA;                                             
                                                                        
         CALL ZZ20390 ('*OPEN','BH91401Y');                             
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         OVERLIN1.DATO  = UDDATO;                                       
                                                                        
         SIDELIN.CCA    = ZZIK1;                                        
         OVERLIN1.CCA   = ZZWS2;                                        
         OVERLIN2.CCA   = ZZWS3;                                        
                                                                        
         TV = 0;                                                        
                                                                        
         DO INDEX = 4000 TO 6000;                                       
            LÆST_FEJLNR(INDEX).ANTAL = 0;                               
            SKR_FEJLNR(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            SKR_EJBEVS(INDEX).ANTAL = 0;                                
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_BERGRL(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         DO INDEX = 0 TO 9;                                             
            LÆST_EJDTYP(INDEX).ANTAL = 0;                               
         END;                                                           
                                                                        
         GL_PNR = 0;                                                    
                                                                        
         FETCH BQ01110;                                                 
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_BH914;                                                
                                                                        
         DO WHILE ( EOF_BH914 = NEJ );                                  
                                                                        
            IF BH914.SORT_CPR < 99999999999     /* OPTÆLL.INDV. */      
            THEN                                                        
               DO;                                                      
              /* CALL BEHANDL_PERSON;                                   
                 CALL BEHANDL_CSC; */                                   
               END;                                                     
                                                                        
            CALL LÆS_BH914;                                             
                                                                        
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK FRA ESR                                           * 
 *********************************************************************/ 
 LÆS_BH914:                                                             
         PROC;                                                          
                                                                        
         READ FILE (BH914I) INTO (BH914_AR);                            
                                                                        
         IF EOF_BH914 = NEJ                                             
         THEN                                                           
            TV.LÆS_BH914 = TV.LÆS_BH914 + 1;                            
                                                                        
 END LÆS_BH914;                                                         
 /********************************************************************* 
 *       PERSONER SOM EVT. SKAL OPDATERES                             * 
 *********************************************************************/ 
 BEHANDL_PERSON:                                                        
         PROC;                                                          
                                                                        
         EVS_OPDATERET = NEJ;                                           
                                                                        
      /* HJ_CHAR1 = BH914.TIL_EVS.CEJDTYPE;  */                         
         INDEX = HJ_PIC1;                                               
         LÆST_EJDTYP(INDEX).ANTAL = LÆST_EJDTYP(INDEX).ANTAL + 1;       
                                                                        
      /* HJ_CHAR1 = BH914.TIL_EVS.CBERGRL;   */                         
         INDEX = HJ_PIC1;                                               
         LÆST_BERGRL(INDEX).ANTAL = LÆST_BERGRL(INDEX).ANTAL + 1;       
                                                                        
         IF BH914.FEJLNR > 0                                            
         THEN                                                           
            DO;                                                         
               HJ_FEJLNR = BH914.FEJLNR;                                
               INDEX = HJ_FEJLNR;                                       
               LÆST_FEJLNR(INDEX).ANTAL = LÆST_FEJLNR(INDEX).ANTAL + 1; 
            END;                                                        
                                                                        
         IF BH914.FEJLNR = 5001 !                                       
           (BH914.TIL_EVS.CEJBEVS = '1' & BH914.FEJLNR = 5008) !        
            BH914.FEJLNR = 5020                                         
         THEN                                                           
            DO;                                                         
               TV_OVERLÆS = TV_OVERLÆS + 1;                             
               RETURN;                                                  
            END;                                                        
                                                                        
     /*  CALL LÆS_PÅ_DB2;  */                                           
                                                                        
 END BEHANDL_PERSON;                                                    
                                                                        
 /********************************************************************* 
 *       DAN DATASÆT TIL CSC                                          * 
 *********************************************************************/ 
 BEHANDL_CSC: PROC;                                                     
                                                                        
         IF EVS_OPDATERET = NEJ                                         
         THEN                                                           
            RETURN;                                                     
                                                                        
         IF BH914.FEJLNR = 5024 !                                       
            BH914.FEJLNR = 5026                                         
         THEN                                                           
            RETURN;                                                     
                                                                        
     /*  CALL DAN_DATA_TIL_SLUT;  */                                    
                                                                        
 END BEHANDL_CSC;                                                       
                                                                        
     /*  %INCLUDE BH91410M;  */                /* LÆS PÅ DB2          */
                                                                        
         %INCLUDE BH00001M;                    /* CHAR4_TIL_BIN15     */
                                               /* CHAR10_TIL_FIX11    */
                                                                        
    /*   %INCLUDE BH00003M                        FIX09_TIL_DB2_DATO  */
                                                                        
         %INCLUDE BQ01922M;                    /* DB2_DATO_TIL_FIX09  */
                                               /* FIX09_TIL_DB2_DATO  */
                                                                        
    /*   %INCLUDE BH91402M; */                 /* DAN_DATA_TIL_SLUT   */
                                                                        
 /********************************************************************* 
 *                       TOTALER UDSKRIVES.                           * 
 *********************************************************************/ 
 TOTALLISTE:                                                            
         PROC;                                                          
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.LÆS_BH914;                                  
         DETLIN1.TEKST = 'ANTAL LÆSTE PÅ UDTRÆK             B.H91400D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DO INDEX = 0 TO 9;                                             
            IF LÆST_EJDTYP(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED EJENDOMSTYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_EJDTYP(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DO INDEX = 0 TO 9;                                             
            IF LÆST_BERGRL(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED BER.GRL.TYPE ' !! HJ_CHAR1;          
                  DETLIN1.ANTAL = LÆST_BERGRL(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DO INDEX = 4000 TO 6000;                                       
            IF LÆST_FEJLNR(INDEX).ANTAL > 0                             
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = LÆST_FEJLNR(INDEX).ANTAL;             
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         LIN3.CTL = ZZWS2;                                              
         LIN3.TEKST = 'ANTAL AJOURFØRTE EVS                           ';
         LIN3.ANT = TV_SKRIV_EVS;                                       
         CALL ZZ20300(LIN3,'01');                                       
         LIN3.CTL = ZZWS2;                                              
         LIN3.TEKST = 'ANTAL ADVIS (F.EKS. OPRETTELSER PÅ EVS)        ';
         LIN3.ANT = TV_FEJL;                                            
         CALL ZZ20300(LIN3,'01');                                       
         LIN3.CTL = ZZWS2;                                              
         LIN3.TEKST = 'ANTAL OVERLÆSTE                                ';
         LIN3.ANT = TV_OVERLÆS;                                         
         CALL ZZ20300(LIN3,'01');                                       
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.EJ_BEHANDL;                                 
         DETLIN1.TEKST = 'ANTAL SKREVET EJ BEHANDLEDE       B.H91410D'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.SKREVET;                                    
         DETLIN1.TEKST = 'ANTAL SUPPL INDIVIDER TIL CSC D0311601.A782'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         IF EX_PARM = 'TDB2'                                            
         THEN                                                           
            DO;                                                         
               DETLIN1.CCA = ZZWS2;                                     
               DETLIN1.ANTAL = TV.LÆS_EJD;                              
               DETLIN1.TEKST =                                          
               'ANTAL LÆST PÅ EVS-TABELLER        B.H91480D';           
               CALL ZZ20300 (DETLIN1,'01');                             
                                                                        
               DETLIN1.CCA = ZZWS2;                                     
               DETLIN1.ANTAL = TV.SKRIV_PERS;                           
               DETLIN1.TEKST =                                          
               'ANTAL SKRIV PÅ EVS_TABELLER       B.H91490D';           
               CALL ZZ20300 (DETLIN1,'01');                             
            END;                                                        
                                                                        
         DO INDEX = 4000 TO 6000;                                       
            IF SKR_FEJLNR(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC4 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED FEJLNR. ' !! HJ_CHAR4;               
                  DETLIN1.ANTAL = SKR_FEJLNR(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         DETLIN1.CCA = ZZIS1;                                           
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DO INDEX = 0 TO 9;                                             
            IF SKR_EJBEVS(INDEX).ANTAL > 0                              
            THEN                                                        
               DO;                                                      
                  DETLIN1.CCA = ZZWS1;                                  
                  HJ_PIC1 = INDEX;                                      
                  DETLIN1.TEKST =                                       
                  '      HERAF MED CEJBEVS ' !! HJ_CHAR1;               
                  DETLIN1.ANTAL = SKR_EJBEVS(INDEX).ANTAL;              
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN2 = '';                                                  
         DETLIN2.CCA = ZZWS2;                                           
         DETLIN2.ANTAL = TV.BEREGNET;                                   
         DETLIN2.TEKST = 'ANTAL BEREGNEDE EJENDOMME (EVS)            '; 
         DETLIN2.BELØB = TV.EVS2001;                                    
         CALL ZZ20300 (DETLIN2,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM1;                                     
         DETLIN1.TEKST = '    HERAF MED 10 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BPROM2;                                     
         DETLIN1.TEKST = '    HERAF MED 30 PROMILLE            ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL1;                                    
         DETLIN1.TEKST = '    HERAF MED 2 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BNEDSL2;                                    
         DETLIN1.TEKST = '    HERAF MED 4 PROMILLE NEDSLAG     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN11;                                   
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG (11-13)   ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN14;                                   
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG (14-19)   ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.CPENSN21;                                   
         DETLIN1.TEKST = '    HERAF MED PENS NEDSLAG (21-23)   ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DO I = 1 TO 10;                                                
            IF TV.CSTIBLB(I) > 0                                        
            THEN                                                        
               DO;                                                      
                  DETLIN1 = '';                                         
                  DETLIN1.CCA = ZZWS1;                                  
                  DETLIN1.ANTAL = TV.CSTIBLB(I);                        
                  HJ_PIC2 = I;                                          
                  DETLIN1.TEKST = '    HERAF MED CSTIBLB-KODE LIG '     
                  !! HJ_CHAR2 !! '    ANTAL:';                          
                  CALL ZZ20300 (DETLIN1,'01');                          
               END;                                                     
         END;                                                           
                                                                        
         CALL ZZ20300(SIDELIN,'01');                                    
         CALL ZZ20300(OVERLIN1,'01');                                   
         CALL ZZ20300(OVERLIN2,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL1;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL2;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL3;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL4;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL5;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL6;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.BER_BOPÆL0;                                 
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1.CCA = ZZWS2;                                           
         DETLIN1.ANTAL = TV.EJBEREGNET;                                 
         DETLIN1.TEKST = 'ANTAL IKKE BEREGNEDE EJENDOMME (EVS)       '; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL1;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 1           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL2;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 2           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL3;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 3           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL4;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 4           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL5;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 5           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL6;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE 6           ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
         DETLIN1 = '';                                                  
         DETLIN1.CCA = ZZWS1;                                           
         DETLIN1.ANTAL = TV.EJBER_BOPÆL0;                               
         DETLIN1.TEKST = '    HERAF MED BOPÆLSKODE BLANK/0     ANTAL:'; 
         CALL ZZ20300 (DETLIN1,'01');                                   
                                                                        
  END TOTALLISTE;                                                       
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
         PROC;                                                          
                                                                        
         CALL TOTALLISTE;                                               
                                                                        
         CALL ZZ20300((133)' ','99');                                   
                                                                        
         RELEASE BQ01110;                                               
                                                                        
         CLOSE FILE (BH914I),                                           
               FILE (BH9140O),                                          
               FILE (BH9141O);                                          
                                                                        
         IF EX_PARM = 'TDB2'                                            
         THEN                                                           
            DO;                                                         
               CLOSE FILE (BH9148O),                                    
                     FILE (BH9149O);                                    
            END;                                                        
                                                                        
         IF SWFEJL = '1'                                                
         THEN                                                           
            CALL ZS30101(4,'BH91400 ** 251 ' !!                         
                 'MASKINEL KONSTATERET AFSTEMNINGSFEJL',2);             
                                                                        
 END AFSLUT;                                                            
                                                                        
                                                                        
 END  BH91400;                                                          
