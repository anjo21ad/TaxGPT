 /*********************************************************************/
 /* BH65300M BRUGES VED BEREGNING AF EVS (EJENDOMSVÆRDISKAT) TIL      */
 /*          SLUT, BOLIGYDELSE OG FORSKUD BL.A. VED BEREGNING AF PER- */
 /*          SONERS ALDER OG HVOR MANGE ÅR EN EJENDOM ER EJET (8 ÅRS  */
 /*          REGEL FOR HELÅRS-SOMMERHUSE).                            */
 /*                                                                   */
 /*          OPSÆTNINGERNE SKER SOM KONSTANTER, DER SKAL RETTES       */
 /*          VED ÅRSTILRETNINGEN I.F.M. FORSKUD.                      */
 /* FORSKUD06  SUSANNE KROGH VILLUMSEN              26/05-2005        */
 /*            TILRETTET FOR FORSKUD2006                              */
 /* FORSKUD07  BO SCHMIDT                           14/05-2006        */
 /*            TILRETTET FOR FORSKUD2007/SLUT2006                     */
 /* FORSKUD08  BO SCHMIDT                           22/05-2007        */
 /*            TILRETTET FOR FORSKUD2008/SLUT2007                     */
 /* FORSKUD09  BO SCHMIDT                           30/06-2008        */
 /*            TILRETTET FOR FORSKUD2009/SLUT2008                     */
 /* FORSKUD10  GERD HOLM-PEDERSEN                   16/04-2009        */
 /*            TILRETTET FOR FORSKUD2010/SLUT2008                     */
 /* FORSKUD11  GERD HOLM-PEDERSEN                   03/06-2010        */
 /*            TILRETTET FOR FORSKUD2011/SLUT2009                     */
 /* FORSKUD11  GERD HOLM-PEDERSEN                   03/06-2010        */
 /*            TILRETTET FOR FORSKUD2011/SLUT2009                     */
 /* FORSKUD12  GERD HOLM-PEDERSEN                   16/05-2011        */
 /*            TILRETTET FOR FORSKUD2011/SLUT2009                     */
 /* FORSKUD13  ESBEN BRODERSEN                      23/05-2012        */
 /*            TILRETTET FOR FORSKUD2013/SLUT2012                     */
 /* FORSKUD14  ESBEN BRODERSEN                      21/05-2013        */
 /*            TILRETTET FOR FORSKUD2014/SLUT2013                     */
 /* FORSKUD15  JØRGEN SAUGMANN                      30/06-2014        */
 /*            TILRETTET FOR FORSKUD2015/SLUT2014                     */
 /* FORSKUD16  JØRGEN SAUGMANN                      30/06-2014        */
 /*            TILRETTET FOR FORSKUD2016/SLUT2015                     */
 /* SLUT15     ESBEN BRODERSEN                      22/02-2016        */
 /*            UDVIDET MED NY FELTER #01                              */
 /*            SÅ MACRO KAN BRUGES FLERE STEDER                       */
 /* FORSKUD17  ESBEN BRODERSEN                      20/06-2016        */
 /*            TILRETTET FOR FORSKUD2017/SLUT2016                     */
 /* FORSKUD18  ESBEN BRODERSEN                      29/05-2017        */
 /*            TILRETTET FOR FORSKUD2018/SLUT2017                     */
 /* FORSKUD19  ESBEN BRODERSEN                      23/05-2018        */
 /*            TILRETTET FOR FORSKUD2019/SLUT2018                     */
 /* FORSKUD20  ESBEN BRODERSEN                      21/03-2019        */
 /*            TILRETTET FOR FORSKUD2020/SLUT2019                     */
 /* FORSKUD21  Per Brunk                            19/03-2020        */
 /*            TILRETTET FOR FORSKUD2021/SLUT2020                     */
 /*********************************************************************/
                                                                        
         2 FORRIGESLUTÅR  BIN FIXED (15),    /* FORRIGE SLUTÅR       */ 
         2 GLSLUTÅR       BIN FIXED (15),    /* AKTUELT GL. SLUTÅR   */ 
         2 SLUTÅR         BIN FIXED (15),    /* AKTUELT SLUTÅR       */ 
         2 FORSKÅR        BIN FIXED (15),    /* AKTUELT FORSKUDSÅR   */ 
         2 FORRIGESLUTÅR1 CHAR      (04),    /* FORRIGE SLUTÅR CHAR  */ 
         2 GLSLUTÅR1      CHAR      (04),    /* GL SLUTÅR CHAR       */ 
         2 INDKÅR1        CHAR      (04),    /* AKTUELT SLUTÅR CHAR  */ 
         2 INDKÅR2        CHAR      (04),    /* FORSKUDSÅR CHAR      */ 
         2 FORRIGE0101    FIXED     (09),                               
         2 FORRIGE0201    FIXED     (09),                               
         2 FORRIGE0301    FIXED     (09),                               
         2 FORRIGE0401    FIXED     (09),                               
         2 FORRIGE0501    FIXED     (09),                               
         2 FORRIGE0601    FIXED     (09),                               
         2 FORRIGE0701    FIXED     (09),                               
         2 FORRIGE0801    FIXED     (09),                               
         2 FORRIGE0901    FIXED     (09),                               
         2 FORRIGE1001    FIXED     (09),                               
         2 FORRIGE1101    FIXED     (09),                               
         2 FORRIGE1201    FIXED     (09),                               
         2 GLÅR0101       FIXED     (09),                               
         2 GLÅR0201       FIXED     (09),                               
         2 GLÅR0301       FIXED     (09),                               
         2 GLÅR0401       FIXED     (09),                               
         2 GLÅR0501       FIXED     (09),                               
         2 GLÅR0601       FIXED     (09),                               
         2 GLÅR0701       FIXED     (09),                               
         2 GLÅR0801       FIXED     (09),                               
         2 GLÅR0901       FIXED     (09),                               
         2 GLÅR1001       FIXED     (09),                               
         2 GLÅR1101       FIXED     (09),                               
         2 GLÅR1201       FIXED     (09),                               
         2 GLÅR0131       FIXED     (09),                               
         2 GLÅR0229       FIXED     (09),                               
         2 GLÅR0331       FIXED     (09),                               
         2 GLÅR0430       FIXED     (09),                               
         2 GLÅR0531       FIXED     (09),                               
         2 GLÅR0630       FIXED     (09),                               
         2 GLÅR0731       FIXED     (09),                               
         2 GLÅR0831       FIXED     (09),                               
         2 GLÅR0930       FIXED     (09),                               
         2 GLÅR1031       FIXED     (09),                               
         2 GLÅR1130       FIXED     (09),                               
         2 GLÅR1231       FIXED     (09),                               
         2 ÅR0101         FIXED     (09),                               
         2 ÅR0201         FIXED     (09),                               
         2 ÅR0301         FIXED     (09),                               
         2 ÅR0401         FIXED     (09),                               
         2 ÅR0501         FIXED     (09),                               
         2 ÅR0601         FIXED     (09),                               
         2 ÅR0701         FIXED     (09),                               
         2 ÅR0801         FIXED     (09),                               
         2 ÅR0901         FIXED     (09),                               
         2 ÅR1001         FIXED     (09),                               
         2 ÅR1101         FIXED     (09),                               
         2 ÅR1201         FIXED     (09),                               
         2 ÅR0131         FIXED     (09),                               
         2 ÅR0229         FIXED     (09),                               
         2 ÅR0331         FIXED     (09),                               
         2 ÅR0430         FIXED     (09),                               
         2 ÅR0531         FIXED     (09),                               
         2 ÅR0630         FIXED     (09),                               
         2 ÅR0731         FIXED     (09),                               
         2 ÅR0831         FIXED     (09),                               
         2 ÅR0930         FIXED     (09),                               
         2 ÅR1031         FIXED     (09),                               
         2 ÅR1130         FIXED     (09),                               
         2 ÅR1231         FIXED     (09),                               
         2 FORSKÅR0101    FIXED     (09),                               
         2 FORSKÅR0201    FIXED     (09),                               
         2 FORSKÅR0301    FIXED     (09),                               
         2 FORSKÅR0401    FIXED     (09),                               
         2 FORSKÅR0501    FIXED     (09),                               
         2 FORSKÅR0601    FIXED     (09),                               
         2 FORSKÅR0701    FIXED     (09),                               
         2 FORSKÅR0801    FIXED     (09),                               
         2 FORSKÅR0901    FIXED     (09),                               
         2 FORSKÅR1001    FIXED     (09),                               
         2 FORSKÅR1101    FIXED     (09),                               
         2 FORSKÅR1201    FIXED     (09),                               
         2 FORSKÅR0131    FIXED     (09),                               
         2 FORSKÅR0229    FIXED     (09),                               
         2 FORSKÅR0331    FIXED     (09),                               
         2 FORSKÅR0430    FIXED     (09),                               
         2 FORSKÅR0531    FIXED     (09),                               
         2 FORSKÅR0630    FIXED     (09),                               
         2 FORSKÅR0731    FIXED     (09),                               
         2 FORSKÅR0831    FIXED     (09),                               
         2 FORSKÅR0930    FIXED     (09),                               
         2 FORSKÅR1031    FIXED     (09),                               
         2 FORSKÅR1130    FIXED     (09),                               
         2 FORSKÅR1231    FIXED     (09),                               
         2 HJ_DATO1       FIXED     (09),     /* SLUTÅR0101 + 1 ÅR    */
         2 HJ_DATO2       FIXED     (09);     /* SLUTÅR0101 + 2 ÅR    */
                                                                        
        /* START PÅ ÅRSRULNING */                                       
        /* OPSÆTNING FOR SLUTÅR =2018  D.V.S. FORRIGE SLUTÅR */         
         BH65300M.FORRIGESLUTÅR   = 2018;           /* RUL */           
         BH65300M.FORRIGESLUTÅR1  = '2018';         /* RUL */           
                                                                        
       /* OPSÆTNING FOR SLUTÅR=2019  D.V.S. GL. SLUTÅR */               
         BH65300M.GLSLUTÅR   = 2019;                 /* RUL */          
         BH65300M.GLSLUTÅR1  = '2019';               /* RUL */          
                                                                        
      /* OPSÆTNING FOR SLUTÅR=2020 D.V.S AKTUELT SLUTÅR */              
         BH65300M.SLUTÅR     = 2020;                 /* RUL */          
         BH65300M.INDKÅR1    = '2020';               /* RUL */          
                                                                        
      /* OPSÆTNING FOR FORSKUDSÅR=2021 */                               
         BH65300M.FORSKÅR    = 2021;                 /* RUL */          
         BH65300M.INDKÅR2    = '2021';               /* RUL */          
                                                                        
      /* SLUT PÅ ÅRSRULNING */                                          
                                                                        
      /* AFLEDTE DATOER FOR FORRIGE SLUTÅR */                           
                                                                        
         BH65300M.FORRIGE0101   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0101);          
         BH65300M.FORRIGE0201   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0201);          
         BH65300M.FORRIGE0301   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0301);          
         BH65300M.FORRIGE0401   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0401);          
         BH65300M.FORRIGE0501   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0501);          
         BH65300M.FORRIGE0601   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0601);          
         BH65300M.FORRIGE0701   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0701);          
         BH65300M.FORRIGE0801   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0801);          
         BH65300M.FORRIGE0901   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,0901);          
         BH65300M.FORRIGE1001   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,1001);          
         BH65300M.FORRIGE1101   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,1101);          
         BH65300M.FORRIGE1201   =                                       
                  OPSÆT_YYYYMMDD(BH65300M.FORRIGESLUTÅR,1201);          
                                                                        
      /* AFLEDTE DATOER FOR GL. SLUTÅR */                               
                                                                        
         BH65300M.GLÅR0101 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0101);    
         BH65300M.GLÅR0201 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0201);    
         BH65300M.GLÅR0301 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0301);    
         BH65300M.GLÅR0401 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0401);    
         BH65300M.GLÅR0501 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0501);    
         BH65300M.GLÅR0601 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0601);    
         BH65300M.GLÅR0701 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0701);    
         BH65300M.GLÅR0801 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0801);    
         BH65300M.GLÅR0901 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0901);    
         BH65300M.GLÅR1001 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,1001);    
         BH65300M.GLÅR1101 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,1101);    
         BH65300M.GLÅR1201 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,1201);    
                                                                        
         BH65300M.GLÅR0131 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0131);    
         BH65300M.GLÅR0229 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0229);    
         BH65300M.GLÅR0331 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0331);    
         BH65300M.GLÅR0430 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0430);    
         BH65300M.GLÅR0531 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0531);    
         BH65300M.GLÅR0630 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0630);    
         BH65300M.GLÅR0731 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0731);    
         BH65300M.GLÅR0831 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0831);    
         BH65300M.GLÅR0930 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,0930);    
         BH65300M.GLÅR1031 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,1031);    
         BH65300M.GLÅR1130 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,1130);    
         BH65300M.GLÅR1231 = OPSÆT_YYYYMMDD(BH65300M.GLSLUTÅR,1231);    
                                                                        
       /* AFLEDTE DATOER FOR AKTUELT SLUTÅR */                          
                                                                        
         BH65300M.ÅR0101 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0101);        
         BH65300M.ÅR0201 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0201);        
         BH65300M.ÅR0301 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0301);        
         BH65300M.ÅR0401 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0401);        
         BH65300M.ÅR0501 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0501);        
         BH65300M.ÅR0601 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0601);        
         BH65300M.ÅR0701 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0701);        
         BH65300M.ÅR0801 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0801);        
         BH65300M.ÅR0901 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0901);        
         BH65300M.ÅR1001 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,1001);        
         BH65300M.ÅR1101 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,1101);        
         BH65300M.ÅR1201 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,1201);        
                                                                        
         BH65300M.ÅR0131 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0131);        
         BH65300M.ÅR0229 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0229);        
         BH65300M.ÅR0331 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0331);        
         BH65300M.ÅR0430 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0430);        
         BH65300M.ÅR0531 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0531);        
         BH65300M.ÅR0630 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0630);        
         BH65300M.ÅR0731 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0731);        
         BH65300M.ÅR0831 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0831);        
         BH65300M.ÅR0930 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,0930);        
         BH65300M.ÅR1031 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,1031);        
         BH65300M.ÅR1130 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,1130);        
         BH65300M.ÅR1231 = OPSÆT_YYYYMMDD(BH65300M.SLUTÅR,1231);        
                                                                        
       /* AFLEDTE DATOER FOR FORSKUDSÅR */                              
                                                                        
         BH65300M.FORSKÅR0101 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0101);  
         BH65300M.FORSKÅR0201 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0201);  
         BH65300M.FORSKÅR0301 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0301);  
         BH65300M.FORSKÅR0401 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0401);  
         BH65300M.FORSKÅR0501 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0501);  
         BH65300M.FORSKÅR0601 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0601);  
         BH65300M.FORSKÅR0701 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0701);  
         BH65300M.FORSKÅR0801 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0801);  
         BH65300M.FORSKÅR0901 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0901);  
         BH65300M.FORSKÅR1001 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,1001);  
         BH65300M.FORSKÅR1101 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,1101);  
         BH65300M.FORSKÅR1201 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,1201);  
                                                                        
         BH65300M.FORSKÅR0131 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0131);  
         BH65300M.FORSKÅR0229 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0229);  
         BH65300M.FORSKÅR0331 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0331);  
         BH65300M.FORSKÅR0430 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0430);  
         BH65300M.FORSKÅR0531 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0531);  
         BH65300M.FORSKÅR0630 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0630);  
         BH65300M.FORSKÅR0731 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0731);  
         BH65300M.FORSKÅR0831 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0831);  
         BH65300M.FORSKÅR0930 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,0930);  
         BH65300M.FORSKÅR1031 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,1031);  
         BH65300M.FORSKÅR1130 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,1130);  
         BH65300M.FORSKÅR1231 = OPSÆT_YYYYMMDD(BH65300M.FORSKÅR,1231);  
                                                                        
         BH65300M.HJ_DATO1   = BH65300M.ÅR0101 +                        
                               10000;                /* ÅR0101 + 1 ÅR */
         BH65300M.HJ_DATO2   = BH65300M.ÅR0101 +                        
                               20000;                /* ÅR0101 + 2 ÅR */
                                                                        
                                                                        
                                                                        
 OPSÆT_YYYYMMDD: PROC (YYYY,MMDD) RETURNS (FIXED(9));                   
                                                                        
   DCL YYYY     BIN FIXED (15);                                         
   DCL MMDD     BIN FIXED (15);                                         
   DCL YYYYMMDD FIXED (9);                                              
                                                                        
   /* Regl for skudår*/                                                 
   IF MMDD = 0229                                                       
   THEN                                                                 
     DO;                                                                
       IF MOD(YYYY,4) > 0                                               
       THEN                                                             
         MMDD = 0228;                                                   
     END;                                                               
                                                                        
   YYYYMMDD = 0;                                                        
   YYYYMMDD = (YYYY * 10000) + MMDD;                                    
                                                                        
  /*PUT SKIP LIST('IND YYYY =',YYYY);                                   
    PUT SKIP LIST('IND MMDD =',MMDD);                                   
    PUT SKIP LIST('UD YYYYMMDD =',YYYYMMDD);*/                          
                                                                        
   RETURN (YYYYMMDD);                                                   
                                                                        
 END OPSÆT_YYYYMMDD;                                                    
