 /* CURSOR 3: UDSØGNING PÅ INDKOMSTÅR,KOMMUNENR,CPR NR, EJDNR, EGENNR   
 /*********************************************************************/
 /*        OPEN  CURSOR 3                                             */
 /*********************************************************************/
 OPEN_CUR3: PROC;                                                       
                                                                        
         EXEC SQL OPEN CUR3;                                            
                                                                        
         IF SQLCODE ^= 0                                                
         THEN                                                           
            DO;                                                         
               SQL_RETURKODEPIC    = SQLCODE;                           
               ZS378TEKST = 'OPEN CUR3 - SQLCODE='!!SQL_RETURKODEPIC;   
               CALL ABEND_PROCEDURE;                                    
            END;                                                        
 END OPEN_CUR3;                                                         
 /*********************************************************************/
 /*       CLOSE CURSOR 3                                              */
 /*********************************************************************/
 CLOSE_CUR3: PROC;                                                      
                                                                        
         EXEC SQL CLOSE CUR3;                                           
                                                                        
         IF SQLCODE ^= 0                                                
         THEN                                                           
            DO;                                                         
             SQL_RETURKODEPIC    = SQLCODE;                             
             ZS378TEKST = 'CLOSE CUR3 - SQLCODE='!!SQL_RETURKODEPIC;    
             CALL ABEND_PROCEDURE;                                      
            END;                                                        
 END CLOSE_CUR3;                                                        
 /*******************************************************************/  
 /*    DECLARE  UDSØGNING AF NØGLEFELTER ANVENDES I BH12000 */          
 /*******************************************************************/  
 DECLARE_CUR3: PROC;                                                    
  EXEC SQL DECLARE CUR3 CURSOR FOR                                      
  SELECT                                                                
           BQ007.DCPRN                                                  
          ,BQ007.DINDKAAR                                               
          ,BQ007.EKOMNR                                                 
          ,BQ007.EEJDNR                                                 
          ,BQ007.ELBNR                                                  
          ,BQ007.EGENNR                                                 
   FROM                                                                 
       BQ00700T BQ007, BQ00600T BQ006                                   
   WHERE                                                                
           BQ007.DCPRN =    :CPRTILDB2                                  
       AND BQ007.DINDKAAR = :INPUT.DINDKAAR                             
       AND BQ007.EKOMNR   = :INPUT.EKOMNR                               
       AND BQ007.EEJDNR=    :INPUT.EEJDNR                               
       AND BQ007.EGENNR=    :INPUT.EGENNR                               
       AND BQ007.DINDKAAR=BQ006.DINDKAAR                                
       AND BQ007.EKOMNR=BQ006.EKOMNR                                    
       AND BQ007.EEJDNR=BQ006.EEJDNR                                    
   ORDER BY                                                             
       BQ007.EKOMNR,BQ007.EEJDNR,BQ007.EGENNR;                          
 END DECLARE_CUR3;                                                      
                                                                        
 /*********************************************************************/
 /*        FETCH PERSON NØGLEFELTER         ANVENDES AF BH12000       */
 /*********************************************************************/
 FETCH_CUR3: PROC;                                                      
        EXEC SQL FETCH CUR3                                             
         INTO                                                           
           :EVSPERSON.DCPRN                                             
          ,:EVSPERSON.DINDKAAR                                          
          ,:EVSPERSON.EKOMNR                                            
          ,:EVSPERSON.EEJDNR                                            
          ,:EVSPERSON.ELBNR                                             
          ,:EVSPERSON.EGENNR                                            
          ;                                                             
 END FETCH_CUR3;                                                        
