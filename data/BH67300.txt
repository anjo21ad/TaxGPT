  PROCESS OPT(TIME);                                                    
 BH67300:       /* BEHANDL BEREGNINGSBÅND MED SAMBESKATTEDE EJENDOMME */
         PROC OPTIONS (MAIN) REORDER;                                   
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 1999');       
 /*********************************************************************/
 /*                                                                   */
 /*      FORMÅL       AJOURFØR SAMTAB-OPLYSNINGER PÅ TILSTØDENDE      */
 /*                   GRUND MED DIVERSE DATA FRA MODEREJENDOMMEN.     */
 /*                   DESUDEN TILPASSES OPSÆTNING AF DIVERSE LINIEKO- */
 /*                   DER SÅLEDES AT EN PERSONS SAMLEDE STATUS VEDR.  */
 /*                   SKATNING SAMT FLIN M.V. OVERFØRES TIL EFTERFØL- */
 /*                   GENDE AF SAMME PERSONS INDIVIDER.               */
 /*                                                                   */
 /*      INDDATA      B.H67101D BEREGNINGSBÅND (KUN SAMBESKATTEDE)    */
 /*                                                                   */
 /*      UDDATA       B.H67300D EJENDOMSOPLYSNINGER FOR SAMBESKATTEDE */
 /*                   B.H67301Y KØRSELSKONTROLLISTE                   */
 /*                                                                   */
 /*      PROGRAMMØR   AAGE RASMUSSEN              PFB      JAN 1998   */
 /*                                                                   */
 /*      ÅRSTILRET    AAGE RASMUSSEN              PFB, JULI    1998   */
 /*      ÅRSTILRET    AAGE RASMUSSEN              PFB, JANUAR  2000   */
 /*                                                                   */
 /*********************************************************************/
         DEFAULT RANGE (*) STATIC UNALIGNED CONN;                       
 /*********************************************************************/
 /*                                                                   */
 /*      FILE-DECLARE                                                 */
 /*                                                                   */
 /*********************************************************************/
 DCL     BH671I          FILE RECORD INPUT;                             
 DCL     BH673O          FILE RECORD OUTPUT;                            
 /*********************************************************************/
 /*                                                                   */
 /*      ENTRY-DECLARE                                                */
 /*                                                                   */
 /*********************************************************************/
 DCL     ZS61900         ENTRY OPTIONS (INTER ASM);   /* SSI-DATO     */
 DCL     ZS38100         ENTRY OPTIONS (INTER ASM);   /* TIMESTAMP    */
 /*********************************************************************/
 /*                                                                   */
 /*      STRUCTUR-DECLARE  INPUT                                      */
 /*                                                                   */
 /*********************************************************************/
 DCL     BH601_AR CHAR (4000) VAR;                                      
 DCL     1 BH601 BASED(ADDR(BH601_AR)),                                 
           2 LÆNGDE BIN FIXED (15),                                     
           %INCLUDE BH60100N;                                           
 DCL     1 BH60199,                                                     
           %INCLUDE BH60199N;                                           
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF PRINTLINIER                                       */
 /*                                                                   */
 /*********************************************************************/
 DCL     1 LIN1,                                                        
          2 CTL          CHAR      (1),                                 
          2 TX1          CHAR      (47)      INIT                       
                         ('PROGRAM: BH67300L'),                         
          2 TX2          CHAR      (59)      INIT                       
                         ('BEHANDL BEREGNINGSBÅND MED SAMBESKATTEDE  '),
          2 TX3          CHAR      (14)      INIT                       
                         ('UDSKREVET DEN '),                            
          2 DATO         CHAR      (10),                                
          2 REST         CHAR      (02)      INIT      (' ');           
 DCL     1 LIN2,                                                        
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (54)      INIT      ('  '),          
          2 TX1          CHAR      (20)      INIT                       
                         ('KØRSELSKONTROLLISTE'),                       
          2 REST         CHAR      (58)      INIT      (' ');           
 DCL     1 LIN3,                                                        
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (2)       INIT      (' '),           
          2 TEKST        CHAR      (52),                                
          2 ANT          PIC       'ZZZ.ZZZ.ZZZ',                       
          2 REST         CHAR      (67)      INIT      (' ');           
 DCL     1 LIN_BLANK,                                                   
          2 CTL          CHAR      (1),                                 
          2 F1           CHAR      (132)     INIT      (' ');           
         %INCLUDE ZZ20301M;                                             
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF TÆLLEVÆRKER                                       */
 /*                                                                   */
 /*********************************************************************/
 DCL     TV_LÆS          FIXED     (9)       INIT      (0);             
 DCL     TV_KOM          FIXED     (9)       INIT      (0);             
 DCL     TV_SKRIV        FIXED     (9)       INIT      (0);             
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF BUILTIN                                           */
 /*                                                                   */
 /*********************************************************************/
 DCL     ADDR            BUILTIN;                                       
 DCL     SUBSTR          BUILTIN;                                       
 DCL     PLIDUMP         BUILTIN;                                       
 /*********************************************************************/
 /*                                                                   */
 /*      DECLARE AF DIVERSE FELTER                                    */
 /*                                                                   */
 /*********************************************************************/
 DCL     I               BIN FIXED (15);                                
                                                                        
 DCL     UDDATO          CHAR      (10);                                
                                                                        
 DCL     DATO1           CHAR      (26);                                
                                                                        
 DCL     1 DATO2                              BASED(ADDR(DATO1)),       
           2 ÅR          CHAR      (04),                                
           2 F1          CHAR      (01),                                
           2 MD          CHAR      (02),                                
           2 F2          CHAR      (01),                                
           2 DG          CHAR      (02);                                
                                                                        
 DCL     EOF             BIT       (1);                                 
 DCL     JA              BIT       (1)       INIT ('1'B);               
 DCL     NEJ             BIT       (1)       INIT ('0'B);               
 DCL     BEREGN_OK       BIT       (1);                                 
 DCL     MODEREJD_TYPE   PIC       '9';                                 
                                                                        
                                                                        
 DCL     1 GEM           STATIC,    /* GEM FOR SAMME PERSON           */
         2 DCPRCIR       FIXED (10),/* CPRNR.                         */
         2 FLIN          FIXED (5), /* IALT ANTAL 'FASTE' LINIER      */
         2 FEJD          FIXED (5), /* ANTAL EJEDE EJENDOMME          */
         2 CUDLEJNING    CHAR  (1), /* EJER MINDST EEN UDLEJNINGSEJD. */
         2 CRENERKL      PIC   '9', /* EJER KUN ERKLÆRBARE            */
         2 CLIN16        PIC   '9', /* SLUTLINIE TIL USA              */
         2 FANT_SAM      FIXED (3), /* ANTAL SAMBESKATNINGSNUMRE      */
         2 SAMTAB(25),                                                  
           3 SKOM        FIXED (3), /* SAMBESKATNINGSNUMMER FOR MODER-*/
           3 SEJD        FIXED (7), /* EJENDOMMEN(E)                  */
           3 SKOMPONEN   CHAR  (1), /* KOMPONENTKODE TIL SLS          */
           3 SCERKLÆR    PIC   '9', /* KODE ERKLÆRBAR EJENDOM         */
           3 SCLEJE      CHAR  (1), /* LEJEVÆRDIKODE TIL BEREGNING    */
           3 SCEJEV      CHAR  (1), /* KODE FOR EJ VURDERET           */
           3 SBENYT      CHAR  (2), /* BENYTTELSESKODE                */
           3 SFLEJL      FIXED (5), /* ANTAL LEJLIGHEDER              */
           3 SCOVG1998   FIXED (1), /* KODE FOR OVERGANGSORDNING 1998 */
           3 SGANE       FIXED (5), /* EJERANDEL                      */
           3 SFRADAG     FIXED (9), /* STARTDATO FOR BEREGNING        */
           3 STILDAG     FIXED (9), /* SLUTDATO  FOR BEREGNING        */
           3 ANTMOD      FIXED (3), /* ANTAL MODEJD MED DETTE NUMMER  */
           3 GKOM        FIXED (3), /* EKOMNR+EEJDNR FOR  FØRSTE  BK09*/
           3 GEJD        FIXED (7), /* TIL SAMBESKATN. MED OVENNÆVNTE */
           3 GKOMPONEN   CHAR  (1), /* KOMPONENTKODE TIL SLS          */
           3 GCERKLÆR    PIC   '9', /* KODE ERKLÆRBAR EJENDOM         */
           3 GCLEJE      CHAR  (1), /* LEJEVÆRDIKODE TIL BEREGNING    */
           3 GCEJEV      CHAR  (1), /* KODE FOR EJ VURDERET           */
           3 GEJDVÆR     FIXED (11),/* EJENDOMSVÆRDI                  */
           3 GLEJE       FIXED (11),/* LEJEV. NORMAL                  */
           3 GLEJEFP     FIXED (11),/* LEJEV. FØRTIDSPENS./EFTERL.    */
           3 GLEJE67     FIXED (11),/* LEJEVÆRDI PENSIONIST           */
           3 GOVLEJE     FIXED (11),/* LEJEV. NORMAL                  */
           3 GOVLEJEFP   FIXED (11),/* LEJEV. FØRTIDSPENS./EFTERL.    */
           3 GOVLEJE67   FIXED (11),/* LEJEVÆRDI PENSIONIST           */
           3 GGANE       FIXED (5), /* EJERANDEL                      */
           3 GFRADAG     FIXED (9), /* STARTDATO FOR BEREGNING        */
           3 GTILDAG     FIXED (9), /* SLUTDATO  FOR BEREGNING        */
           3 ANT09       FIXED (3); /* ANTAL BK 09 MED DETTE NUMMER   */
 /*********************************************************************/
 /*                                                                   */
 /*      HOUSE-KEEPING                                                */
 /*                                                                   */
 /*********************************************************************/
         ON ERROR CALL PLIDUMP('SNHOB');                                
         CALL ZS61900;                 /*   UDSKRIVNING AF SSI-DATO   */
         LIN_BLANK.CTL = ZZIK1;                                         
         LIN1.CTL = ZZWS2;                                              
         LIN2.CTL = ZZWS3;                                              
         LIN3.CTL = ZZWS2;                                              
         OPEN FILE (BH671I)  TITLE ('BH67101I');                        
         OPEN FILE (BH673O)  TITLE ('BH67300O');                        
         CALL ZZ20390 ('*OPEN','BH67301Y');                             
         ON ENDFILE (BH671I)                                            
         BEGIN;                                                         
            EOF = JA;                                                   
         END;                                                           
         GEM = '';                                                      
         DO I = 1 TO 25;                                                
            GEM.SAMTAB(I) = '';                                         
         END;                                                           
                                                                        
         CALL ZS38100(DATO1);                                           
         UDDATO = DATO2.DG !! '/' !! DATO2.MD !!                        
                  '-' !! DATO2.ÅR;                                      
         LIN1.DATO = UDDATO;                                            
 /*********************************************************************/
 /*                                                                   */
 /*      PROCES                                                       */
 /*                                                                   */
 /*********************************************************************/
                                                                        
         READ FILE (BH671I) INTO (BH601_AR);                            
                                                                        
         DO WHILE (EOF = NEJ);                                          
            TV_LÆS = TV_LÆS + 1;                                        
            IF BH601.SORT_KOMNR = 999 /* KOMMUNE-INDIVID        */      
            THEN                                                        
               TV_KOM = TV_KOM + 1;                                     
            ELSE                                                        
               DO;                                                      
                  CALL BEHANDL;                                         
                  CALL SKRIV_DATASÆT;                                   
               END;                                                     
                                                                        
            READ FILE (BH671I) INTO (BH601_AR);                         
         END;                                                           
                                                                        
 /*********************************************************************/
 /*                                                                   */
 /*    AFSLUT PROGRAM                                                 */
 /*                                                                   */
 /*********************************************************************/
                                                                        
         CALL DAN_OPT_INDV;                                             
                                                                        
         CALL SKRIV_TOTALER;                                            
                                                                        
         CALL ZZ20300(LIN_BLANK,'99');                                  
                                                                        
         CLOSE FILE (BH671I),                                           
               FILE (BH673O);                                           
                                                                        
 /********************************************************************/ 
 /*                                                                  */ 
 /*      OVERFØR DEN SAMLEDE STATUS FOR PERSONEN VEDR. AFGØRELSE OM  */ 
 /*      ØNSKE OM SAMBESKATNING ER MULIGT AT UDFØRE SAMT DIVERSE OP- */ 
 /*      LYSNINGER TIL BRUG VED STYRING AF UDSKRIVNING AF EJENDOMS-  */ 
 /*      OPLYSNINGER PÅ HENHOLDSVIS PSA, USA, BSA ELLER EJENDOMSSKE- */ 
 /*      MA.                                                         */ 
 /*                                                                  */ 
 /********************************************************************/ 
 BEHANDL:                                                               
 PROC;                                                                  
                                                                        
         IF GEM.DCPRCIR ^= BH601.DCPRCIR                                
         THEN                                                           
            DO;                                                         
               /* NY PERSON SÅ TAG LIGE OG INITIER DIV. TÆLLEVÆRKER */  
               /* M.V. TIL STYRING AF SLUTLINIE-REDIGERING          */  
               GEM = '';                                                
               DO I = 1 TO 25;                                          
                  GEM.SAMTAB(I) = '';                                   
               END;                                                     
               GEM.DCPRCIR    = BH601.DCPRCIR;                          
               GEM.FLIN       = BH601.FLIN;                             
               GEM.FEJD       = BH601.FEJD;                             
               GEM.CUDLEJNING = BH601.CUDLEJNING;                       
               GEM.CRENERKL   = BH601.CRENERKL;                         
               GEM.CLIN16     = BH601.CLIN16;                           
               GEM.FANT_SAM   = BH601.FANT_SAM;                         
               DO I = 1 TO BH601.FANT_SAM;                              
                  GEM.SAMTAB(I) = BH601.SAMTAB(I), BY NAME;             
               END;                                                     
            END;                                                        
                                                                        
         BH601.FLIN       = GEM.FLIN;                                   
         BH601.FEJD       = GEM.FEJD;                                   
         BH601.CUDLEJNING = GEM.CUDLEJNING;                             
         BH601.CRENERKL   = GEM.CRENERKL;                               
         BH601.CLIN16     = GEM.CLIN16;                                 
                                                                        
         /* OVERFØR STATUS VEDR. SAMBESKATNING FRA OPSÆTNINGEN I */     
         /* BH67100 (FRA LAVESTE SEKVNR) TIL AKTUELT INDIVID     */     
                                                                        
         BH601.FANT_SAM = GEM.FANT_SAM;                                 
         DO I = 1 TO GEM.FANT_SAM;                                      
            BH601.SAMTAB(I) = GEM.SAMTAB(I), BY NAME;                   
         END;                                                           
                                                                        
         IF BH601.CSAMBSKAT = '2'                                       
         THEN                                                           
            CALL BEHANDL_MODEREJD;                                      
                                                                        
         IF BH601.CSAMBSKAT = '4'                                       
         THEN                                                           
            CALL BEHANDL_GRUND;                                         
                                                                        
         IF BH601.CSAMBSKAT = '2' !                                     
            BH601.CSAMBSKAT = '4'                                       
         THEN                                                           
            DO;                                                         
               BH601.CERKLÆR = 0;                                       
               BH601.CKOMPONEN = ' ';                                   
               GEM.CRENERKL = 0;                                        
            END;                                                        
                                                                        
         /* OVERFØR EVT. RETTET STATUS TIL AKTUELT INDIVID */           
                                                                        
         BH601.FLIN     = GEM.FLIN;                                     
         BH601.CRENERKL = GEM.CRENERKL;                                 
                                                                        
 END BEHANDL;                                                           
 /*********************************************************************/
 /*                                                                   */
 /*    KONTROLLER MODEREJD-OPLYSNINGER IMOD DEN TILSTØDENDE GRUND     */
 /*                                                                   */
 /*********************************************************************/
 BEHANDL_MODEREJD:                                                      
 PROC;                                                                  
                                                                        
         DO I = 1 TO GEM.FANT_SAM;                                      
            IF (GEM.SAMTAB(I).SKOM = BH601.EKOMNR &                     
                GEM.SAMTAB(I).SEJD = BH601.EEJDNR)                      
            THEN                                                        
               DO;                                                      
                  /* MODEREJD OPSÆTTES VEDR. SAMBESKATNING PÅ */        
                  /* GRUNDLAG AF DEN SAMLEDE STATUS.          */        
                  MODEREJD_TYPE    = 0;                                 
                  IF BH601.CBENYT = '01' & BH601.FLEJL = 1              
                  THEN                                                  
                     MODEREJD_TYPE = 1;                                 
                  ELSE                                                  
                     IF BH601.CBENYT = '08'                             
                     THEN                                               
                        MODEREJD_TYPE = 2;                              
                  IF GEM.SAMTAB(I).GKOMPONEN = '2'  !                   
                     GEM.SAMTAB(I).SKOMPONEN = '2'  !                   
                    (GEM.SAMTAB(I).GKOMPONEN = '3' &                    
                     GEM.SAMTAB(I).SKOMPONEN = '3')                     
                  THEN                                                  
                     DO;                                                
                        /* SÅ SKAL DER IKKE ÆNDRES I DIVERSE */         
                        /* OPSÆTNING FOR MODEREJENDOMMEN OG  */         
                        /* ALTSÅ INGEN SAMBESKATNING MEN IN- */         
                        /* DIVIDET BEREGNES IGEN SOM FØR     */         
                        BH601.CSAMBSKAT  = '9';                         
                     END;                                               
                  ELSE                                                  
                     IF GEM.SAMTAB(I).SCERKLÆR  = 0       !             
                        GEM.SAMTAB(I).GCERKLÆR  = 0       !             
                        GEM.SAMTAB(I).ANTMOD    > 1       !             
                        GEM.SAMTAB(I).ANT09     > 1       !             
                       (BH601.FEJER > 1 & BH601.GANE = 0) !             
                       (GEM.SAMTAB(I).SGANE    ^=                       
                        GEM.SAMTAB(I).GGANE)              !             
                       (GEM.SAMTAB(I).SFRADAG  ^=                       
                        GEM.SAMTAB(I).GFRADAG)            !             
                       (GEM.SAMTAB(I).STILDAG  ^=                       
                        GEM.SAMTAB(I).GTILDAG)            !             
                        GEM.SAMTAB(I).GLEJE     = 0       !             
                       (BH601.COVG_1998 = '2' &                         
                        GEM.SAMTAB(I).GOVLEJE = 0)        !             
                        MODEREJD_TYPE           = 0                     
                     THEN                                               
                        DO;                                             
                           /* ALTSÅ INGEN SAMBESKATNING */              
                           IF MODEREJD_TYPE = 0                         
                           THEN;                                        
                           ELSE                                         
                              DO;                                       
                                 BH601.CLIN09 = 1;                      
                                 GEM.FLIN = GEM.FLIN + 1;               
                              END;                                      
                        END;                                            
                     ELSE                                               
                        DO;                                             
                           IF GEM.SAMTAB(I).SKOMPONEN = '1' &           
                              GEM.SAMTAB(I).GKOMPONEN = '3'             
                           THEN                                         
                              DO;                                       
                                 /* BEGGE BLEV BEREGNET NORMALT */      
                                 BH601.CLIN08 = 1;                      
                                 BH601.CSAMBSKAT = '1';                 
                                 GEM.FLIN = GEM.FLIN + 1;               
                              END;                                      
                           ELSE                                         
                              /* ALTSÅ INGEN SAMBESKATNING */           
                              IF MODEREJD_TYPE = 0                      
                              THEN;                                     
                              ELSE                                      
                                 DO;                                    
                                    BH601.CLIN09 = 1;                   
                                    GEM.FLIN = GEM.FLIN + 1;            
                                 END;                                   
                        END;                                            
                  I = GEM.FANT_SAM;                                     
               END;                                                     
         END;                                                           
                                                                        
 END BEHANDL_MODEREJD;                                                  
 /*********************************************************************/
 /*                                                                   */
 /*    KONTROLLER GRUND-OPLYSNINGER IMOD MODEREJENDOMMEN              */
 /*                                                                   */
 /*********************************************************************/
 BEHANDL_GRUND:                                                         
 PROC;                                                                  
                                                                        
         DO I = 1 TO GEM.FANT_SAM;                                      
            IF (GEM.SAMTAB(I).SKOM = BH601.ESAMBKNR &                   
                GEM.SAMTAB(I).SEJD = BH601.ESAMBENR)                    
            THEN                                                        
               DO;                                                      
                  /* GRUNDEN OPSÆTTES VEDR. SAMBESKATNING PÅ */         
                  /* GRUNDLAG AF DEN SAMLEDE STATUS.         */         
                  BH601.CREDIG7    = '1';                               
                  MODEREJD_TYPE    = 0;                                 
                  IF GEM.SAMTAB(I).SBENYT = '01' &                      
                     GEM.SAMTAB(I).SFLEJL = 1                           
                  THEN                                                  
                     MODEREJD_TYPE = 1;                                 
                  ELSE                                                  
                     IF GEM.SAMTAB(I).SBENYT = '08'                     
                     THEN                                               
                        DO;                                             
                           BH601.CREDIG7 = '2';                         
                           MODEREJD_TYPE = 2;                           
                        END;                                            
                  IF GEM.SAMTAB(I).GKOMPONEN = '2'  !                   
                     GEM.SAMTAB(I).SKOMPONEN = '2'  !                   
                    (GEM.SAMTAB(I).GKOMPONEN = '3' &                    
                     GEM.SAMTAB(I).SKOMPONEN = '3')                     
                  THEN                                                  
                     DO;                                                
                        /* SÅ SKAL DER IKKE ÆNDRES I DIVERSE */         
                        /* OPSÆTNING FOR MODEREJENDOMMEN OG  */         
                        /* ALTSÅ INGEN SAMBESKATNING MEN IN- */         
                        /* DIVIDET BEREGNES IGEN SOM FØR     */         
                        BH601.CSAMBSKAT  = '9';                         
                     END;                                               
                  ELSE                                                  
                     DO;                                                
                        IF GEM.SAMTAB(I).GCERKLÆR  = 0       !          
                           GEM.SAMTAB(I).SCERKLÆR  = 0       !          
                           GEM.SAMTAB(I).ANTMOD    > 1       !          
                           GEM.SAMTAB(I).ANT09     > 1       !          
                          (BH601.FEJER > 1 & BH601.GANE = 0) !          
                          (GEM.SAMTAB(I).SGANE    ^=                    
                           GEM.SAMTAB(I).GGANE)              !          
                          (GEM.SAMTAB(I).SFRADAG  ^=                    
                           GEM.SAMTAB(I).GFRADAG)            !          
                          (GEM.SAMTAB(I).STILDAG  ^=                    
                           GEM.SAMTAB(I).GTILDAG)            !          
                           GEM.SAMTAB(I).GLEJE     = 0       !          
                          ((GEM.SAMTAB(I).SCOVG1998 = 2) &              
                           (BH601.COVG_1998        ^= '2' !             
                            BH601.OVG_1998.BLEJE    = 0   !             
                            BH601.OVG_1998.BLEJEFP  = 0   !             
                            BH601.OVG_1998.BLEJE67  = 0))    !          
                           MODEREJD_TYPE           = 0                  
                        THEN                                            
                           DO;                                          
                              /*INGEN SAMBESKATNING*/                   
                              BH601.CSAMBSKAT = '4';                    
                           END;                                         
                        ELSE                                            
                           IF GEM.SAMTAB(I).SKOMPONEN = '1' &           
                              GEM.SAMTAB(I).GKOMPONEN = '3'             
                           THEN                                         
                              DO;                                       
                                 /* BEGGE BLEV BEREGNET NORMALT */      
                                 BH601.CSAMBSKAT = '3';                 
                                 BH601.CKOMPONEN = '1';                 
                                 BH601.CLIN07    = 1;                   
                                 GEM.FLIN = GEM.FLIN + 1;               
                              END;                                      
                        IF GEM.SAMTAB(I).ANTMOD = 0 ! /*INGEN MODEREJD*/
                           MODEREJD_TYPE        = 0   /*FORKERT BENYT */
                        THEN                                            
                           DO;                                          
                              BH601.CLIN09 = 1;                         
                              GEM.FLIN = GEM.FLIN + 1;                  
                           END;                                         
                     END;                                               
                  I = GEM.FANT_SAM;                                     
               END;                                                     
         END;                                                           
                                                                        
 END BEHANDL_GRUND;                                                     
 /*********************************************************************/
 /*                                                                   */
 /*    SKRIV DATASÆT                                                  */
 /*                                                                   */
 /*********************************************************************/
 SKRIV_DATASÆT:                                                         
 PROC;                                                                  
                                                                        
         WRITE FILE (BH673O) FROM (BH601_AR);                           
         TV_SKRIV = TV_SKRIV + 1;                                       
                                                                        
 END SKRIV_DATASÆT;                                                     
 /*********************************************************************/
 /*      DER DANNES ET SLUTINDIVID TIL BRUG FOR MASKINEL AFSTEMNING   */
 /*********************************************************************/
 DAN_OPT_INDV:                                                          
 PROC;                                                                  
                                                                        
         BH60199          = '';                                         
         BH60199.SORT_KOMNR   = 999;                                    
         BH60199.SORT_EJDNR   = 8888888;                                
         BH60199.SORT_CPR = 99999999999;                                
         BH60199.SORT_CITYP = 9;                                        
         BH60199.SORT_EÆKNR = 999;                                      
         BH60199.ANT_INDV = TV_SKRIV;                                   
         WRITE FILE (BH673O) FROM (BH60199);                            
                                                                        
 END DAN_OPT_INDV;                                                      
 /*********************************************************************/
 /*                                                                   */
 /*          UDSKRIVNING AF TOTALLISTE                                */
 /*                                                                   */
 /*********************************************************************/
 SKRIV_TOTALER:                                                         
 PROC;                                                                  
                                                                        
         CALL ZZ20300(LIN_BLANK,'01');                                  
         CALL ZZ20300(LIN1,'01');                                       
         CALL ZZ20300(LIN2,'01');                                       
         LIN3.TEKST ='ANTAL LÆSTE INDIVIDER PÅ BH67101D BEREGNINGSBÅND';
         LIN3.ANT = TV_LÆS;                                             
         CALL ZZ20300(LIN3,'01');                                       
         LIN3.TEKST = 'ANTAL FRASORTEREDE KOMMUNEHEADERE';              
         LIN3.ANT = TV_KOM;                                             
         CALL ZZ20300(LIN3,'01');                                       
         LIN3.CTL = ZZWS2;                                              
         LIN3.TEKST = 'ANTAL SKREVNE INDIVIDER VEDR. SAMBESKATNING    ';
         LIN3.ANT = TV_SKRIV;                                           
         CALL ZZ20300(LIN3,'01');                                       
                                                                        
 END SKRIV_TOTALER;                                                     
                                                                        
                                                                        
 END BH67300;                                                           
