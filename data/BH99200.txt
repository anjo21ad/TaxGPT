  PROCESS OPT(TIME);                                                    
 BH99200: /* DAN EVSOPDAT PGA EVSGRUND 2001 */                          
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /*********************************************************************/
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA A/S 2001');       
         DEFAULT RANGE (*) STATIC UNALIGNED CONNECTED;                  
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     BH992I FILE RECORD INPUT;                                      
 DCL     BH992O FILE RECORD OUTPUT;                                     
 /********************************************************************* 
 *       DECLARE AF UDTRÆK                                            * 
 *********************************************************************/ 
 DCL     1 BH992_I,                                                     
                              /* GRUNDLEVERING EVS SLUT FRA BH96100L  */
   3 INDVNR         BIN FIXED (15) UNAL, /* KONSTANT = 810            */
   3 INDVLGD        BIN FIXED (15) UNAL, /* KONSTANT = 308            */
   3 FELTLGD        BIN FIXED (15) UNAL, /* KONSTANT = 308            */
   3 HEADER         CHAR (8),            /* KONSTANT = EVSGRUND       */
   3 DINDKAAR       CHAR (4),            /* KONSTANT = 2001           */
   3 DCPRN          PIC '(10)9',         /* PERSONNUMMER              */
   3 EKOMNR_EEJDNR  CHAR(10),            /* KOMMUNE- OG EJENDOMSNR    */
   3 ELBNR          DEC FIXED (3,0),     /* LØBENR - PR EJERPERIODE   */
   3 CSLET          CHAR (1),            /* SLET EJENDOM 1: SLETTET   */
   3 DAFSTAA        CHAR (10),           /* AFSTÅELSESDATO            */
   3 DAFSTAAFOR     CHAR (10),           /* AFSTÅELSESDATO FORSKUD    */
   3 BEJBOL1_I      BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BEJBOL1        DEC FIXED (11,0),    /* EJERBOLIGVÆRDI1-2-FAM.    */
   3 BEJBOL2_I      BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BEJBOL2        DEC FIXED (11,0),    /* EJERBOLIGVÆRDI2-2-FAM.    */
   3 CBENYT         CHAR (2),            /* BENYTTELSE AF EJENDOM     */
   3 BOBHAKOD       CHAR (1),            /* BOBEHANDLINGSKODE         */
   3 EJDBELIG       CHAR (32),           /* BELIGGENHED               */
   3 CENKE          CHAR (1),            /* EFTERLEVENDE ÆGTEFÆLLE    */
   3 CBERGRL        CHAR (1),            /* BEREGNINGSGRUNDLAGSKODE   */
   3 CEJBEVS        CHAR (1),            /* EJENDOM BEREGNES          */
   3 BPROM2         DEC FIXED (13,2),    /* EJENDOMSVÆRDISKAT 30 PROM */
   3 BPROM1         DEC FIXED (13,2),    /* EJENDOMSVÆRDISKAT 10 PROM */
   3 CELØNCOR       CHAR (1),            /* EFTERLØN FRA COR          */
   3 GPCTEJERFOR    DEC FIXED (5,2),     /* EJERANDEL I FORSKUD REL.  */
   3 GPCTEJER_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 GPCTEJER       DEC FIXED (5,2),     /* EJERANDEL I PCT.          */
   3 FDAGERHV       DEC FIXED (3),       /* ANTAL DAGE MED ERHVERV    */
   3 CERHV          CHAR (1),            /* DATAKODE, ERHV. UDLEJNING */
   3 BPENSNEDGL_I   BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BPENSNEDGL     DEC FIXED (13,2),    /* PENS.NEDSLAG, SIDSTE ÅR   */
   3 BEVSGL_I       BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BEVSGL         DEC FIXED (13,2),    /* EJD.VÆRDISKAT SIDSTE ÅR   */
   3 FELT760        CHAR (1),            /* FREDET EJENDOM MV. TIL CSC*/
   3 FELT759        CHAR (1),            /* PENSIONISTNEDSLAG TIL CSC */
   3 BBERGRL_I      BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BBERGRL        DEC FIXED (11,0),    /* BEREGNINGSGRUNDLAGSKODE   */
   3 BSTIBGR        DEC FIXED (13,2),    /* STIGNINGSBEGRÆNSNING      */
   3 BFORSKAT_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BFORSKAT       DEC FIXED (11,0),    /* FORSKUDSSKAT              */
   3 CFORSKAT       CHAR (1),            /* EVS FORSKUD 1:SUM,2:MGL   */
   3 BNEDSL1        DEC FIXED (13,2),    /* 2 PROMILLE NEDSLAG        */
   3 BPENSNED       DEC FIXED (13,2),    /* PENSIONISTNEDSLAG         */
   3 BNEDSL2        DEC FIXED (13,2),    /* 4 PROMILLE NEDSLAG        */
   3 CNULSTIL       CHAR (1),            /* SKATTER NULSTILLES        */
   3 CEJDTYPE       CHAR (1),            /* KODE EJENDOMSTYPE         */
   3 GPCTUDLE       DEC FIXED (5,2),     /* UDLEJET PROCENT           */
   3 CUDLMAN        CHAR (1),            /* DATAKODE,MAN.NEDSL.DEL.   */
   3 BBER2FAM_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BBER2FAM       DEC FIXED (11,0),    /* EJENDOMSVÆRDI 2 FAMILIE   */
   3 FERHVFLER      DEC FIXED (3,0),     /* FLERÅRIG ERHVERV          */
   3 GPCTERHV       DEC FIXED (5,2),     /* FORDELING BOLIG ERHVERV   */
   3 FEJLNR         CHAR (4),            /* FEJLNUMMER                */
   3 CSKPLOMGL      CHAR (1),            /* GL. SKATTEPLIGTS OMGANG   */
   3 DFRAGLD        CHAR (26),           /* GÆLDENDE FRA DATO KMD     */
   3 CNEDSL1        CHAR (2),            /* KODE FOR 2PRM NEDSLAG     */
   3 CBILAG_1       CHAR (1),            /* KØB/SALG FORSKUD EJ REG   */
   3 FLEJL          DEC FIXED (3,0),     /* ANTAL LEJLIGHEDER         */
   3 CSKPLOMF       CHAR (1),            /* OMF. SKATTEPL. VEDR. PENS */
   3 BGRPROM2_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BGRPROM2       DEC FIXED (11,0),    /* BEREGNINGSGRUNDLAG 30 PROM*/
   3 DOVTG          CHAR (10),           /* OVERTAGELSESDATO          */
   3 DOVTGFOR       CHAR (10),           /* OVERTAGELSESDATO FORSKUD  */
   3 CPTYPGL        CHAR (1),            /* KODE PERSONTYPE SIDSTE ÅR */
   3 CPTYPSLUT      CHAR (1),            /* KODE PERSONTYPE I ÅR      */
   3 CSTIBLB        CHAR (2),            /* STIGNINGSBEGR. FORKLAR.   */
   3 FELT750        CHAR (1),            /* STIGNINGSBEGRÆNSNING      */
   3 CDATAFRA       CHAR (1),            /* SYSTEMKILDEKODE           */
   3 CUDLHEL        CHAR (1),            /* DATAKODE, UDLEJE HELE ÅR  */
   3 CUDLDEL        CHAR (1),            /* DATAKODE, UDL. DEL AF BOL.*/
   3 FDAGUDLE       DEC FIXED (3),       /* ANTAL DAGE MED UDLEJNING  */
   3 BGRPROM1_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BGRPROM1       DEC FIXED (11,0);    /* BEREGNINGSGRUNDLAG 10 PROM*/
 DCL     1 BH992_O,                                                     
                   /* OPDATERINGSANMODNING + MQ SVAR. INDPUT FRA CSC. */
   3 INDVNR         BIN FIXED (15) UNAL, /* KONSTANT = 811            */
   3 INDVLGD        BIN FIXED (15) UNAL, /* KONSTANT =                */
   3 FELTLGD        BIN FIXED (15) UNAL, /* KONSTANT =                */
   3 HEADER         CHAR (8),            /* KONSTANT = EVSOPDAT       */
   3 DINDKAAR       CHAR (4),            /* KONSTANT = 2001           */
   3 DCPRN          PIC '(10)9',         /* PERSONNUMMER              */
   3 EKOMNR_EEJDNR  CHAR(10),            /* KOMMUNE- OG EJENDOMSNR    */
   3 ELBNR          DEC FIXED (3,0),     /* LØBENR - PR EJERPERIODE   */
   3 CSLET          CHAR (1),            /* SLET EJENDOM 1: SLETTET   */
   3 DAFSTAA        CHAR (10),           /* AFSTÅELSESDATO            */
   3 BOBHAKOD       CHAR (1),            /* BOBEHANDLINGSKODE         */
   3 CSCREGISTMP    CHAR (26),           /* KONSTANT = BLANKE         */
   3 EJDBELIG       CHAR (32),           /* BELIGGENHED               */
   3 CENKE          CHAR (1),            /* EFTERLEVENDE ÆGTEFÆLLE    */
   3 CEJBEVS        CHAR (1),            /* EJENDOM BEREGNES          */
   3 CELØNCOR       CHAR (1),            /* EFTERLØN FRA COR          */
   3 GPCTEJER_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 GPCTEJER       DEC FIXED (5,2),     /* EJERANDEL I PCT.          */
   3 FDAGERHV       DEC FIXED (3),       /* ANTAL DAGE MED ERHVERV    */
   3 CERHV          CHAR (1),            /* DATAKODE, ERHV. UDLEJNING */
   3 CÆGTOPR        CHAR (1),            /* ÆGTEFÆLLE OPRETTET        */
   3 BPENSNEDGL_I   BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BPENSNEDGL     DEC FIXED (13,2),    /* PENS.NEDSLAG, SIDSTE ÅR   */
   3 BEVSGL_I       BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BEVSGL         DEC FIXED (13,2),    /* EJD.VÆRDISKAT, SIDSTE ÅR  */
   3 FELT760        CHAR (1),            /* FREDET EJENDOM MV. TIL CSC*/
   3 FELT759        CHAR (1),            /* PENSIONISTNEDSLAG TIL CSC */
   3 BBERGRL_I      BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BBERGRL        DEC FIXED (11,0),    /* BEREGNINGSGRUNDLAGSKODE   */
   3 BEVSMAN_I      BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BEVSMAN        DEC FIXED (13,2),    /* MANUEL EJENDOMSVÆRDISKAT  */
   3 CNULSTIL       CHAR (1),            /* SKATTER NULSTILLES        */
   3 CEJDTYPE       CHAR (1),            /* KODE EJENDOMSTYPE         */
   3 GPCTUDLE       DEC FIXED (5,2),     /* EJERANDEL I PCT.          */
   3 BMANNEDSL      DEC FIXED (13,2),    /* MANUEL BLB. DELVIS UDLE   */
   3 BUDLSKC_I      BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BUDLSKC        DEC FIXED (13,2),    /* BETALT UDENL. KREDIT      */
   3 CEKSEMP        CHAR (1),            /* EKSEMPTION                */
   3 BBER2FAM_I     BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BBER2FAM       DEC FIXED (11,0),    /* EJENDOMSVÆRDI 2 FAMILIE   */
   3 FERHVFLER      DEC FIXED (3,0),     /* FLERÅRIG ERHVERV          */
   3 GPCTERHV       DEC FIXED (5,2),     /* %-FORDELING BOLIG-ERHV    */
   3 CNEDSL1        CHAR (2),            /* KODE FOR 2PRM NEDSLAG     */
   3 MYNDNR         CHAR (4),            /* MYNDIGHEDSNUMMER          */
   3 CSKPLOMF       CHAR (1),            /* OMF. SKATTEPL. VEDR. PENS */
   3 DOVTG          CHAR (10),           /* OVERTAGELSESDATO          */
   3 CPTYPGL        CHAR (1),            /* KODE PERSONTYPE SIDSTE ÅR */
   3 CPTYPSLUT      CHAR (1),            /* KODE PERSONTYPE I ÅR      */
   3 PERSKOD        CHAR(15),            /* PERSONKODE                */
   3 FELT750        CHAR (1),            /* STIGNINGSBEGRÆNSNING      */
   3 FUDL100        DEC FIXED (3,0),     /* UDLEJNING ÅRSBASIS        */
   3 CUDLDEL        CHAR (1),            /* DATAKODE, UDL. DEL AF BOL.*/
   3 FDAGUDLE       DEC FIXED (3,0),     /* ANTAL DAGE UDLEJNING.     */
   3 BMANEVSSTI_I   BIN FIXED (15) UNAL, /* SWITCH BETYDENDE NUL      */
   3 BMANEVSSTI     DEC FIXED (13,2),    /* EJD.VÆRDISKAT, SIDSTE ÅR  */
   3 MANPENSSTI     DEC FIXED (13,2);    /* EJD.VÆRDISKAT, SIDSTE ÅR  */
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS61900         ENTRY;                                         
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     EOF_BH992       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
                                                                        
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL ZS61900;                         /* UDSKRIVNING AF SSI */ 
                                                                        
         EOF_BH992 = NEJ;                                               
                                                                        
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
                                                                        
         OPEN FILE (BH992I) TITLE ('BH99200I');                         
         OPEN FILE (BH992O) TITLE ('BH99200O');                         
                                                                        
         ON ENDFILE (BH992I)                                            
            EOF_BH992 = JA;                                             
                                                                        
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         READ FILE (BH992I) INTO (BH992_I);                             
                                                                        
         DO WHILE ( EOF_BH992 = NEJ );                                  
                                                                        
            CALL BEHANDL;                                               
                                                                        
            READ FILE (BH992I) INTO (BH992_I);                          
                                                                        
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
 /********************************************************************* 
 *       OVERFØR DATA FRA EVSOPDAT TIL EVSSUPL                        * 
 *********************************************************************/ 
 BEHANDL:                                                               
 PROC;                                                                  
                                                                        
         BH992_O = '';                                                  
         BH992_O = BH992_I, BY NAME;                                    
         BH992_O.INDVNR = 811;                                          
         BH992_O.INDVLGD = 250;                                         
         BH992_O.FELTLGD = 250;                                         
         BH992_O.HEADER = 'EVSOPDAT';                                   
         BH992_O.BEVSMAN_I = -1;                                        
         BH992_O.BUDLSKC_I = -1;                                        
         WRITE FILE (BH992O) FROM (BH992_O);                            
                                                                        
 END BEHANDL;                                                           
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
 PROC;                                                                  
                                                                        
         CLOSE FILE (BH992I),                                           
               FILE (BH992O);                                           
                                                                        
 END AFSLUT;                                                            
                                                                        
 END  BH99200;                                                          
