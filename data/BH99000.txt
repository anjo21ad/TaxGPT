  PROCESS OPT(TIME);                                                    
 BH99000: /* FIND BRUGTE BELIGGENHEDS-KOMMUNENUMRE JVF. ESR-UDTRÆK */   
         PROCEDURE OPTIONS (MAIN) REORDER;                              
 /*********************************************************************/
         DCL COPYRIGHT   CHAR      (30) STATIC                          
                         INIT ('COPYRIGHT KOMMUNEDATA I/S 2001');       
 /**********************************************************************
 * INPUT  : C.N57040X  ESR-UDTRÆK TIL FORSKUDS-TEST                    *
 *                                                                     *
 * PROGRAMMØR: AAGE RASMUSSEN  AUGUST    2001                          *
 **********************************************************************/
         DEFAULT RANGE (*) STATIC;                                      
 /********************************************************************* 
 *                       DECLARE AF REGISTRE                          * 
 *********************************************************************/ 
 DCL     CN570I FILE RECORD INPUT;                                      
 DCL     SYSPRINT EXTERNAL FILE PRINT;                                  
 /********************************************************************* 
 *       DECLARE AF UDTRÆK                                            * 
 *********************************************************************/ 
 DCL     CN570_AR        CHAR      (4000) VAR;                          
 DCL     1 CN570         BASED     (ADDR(CN570_AR)),                    
      3 LÆNGDE   BIN FIXED   (15),                                      
      %INCLUDE CN57000N;                                                
 /********************************************************************* 
 *       DECLARE AF BUILTIN'S                                         * 
 *********************************************************************/ 
 DCL     PLIDUMP         BUILTIN;                                       
 DCL     ADDR            BUILTIN;                                       
 /********************************************************************* 
 *       DECLARE AF ENTRY'S                                           * 
 *********************************************************************/ 
 DCL     ZS61900         ENTRY;                                         
 /********************************************************************* 
 *               DECLARE AF DIV. HJÆLPEFELTER                         * 
 *********************************************************************/ 
 DCL     PLIXOPT         CHAR      (40)      VAR STATIC                 
 EXTERNAL INIT ('NOTEST(ALL,,;)');                                      
 DCL     EOF_CN570       BIT       (1);                                 
 DCL     JA              BIT       (1)     INIT ('1'B);                 
 DCL     NEJ             BIT       (1)     INIT ('0'B);                 
 DCL     KOMTAB(0:999)   FIXED     (7);                                 
 DCL     I           BIN FIXED    (15);                                 
 /********************************************************************* 
 *       HOUSEKEEPING                                                 * 
 *********************************************************************/ 
         CALL ZS61900;                                                  
         EOF_CN570 = NEJ;                                               
         ON ERROR                                                       
            CALL PLIDUMP ('SNHOB');                                     
         OPEN FILE (CN570I) TITLE ('CN57010I');                         
                                                                        
         ON ENDFILE (CN570I)                                            
            EOF_CN570 = JA;                                             
                                                                        
         DO I = 0 TO 999;                                               
            KOMTAB(I) = 0;                                              
         END;                                                           
 /********************************************************************* 
 *       HOVEDSTYRING                                                 * 
 *********************************************************************/ 
                                                                        
         CALL LÆS_CN570;                                                
                                                                        
         DO WHILE ( EOF_CN570 = NEJ );                                  
                                                                        
            IF CN570.DCPRCIR < 9999999999     /* OPTÆLL.INDV. */        
            THEN                                                        
               CALL BEHANDL;                                            
                                                                        
            CALL LÆS_CN570;                                             
                                                                        
         END;                                                           
                                                                        
         CALL AFSLUT;                                                   
                                                                        
 /********************************************************************* 
 *       LÆS UDTRÆK                                                   * 
 *********************************************************************/ 
 LÆS_CN570:                                                             
         PROC;                                                          
                                                                        
         READ FILE (CN570I) INTO (CN570_AR);                            
                                                                        
 END LÆS_CN570;                                                         
 /********************************************************************* 
 *********************************************************************/ 
 BEHANDL:                                                               
 PROC;                                                                  
                                                                        
        KOMTAB(CN570.EKOMNR) = KOMTAB(CN570.EKOMNR) + 1;                
                                                                        
 END BEHANDL;                                                           
 /********************************************************************* 
 *       AFSLUT PROGRAM                                               * 
 *********************************************************************/ 
 AFSLUT:                                                                
 PROC;                                                                  
         DO I = 0 TO 999;                                               
            IF KOMTAB(I) > 0                                            
            THEN                                                        
               PUT SKIP LIST (I);                                       
         END;                                                           
         CLOSE FILE (CN570I);                                           
 END AFSLUT;                                                            
 END  BH99000;                                                          
