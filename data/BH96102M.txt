 /*********************************************************************/
 /*      DANNE DATA TIL SLUT CSC                                      */
 /*   SLUT08    BO SCHMIDT                                19/11-2008  */
 /*             TILRETTET SLUT 2008                                   */
 /*********************************************************************/
 /*   SLUT09    GERD HOLM-PEDERSEN                        09/10-2009  */
 /*             TILRETTET SLUT 2009 SAMT                              */
 /*             KRAV 18-02-01: OPSÆTNING AF BEREGNINGSGRL. FOR UDL. EJ*/
 /*             HVOR FELT 614 (BBERGRL_015ANV) NU SKAL ANVENDES BÅDE  */
 /*             TIL DANSKE OG UDENLANDSKE EJENDOMME                   */
 /*             KRAV 18-03-03: NEDTAGNING AF FELT 158=7               */
 /*                            FUDL100 OPSÆTTES HVIS 158 ER NEDTAGET  */
 /*********************************************************************/
 /*   SLUT10    GERD HOLM-PEDERSEN                        05/10-2010  */
 /*             TILRETTET SLUT 2010                                   */
 /*********************************************************************/
 /*   SLUT11    GERD HOLM-PEDERSEN                        18/10-2011  */
 /*             TILRETTET SLUT 2011 SAMT                              */
 /*             KRAV 18-05:    OPSÆTNING AF BEREGNINGSGRL. FOR UDL. EJ*/
 /*             HVOR FELT 615,616,,21,622 OG 626 OVERFØRES SOM 614    */
 /*             FELT 616 OG 626 SKAL IKKE OVERFØRES.                  */
 /*             ER DERFOR SLETTEDE.                                   */
 /*   SLUT12    LARS KAAE HARRITSHØJ                      SEP. 2012   */
 /*             TILRETTET SLUT 2012                                   */
 /*   SLUT13    JØRGEN SAUGMANN                           OKT. 2013   */
 /*             TILRETTET SLUT 2013                                   */
 /*   SLUT14    Esben BRodersen                           NOV. 2014   */
 /*             TILRETTET SLUT 2014                                   */
 /*   SLUT15    JNK : TILRETTET til SLUT-15               NOV. 2015   */
 /*   SLUT15    ESBEN BRODERSEN                                       */
 /*             ÅRSTAL TAGES FRA BH65300M #01                         */
 /*   SLUT16    ESBEN BRODERSEN                           JUN  2016   */
 /*             RETTELSE TIL DEFECT 158 FRA SLUT 2015                 */
 /*   SLUT16    ÆNDRING I HÅNDTERING AF  SPECIELLE        OKT 2016    */
 /*             LANDBRUGSOPLYSNINGER CEJDTYPE = '9' QEB  #01          */
 /*             NYE FELTER: BLANDVÆR_015ANV, BLANDVÆR_02ANV,          */
 /*                         BLANDVÆR_AKT                              */
 /*             UDGÅEDE FELTER: BPROM2, BPROM1, BSTIBEGR, BNEDSL1,    */
 /*             BPENSNED, BNEDSL2, BGRPROM2, CSTIBLB, BGRPROM1        */
 /*   SLUT17    ESBEN BRODERSEN                           OKT 2017    */
 /*             UDGÅEDE FELTER: CSCREGISTMP, BGLSUM1, CNULSTIL        */
 /*********************************************************************/
 DAN_DATA_TIL_SLUT:                                                     
 PROC;                                                                  
                                                                        
      BH961            =  '';                                           
      BH961.INDVNR     = 810;                                           
      BH961.INDVLGD    = 472;                                           
      BH961.FELTLGD    = 472;                                           
      BH961.HEADER     = 'EVSGRUND';                                    
      BH961.DINDKAAR   = BH65300M.INDKÅR1;                  /*#01*/     
      BH961.DCPRN      = BH960.SORT_CPR;                                
      BH961.EKOMNR     = BH960.SORT_KOMNR;                              
      BH961.EEJDNR     = BH960.SORT_EJDNR;                              
      BH961.ELBNR      = BH960.UDSKRLBNR;                               
      BH961.CSLET      = '';                                            
      BH961.CLANDEKODE = BH960.EJENDOM.CLANDEKODE;                      
      BH961.CSKPLOMF   = BH960.TIL_EVS.CSKPLOMF;                        
      BH961.CEJBEVS    = BH960.TIL_EVS.CEJBEVS;                         
      BH961.BOBEHAKOD  = ' ';                                           
      BH961.MANPENSSTI_I = -1;                                          
      BH961.MANPENSSTI = 0;                                             
      IF BH961.EKOMNR = 999                                             
      THEN                                                              
        DO;                                                             
          BH961.BBERGRL_015ANV_I  = BH960.EJERSKAB.UDL_614_SW;          
          BH961.BBERGRL_015ANV    = BH960.EJERSKAB.UDL_614;             
          BH961.BBERGRL_02ANV_I   = BH960.EJERSKAB.UDL_615_SW;          
          BH961.BBERGRL_02ANV     = BH960.EJERSKAB.UDL_615;             
          BH961.BBERGRL_AKT_I     = -1;                                 
          BH961.BBERGRL_AKT       = 0;                                  
                                                                        
          BH961.BBER2FAM_015ANV_I = BH960.EJERSKAB.UDL_621_SW;          
          BH961.BBER2FAM_015ANV   = BH960.EJERSKAB.UDL_621;             
          BH961.BBER2FAM_02ANV_I  = BH960.EJERSKAB.UDL_622_SW;          
          BH961.BBER2FAM_02ANV    = BH960.EJERSKAB.UDL_622;             
          BH961.BBER2FAM_AKT_I    = -1;                                 
          BH961.BBER2FAM_AKT      = 0;                                  
        END;                                                            
      ELSE                                                              
        DO;                                                             
          BH961.BBERGRL_015ANV_I = BH960.VURD_015ANV.BBERGRL_015ANV_SW; 
          BH961.BBERGRL_015ANV   = BH960.VURD_015ANV.BBERGRL_015ANV;    
          BH961.BBERGRL_02ANV_I  = BH960.VURD_02ANV.BBERGRL_02ANV_SW;   
          BH961.BBERGRL_02ANV    = BH960.VURD_02ANV.BBERGRL_02ANV;      
          BH961.BBERGRL_AKT_I    = BH960.VURD_AKT.BBERGRL_AKT_SW;       
          BH961.BBERGRL_AKT      = BH960.VURD_AKT.BBERGRL_AKT;          
                                                                        
          BH961.BBER2FAM_015ANV_I =                                     
                                BH960.VURD_015ANV.BBER2FAM_015ANV_SW;   
          BH961.BBER2FAM_015ANV   =                                     
                                BH960.VURD_015ANV.BBER2FAM_015ANV;      
          BH961.BBER2FAM_02ANV_I  =                                     
                                BH960.VURD_02ANV.BBER2FAM_02ANV_SW;     
          BH961.BBER2FAM_02ANV    = BH960.VURD_02ANV.BBER2FAM_02ANV;    
          BH961.BBER2FAM_AKT_I    = BH960.VURD_AKT.BBER2FAM_AKT_SW;     
          BH961.BBER2FAM_AKT      = BH960.VURD_AKT.BBER2FAM_AKT;        
        END;                                                            
                                                                        
      BH961.EJDBELIG = BH960.EJENDOM.EJDBELIG;                          
                                                                        
      /* Rettelse til defect 154 fra slut 2015 QEB */                   
      IF BH960.EJERSKAB.CEJDTYPE_AKT > '0'                              
      THEN                                                              
        BH961.CEJDTYPE = BH960.EJERSKAB.CEJDTYPE_AKT;                   
      ELSE                                                              
        BH961.CEJDTYPE = BH960.EJENDOM.CEJDTYPE;                        
                                                                        
      BH961.CÆGTOPR  = BH960.TIL_EVS.CÆGTOPR;                           
      IF BH960.TIL_EVS.DOVTG > 0                                        
      THEN                                                              
         BH961.DOVTG = FIX09_TIL_DB2_DATO(BH960.TIL_EVS.DOVTG);         
      ELSE                                                              
         BH961.DOVTG = (10)' ';                                         
      IF BH960.TIL_EVS.DAFSTAA > BH960.MT.DRGNÅRTIL                     
      THEN                                                              
         BH961.DAFSTAA = '';                                            
      ELSE                                                              
         IF BH960.TIL_EVS.DAFSTAA > 0                                   
         THEN                                                           
            BH961.DAFSTAA =                                             
            FIX09_TIL_DB2_DATO(BH960.TIL_EVS.DAFSTAA);                  
         ELSE                                                           
            BH961.DAFSTAA = (10)' ';                                    
      BH961.GPCTEJER_I = BH960.TIL_EVS.GPCTEJER_SW;                     
      IF BH960.TIL_EVS.GPCTEJER_SW = 0                                  
      THEN                                                              
         BH961.GPCTEJER = BH960.TIL_EVS.GPCTEJER;                       
      BH961.FDAGUDLE  = 0;                                              
      BH961.GPCTUDLE  = 0;                                              
                                                                        
      BH961.FUDL100 = BH960.TIL_EVS.FUDL100;                            
                                                                        
      BH961.GPCTERHV  = 0;                                              
      BH961.FDAGERHV  = 0;                                              
      BH961.FERHVFLER = BH960.TIL_EVS.FERHVFLER;                        
      BH961.CENKE     = BH960.TIL_EVS.CENKE;                            
      BH961.CPTYPSLUT = BH960.TIL_EVS.CPTYPSLUT;                        
      BH961.CPTYPGL   = BH960.TIL_EVS.CPTYPGL;                          
      BH961.FELT759   = BH960.TIL_EVS.FELT759;                          
      BH961.FELT760   = BH960.TIL_EVS.CFRED;                            
      BH961.BEVSGL_I  = BH960.TIL_EVS.BEVSGL_SW;                        
      BH961.BEVSGL    = BH960.TIL_EVS.BEVSGL;                           
      BH961.BPENSNEDGL_I = BH960.TIL_EVS.BPENSNEDGL_SW;                 
      BH961.BPENSNEDGL = BH960.TIL_EVS.BPENSNEDGL;                      
                                                                        
      IF BH960.TIL_EVS.DINDFLYT > 0                                     
      THEN                                                              
         BH961.DINDFLYT =                                               
         FIX09_TIL_DB2_DATO(BH960.TIL_EVS.DINDFLYT);                    
                                                                        
      IF BH960.TIL_EVS.DFRAFLYT > 0                                     
      THEN                                                              
         BH961.DFRAFLYT =                                               
         FIX09_TIL_DB2_DATO(BH960.TIL_EVS.DFRAFLYT);                    
                                                                        
      BH961.FUBEBOELIG = 0;                                             
      BH961.BFASTSTIGBGR_I = BH960.TIL_EVS.BFASTSTIGBGR_SW;             
      BH961.BFASTSTIGBGR   = BH960.TIL_EVS.BFASTSTIGBGR;                
      BH961.CINDFLYT       = '';                                        
      BH961.CBERGRGLOP     = BH960.EJERSKAB.CBERGRGLOP;                 
      BH961.BMANEVSSTI_I   = -1;                                        
      BH961.BMANEVSSTI     = 0;;                                        
      BH961.BEVSMAN_I      = -1;                                        
      BH961.BEVSMAN        = 0;;                                        
      BH961.BMANNEDSL_I    = -1;                                        
      BH961.BMANNEDSL      = 0;;                                        
      BH961.CEKSEMP        = BH960.TIL_EVS.CEKSEMP;                     
      BH961.MANNEDSLSTI_I  = -1;                                        
      BH961.MANNEDSLSTI    = 0;;                                        
      BH961.BUDLSKC_I      = -1;                                        
      BH961.BUDLSKC        = 0;;                                        
      BH961.BEJBOL1_AKT_I  = BH960.VURD_AKT.BEJBOL1_AKT_SW;             
      BH961.BEJBOL1_AKT    = BH960.VURD_AKT.BEJBOL1_AKT;                
      BH961.BEJBOL2_AKT_I  = BH960.VURD_AKT.BEJBOL2_AKT_SW;             
      BH961.BEJBOL2_AKT    = BH960.VURD_AKT.BEJBOL2_AKT;                
      BH961.DAFSTAAFOR     = BH960.TIL_EVS.DAFSTAAFOR;                  
      BH961.BEJBOL1_02ANV_I = BH960.VURD_02ANV.BEJBOL1_02ANV_SW;        
      BH961.BEJBOL1_02ANV  = BH960.VURD_02ANV.BEJBOL1_02ANV;            
      BH961.BEJBOL2_02ANV_I = BH960.VURD_02ANV.BEJBOL2_02ANV_SW;        
      BH961.BEJBOL2_02ANV  = BH960.VURD_02ANV.BEJBOL2_02ANV;            
      BH961.CBENYT      = BH960.EJENDOM.CBENYT;                         
      BH961.CBERGRL     = BH960.EJENDOM.CBERGRL;                        
      BH961.CELØNCOR    = BH960.TIL_EVS.CELØNCOR;                       
      BH961.GPCTEJERFOR = BH960.TIL_EVS.GPCTEJERFOR;                    
      BH961.CERHV       = BH960.TIL_EVS.CERHV;                          
      BH961.CVURDOPR    = BH960.AKT_VURD.CVURDOPR;                      
      BH961.COMBYG      = BH960.EJENDOM.COMBYG;                         
                                                                        
                                                                        
      /* 3 Nye felter slut 2016 til overførsel af landbrugs opl #01*/   
      IF BH961.CEJDTYPE = '9' &                                         
         BH961.EKOMNR ^= 999                                            
      THEN                                                              
        DO;                                                             
          BH961.BLANDVÆR_015ANV_I =                                     
                          BH960.VURD_015ANV.BEJDVÆR_015ANV_SW;          
          BH961.BLANDVÆR_015ANV   = BH960.VURD_015ANV.BEJDVÆR_015ANV;   
          BH961.BLANDVÆR_02ANV_I =                                      
                          BH960.VURD_02ANV.BEJDVÆR_02ANV_SW;            
          BH961.BLANDVÆR_02ANV  = BH960.VURD_02ANV.BEJDVÆR_02ANV;       
          BH961.BLANDVÆR_AKT_I    = BH960.VURD_AKT.BEJDVÆR_AKT_SW;      
          BH961.BLANDVÆR_AKT      = BH960.VURD_AKT.BEJDVÆR_AKT;         
        END;                                                            
      ELSE                                                              
        DO;                                                             
          BH961.BLANDVÆR_015ANV_I = -1;                                 
          BH961.BLANDVÆR_015ANV   = 0;                                  
          BH961.BLANDVÆR_02ANV_I  = -1;                                 
          BH961.BLANDVÆR_02ANV    = 0;                                  
          BH961.BLANDVÆR_AKT_I    = -1;                                 
          BH961.BLANDVÆR_AKT      = 0;                                  
        END;                                                            
                                                                        
                                                                        
      BH961.BBERGRL_I  = BH960.EJERSKAB.BBERGRL_SW;                     
      BH961.BBERGRL    = BH960.EJERSKAB.BBERGRL;                        
      BH961.CBERGROP   = BH960.EJERSKAB.CBERGROP;                       
      BH961.BFORSKAT_I = BH960.TIL_EVS.BFORSKAT_SW;                     
      BH961.BFORSKAT   = BH960.TIL_EVS.BFORSKAT;                        
      BH961.CFORSKAT   = BH960.TIL_EVS.CFORSKAT;                        
      BH961.CUDLMAN    = BH960.TIL_EVS.CUDLMAN;                         
      BH961.BBER2FAM_I = BH960.EJERSKAB.BBER2FAM_SW;                    
      BH961.BBER2FAM   = BH960.EJERSKAB.BBER2FAM;                       
      IF BH960.FEJLNR > 0                                               
      THEN                                                              
         DO;                                                            
            HJ_FEJLNR = BH960.FEJLNR;                                   
            BH961.FEJLNR = HJ_FEJLNR;                                   
         END;                                                           
      ELSE                                                              
         BH961.FEJLNR = ' ';                                            
      BH961.BEJBOL1_015ANV_I =                                          
                    BH960.VURD_015ANV.BEJBOL1_015ANV_SW;                
      BH961.BEJBOL1_015ANV   =                                          
                    BH960.VURD_015ANV.BEJBOL1_015ANV;                   
      BH961.BEJBOL2_015ANV_I =                                          
                    BH960.VURD_015ANV.BEJBOL2_015ANV_SW;                
      BH961.BEJBOL2_015ANV   =                                          
                    BH960.VURD_015ANV.BEJBOL2_015ANV;                   
                                                                        
      IF BH960.TIL_EVS.EKOMNR_GL > 0                                    
      THEN                                                              
         DO;                                                            
            HJ_PIC3 = BH960.TIL_EVS.EKOMNR_GL;                          
            BH961.EKOMNR_GL = HJ_CHAR3;                                 
            HJ_PIC7 = BH960.TIL_EVS.EEJDNR_GL;                          
            BH961.EEJDNR_GL = HJ_PIC7;                                  
         END;                                                           
      ELSE                                                              
         DO;                                                            
            BH961.EKOMNR_GL = '   ';                                    
            BH961.EEJDNR_GL = (7)' ';                                   
         END;                                                           
                                                                        
      BH961.CSKPLOMFGL = BH960.TIL_EVS.CSKPLOMFGL;                      
      BH961.DFRAGLD    = DATO2.ÅR !! '-' !! DATO2.MD !! '-' !!          
                         DATO2.DG !! '-01.01.01.000001';                
      BH961.CNEDSL1  = BH960.TIL_EVS.CNEDSL1;                           
      BH961.FLEJL    = BH960.VURD_AKT.FLEJL_AKT;                        
      BH961.DOVTGFOR = BH960.TIL_EVS.DOVTGFOR;                          
      BH961.CDATAFRA = BH960.TIL_EVS.CDATAFRA;                          
      BH961.CUDLHEL  = BH960.TIL_EVS.CUDLHEL;                           
      BH961.CUDLDEL  = BH960.TIL_EVS.CUDLDEL;                           
                                                                        
      BH961.BEJDVPUSKTP_I = -1;                                         
      BH961.BEJDVPUSKTP   = 0;                                          
      BH961.BEJDVÆPUSKP_I = -1;                                         
      BH961.BEJDVÆPUSKP   = 0;                                          
                                                                        
      TV.SKREVET = TV.SKREVET + 1;                                      
                                                                        
      WRITE FILE (BH961O) FROM (BH961);                                 
                                                                        
 END DAN_DATA_TIL_SLUT;                                                 
