 /*********************************************************************/
 /* Indlæsning/Opdatering af tabeller i forbindelse med beregning af  */
 /* GS Indefrysningslån og Pensionistlån.                             */
 /*                                                                   */
 /* Tabeller: BS03600T - GS Grundlag Ejerforhold                      */
 /*           BS04100T - GS Resultat Ejerrelation                     */
 /*           BS04200T - GS Resultat Ejerforhold                      */
 /*           BS04300T - GS Grundlag Sammenligningsår                 */
 /*           BS04400T - GS Grundlag Sammenligningsår aktuelt         */
 /*           BS04600T - Indefrysningsvalg                            */
 /*           BE65000T - ESR Oplysninger                              */
 /*           BE64000T - GS baggrundstabel                            */
 /*                                                                   */
 /* Forskud 2024: BF17 Tina Carstens    Juli  2022                    */
 /*                                                                   */
 /* Forskud 2025: BF17 LAC  Juli  2022                                */
 /*              Tilføjet opslag på BE64000Tvedr. indefrysning tilsagn*/
 /*              og P-lån                                             */
 /*                                                                   */
 /*********************************************************************/
 /*********************************************************************/
 /*      DECLARE AF CURSORS                                           */
 /*********************************************************************/
                                                                        
         /* Hent GS Grundlag - Ejerforhold                            */
         /* Indikatorvariable er  i BS036_SW                          */
         EXEC SQL DECLARE GS_EJERFORHOLD_CUR CURSOR WITH HOLD FOR       
                  SELECT BS036.DINDKAAR,                                
                         BS036.PERSONNUMMER,                            
                         BS036.EKOMNR,                                  
                         BS036.EEJDNR,                                  
                         BS036.EPLBNR,                                  
                         BS036.DFRAGLD,                                 
                         BS036.GSBEREGNTID,                             
                         BS036.FEJLKODE,                                
                         BS036.FEJLTEKST,                               
                         BS036.DTILGLD,                                 
                         BS036.EJERANDEL,                               
                         BS036.EP_EJERSTARTDATO,                        
                         BS036.EP_EJERSLUTDATO,                         
                         BS036.EP_ANTALDAGE,                            
                         BS036.EGS_OPKRPSKAT3112,                       
                         BS036.EGS_BELØB,                               
                         BS036.EGS_RABATBELØB,                          
                         BS036.EGS_BELØBEFTERRABAT,                     
                         BS036.OPRET_AF,                                
                         BS036.OPRET_TS                                 
                    FROM BS03600T BS036                                 
                   WHERE BS036.DINDKAAR  = :WS_TIL_EVS_AAR              
                     AND BS036.DTILGLD   = '9999-12-31-23.59.59.999999' 
                  ORDER BY BS036.DINDKAAR, BS036.EKOMNR, BS036.EEJDNR,  
                           BS036.PERSONNUMMER, BS036.EPLBNR;            
                                                                        
 /*********************************************************************/
 /*      FETCH CURSOR TIL LÆS AF GS EJERFORHOLD                       */
 /*********************************************************************/
 FETCH_GS_EJERFORHOLD: PROC;                                            
                                                                        
         GS_EJERFORH_FUNDET = '0'B;                                     
         DCLBS03600T        = '';                                       
                                                                        
         /* Indikatorvariable er i BS036_SW                          */ 
                                                                        
         EXEC SQL FETCH GS_EJERFORHOLD_CUR INTO                         
                         :DCLBS03600T.DINDKAAR,                         
                         :DCLBS03600T.PERSONNUMMER,                     
                         :DCLBS03600T.EKOMNR,                           
                         :DCLBS03600T.EEJDNR,                           
                         :DCLBS03600T.EPLBNR,                           
                         :DCLBS03600T.DFRAGLD,                          
                         :DCLBS03600T.GSBEREGNTID,                      
                         :DCLBS03600T.FEJLKODE:BS036_SW.FEJLKODE_SW,    
                         :DCLBS03600T.FEJLTEKST:BS036_SW.FEJLTEKST_SW,  
                         :DCLBS03600T.DTILGLD,                          
                         :DCLBS03600T.EJERANDEL:BS036_SW.EJERANDEL_SW,  
                         :DCLBS03600T.EP_EJERSTARTDATO,                 
                         :DCLBS03600T.EP_EJERSLUTDATO                   
                                          :BS036_SW.EP_EJERSLUTDATO_SW, 
                         :DCLBS03600T.EP_ANTALDAGE,                     
                         :DCLBS03600T.EGS_OPKRPSKAT3112,                
                         :DCLBS03600T.EGS_BELØB,                        
                         :DCLBS03600T.EGS_RABATBELØB                    
                                         :BS036_SW.EGS_RABATBELØB_SW,   
                         :DCLBS03600T.EGS_BELØBEFTERRABAT,              
                         :DCLBS03600T.OPRET_AF,                         
                         :DCLBS03600T.OPRET_TS;                         
                                                                        
         SELECT (SQLCA.SQLCODE);                                        
           WHEN (0) DO;                                                 
              GS_EJERFORH_FUNDET   = '1'B;                              
              TV.LÆST_GSGR_EJERFH  = TV.LÆST_GSGR_EJERFH + 1;           
              END;                                                      
           WHEN (100) DO;                                               
              GS_EJERFORH_FUNDET = '0'B;                                
              END;                                                      
           OTHERWISE DO;                                                
              ABENDTXT = '101 FETCH GS_EJERFORHOLD_CUR BS03600T';       
              CALL SQL_FEJL;                                            
              END;                                                      
         END; /* SELECT*/                                               
                                                                        
                                                                        
 END FETCH_GS_EJERFORHOLD;                                              
 /*********************************************************************/
 /*      OPEN CURSOR TIL LÆS AF EGS EJERFORHOLD                       */
 /*********************************************************************/
 OPEN_GS_EJERFORHOLD:  PROC;                                            
                                                                        
         EXEC SQL OPEN GS_EJERFORHOLD_CUR;                              
                                                                        
         IF SQLCODE ^= 0                                                
         THEN DO;                                                       
            ABENDTXT = '101 OPEN GS_EJERFORHOLD_CUR BS03600T';          
            CALL SQL_FEJL;                                              
            END;                                                        
                                                                        
 END OPEN_GS_EJERFORHOLD;                                               
 /*********************************************************************/
 /*      CURSOR TIL LÆS AF GS EJERFORHOLD                             */
 /*********************************************************************/
 CLOSE_GS_EJERFORHOLD: PROC;                                            
                                                                        
         EXEC SQL CLOSE GS_EJERFORHOLD_CUR;                             
                                                                        
 END CLOSE_GS_EJERFORHOLD;                                              
 /*********************************************************************/
 /*      SELECT INDEFRYSNINGSVALG m.m.     (BE64000T)  LAC 2023       */
 /*********************************************************************/
 SELECT_GS_OPLYSNINGER:    PROC;                                        
                                                                        
         GS_IFRVALG_FUNDET        = '0'B;                               
         GS_PL_BEVILG_FUNDET      = '0'B;                               
                                                                        
         DCLBE64000T               = '';                                
         DCLBE64000T.TIL_EVS_AAR   = WS_TIL_EVS_AAR;                    
         DCLBE64000T.AFVIKLINGS_ID = WS_FORSKUD_SLUT_TXT;               
         DCLBE64000T.DATA_ID       = WS_DATA_ID;                        
   /*      DCLBE64000T.KØRSELS_ID    = 'ESR1';       */                 
         DCLBE64000T.DCPRN         = DCLBS03600T.PERSONNUMMER;          
         DCLBE64000T.EKOMNR        = DCLBS03600T.EKOMNR;                
         DCLBE64000T.EEJDNR        = DCLBS03600T.EEJDNR;                
                                                                        
         EXEC SQL SELECT *                                              
                     /*    BE640.DCPRN                                  
                         ,BE640.EKOMNR                                  
                         ,BE640.EEJDNR                                  
                         ,BE640.OPRET_TS                                
                         ,BE640.CINDEFRYS_VALG                          
                         ,BE640.DATO_CINDEFRYS_VALG                     
                         ,BE640.CPLÅN_TILSAGN                           
                         ,BE640.DATO_CPLÅN_TILSAGN                      
                       */                                               
                    INTO  :DCLBE64000T                                  
                    /*   :DCLBE64000T.DCPRN                             
                        ,:DCLBE64000T.EKOMNR                            
                        ,:DCLBE64000T.EEJDNR                            
                        ,:DCLBE64000T.OPRET_TS                          
                        ,:DCLBE64000T.CINDEFRYS_VALG                    
                        ,:DCLBE64000T.DATO_CINDEFRYS_VALG               
                        ,:DCLBE64000T.CPLÅN_TILSAGN                     
                        ,:DCLBE64000T.DATO_CPLÅN_TILSAGN                
                         */                                             
                    FROM BE64000T BE640                                 
                   WHERE BE640.TIL_EVS_AAR  = :DCLBE64000T.TIL_EVS_AAR  
                     and BE640.AFVIKLINGS_ID= :DCLBE64000T.AFVIKLINGS_ID
                     and BE640.DATA_ID      = :DCLBE64000T.DATA_ID      
                     AND BE640.DCPRN        = :DCLBE64000T.DCPRN        
                     AND BE640.EKOMNR       = :DCLBE64000T.EKOMNR       
                     AND BE640.EEJDNR       = :DCLBE64000T.EEJDNR       
                  ORDER BY BE640.DCPRN                                  
                  ;                                                     
                                                                        
         IF SQLCODE = 0                                                 
         THEN DO;                                                       
              GS_IFRVALG_FUNDET   = '1'B;                               
              GS_PL_BEVILG_FUNDET = '1'B;                               
              END;                                                      
          ELSE DO;                                                      
               IF SQLCODE = 100                                         
               THEN DO;                                                 
                    GS_IFRVALG_FUNDET   = '0'B;                         
                    GS_PL_BEVILG_FUNDET = '0'B;                         
                    END;                                                
                ELSE DO;                                                
                     ABENDTXT = '101 LÆS GS oplysninger BE64000T';      
                     CALL SQL_FEJL;                                     
                     END;                                               
                END;                                                    
                                                                        
                                                                        
 END SELECT_GS_OPLYSNINGER;                                             
                                                                        
 /*********************************************************************/
 /*      SELECT INDEFRYSNINGSVALG          (BS04600T)                 */
 /*********************************************************************/
 SELECT_INDEFRYSNINGSVALG:      PROC;                                   
                                                                        
         /* Hent Indefrysningsvalg                                    */
         GS_IFRVALG_FUNDET        = '0'B;                               
         DCLBS04600T              = '';                                 
                                                                        
         DCLBS04600T.PERSONNUMMER = DCLBS03600T.PERSONNUMMER;           
         DCLBS04600T.EKOMNR       = DCLBS03600T.EKOMNR;                 
         DCLBS04600T.EEJDNR       = DCLBS03600T.EEJDNR;                 
                                                                        
         EXEC SQL SELECT  BS046.PERSONNUMMER                            
                         ,BS046.EKOMNR                                  
                         ,BS046.EEJDNR                                  
                         ,BS046.CSTATUS                                 
                         ,BS046.CINDEFRYS_VALG                          
                         ,BS046.DATO_CINDEFRYS_VALG                     
                         ,BS046.OPRET_TS                                
                    INTO :DCLBS04600T.PERSONNUMMER                      
                        ,:DCLBS04600T.EKOMNR                            
                        ,:DCLBS04600T.EEJDNR                            
                        ,:DCLBS04600T.CSTATUS                           
                        ,:DCLBS04600T.CINDEFRYS_VALG                    
                        ,:DCLBS04600T.DATO_CINDEFRYS_VALG               
                        ,:DCLBS04600T.OPRET_TS                          
                    FROM BS04600T BS046                                 
                   WHERE BS046.PERSONNUMMER = :DCLBS04600T.PERSONNUMMER 
                     AND BS046.EKOMNR       = :DCLBS04600T.EKOMNR       
                     AND BS046.EEJDNR       = :DCLBS04600T.EEJDNR       
                  ORDER BY BS046.OPRET_TS DESC                          
                  FETCH FIRST 1 ROWS ONLY;                              
                                                                        
         IF SQLCODE = 0                                                 
         THEN                                                           
            GS_IFRVALG_FUNDET = '1'B;                                   
         ELSE                                                           
            IF SQLCODE = 100                                            
            THEN                                                        
               GS_IFRVALG_FUNDET = '0'B;                                
            ELSE DO;                                                    
               ABENDTXT = '101 LÆS INDEFRYSNINGSVALG BS04600T';         
               CALL SQL_FEJL;                                           
               END;                                                     
                                                                        
                                                                        
 END SELECT_INDEFRYSNINGSVALG;                                          
 /*********************************************************************/
 /*      SELECT AF SAMMENLIGNINGSÅR OG GRUNDSKYLD (BS04400T/BS04300T) */
 /*********************************************************************/
 SELECT_GS_SAMMENLIGNINGSÅR:    PROC;                                   
                                                                        
         /* Hent Grundskyld for hele ejendommen på Sammenligningsår-  */
         /* grundlag                                                  */
                                                                        
         /* Hent Sammenligningsår                                     */
         DCLBS04400T.DINDKAAR     = DCLBS03600T.DINDKAAR;               
         DCLBS04400T.PERSONNUMMER = DCLBS03600T.PERSONNUMMER;           
         DCLBS04400T.EKOMNR       = DCLBS03600T.EKOMNR;                 
         DCLBS04400T.EEJDNR       = DCLBS03600T.EEJDNR;                 
         DCLBS04400T.DTILGLD      = '9999-12-31-23.59.59.999999';       
                                                                        
         EXEC SQL SELECT BS044.AKTSAMLIGNAAR                            
                    INTO :DCLBS04400T.AKTSAMLIGNAAR                     
                    FROM BS04400T BS044                                 
                   WHERE BS044.DINDKAAR     = :DCLBS04400T.DINDKAAR     
                     AND BS044.PERSONNUMMER = :DCLBS04400T.PERSONNUMMER 
                     AND BS044.EKOMNR       = :DCLBS04400T.EKOMNR       
                     AND BS044.EEJDNR       = :DCLBS04400T.EEJDNR       
                     AND BS044.DTILGLD      = :DCLBS04400T.DTILGLD;     
                                                                        
         IF SQLCODE = 0                                                 
         THEN DO;                                                       
            TV.LÆST_GSGR_SAMLÅR = TV.LÆST_GSGR_SAMLÅR + 1;              
            END;                                                        
         ELSE                                                           
            IF SQLCODE = 100                                            
            THEN                                                        
               DCLBS04400T.AKTSAMLIGNAAR = 0;                           
            ELSE DO;                                                    
               ABENDTXT = '101 LÆS SAMMENLIGNINGSÅR BS04400T';          
               CALL SQL_FEJL;                                           
               END;                                                     
                                                                        
         /* Hent grundskyld for hele ejendommen                       */
         IF DCLBS04400T.AKTSAMLIGNAAR  > 0                              
         THEN DO;                                                       
            DCLBS04300T.DINDKAAR     = DCLBS04400T.AKTSAMLIGNAAR;       
            DCLBS04300T.EKOMNR       = DCLBS03600T.EKOMNR;              
            DCLBS04300T.EEJDNR       = DCLBS03600T.EEJDNR;              
            DCLBS04300T.DTILGLD      = '9999-12-31-23.59.59.999999';    
                                                                        
            EXEC SQL SELECT BS043.GRUNDSKYLDEJENDOM                     
                       INTO :DCLBS04300T.GRUNDSKYLDEJENDOM              
                       FROM BS04300T BS043                              
                      WHERE BS043.DINDKAAR     = :DCLBS04300T.DINDKAAR  
                        AND BS043.EKOMNR       = :DCLBS04300T.EKOMNR    
                        AND BS043.EEJDNR       = :DCLBS04300T.EEJDNR    
                        AND BS043.DTILGLD      = :DCLBS04300T.DTILGLD;  
                                                                        
            IF SQLCODE = 0                                              
            THEN                                                        
               TV.LÆST_GSGR_GSEJENDOM = TV.LÆST_GSGR_GSEJENDOM + 1;     
            ELSE                                                        
               IF SQLCODE = 100                                         
               THEN                                                     
                  DCLBS04300T.GRUNDSKYLDEJENDOM = 0;                    
               ELSE DO;                                                 
                  ABENDTXT = '101 LÆS GRUNDSKYLD EJENDM BS04300T';      
                  CALL SQL_FEJL;                                        
                  END;                                                  
            END;                                                        
         ELSE                                                           
            DCLBS04300T.GRUNDSKYLDEJENDOM = 0;                          
                                                                        
 END SELECT_GS_SAMMENLIGNINGSÅR;                                        
 /*********************************************************************/
 /*      SELECT AF ESR OPLYSNINGER (BE65000T)                         */
 /*********************************************************************/
 SELECT_ESR_OPLYSNINGER:    PROC;                                       
                                                                        
         ESR_OPL_FUNDET            = '0'B;                              
         BEBYGGET_GRUND            = '1'B; /* Hvis ESR ikke findes    */
                                           /* betragtes grund som     */
                                           /* bebygget                */
                                                                        
         DCLBE65000T               = '';                                
         DCLBE65000T.TIL_EVS_AAR   = DCLBS03600T.DINDKAAR;              
         DCLBE65000T.AFVIKLINGS_ID = WS_FORSKUD_SLUT_TXT;               
         DCLBE65000T.DATA_ID       = WS_DATA_ID;                        
         DCLBE65000T.KØRSELS_ID    = 'ESR1';                            
         DCLBE65000T.DCPRN         = DCLBS03600T.PERSONNUMMER;          
         DCLBE65000T.EKOMNR        = DCLBS03600T.EKOMNR;                
         DCLBE65000T.EEJDNR        = DCLBS03600T.EEJDNR;                
                                                                        
         EXEC SQL DECLARE ESR_OPL_CUR CURSOR WITH HOLD FOR              
                   SELECT  BE650.TIL_EVS_AAR                            
                          ,BE650.AFVIKLINGS_ID                          
                          ,BE650.DATA_ID                                
                          ,BE650.KØRSELS_ID                             
                          ,BE650.DCPRN                                  
                          ,BE650.EKOMNR                                 
                          ,BE650.EEJDNR                                 
                          ,BE650.EENHEDLBNR                             
                          ,BE650.EJER_DAFSTÅ                            
                          ,BE650.OPL_VURDGL_CBENYT                      
                    FROM  BE65000T BE650                                
                   WHERE  BE650.TIL_EVS_AAR   =                         
                                             :DCLBE65000T.TIL_EVS_AAR   
                     AND  BE650.AFVIKLINGS_ID =                         
                                             :DCLBE65000T.AFVIKLINGS_ID 
                     AND  BE650.DATA_ID       = :DCLBE65000T.DATA_ID    
                     AND  BE650.KØRSELS_ID    = :DCLBE65000T.KØRSELS_ID 
                     AND  BE650.DCPRN         = :DCLBE65000T.DCPRN      
                     AND  BE650.EKOMNR        = :DCLBE65000T.EKOMNR     
                     AND  BE650.EEJDNR        = :DCLBE65000T.EEJDNR     
                   ORDER BY BE650.EENHEDLBNR, BE650.EJER_DAFSTÅ;        
                                                                        
         EXEC SQL OPEN ESR_OPL_CUR;                                     
                                                                        
         IF SQLCODE = 0                                                 
         THEN DO;                                                       
            EXEC SQL FETCH ESR_OPL_CUR INTO                             
                                       :DCLBE65000T.TIL_EVS_AAR         
                                      ,:DCLBE65000T.AFVIKLINGS_ID       
                                      ,:DCLBE65000T.DATA_ID             
                                      ,:DCLBE65000T.KØRSELS_ID          
                                      ,:DCLBE65000T.DCPRN               
                                      ,:DCLBE65000T.EKOMNR              
                                      ,:DCLBE65000T.EEJDNR              
                                      ,:DCLBE65000T.EENHEDLBNR          
                                      ,:DCLBE65000T.EJER_DAFSTÅ         
                                      ,:DCLBE65000T.OPL_VURDGL_CBENYT;  
                                                                        
            DO WHILE(SQLCODE = 0);                                      
                                                                        
               ESR_OPL_FUNDET = '1'B;                                   
                                                                        
               IF (DCLBE65000T.EJER_DAFSTÅ       = 0                    
                ! (DCLBE65000T.EJER_DAFSTÅ      >= HJ_EVS_AAR_START     
                &  DCLBE65000T.EJER_DAFSTÅ      <= HJ_EVS_AAR_SLUT))    
                &  DCLBE65000T.OPL_VURDGL_CBENYT = '09'                 
               THEN                                                     
                  BEBYGGET_GRUND = '0'B;                                
                                                                        
               EXEC SQL FETCH ESR_OPL_CUR INTO                          
                                       :DCLBE65000T.TIL_EVS_AAR         
                                      ,:DCLBE65000T.AFVIKLINGS_ID       
                                      ,:DCLBE65000T.DATA_ID             
                                      ,:DCLBE65000T.KØRSELS_ID          
                                      ,:DCLBE65000T.DCPRN               
                                      ,:DCLBE65000T.EKOMNR              
                                      ,:DCLBE65000T.EEJDNR              
                                      ,:DCLBE65000T.EENHEDLBNR          
                                      ,:DCLBE65000T.EJER_DAFSTÅ         
                                      ,:DCLBE65000T.OPL_VURDGL_CBENYT;  
                                                                        
            END;                                                        
                                                                        
            IF SQLCODE < 0                                              
            THEN DO;                                                    
               ABENDTXT = '101 FETCH ESR_OPL_CUR BE65000T';             
               CALL SQL_FEJL;                                           
               END;                                                     
                                                                        
            EXEC SQL CLOSE ESR_OPL_CUR;                                 
                                                                        
            IF SQLCODE < 0                                              
            THEN DO;                                                    
               ABENDTXT = '101 CLOSE ESR_OPL_CUR BE65000T';             
               CALL SQL_FEJL;                                           
               END;                                                     
            END;                                                        
         ELSE DO;                                                       
            ABENDTXT = '101 OPEN ESR_OPL_CUR BE65000T';                 
            CALL SQL_FEJL;                                              
            END;                                                        
                                                                        
 END SELECT_ESR_OPLYSNINGER;                                            
 /*********************************************************************/
 /*      INSERT GS RESULTAT - EJERRELATION (BS04100T)                 */
 /*********************************************************************/
 INSERT_GS_RES_EJERRELATION:   PROC;                                    
                                                                        
         EXEC SQL INSERT INTO BS04100T                                  
                  (DINDKAAR,                                            
                   PERSONNUMMER,                                        
                   EKOMNR,                                              
                   EEJDNR,                                              
                   DFRAGLD,                                             
                   DTILGLD,                                             
                   CINDEFRYS_VALG,                                      
                   COPR_CINDEFRYS_VALG,                                 
                   DATO_CINDEFRYS_VALG,                                 
                   GS_INDEFRYSBELØB_EJERREL,                            
                   GS_INDEFRYS_MIN_EJERREL,                             
                   CPLÅN_TILSAGN,                                       
                   COPR_CPLÅN_TILSAGN,                                  
                   DATO_CPLÅN_TILSAGN,                                  
                   PENSIONISTLÅN_BELØB_EJERREL,                         
                   NETTO_GS_EJENDOM,                                    
                   OPRET_AF)                                            
           VALUES (:DCLBS04100T.DINDKAAR,                               
                   :DCLBS04100T.PERSONNUMMER,                           
                   :DCLBS04100T.EKOMNR,                                 
                   :DCLBS04100T.EEJDNR,                                 
                   :DCLBS04100T.DFRAGLD,                                
                   :DCLBS04100T.DTILGLD,                                
                   :DCLBS04100T.CINDEFRYS_VALG,                         
                   :DCLBS04100T.COPR_CINDEFRYS_VALG,                    
                   :DCLBS04100T.DATO_CINDEFRYS_VALG,                    
                   :DCLBS04100T.GS_INDEFRYSBELØB_EJERREL,               
                   :DCLBS04100T.GS_INDEFRYS_MIN_EJERREL,                
                   :DCLBS04100T.CPLÅN_TILSAGN,                          
                   :DCLBS04100T.COPR_CPLÅN_TILSAGN,                     
                   :DCLBS04100T.DATO_CPLÅN_TILSAGN,                     
                   :DCLBS04100T.PENSIONISTLÅN_BELØB_EJERREL,            
                   :DCLBS04100T.NETTO_GS_EJENDOM,                       
                   :DCLBS04100T.OPRET_AF);                              
                                                                        
         IF SQLCODE = 0                                                 
         THEN DO;                                                       
            TV.SKRIV_GSRES_EJERRL  = TV.SKRIV_GSRES_EJERRL + 1;         
            TV.ANT_INS             = TV.ANT_INS + 1;                    
            END;                                                        
         ELSE DO;                                                       
            ABENDTXT = '101 INSERT GS EJERRELATION BS04100T';           
            CALL SQL_FEJL;                                              
            END;                                                        
                                                                        
 END INSERT_GS_RES_EJERRELATION;                                        
 /*********************************************************************/
 /*      INSERT GS RESULTAT - EJERFORHOLD  (BS04200T)                 */
 /*********************************************************************/
 INSERT_GS_RES_EJERFORHOLD:   PROC;                                     
                                                                        
         EXEC SQL INSERT INTO BS04200T                                  
                  (DINDKAAR,                                            
                   PERSONNUMMER,                                        
                   EKOMNR,                                              
                   EEJDNR,                                              
                   EPLBNR,                                              
                   DFRAGLD,                                             
                   DTILGLD,                                             
                   CICSID,                                              
                   GS_INDEFRYS_BELØB,                                   
                   GS_INDEFRYS_BELØB_NEG,                               
                   GS_INDEFRYS_BELØB_POT,                               
                   GS_INDEFRYS_BELØB_MIN,                               
                   PENSIONISTLÅNEBELØB,                                 
                   NETTO_GS_EFT_INDEFRYS,                               
                   NETTO_GS_EFT_PLÅN,                                   
                   NETTO_GS_EJERFORHOLD,                                
                   DFRAGLD_GSG,                                         
                   OPRET_AF)                                            
           VALUES (:DCLBS04200T.DINDKAAR,                               
                   :DCLBS04200T.PERSONNUMMER,                           
                   :DCLBS04200T.EKOMNR,                                 
                   :DCLBS04200T.EEJDNR,                                 
                   :DCLBS04200T.EPLBNR,                                 
                   :DCLBS04200T.DFRAGLD,                                
                   :DCLBS04200T.DTILGLD,                                
                   :DCLBS04200T.CICSID,                                 
                   :DCLBS04200T.GS_INDEFRYS_BELØB,                      
                   :DCLBS04200T.GS_INDEFRYS_BELØB_NEG,                  
                   :DCLBS04200T.GS_INDEFRYS_BELØB_POT,                  
                   :DCLBS04200T.GS_INDEFRYS_BELØB_MIN,                  
                   :DCLBS04200T.PENSIONISTLÅNEBELØB,                    
                   :DCLBS04200T.NETTO_GS_EFT_INDEFRYS,                  
                   :DCLBS04200T.NETTO_GS_EFT_PLÅN,                      
                   :DCLBS04200T.NETTO_GS_EJERFORHOLD,                   
                   :DCLBS04200T.DFRAGLD_GSG,                            
                   :DCLBS04200T.OPRET_AF);                              
                                                                        
         IF SQLCODE = 0                                                 
         THEN DO;                                                       
            TV.SKRIV_GSRES_EJERFH  = TV.SKRIV_GSRES_EJERFH + 1;         
            TV.ANT_INS             = TV.ANT_INS + 1;                    
            END;                                                        
         ELSE DO;                                                       
            ABENDTXT = '101 INSERT GS EJERFORHOLD BS04200T';            
            CALL SQL_FEJL;                                              
            END;                                                        
                                                                        
 END INSERT_GS_RES_EJERFORHOLD;                                         
